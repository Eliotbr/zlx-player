"use strict";var _typeof2=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f;}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e);},l,l.exports,e,t,n,r);}return n[o].exports;}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++){s(r[o]);}return s;})({1:[function(require,module,exports){(function(){"use strict";var videojs=require("video.js");var DependencyInjector=require("./src/Helper/DependencyInjector.js");var VideoTorrent=require("./src/Helper/VideoTorrent.js");var ZLXPlayer=function ZLXPlayer(player_element,opts,callback){var self=this;this._playerElement=player_element;this.dependencyInjector=new DependencyInjector(videojs);this.VideoTorrent=new VideoTorrent();try{this.opts={autoplay:true,controls:true,sources:{},prefer_quality:"high",adTagUrl:null,adLabel:"Advertising"};this._loadOptions(opts);this._config={autoplay:this.opts.autoplay,controls:this.opts.controls,plugins:{}};this.dependencyInjector.loadDependencies().then(function(){self._createPlayer().then(function(player){self.player=player;self._loadAds();return callback(self.player);});}).catch(function(e){console.log("[ZLX PLAYER] >> ERROR << "+e);});}catch(e){console.log("[ZLX PLAYER] >> ERROR << "+e);}};ZLXPlayer.prototype._loadOptions=function _loadOptions(opts){opts=opts||{};for(var key in opts){this.opts[key]=opts[key];}};ZLXPlayer.prototype._createPlayer=function _createPlayer(){var self=this;return new Promise(function(resolve,reject){var _configs=self._configPlayer();var _player=videojs(self._playerElement,_configs,function(){var _sources=self.opts.sources||{};var player_srcs=[];for(var quality in _sources){player_srcs.push({label:quality.toUpperCase(),src:_sources[quality].src,type:_sources[quality].type});}_player.updateSrc(player_srcs);resolve(_player);});});};ZLXPlayer.prototype._loadAds=function _loadAds(){var self=this;var options={id:this._playerElement,adTagUrl:this.opts.adTagUrl,adLabel:this.opts.adLabel};var supportsES6=function(){try{new Function("(a = 0) => a");return true;}catch(err){return false;}}();if(options.adTagUrl&&supportsES6===true){videojs.Html5=videojs.getComponent("Html5");this.player.ima(options);var startEvent="click";if(navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/Android/i)){startEvent="touchend";}var contentPlayer=document.getElementById(this._playerElement+"_html5_api");if(contentPlayer){if((navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/Android/i))&&contentPlayer.hasAttribute("controls")){contentPlayer.removeAttribute("controls");}if(this.player.autoplay()!==true){this.player.one(startEvent,function(){self.player.ima.initializeAdDisplayContainer();self.player.ima.requestAds();self.player.play();});}else{this.player.ima.initializeAdDisplayContainer();this.player.ima.requestAds();}}else{this.player.one(startEvent,function(){self.player.play();});}}};ZLXPlayer.prototype._configPlayer=function _configPlayer(){var self=this;this._config.plugins["videoJsResolutionSwitcher"]=null;var qualitySwitcherConfig={default:this.opts.prefer_quality};if(this.VideoTorrent.isSupported()){qualitySwitcherConfig["customSourcePicker"]=this._customSourcePicker.bind(this);}this._config.plugins["videoJsResolutionSwitcher"]=qualitySwitcherConfig;return this._config;};ZLXPlayer.prototype._fallbackToServer=function _fallbackToServer(player,source,type){player.src({src:source,type:type});};ZLXPlayer.prototype._customSourcePicker=function _customSourcePicker(player,sources,label,is_starting){var self=this;try{var _source=this.opts.sources[label.toLowerCase()];if(!_source.magnet){throw"No magnet link to Quality "+label+". Falling back to Server only.";}this.VideoTorrent.change(_source.magnet).then(function(file){file.renderTo(self._playerElement,{autoplay:self.opts.autoplay});}).catch(function(e){self._fallbackToServer(player,_source.src,_source.type);});}catch(e){console.log(e);this._fallbackToServer(player,_source.src,_source.type);}return player;};window.ZLXPlayer=ZLXPlayer;})();},{"./src/Helper/DependencyInjector.js":375,"./src/Helper/VideoTorrent.js":376,"video.js":332}],2:[function(require,module,exports){var ADDR_RE=/^\[?([^\]]+)\]?:(\d+)$/;var cache={};var size=0;module.exports=function addrToIPPort(addr){if(size===1e5)module.exports.reset();if(!cache[addr]){var m=ADDR_RE.exec(addr);if(!m)throw new Error("invalid addr: "+addr);cache[addr]=[m[1],Number(m[2])];size+=1;}return cache[addr];};module.exports.reset=function reset(){cache={};size=0;};},{}],3:[function(require,module,exports){"use strict";exports.byteLength=byteLength;exports.toByteArray=toByteArray;exports.fromByteArray=fromByteArray;var lookup=[];var revLookup=[];var Arr=typeof Uint8Array!=="undefined"?Uint8Array:Array;var code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var i=0,len=code.length;i<len;++i){lookup[i]=code[i];revLookup[code.charCodeAt(i)]=i;}revLookup["-".charCodeAt(0)]=62;revLookup["_".charCodeAt(0)]=63;function placeHoldersCount(b64){var len=b64.length;if(len%4>0){throw new Error("Invalid string. Length must be a multiple of 4");}return b64[len-2]==="="?2:b64[len-1]==="="?1:0;}function byteLength(b64){return b64.length*3/4-placeHoldersCount(b64);}function toByteArray(b64){var i,l,tmp,placeHolders,arr;var len=b64.length;placeHolders=placeHoldersCount(b64);arr=new Arr(len*3/4-placeHolders);l=placeHolders>0?len-4:len;var L=0;for(i=0;i<l;i+=4){tmp=revLookup[b64.charCodeAt(i)]<<18|revLookup[b64.charCodeAt(i+1)]<<12|revLookup[b64.charCodeAt(i+2)]<<6|revLookup[b64.charCodeAt(i+3)];arr[L++]=tmp>>16&255;arr[L++]=tmp>>8&255;arr[L++]=tmp&255;}if(placeHolders===2){tmp=revLookup[b64.charCodeAt(i)]<<2|revLookup[b64.charCodeAt(i+1)]>>4;arr[L++]=tmp&255;}else if(placeHolders===1){tmp=revLookup[b64.charCodeAt(i)]<<10|revLookup[b64.charCodeAt(i+1)]<<4|revLookup[b64.charCodeAt(i+2)]>>2;arr[L++]=tmp>>8&255;arr[L++]=tmp&255;}return arr;}function tripletToBase64(num){return lookup[num>>18&63]+lookup[num>>12&63]+lookup[num>>6&63]+lookup[num&63];}function encodeChunk(uint8,start,end){var tmp;var output=[];for(var i=start;i<end;i+=3){tmp=(uint8[i]<<16)+(uint8[i+1]<<8)+uint8[i+2];output.push(tripletToBase64(tmp));}return output.join("");}function fromByteArray(uint8){var tmp;var len=uint8.length;var extraBytes=len%3;var output="";var parts=[];var maxChunkLength=16383;for(var i=0,len2=len-extraBytes;i<len2;i+=maxChunkLength){parts.push(encodeChunk(uint8,i,i+maxChunkLength>len2?len2:i+maxChunkLength));}if(extraBytes===1){tmp=uint8[len-1];output+=lookup[tmp>>2];output+=lookup[tmp<<4&63];output+="==";}else if(extraBytes===2){tmp=(uint8[len-2]<<8)+uint8[len-1];output+=lookup[tmp>>10];output+=lookup[tmp>>4&63];output+=lookup[tmp<<2&63];output+="=";}parts.push(output);return parts.join("");}},{}],4:[function(require,module,exports){(function(Buffer){var INTEGER_START=105;var STRING_DELIM=58;var DICTIONARY_START=100;var LIST_START=108;var END_OF_TYPE=101;function getIntFromBuffer(buffer,start,end){var sum=0;var sign=1;for(var i=start;i<end;i++){var num=buffer[i];if(num<58&&num>=48){sum=sum*10+(num-48);continue;}if(i===start&&num===43){continue;}if(i===start&&num===45){sign=-1;continue;}if(num===46){break;}throw new Error("not a number: buffer["+i+"] = "+num);}return sum*sign;}function decode(data,start,end,encoding){if(data==null||data.length===0){return null;}if(typeof start!=="number"&&encoding==null){encoding=start;start=undefined;}if(typeof end!=="number"&&encoding==null){encoding=end;end=undefined;}decode.position=0;decode.encoding=encoding||null;decode.data=!Buffer.isBuffer(data)?new Buffer(data):data.slice(start,end);decode.bytes=decode.data.length;return decode.next();}decode.bytes=0;decode.position=0;decode.data=null;decode.encoding=null;decode.next=function(){switch(decode.data[decode.position]){case DICTIONARY_START:return decode.dictionary();case LIST_START:return decode.list();case INTEGER_START:return decode.integer();default:return decode.buffer();}};decode.find=function(chr){var i=decode.position;var c=decode.data.length;var d=decode.data;while(i<c){if(d[i]===chr)return i;i++;}throw new Error('Invalid data: Missing delimiter "'+String.fromCharCode(chr)+'" [0x'+chr.toString(16)+"]");};decode.dictionary=function(){decode.position++;var dict={};while(decode.data[decode.position]!==END_OF_TYPE){dict[decode.buffer()]=decode.next();}decode.position++;return dict;};decode.list=function(){decode.position++;var lst=[];while(decode.data[decode.position]!==END_OF_TYPE){lst.push(decode.next());}decode.position++;return lst;};decode.integer=function(){var end=decode.find(END_OF_TYPE);var number=getIntFromBuffer(decode.data,decode.position+1,end);decode.position+=end+1-decode.position;return number;};decode.buffer=function(){var sep=decode.find(STRING_DELIM);var length=getIntFromBuffer(decode.data,decode.position,sep);var end=++sep+length;decode.position=end;return decode.encoding?decode.data.toString(decode.encoding,sep,end):decode.data.slice(sep,end);};module.exports=decode;}).call(this,require("buffer").Buffer);},{buffer:41}],5:[function(require,module,exports){var Buffer=require("safe-buffer").Buffer;function encode(data,buffer,offset){var buffers=[];var result=null;encode._encode(buffers,data);result=Buffer.concat(buffers);encode.bytes=result.length;if(Buffer.isBuffer(buffer)){result.copy(buffer,offset);return buffer;}return result;}encode.bytes=-1;encode._floatConversionDetected=false;encode._encode=function(buffers,data){if(Buffer.isBuffer(data)){buffers.push(Buffer.from(data.length+":"));buffers.push(data);return;}if(data==null){return;}switch(typeof data==="undefined"?"undefined":_typeof2(data)){case"string":encode.buffer(buffers,data);break;case"number":encode.number(buffers,data);break;case"object":data.constructor===Array?encode.list(buffers,data):encode.dict(buffers,data);break;case"boolean":encode.number(buffers,data?1:0);break;}};var buffE=Buffer.from("e");var buffD=Buffer.from("d");var buffL=Buffer.from("l");encode.buffer=function(buffers,data){buffers.push(Buffer.from(Buffer.byteLength(data)+":"+data));};encode.number=function(buffers,data){var maxLo=2147483648;var hi=data/maxLo<<0;var lo=data%maxLo<<0;var val=hi*maxLo+lo;buffers.push(Buffer.from("i"+val+"e"));if(val!==data&&!encode._floatConversionDetected){encode._floatConversionDetected=true;console.warn('WARNING: Possible data corruption detected with value "'+data+'":','Bencoding only defines support for integers, value was converted to "'+val+'"');console.trace();}};encode.dict=function(buffers,data){buffers.push(buffD);var j=0;var k;var keys=Object.keys(data).sort();var kl=keys.length;for(;j<kl;j++){k=keys[j];if(data[k]==null)continue;encode.buffer(buffers,k);encode._encode(buffers,data[k]);}buffers.push(buffE);};encode.list=function(buffers,data){var i=0;var c=data.length;buffers.push(buffL);for(;i<c;i++){if(data[i]==null)continue;encode._encode(buffers,data[i]);}buffers.push(buffE);};module.exports=encode;},{"safe-buffer":177}],6:[function(require,module,exports){var bencode=module.exports;bencode.encode=require("./encode");bencode.decode=require("./decode");bencode.byteLength=bencode.encodingLength=function(value){return bencode.encode(value).length;};},{"./decode":4,"./encode":5}],7:[function(require,module,exports){module.exports=function(haystack,needle,comparator,low,high){var mid,cmp;if(low===undefined)low=0;else{low=low|0;if(low<0||low>=haystack.length)throw new RangeError("invalid lower bound");}if(high===undefined)high=haystack.length-1;else{high=high|0;if(high<low||high>=haystack.length)throw new RangeError("invalid upper bound");}while(low<=high){mid=low+(high-low>>1);cmp=+comparator(haystack[mid],needle,mid,haystack);if(cmp<0)low=mid+1;else if(cmp>0)high=mid-1;else return mid;}return~low;};},{}],8:[function(require,module,exports){(function(Buffer){var Container=typeof Buffer!=="undefined"?Buffer:typeof Int8Array!=="undefined"?Int8Array:function(l){var a=new Array(l);for(var i=0;i<l;i++){a[i]=0;}};function BitField(data,opts){if(!(this instanceof BitField)){return new BitField(data,opts);}if(arguments.length===0){data=0;}this.grow=opts&&(isFinite(opts.grow)&&getByteSize(opts.grow)||opts.grow)||0;if(typeof data==="number"||data===undefined){data=new Container(getByteSize(data));if(data.fill&&!data._isBuffer)data.fill(0);}this.buffer=data;}function getByteSize(num){var out=num>>3;if(num%8!==0)out++;return out;}BitField.prototype.get=function(i){var j=i>>3;return j<this.buffer.length&&!!(this.buffer[j]&128>>i%8);};BitField.prototype.set=function(i,b){var j=i>>3;if(b||arguments.length===1){if(this.buffer.length<j+1)this._grow(Math.max(j+1,Math.min(2*this.buffer.length,this.grow)));this.buffer[j]|=128>>i%8;}else if(j<this.buffer.length){this.buffer[j]&=~(128>>i%8);}};BitField.prototype._grow=function(length){if(this.buffer.length<length&&length<=this.grow){var newBuffer=new Container(length);if(newBuffer.fill)newBuffer.fill(0);if(this.buffer.copy)this.buffer.copy(newBuffer,0);else{for(var i=0;i<this.buffer.length;i++){newBuffer[i]=this.buffer[i];}}this.buffer=newBuffer;}};if(typeof module!=="undefined")module.exports=BitField;}).call(this,require("buffer").Buffer);},{buffer:41}],9:[function(require,module,exports){module.exports=Wire;var arrayRemove=require("unordered-array-remove");var bencode=require("bencode");var BitField=require("bitfield");var Buffer=require("safe-buffer").Buffer;var debug=require("debug")("bittorrent-protocol");var extend=require("xtend");var inherits=require("inherits");var randombytes=require("randombytes");var speedometer=require("speedometer");var stream=require("readable-stream");var BITFIELD_GROW=4e5;var KEEP_ALIVE_TIMEOUT=55e3;var MESSAGE_PROTOCOL=Buffer.from("BitTorrent protocol");var MESSAGE_KEEP_ALIVE=Buffer.from([0,0,0,0]);var MESSAGE_CHOKE=Buffer.from([0,0,0,1,0]);var MESSAGE_UNCHOKE=Buffer.from([0,0,0,1,1]);var MESSAGE_INTERESTED=Buffer.from([0,0,0,1,2]);var MESSAGE_UNINTERESTED=Buffer.from([0,0,0,1,3]);var MESSAGE_RESERVED=[0,0,0,0,0,0,0,0];var MESSAGE_PORT=[0,0,0,3,9,0,0];function Request(piece,offset,length,callback){this.piece=piece;this.offset=offset;this.length=length;this.callback=callback;}inherits(Wire,stream.Duplex);function Wire(){if(!(this instanceof Wire))return new Wire();stream.Duplex.call(this);this._debugId=randombytes(4).toString("hex");this._debug("new wire");this.peerId=null;this.peerIdBuffer=null;this.type=null;this.amChoking=true;this.amInterested=false;this.peerChoking=true;this.peerInterested=false;this.peerPieces=new BitField(0,{grow:BITFIELD_GROW});this.peerExtensions={};this.requests=[];this.peerRequests=[];this.extendedMapping={};this.peerExtendedMapping={};this.extendedHandshake={};this.peerExtendedHandshake={};this._ext={};this._nextExt=1;this.uploaded=0;this.downloaded=0;this.uploadSpeed=speedometer();this.downloadSpeed=speedometer();this._keepAliveInterval=null;this._timeout=null;this._timeoutMs=0;this.destroyed=false;this._finished=false;this._parserSize=0;this._parser=null;this._buffer=[];this._bufferSize=0;this.on("finish",this._onFinish);this._parseHandshake();}Wire.prototype.setKeepAlive=function(enable){var self=this;self._debug("setKeepAlive %s",enable);clearInterval(self._keepAliveInterval);if(enable===false)return;self._keepAliveInterval=setInterval(function(){self.keepAlive();},KEEP_ALIVE_TIMEOUT);};Wire.prototype.setTimeout=function(ms,unref){this._debug("setTimeout ms=%d unref=%s",ms,unref);this._clearTimeout();this._timeoutMs=ms;this._timeoutUnref=!!unref;this._updateTimeout();};Wire.prototype.destroy=function(){if(this.destroyed)return;this.destroyed=true;this._debug("destroy");this.emit("close");this.end();};Wire.prototype.end=function(){this._debug("end");this._onUninterested();this._onChoke();stream.Duplex.prototype.end.apply(this,arguments);};Wire.prototype.use=function(Extension){var name=Extension.prototype.name;if(!name){throw new Error('Extension class requires a "name" property on the prototype');}this._debug("use extension.name=%s",name);var ext=this._nextExt;var handler=new Extension(this);function noop(){}if(typeof handler.onHandshake!=="function"){handler.onHandshake=noop;}if(typeof handler.onExtendedHandshake!=="function"){handler.onExtendedHandshake=noop;}if(typeof handler.onMessage!=="function"){handler.onMessage=noop;}this.extendedMapping[ext]=name;this._ext[name]=handler;this[name]=handler;this._nextExt+=1;};Wire.prototype.keepAlive=function(){this._debug("keep-alive");this._push(MESSAGE_KEEP_ALIVE);};Wire.prototype.handshake=function(infoHash,peerId,extensions){var infoHashBuffer,peerIdBuffer;if(typeof infoHash==="string"){infoHashBuffer=Buffer.from(infoHash,"hex");}else{infoHashBuffer=infoHash;infoHash=infoHashBuffer.toString("hex");}if(typeof peerId==="string"){peerIdBuffer=Buffer.from(peerId,"hex");}else{peerIdBuffer=peerId;peerId=peerIdBuffer.toString("hex");}if(infoHashBuffer.length!==20||peerIdBuffer.length!==20){throw new Error("infoHash and peerId MUST have length 20");}this._debug("handshake i=%s p=%s exts=%o",infoHash,peerId,extensions);var reserved=Buffer.from(MESSAGE_RESERVED);reserved[5]|=16;if(extensions&&extensions.dht)reserved[7]|=1;this._push(Buffer.concat([MESSAGE_PROTOCOL,reserved,infoHashBuffer,peerIdBuffer]));this._handshakeSent=true;if(this.peerExtensions.extended&&!this._extendedHandshakeSent){this._sendExtendedHandshake();}};Wire.prototype._sendExtendedHandshake=function(){var msg=extend(this.extendedHandshake);msg.m={};for(var ext in this.extendedMapping){var name=this.extendedMapping[ext];msg.m[name]=Number(ext);}this.extended(0,bencode.encode(msg));this._extendedHandshakeSent=true;};Wire.prototype.choke=function(){if(this.amChoking)return;this.amChoking=true;this._debug("choke");while(this.peerRequests.length){this.peerRequests.pop();}this._push(MESSAGE_CHOKE);};Wire.prototype.unchoke=function(){if(!this.amChoking)return;this.amChoking=false;this._debug("unchoke");this._push(MESSAGE_UNCHOKE);};Wire.prototype.interested=function(){if(this.amInterested)return;this.amInterested=true;this._debug("interested");this._push(MESSAGE_INTERESTED);};Wire.prototype.uninterested=function(){if(!this.amInterested)return;this.amInterested=false;this._debug("uninterested");this._push(MESSAGE_UNINTERESTED);};Wire.prototype.have=function(index){this._debug("have %d",index);this._message(4,[index],null);};Wire.prototype.bitfield=function(bitfield){this._debug("bitfield");if(!Buffer.isBuffer(bitfield))bitfield=bitfield.buffer;this._message(5,[],bitfield);};Wire.prototype.request=function(index,offset,length,cb){if(!cb)cb=function cb(){};if(this._finished)return cb(new Error("wire is closed"));if(this.peerChoking)return cb(new Error("peer is choking"));this._debug("request index=%d offset=%d length=%d",index,offset,length);this.requests.push(new Request(index,offset,length,cb));this._updateTimeout();this._message(6,[index,offset,length],null);};Wire.prototype.piece=function(index,offset,buffer){this._debug("piece index=%d offset=%d",index,offset);this.uploaded+=buffer.length;this.uploadSpeed(buffer.length);this.emit("upload",buffer.length);this._message(7,[index,offset],buffer);};Wire.prototype.cancel=function(index,offset,length){this._debug("cancel index=%d offset=%d length=%d",index,offset,length);this._callback(pull(this.requests,index,offset,length),new Error("request was cancelled"),null);this._message(8,[index,offset,length],null);};Wire.prototype.port=function(port){this._debug("port %d",port);var message=Buffer.from(MESSAGE_PORT);message.writeUInt16BE(port,5);this._push(message);};Wire.prototype.extended=function(ext,obj){this._debug("extended ext=%s",ext);if(typeof ext==="string"&&this.peerExtendedMapping[ext]){ext=this.peerExtendedMapping[ext];}if(typeof ext==="number"){var extId=Buffer.from([ext]);var buf=Buffer.isBuffer(obj)?obj:bencode.encode(obj);this._message(20,[],Buffer.concat([extId,buf]));}else{throw new Error("Unrecognized extension: "+ext);}};Wire.prototype._read=function(){};Wire.prototype._message=function(id,numbers,data){var dataLength=data?data.length:0;var buffer=Buffer.allocUnsafe(5+4*numbers.length);buffer.writeUInt32BE(buffer.length+dataLength-4,0);buffer[4]=id;for(var i=0;i<numbers.length;i++){buffer.writeUInt32BE(numbers[i],5+4*i);}this._push(buffer);if(data)this._push(data);};Wire.prototype._push=function(data){if(this._finished)return;return this.push(data);};Wire.prototype._onKeepAlive=function(){this._debug("got keep-alive");this.emit("keep-alive");};Wire.prototype._onHandshake=function(infoHashBuffer,peerIdBuffer,extensions){var infoHash=infoHashBuffer.toString("hex");var peerId=peerIdBuffer.toString("hex");this._debug("got handshake i=%s p=%s exts=%o",infoHash,peerId,extensions);this.peerId=peerId;this.peerIdBuffer=peerIdBuffer;this.peerExtensions=extensions;this.emit("handshake",infoHash,peerId,extensions);var name;for(name in this._ext){this._ext[name].onHandshake(infoHash,peerId,extensions);}if(extensions.extended&&this._handshakeSent&&!this._extendedHandshakeSent){this._sendExtendedHandshake();}};Wire.prototype._onChoke=function(){this.peerChoking=true;this._debug("got choke");this.emit("choke");while(this.requests.length){this._callback(this.requests.pop(),new Error("peer is choking"),null);}};Wire.prototype._onUnchoke=function(){this.peerChoking=false;this._debug("got unchoke");this.emit("unchoke");};Wire.prototype._onInterested=function(){this.peerInterested=true;this._debug("got interested");this.emit("interested");};Wire.prototype._onUninterested=function(){this.peerInterested=false;this._debug("got uninterested");this.emit("uninterested");};Wire.prototype._onHave=function(index){if(this.peerPieces.get(index))return;this._debug("got have %d",index);this.peerPieces.set(index,true);this.emit("have",index);};Wire.prototype._onBitField=function(buffer){this.peerPieces=new BitField(buffer);this._debug("got bitfield");this.emit("bitfield",this.peerPieces);};Wire.prototype._onRequest=function(index,offset,length){var self=this;if(self.amChoking)return;self._debug("got request index=%d offset=%d length=%d",index,offset,length);var respond=function respond(err,buffer){if(request!==pull(self.peerRequests,index,offset,length))return;if(err)return self._debug("error satisfying request index=%d offset=%d length=%d (%s)",index,offset,length,err.message);self.piece(index,offset,buffer);};var request=new Request(index,offset,length,respond);self.peerRequests.push(request);self.emit("request",index,offset,length,respond);};Wire.prototype._onPiece=function(index,offset,buffer){this._debug("got piece index=%d offset=%d",index,offset);this._callback(pull(this.requests,index,offset,buffer.length),null,buffer);this.downloaded+=buffer.length;this.downloadSpeed(buffer.length);this.emit("download",buffer.length);this.emit("piece",index,offset,buffer);};Wire.prototype._onCancel=function(index,offset,length){this._debug("got cancel index=%d offset=%d length=%d",index,offset,length);pull(this.peerRequests,index,offset,length);this.emit("cancel",index,offset,length);};Wire.prototype._onPort=function(port){this._debug("got port %d",port);this.emit("port",port);};Wire.prototype._onExtended=function(ext,buf){if(ext===0){var info;try{info=bencode.decode(buf);}catch(err){this._debug("ignoring invalid extended handshake: %s",err.message||err);}if(!info)return;this.peerExtendedHandshake=info;var name;if(_typeof2(info.m)==="object"){for(name in info.m){this.peerExtendedMapping[name]=Number(info.m[name].toString());}}for(name in this._ext){if(this.peerExtendedMapping[name]){this._ext[name].onExtendedHandshake(this.peerExtendedHandshake);}}this._debug("got extended handshake");this.emit("extended","handshake",this.peerExtendedHandshake);}else{if(this.extendedMapping[ext]){ext=this.extendedMapping[ext];if(this._ext[ext]){this._ext[ext].onMessage(buf);}}this._debug("got extended message ext=%s",ext);this.emit("extended",ext,buf);}};Wire.prototype._onTimeout=function(){this._debug("request timed out");this._callback(this.requests.shift(),new Error("request has timed out"),null);this.emit("timeout");};Wire.prototype._write=function(data,encoding,cb){this._bufferSize+=data.length;this._buffer.push(data);while(this._bufferSize>=this._parserSize){var buffer=this._buffer.length===1?this._buffer[0]:Buffer.concat(this._buffer);this._bufferSize-=this._parserSize;this._buffer=this._bufferSize?[buffer.slice(this._parserSize)]:[];this._parser(buffer.slice(0,this._parserSize));}cb(null);};Wire.prototype._callback=function(request,err,buffer){if(!request)return;this._clearTimeout();if(!this.peerChoking&&!this._finished)this._updateTimeout();request.callback(err,buffer);};Wire.prototype._clearTimeout=function(){if(!this._timeout)return;clearTimeout(this._timeout);this._timeout=null;};Wire.prototype._updateTimeout=function(){var self=this;if(!self._timeoutMs||!self.requests.length||self._timeout)return;self._timeout=setTimeout(function(){self._onTimeout();},self._timeoutMs);if(self._timeoutUnref&&self._timeout.unref)self._timeout.unref();};Wire.prototype._parse=function(size,parser){this._parserSize=size;this._parser=parser;};Wire.prototype._onMessageLength=function(buffer){var length=buffer.readUInt32BE(0);if(length>0){this._parse(length,this._onMessage);}else{this._onKeepAlive();this._parse(4,this._onMessageLength);}};Wire.prototype._onMessage=function(buffer){this._parse(4,this._onMessageLength);switch(buffer[0]){case 0:return this._onChoke();case 1:return this._onUnchoke();case 2:return this._onInterested();case 3:return this._onUninterested();case 4:return this._onHave(buffer.readUInt32BE(1));case 5:return this._onBitField(buffer.slice(1));case 6:return this._onRequest(buffer.readUInt32BE(1),buffer.readUInt32BE(5),buffer.readUInt32BE(9));case 7:return this._onPiece(buffer.readUInt32BE(1),buffer.readUInt32BE(5),buffer.slice(9));case 8:return this._onCancel(buffer.readUInt32BE(1),buffer.readUInt32BE(5),buffer.readUInt32BE(9));case 9:return this._onPort(buffer.readUInt16BE(1));case 20:return this._onExtended(buffer.readUInt8(1),buffer.slice(2));default:this._debug("got unknown message");return this.emit("unknownmessage",buffer);}};Wire.prototype._parseHandshake=function(){var self=this;self._parse(1,function(buffer){var pstrlen=buffer.readUInt8(0);self._parse(pstrlen+48,function(handshake){var protocol=handshake.slice(0,pstrlen);if(protocol.toString()!=="BitTorrent protocol"){self._debug("Error: wire not speaking BitTorrent protocol (%s)",protocol.toString());self.end();return;}handshake=handshake.slice(pstrlen);self._onHandshake(handshake.slice(8,28),handshake.slice(28,48),{dht:!!(handshake[7]&1),extended:!!(handshake[5]&16)});self._parse(4,self._onMessageLength);});});};Wire.prototype._onFinish=function(){this._finished=true;this.push(null);while(this.read()){}clearInterval(this._keepAliveInterval);this._parse(Number.MAX_VALUE,function(){});while(this.peerRequests.length){this.peerRequests.pop();}while(this.requests.length){this._callback(this.requests.pop(),new Error("wire was closed"),null);}};Wire.prototype._debug=function(){var args=[].slice.call(arguments);args[0]="["+this._debugId+"] "+args[0];debug.apply(null,args);};function pull(requests,piece,offset,length){for(var i=0;i<requests.length;i++){var req=requests[i];if(req.piece===piece&&req.offset===offset&&req.length===length){arrayRemove(requests,i);return req;}}return null;}},{bencode:6,bitfield:8,debug:69,inherits:94,randombytes:159,"readable-stream":19,"safe-buffer":177,speedometer:206,"unordered-array-remove":235,xtend:372}],10:[function(require,module,exports){var toString={}.toString;module.exports=Array.isArray||function(arr){return toString.call(arr)=="[object Array]";};},{}],11:[function(require,module,exports){"use strict";var processNextTick=require("process-nextick-args");var objectKeys=Object.keys||function(obj){var keys=[];for(var key in obj){keys.push(key);}return keys;};module.exports=Duplex;var util=require("core-util-is");util.inherits=require("inherits");var Readable=require("./_stream_readable");var Writable=require("./_stream_writable");util.inherits(Duplex,Readable);var keys=objectKeys(Writable.prototype);for(var v=0;v<keys.length;v++){var method=keys[v];if(!Duplex.prototype[method])Duplex.prototype[method]=Writable.prototype[method];}function Duplex(options){if(!(this instanceof Duplex))return new Duplex(options);Readable.call(this,options);Writable.call(this,options);if(options&&options.readable===false)this.readable=false;if(options&&options.writable===false)this.writable=false;this.allowHalfOpen=true;if(options&&options.allowHalfOpen===false)this.allowHalfOpen=false;this.once("end",onend);}function onend(){if(this.allowHalfOpen||this._writableState.ended)return;processNextTick(onEndNT,this);}function onEndNT(self){self.end();}Object.defineProperty(Duplex.prototype,"destroyed",{get:function get(){if(this._readableState===undefined||this._writableState===undefined){return false;}return this._readableState.destroyed&&this._writableState.destroyed;},set:function set(value){if(this._readableState===undefined||this._writableState===undefined){return;}this._readableState.destroyed=value;this._writableState.destroyed=value;}});Duplex.prototype._destroy=function(err,cb){this.push(null);this.end();processNextTick(cb,err);};function forEach(xs,f){for(var i=0,l=xs.length;i<l;i++){f(xs[i],i);}}},{"./_stream_readable":13,"./_stream_writable":15,"core-util-is":56,inherits:94,"process-nextick-args":152}],12:[function(require,module,exports){"use strict";module.exports=PassThrough;var Transform=require("./_stream_transform");var util=require("core-util-is");util.inherits=require("inherits");util.inherits(PassThrough,Transform);function PassThrough(options){if(!(this instanceof PassThrough))return new PassThrough(options);Transform.call(this,options);}PassThrough.prototype._transform=function(chunk,encoding,cb){cb(null,chunk);};},{"./_stream_transform":14,"core-util-is":56,inherits:94}],13:[function(require,module,exports){(function(process,global){"use strict";var processNextTick=require("process-nextick-args");module.exports=Readable;var isArray=require("isarray");var Duplex;Readable.ReadableState=ReadableState;var EE=require("events").EventEmitter;var EElistenerCount=function EElistenerCount(emitter,type){return emitter.listeners(type).length;};var Stream=require("./internal/streams/stream");var Buffer=require("safe-buffer").Buffer;var OurUint8Array=global.Uint8Array||function(){};function _uint8ArrayToBuffer(chunk){return Buffer.from(chunk);}function _isUint8Array(obj){return Buffer.isBuffer(obj)||obj instanceof OurUint8Array;}var util=require("core-util-is");util.inherits=require("inherits");var debugUtil=require("util");var debug=void 0;if(debugUtil&&debugUtil.debuglog){debug=debugUtil.debuglog("stream");}else{debug=function debug(){};}var BufferList=require("./internal/streams/BufferList");var destroyImpl=require("./internal/streams/destroy");var StringDecoder;util.inherits(Readable,Stream);var kProxyEvents=["error","close","destroy","pause","resume"];function prependListener(emitter,event,fn){if(typeof emitter.prependListener==="function"){return emitter.prependListener(event,fn);}else{if(!emitter._events||!emitter._events[event])emitter.on(event,fn);else if(isArray(emitter._events[event]))emitter._events[event].unshift(fn);else emitter._events[event]=[fn,emitter._events[event]];}}function ReadableState(options,stream){Duplex=Duplex||require("./_stream_duplex");options=options||{};this.objectMode=!!options.objectMode;if(stream instanceof Duplex)this.objectMode=this.objectMode||!!options.readableObjectMode;var hwm=options.highWaterMark;var defaultHwm=this.objectMode?16:16*1024;this.highWaterMark=hwm||hwm===0?hwm:defaultHwm;this.highWaterMark=Math.floor(this.highWaterMark);this.buffer=new BufferList();this.length=0;this.pipes=null;this.pipesCount=0;this.flowing=null;this.ended=false;this.endEmitted=false;this.reading=false;this.sync=true;this.needReadable=false;this.emittedReadable=false;this.readableListening=false;this.resumeScheduled=false;this.destroyed=false;this.defaultEncoding=options.defaultEncoding||"utf8";this.awaitDrain=0;this.readingMore=false;this.decoder=null;this.encoding=null;if(options.encoding){if(!StringDecoder)StringDecoder=require("string_decoder/").StringDecoder;this.decoder=new StringDecoder(options.encoding);this.encoding=options.encoding;}}function Readable(options){Duplex=Duplex||require("./_stream_duplex");if(!(this instanceof Readable))return new Readable(options);this._readableState=new ReadableState(options,this);this.readable=true;if(options){if(typeof options.read==="function")this._read=options.read;if(typeof options.destroy==="function")this._destroy=options.destroy;}Stream.call(this);}Object.defineProperty(Readable.prototype,"destroyed",{get:function get(){if(this._readableState===undefined){return false;}return this._readableState.destroyed;},set:function set(value){if(!this._readableState){return;}this._readableState.destroyed=value;}});Readable.prototype.destroy=destroyImpl.destroy;Readable.prototype._undestroy=destroyImpl.undestroy;Readable.prototype._destroy=function(err,cb){this.push(null);cb(err);};Readable.prototype.push=function(chunk,encoding){var state=this._readableState;var skipChunkCheck;if(!state.objectMode){if(typeof chunk==="string"){encoding=encoding||state.defaultEncoding;if(encoding!==state.encoding){chunk=Buffer.from(chunk,encoding);encoding="";}skipChunkCheck=true;}}else{skipChunkCheck=true;}return readableAddChunk(this,chunk,encoding,false,skipChunkCheck);};Readable.prototype.unshift=function(chunk){return readableAddChunk(this,chunk,null,true,false);};function readableAddChunk(stream,chunk,encoding,addToFront,skipChunkCheck){var state=stream._readableState;if(chunk===null){state.reading=false;onEofChunk(stream,state);}else{var er;if(!skipChunkCheck)er=chunkInvalid(state,chunk);if(er){stream.emit("error",er);}else if(state.objectMode||chunk&&chunk.length>0){if(typeof chunk!=="string"&&!state.objectMode&&Object.getPrototypeOf(chunk)!==Buffer.prototype){chunk=_uint8ArrayToBuffer(chunk);}if(addToFront){if(state.endEmitted)stream.emit("error",new Error("stream.unshift() after end event"));else addChunk(stream,state,chunk,true);}else if(state.ended){stream.emit("error",new Error("stream.push() after EOF"));}else{state.reading=false;if(state.decoder&&!encoding){chunk=state.decoder.write(chunk);if(state.objectMode||chunk.length!==0)addChunk(stream,state,chunk,false);else maybeReadMore(stream,state);}else{addChunk(stream,state,chunk,false);}}}else if(!addToFront){state.reading=false;}}return needMoreData(state);}function addChunk(stream,state,chunk,addToFront){if(state.flowing&&state.length===0&&!state.sync){stream.emit("data",chunk);stream.read(0);}else{state.length+=state.objectMode?1:chunk.length;if(addToFront)state.buffer.unshift(chunk);else state.buffer.push(chunk);if(state.needReadable)emitReadable(stream);}maybeReadMore(stream,state);}function chunkInvalid(state,chunk){var er;if(!_isUint8Array(chunk)&&typeof chunk!=="string"&&chunk!==undefined&&!state.objectMode){er=new TypeError("Invalid non-string/buffer chunk");}return er;}function needMoreData(state){return!state.ended&&(state.needReadable||state.length<state.highWaterMark||state.length===0);}Readable.prototype.isPaused=function(){return this._readableState.flowing===false;};Readable.prototype.setEncoding=function(enc){if(!StringDecoder)StringDecoder=require("string_decoder/").StringDecoder;this._readableState.decoder=new StringDecoder(enc);this._readableState.encoding=enc;return this;};var MAX_HWM=8388608;function computeNewHighWaterMark(n){if(n>=MAX_HWM){n=MAX_HWM;}else{n--;n|=n>>>1;n|=n>>>2;n|=n>>>4;n|=n>>>8;n|=n>>>16;n++;}return n;}function howMuchToRead(n,state){if(n<=0||state.length===0&&state.ended)return 0;if(state.objectMode)return 1;if(n!==n){if(state.flowing&&state.length)return state.buffer.head.data.length;else return state.length;}if(n>state.highWaterMark)state.highWaterMark=computeNewHighWaterMark(n);if(n<=state.length)return n;if(!state.ended){state.needReadable=true;return 0;}return state.length;}Readable.prototype.read=function(n){debug("read",n);n=parseInt(n,10);var state=this._readableState;var nOrig=n;if(n!==0)state.emittedReadable=false;if(n===0&&state.needReadable&&(state.length>=state.highWaterMark||state.ended)){debug("read: emitReadable",state.length,state.ended);if(state.length===0&&state.ended)endReadable(this);else emitReadable(this);return null;}n=howMuchToRead(n,state);if(n===0&&state.ended){if(state.length===0)endReadable(this);return null;}var doRead=state.needReadable;debug("need readable",doRead);if(state.length===0||state.length-n<state.highWaterMark){doRead=true;debug("length less than watermark",doRead);}if(state.ended||state.reading){doRead=false;debug("reading or ended",doRead);}else if(doRead){debug("do read");state.reading=true;state.sync=true;if(state.length===0)state.needReadable=true;this._read(state.highWaterMark);state.sync=false;if(!state.reading)n=howMuchToRead(nOrig,state);}var ret;if(n>0)ret=fromList(n,state);else ret=null;if(ret===null){state.needReadable=true;n=0;}else{state.length-=n;}if(state.length===0){if(!state.ended)state.needReadable=true;if(nOrig!==n&&state.ended)endReadable(this);}if(ret!==null)this.emit("data",ret);return ret;};function onEofChunk(stream,state){if(state.ended)return;if(state.decoder){var chunk=state.decoder.end();if(chunk&&chunk.length){state.buffer.push(chunk);state.length+=state.objectMode?1:chunk.length;}}state.ended=true;emitReadable(stream);}function emitReadable(stream){var state=stream._readableState;state.needReadable=false;if(!state.emittedReadable){debug("emitReadable",state.flowing);state.emittedReadable=true;if(state.sync)processNextTick(emitReadable_,stream);else emitReadable_(stream);}}function emitReadable_(stream){debug("emit readable");stream.emit("readable");flow(stream);}function maybeReadMore(stream,state){if(!state.readingMore){state.readingMore=true;processNextTick(maybeReadMore_,stream,state);}}function maybeReadMore_(stream,state){var len=state.length;while(!state.reading&&!state.flowing&&!state.ended&&state.length<state.highWaterMark){debug("maybeReadMore read 0");stream.read(0);if(len===state.length)break;else len=state.length;}state.readingMore=false;}Readable.prototype._read=function(n){this.emit("error",new Error("_read() is not implemented"));};Readable.prototype.pipe=function(dest,pipeOpts){var src=this;var state=this._readableState;switch(state.pipesCount){case 0:state.pipes=dest;break;case 1:state.pipes=[state.pipes,dest];break;default:state.pipes.push(dest);break;}state.pipesCount+=1;debug("pipe count=%d opts=%j",state.pipesCount,pipeOpts);var doEnd=(!pipeOpts||pipeOpts.end!==false)&&dest!==process.stdout&&dest!==process.stderr;var endFn=doEnd?onend:unpipe;if(state.endEmitted)processNextTick(endFn);else src.once("end",endFn);dest.on("unpipe",onunpipe);function onunpipe(readable,unpipeInfo){debug("onunpipe");if(readable===src){if(unpipeInfo&&unpipeInfo.hasUnpiped===false){unpipeInfo.hasUnpiped=true;cleanup();}}}function onend(){debug("onend");dest.end();}var ondrain=pipeOnDrain(src);dest.on("drain",ondrain);var cleanedUp=false;function cleanup(){debug("cleanup");dest.removeListener("close",onclose);dest.removeListener("finish",onfinish);dest.removeListener("drain",ondrain);dest.removeListener("error",onerror);dest.removeListener("unpipe",onunpipe);src.removeListener("end",onend);src.removeListener("end",unpipe);src.removeListener("data",ondata);cleanedUp=true;if(state.awaitDrain&&(!dest._writableState||dest._writableState.needDrain))ondrain();}var increasedAwaitDrain=false;src.on("data",ondata);function ondata(chunk){debug("ondata");increasedAwaitDrain=false;var ret=dest.write(chunk);if(false===ret&&!increasedAwaitDrain){if((state.pipesCount===1&&state.pipes===dest||state.pipesCount>1&&indexOf(state.pipes,dest)!==-1)&&!cleanedUp){debug("false write response, pause",src._readableState.awaitDrain);src._readableState.awaitDrain++;increasedAwaitDrain=true;}src.pause();}}function onerror(er){debug("onerror",er);unpipe();dest.removeListener("error",onerror);if(EElistenerCount(dest,"error")===0)dest.emit("error",er);}prependListener(dest,"error",onerror);function onclose(){dest.removeListener("finish",onfinish);unpipe();}dest.once("close",onclose);function onfinish(){debug("onfinish");dest.removeListener("close",onclose);unpipe();}dest.once("finish",onfinish);function unpipe(){debug("unpipe");src.unpipe(dest);}dest.emit("pipe",src);if(!state.flowing){debug("pipe resume");src.resume();}return dest;};function pipeOnDrain(src){return function(){var state=src._readableState;debug("pipeOnDrain",state.awaitDrain);if(state.awaitDrain)state.awaitDrain--;if(state.awaitDrain===0&&EElistenerCount(src,"data")){state.flowing=true;flow(src);}};}Readable.prototype.unpipe=function(dest){var state=this._readableState;var unpipeInfo={hasUnpiped:false};if(state.pipesCount===0)return this;if(state.pipesCount===1){if(dest&&dest!==state.pipes)return this;if(!dest)dest=state.pipes;state.pipes=null;state.pipesCount=0;state.flowing=false;if(dest)dest.emit("unpipe",this,unpipeInfo);return this;}if(!dest){var dests=state.pipes;var len=state.pipesCount;state.pipes=null;state.pipesCount=0;state.flowing=false;for(var i=0;i<len;i++){dests[i].emit("unpipe",this,unpipeInfo);}return this;}var index=indexOf(state.pipes,dest);if(index===-1)return this;state.pipes.splice(index,1);state.pipesCount-=1;if(state.pipesCount===1)state.pipes=state.pipes[0];dest.emit("unpipe",this,unpipeInfo);return this;};Readable.prototype.on=function(ev,fn){var res=Stream.prototype.on.call(this,ev,fn);if(ev==="data"){if(this._readableState.flowing!==false)this.resume();}else if(ev==="readable"){var state=this._readableState;if(!state.endEmitted&&!state.readableListening){state.readableListening=state.needReadable=true;state.emittedReadable=false;if(!state.reading){processNextTick(nReadingNextTick,this);}else if(state.length){emitReadable(this);}}}return res;};Readable.prototype.addListener=Readable.prototype.on;function nReadingNextTick(self){debug("readable nexttick read 0");self.read(0);}Readable.prototype.resume=function(){var state=this._readableState;if(!state.flowing){debug("resume");state.flowing=true;resume(this,state);}return this;};function resume(stream,state){if(!state.resumeScheduled){state.resumeScheduled=true;processNextTick(resume_,stream,state);}}function resume_(stream,state){if(!state.reading){debug("resume read 0");stream.read(0);}state.resumeScheduled=false;state.awaitDrain=0;stream.emit("resume");flow(stream);if(state.flowing&&!state.reading)stream.read(0);}Readable.prototype.pause=function(){debug("call pause flowing=%j",this._readableState.flowing);if(false!==this._readableState.flowing){debug("pause");this._readableState.flowing=false;this.emit("pause");}return this;};function flow(stream){var state=stream._readableState;debug("flow",state.flowing);while(state.flowing&&stream.read()!==null){}}Readable.prototype.wrap=function(stream){var state=this._readableState;var paused=false;var self=this;stream.on("end",function(){debug("wrapped end");if(state.decoder&&!state.ended){var chunk=state.decoder.end();if(chunk&&chunk.length)self.push(chunk);}self.push(null);});stream.on("data",function(chunk){debug("wrapped data");if(state.decoder)chunk=state.decoder.write(chunk);if(state.objectMode&&(chunk===null||chunk===undefined))return;else if(!state.objectMode&&(!chunk||!chunk.length))return;var ret=self.push(chunk);if(!ret){paused=true;stream.pause();}});for(var i in stream){if(this[i]===undefined&&typeof stream[i]==="function"){this[i]=function(method){return function(){return stream[method].apply(stream,arguments);};}(i);}}for(var n=0;n<kProxyEvents.length;n++){stream.on(kProxyEvents[n],self.emit.bind(self,kProxyEvents[n]));}self._read=function(n){debug("wrapped _read",n);if(paused){paused=false;stream.resume();}};return self;};Readable._fromList=fromList;function fromList(n,state){if(state.length===0)return null;var ret;if(state.objectMode)ret=state.buffer.shift();else if(!n||n>=state.length){if(state.decoder)ret=state.buffer.join("");else if(state.buffer.length===1)ret=state.buffer.head.data;else ret=state.buffer.concat(state.length);state.buffer.clear();}else{ret=fromListPartial(n,state.buffer,state.decoder);}return ret;}function fromListPartial(n,list,hasStrings){var ret;if(n<list.head.data.length){ret=list.head.data.slice(0,n);list.head.data=list.head.data.slice(n);}else if(n===list.head.data.length){ret=list.shift();}else{ret=hasStrings?copyFromBufferString(n,list):copyFromBuffer(n,list);}return ret;}function copyFromBufferString(n,list){var p=list.head;var c=1;var ret=p.data;n-=ret.length;while(p=p.next){var str=p.data;var nb=n>str.length?str.length:n;if(nb===str.length)ret+=str;else ret+=str.slice(0,n);n-=nb;if(n===0){if(nb===str.length){++c;if(p.next)list.head=p.next;else list.head=list.tail=null;}else{list.head=p;p.data=str.slice(nb);}break;}++c;}list.length-=c;return ret;}function copyFromBuffer(n,list){var ret=Buffer.allocUnsafe(n);var p=list.head;var c=1;p.data.copy(ret);n-=p.data.length;while(p=p.next){var buf=p.data;var nb=n>buf.length?buf.length:n;buf.copy(ret,ret.length-n,0,nb);n-=nb;if(n===0){if(nb===buf.length){++c;if(p.next)list.head=p.next;else list.head=list.tail=null;}else{list.head=p;p.data=buf.slice(nb);}break;}++c;}list.length-=c;return ret;}function endReadable(stream){var state=stream._readableState;if(state.length>0)throw new Error('"endReadable()" called on non-empty stream');if(!state.endEmitted){state.ended=true;processNextTick(endReadableNT,state,stream);}}function endReadableNT(state,stream){if(!state.endEmitted&&state.length===0){state.endEmitted=true;stream.readable=false;stream.emit("end");}}function forEach(xs,f){for(var i=0,l=xs.length;i<l;i++){f(xs[i],i);}}function indexOf(xs,x){for(var i=0,l=xs.length;i<l;i++){if(xs[i]===x)return i;}return-1;}}).call(this,require("_process"),typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{});},{"./_stream_duplex":11,"./internal/streams/BufferList":16,"./internal/streams/destroy":17,"./internal/streams/stream":18,_process:40,"core-util-is":56,events:73,inherits:94,isarray:10,"process-nextick-args":152,"safe-buffer":177,"string_decoder/":20,util:38}],14:[function(require,module,exports){"use strict";module.exports=Transform;var Duplex=require("./_stream_duplex");var util=require("core-util-is");util.inherits=require("inherits");util.inherits(Transform,Duplex);function TransformState(stream){this.afterTransform=function(er,data){return afterTransform(stream,er,data);};this.needTransform=false;this.transforming=false;this.writecb=null;this.writechunk=null;this.writeencoding=null;}function afterTransform(stream,er,data){var ts=stream._transformState;ts.transforming=false;var cb=ts.writecb;if(!cb){return stream.emit("error",new Error("write callback called multiple times"));}ts.writechunk=null;ts.writecb=null;if(data!==null&&data!==undefined)stream.push(data);cb(er);var rs=stream._readableState;rs.reading=false;if(rs.needReadable||rs.length<rs.highWaterMark){stream._read(rs.highWaterMark);}}function Transform(options){if(!(this instanceof Transform))return new Transform(options);Duplex.call(this,options);this._transformState=new TransformState(this);var stream=this;this._readableState.needReadable=true;this._readableState.sync=false;if(options){if(typeof options.transform==="function")this._transform=options.transform;if(typeof options.flush==="function")this._flush=options.flush;}this.once("prefinish",function(){if(typeof this._flush==="function")this._flush(function(er,data){done(stream,er,data);});else done(stream);});}Transform.prototype.push=function(chunk,encoding){this._transformState.needTransform=false;return Duplex.prototype.push.call(this,chunk,encoding);};Transform.prototype._transform=function(chunk,encoding,cb){throw new Error("_transform() is not implemented");};Transform.prototype._write=function(chunk,encoding,cb){var ts=this._transformState;ts.writecb=cb;ts.writechunk=chunk;ts.writeencoding=encoding;if(!ts.transforming){var rs=this._readableState;if(ts.needTransform||rs.needReadable||rs.length<rs.highWaterMark)this._read(rs.highWaterMark);}};Transform.prototype._read=function(n){var ts=this._transformState;if(ts.writechunk!==null&&ts.writecb&&!ts.transforming){ts.transforming=true;this._transform(ts.writechunk,ts.writeencoding,ts.afterTransform);}else{ts.needTransform=true;}};Transform.prototype._destroy=function(err,cb){var _this=this;Duplex.prototype._destroy.call(this,err,function(err2){cb(err2);_this.emit("close");});};function done(stream,er,data){if(er)return stream.emit("error",er);if(data!==null&&data!==undefined)stream.push(data);var ws=stream._writableState;var ts=stream._transformState;if(ws.length)throw new Error("Calling transform done when ws.length != 0");if(ts.transforming)throw new Error("Calling transform done when still transforming");return stream.push(null);}},{"./_stream_duplex":11,"core-util-is":56,inherits:94}],15:[function(require,module,exports){(function(process,global){"use strict";var processNextTick=require("process-nextick-args");module.exports=Writable;function WriteReq(chunk,encoding,cb){this.chunk=chunk;this.encoding=encoding;this.callback=cb;this.next=null;}function CorkedRequest(state){var _this=this;this.next=null;this.entry=null;this.finish=function(){onCorkedFinish(_this,state);};}var asyncWrite=!process.browser&&["v0.10","v0.9."].indexOf(process.version.slice(0,5))>-1?setImmediate:processNextTick;var Duplex;Writable.WritableState=WritableState;var util=require("core-util-is");util.inherits=require("inherits");var internalUtil={deprecate:require("util-deprecate")};var Stream=require("./internal/streams/stream");var Buffer=require("safe-buffer").Buffer;var OurUint8Array=global.Uint8Array||function(){};function _uint8ArrayToBuffer(chunk){return Buffer.from(chunk);}function _isUint8Array(obj){return Buffer.isBuffer(obj)||obj instanceof OurUint8Array;}var destroyImpl=require("./internal/streams/destroy");util.inherits(Writable,Stream);function nop(){}function WritableState(options,stream){Duplex=Duplex||require("./_stream_duplex");options=options||{};this.objectMode=!!options.objectMode;if(stream instanceof Duplex)this.objectMode=this.objectMode||!!options.writableObjectMode;var hwm=options.highWaterMark;var defaultHwm=this.objectMode?16:16*1024;this.highWaterMark=hwm||hwm===0?hwm:defaultHwm;this.highWaterMark=Math.floor(this.highWaterMark);this.finalCalled=false;this.needDrain=false;this.ending=false;this.ended=false;this.finished=false;this.destroyed=false;var noDecode=options.decodeStrings===false;this.decodeStrings=!noDecode;this.defaultEncoding=options.defaultEncoding||"utf8";this.length=0;this.writing=false;this.corked=0;this.sync=true;this.bufferProcessing=false;this.onwrite=function(er){onwrite(stream,er);};this.writecb=null;this.writelen=0;this.bufferedRequest=null;this.lastBufferedRequest=null;this.pendingcb=0;this.prefinished=false;this.errorEmitted=false;this.bufferedRequestCount=0;this.corkedRequestsFree=new CorkedRequest(this);}WritableState.prototype.getBuffer=function getBuffer(){var current=this.bufferedRequest;var out=[];while(current){out.push(current);current=current.next;}return out;};(function(){try{Object.defineProperty(WritableState.prototype,"buffer",{get:internalUtil.deprecate(function(){return this.getBuffer();},"_writableState.buffer is deprecated. Use _writableState.getBuffer "+"instead.","DEP0003")});}catch(_){}})();var realHasInstance;if(typeof Symbol==="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]==="function"){realHasInstance=Function.prototype[Symbol.hasInstance];Object.defineProperty(Writable,Symbol.hasInstance,{value:function value(object){if(realHasInstance.call(this,object))return true;return object&&object._writableState instanceof WritableState;}});}else{realHasInstance=function realHasInstance(object){return object instanceof this;};}function Writable(options){Duplex=Duplex||require("./_stream_duplex");if(!realHasInstance.call(Writable,this)&&!(this instanceof Duplex)){return new Writable(options);}this._writableState=new WritableState(options,this);this.writable=true;if(options){if(typeof options.write==="function")this._write=options.write;if(typeof options.writev==="function")this._writev=options.writev;if(typeof options.destroy==="function")this._destroy=options.destroy;if(typeof options.final==="function")this._final=options.final;}Stream.call(this);}Writable.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"));};function writeAfterEnd(stream,cb){var er=new Error("write after end");stream.emit("error",er);processNextTick(cb,er);}function validChunk(stream,state,chunk,cb){var valid=true;var er=false;if(chunk===null){er=new TypeError("May not write null values to stream");}else if(typeof chunk!=="string"&&chunk!==undefined&&!state.objectMode){er=new TypeError("Invalid non-string/buffer chunk");}if(er){stream.emit("error",er);processNextTick(cb,er);valid=false;}return valid;}Writable.prototype.write=function(chunk,encoding,cb){var state=this._writableState;var ret=false;var isBuf=_isUint8Array(chunk)&&!state.objectMode;if(isBuf&&!Buffer.isBuffer(chunk)){chunk=_uint8ArrayToBuffer(chunk);}if(typeof encoding==="function"){cb=encoding;encoding=null;}if(isBuf)encoding="buffer";else if(!encoding)encoding=state.defaultEncoding;if(typeof cb!=="function")cb=nop;if(state.ended)writeAfterEnd(this,cb);else if(isBuf||validChunk(this,state,chunk,cb)){state.pendingcb++;ret=writeOrBuffer(this,state,isBuf,chunk,encoding,cb);}return ret;};Writable.prototype.cork=function(){var state=this._writableState;state.corked++;};Writable.prototype.uncork=function(){var state=this._writableState;if(state.corked){state.corked--;if(!state.writing&&!state.corked&&!state.finished&&!state.bufferProcessing&&state.bufferedRequest)clearBuffer(this,state);}};Writable.prototype.setDefaultEncoding=function setDefaultEncoding(encoding){if(typeof encoding==="string")encoding=encoding.toLowerCase();if(!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((encoding+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+encoding);this._writableState.defaultEncoding=encoding;return this;};function decodeChunk(state,chunk,encoding){if(!state.objectMode&&state.decodeStrings!==false&&typeof chunk==="string"){chunk=Buffer.from(chunk,encoding);}return chunk;}function writeOrBuffer(stream,state,isBuf,chunk,encoding,cb){if(!isBuf){var newChunk=decodeChunk(state,chunk,encoding);if(chunk!==newChunk){isBuf=true;encoding="buffer";chunk=newChunk;}}var len=state.objectMode?1:chunk.length;state.length+=len;var ret=state.length<state.highWaterMark;if(!ret)state.needDrain=true;if(state.writing||state.corked){var last=state.lastBufferedRequest;state.lastBufferedRequest={chunk:chunk,encoding:encoding,isBuf:isBuf,callback:cb,next:null};if(last){last.next=state.lastBufferedRequest;}else{state.bufferedRequest=state.lastBufferedRequest;}state.bufferedRequestCount+=1;}else{doWrite(stream,state,false,len,chunk,encoding,cb);}return ret;}function doWrite(stream,state,writev,len,chunk,encoding,cb){state.writelen=len;state.writecb=cb;state.writing=true;state.sync=true;if(writev)stream._writev(chunk,state.onwrite);else stream._write(chunk,encoding,state.onwrite);state.sync=false;}function onwriteError(stream,state,sync,er,cb){--state.pendingcb;if(sync){processNextTick(cb,er);processNextTick(finishMaybe,stream,state);stream._writableState.errorEmitted=true;stream.emit("error",er);}else{cb(er);stream._writableState.errorEmitted=true;stream.emit("error",er);finishMaybe(stream,state);}}function onwriteStateUpdate(state){state.writing=false;state.writecb=null;state.length-=state.writelen;state.writelen=0;}function onwrite(stream,er){var state=stream._writableState;var sync=state.sync;var cb=state.writecb;onwriteStateUpdate(state);if(er)onwriteError(stream,state,sync,er,cb);else{var finished=needFinish(state);if(!finished&&!state.corked&&!state.bufferProcessing&&state.bufferedRequest){clearBuffer(stream,state);}if(sync){asyncWrite(afterWrite,stream,state,finished,cb);}else{afterWrite(stream,state,finished,cb);}}}function afterWrite(stream,state,finished,cb){if(!finished)onwriteDrain(stream,state);state.pendingcb--;cb();finishMaybe(stream,state);}function onwriteDrain(stream,state){if(state.length===0&&state.needDrain){state.needDrain=false;stream.emit("drain");}}function clearBuffer(stream,state){state.bufferProcessing=true;var entry=state.bufferedRequest;if(stream._writev&&entry&&entry.next){var l=state.bufferedRequestCount;var buffer=new Array(l);var holder=state.corkedRequestsFree;holder.entry=entry;var count=0;var allBuffers=true;while(entry){buffer[count]=entry;if(!entry.isBuf)allBuffers=false;entry=entry.next;count+=1;}buffer.allBuffers=allBuffers;doWrite(stream,state,true,state.length,buffer,"",holder.finish);state.pendingcb++;state.lastBufferedRequest=null;if(holder.next){state.corkedRequestsFree=holder.next;holder.next=null;}else{state.corkedRequestsFree=new CorkedRequest(state);}}else{while(entry){var chunk=entry.chunk;var encoding=entry.encoding;var cb=entry.callback;var len=state.objectMode?1:chunk.length;doWrite(stream,state,false,len,chunk,encoding,cb);entry=entry.next;if(state.writing){break;}}if(entry===null)state.lastBufferedRequest=null;}state.bufferedRequestCount=0;state.bufferedRequest=entry;state.bufferProcessing=false;}Writable.prototype._write=function(chunk,encoding,cb){cb(new Error("_write() is not implemented"));};Writable.prototype._writev=null;Writable.prototype.end=function(chunk,encoding,cb){var state=this._writableState;if(typeof chunk==="function"){cb=chunk;chunk=null;encoding=null;}else if(typeof encoding==="function"){cb=encoding;encoding=null;}if(chunk!==null&&chunk!==undefined)this.write(chunk,encoding);if(state.corked){state.corked=1;this.uncork();}if(!state.ending&&!state.finished)endWritable(this,state,cb);};function needFinish(state){return state.ending&&state.length===0&&state.bufferedRequest===null&&!state.finished&&!state.writing;}function callFinal(stream,state){stream._final(function(err){state.pendingcb--;if(err){stream.emit("error",err);}state.prefinished=true;stream.emit("prefinish");finishMaybe(stream,state);});}function prefinish(stream,state){if(!state.prefinished&&!state.finalCalled){if(typeof stream._final==="function"){state.pendingcb++;state.finalCalled=true;processNextTick(callFinal,stream,state);}else{state.prefinished=true;stream.emit("prefinish");}}}function finishMaybe(stream,state){var need=needFinish(state);if(need){prefinish(stream,state);if(state.pendingcb===0){state.finished=true;stream.emit("finish");}}return need;}function endWritable(stream,state,cb){state.ending=true;finishMaybe(stream,state);if(cb){if(state.finished)processNextTick(cb);else stream.once("finish",cb);}state.ended=true;stream.writable=false;}function onCorkedFinish(corkReq,state,err){var entry=corkReq.entry;corkReq.entry=null;while(entry){var cb=entry.callback;state.pendingcb--;cb(err);entry=entry.next;}if(state.corkedRequestsFree){state.corkedRequestsFree.next=corkReq;}else{state.corkedRequestsFree=corkReq;}}Object.defineProperty(Writable.prototype,"destroyed",{get:function get(){if(this._writableState===undefined){return false;}return this._writableState.destroyed;},set:function set(value){if(!this._writableState){return;}this._writableState.destroyed=value;}});Writable.prototype.destroy=destroyImpl.destroy;Writable.prototype._undestroy=destroyImpl.undestroy;Writable.prototype._destroy=function(err,cb){this.end();cb(err);};}).call(this,require("_process"),typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{});},{"./_stream_duplex":11,"./internal/streams/destroy":17,"./internal/streams/stream":18,_process:40,"core-util-is":56,inherits:94,"process-nextick-args":152,"safe-buffer":177,"util-deprecate":239}],16:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}var Buffer=require("safe-buffer").Buffer;function copyBuffer(src,target,offset){src.copy(target,offset);}module.exports=function(){function BufferList(){_classCallCheck(this,BufferList);this.head=null;this.tail=null;this.length=0;}BufferList.prototype.push=function push(v){var entry={data:v,next:null};if(this.length>0)this.tail.next=entry;else this.head=entry;this.tail=entry;++this.length;};BufferList.prototype.unshift=function unshift(v){var entry={data:v,next:this.head};if(this.length===0)this.tail=entry;this.head=entry;++this.length;};BufferList.prototype.shift=function shift(){if(this.length===0)return;var ret=this.head.data;if(this.length===1)this.head=this.tail=null;else this.head=this.head.next;--this.length;return ret;};BufferList.prototype.clear=function clear(){this.head=this.tail=null;this.length=0;};BufferList.prototype.join=function join(s){if(this.length===0)return"";var p=this.head;var ret=""+p.data;while(p=p.next){ret+=s+p.data;}return ret;};BufferList.prototype.concat=function concat(n){if(this.length===0)return Buffer.alloc(0);if(this.length===1)return this.head.data;var ret=Buffer.allocUnsafe(n>>>0);var p=this.head;var i=0;while(p){copyBuffer(p.data,ret,i);i+=p.data.length;p=p.next;}return ret;};return BufferList;}();},{"safe-buffer":177}],17:[function(require,module,exports){"use strict";var processNextTick=require("process-nextick-args");function destroy(err,cb){var _this=this;var readableDestroyed=this._readableState&&this._readableState.destroyed;var writableDestroyed=this._writableState&&this._writableState.destroyed;if(readableDestroyed||writableDestroyed){if(cb){cb(err);}else if(err&&(!this._writableState||!this._writableState.errorEmitted)){processNextTick(emitErrorNT,this,err);}return;}if(this._readableState){this._readableState.destroyed=true;}if(this._writableState){this._writableState.destroyed=true;}this._destroy(err||null,function(err){if(!cb&&err){processNextTick(emitErrorNT,_this,err);if(_this._writableState){_this._writableState.errorEmitted=true;}}else if(cb){cb(err);}});}function undestroy(){if(this._readableState){this._readableState.destroyed=false;this._readableState.reading=false;this._readableState.ended=false;this._readableState.endEmitted=false;}if(this._writableState){this._writableState.destroyed=false;this._writableState.ended=false;this._writableState.ending=false;this._writableState.finished=false;this._writableState.errorEmitted=false;}}function emitErrorNT(self,err){self.emit("error",err);}module.exports={destroy:destroy,undestroy:undestroy};},{"process-nextick-args":152}],18:[function(require,module,exports){module.exports=require("events").EventEmitter;},{events:73}],19:[function(require,module,exports){exports=module.exports=require("./lib/_stream_readable.js");exports.Stream=exports;exports.Readable=exports;exports.Writable=require("./lib/_stream_writable.js");exports.Duplex=require("./lib/_stream_duplex.js");exports.Transform=require("./lib/_stream_transform.js");exports.PassThrough=require("./lib/_stream_passthrough.js");},{"./lib/_stream_duplex.js":11,"./lib/_stream_passthrough.js":12,"./lib/_stream_readable.js":13,"./lib/_stream_transform.js":14,"./lib/_stream_writable.js":15}],20:[function(require,module,exports){"use strict";var Buffer=require("safe-buffer").Buffer;var isEncoding=Buffer.isEncoding||function(encoding){encoding=""+encoding;switch(encoding&&encoding.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return true;default:return false;}};function _normalizeEncoding(enc){if(!enc)return"utf8";var retried;while(true){switch(enc){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return enc;default:if(retried)return;enc=(""+enc).toLowerCase();retried=true;}}}function normalizeEncoding(enc){var nenc=_normalizeEncoding(enc);if(typeof nenc!=="string"&&(Buffer.isEncoding===isEncoding||!isEncoding(enc)))throw new Error("Unknown encoding: "+enc);return nenc||enc;}exports.StringDecoder=StringDecoder;function StringDecoder(encoding){this.encoding=normalizeEncoding(encoding);var nb;switch(this.encoding){case"utf16le":this.text=utf16Text;this.end=utf16End;nb=4;break;case"utf8":this.fillLast=utf8FillLast;nb=4;break;case"base64":this.text=base64Text;this.end=base64End;nb=3;break;default:this.write=simpleWrite;this.end=simpleEnd;return;}this.lastNeed=0;this.lastTotal=0;this.lastChar=Buffer.allocUnsafe(nb);}StringDecoder.prototype.write=function(buf){if(buf.length===0)return"";var r;var i;if(this.lastNeed){r=this.fillLast(buf);if(r===undefined)return"";i=this.lastNeed;this.lastNeed=0;}else{i=0;}if(i<buf.length)return r?r+this.text(buf,i):this.text(buf,i);return r||"";};StringDecoder.prototype.end=utf8End;StringDecoder.prototype.text=utf8Text;StringDecoder.prototype.fillLast=function(buf){if(this.lastNeed<=buf.length){buf.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed);return this.lastChar.toString(this.encoding,0,this.lastTotal);}buf.copy(this.lastChar,this.lastTotal-this.lastNeed,0,buf.length);this.lastNeed-=buf.length;};function utf8CheckByte(byte){if(byte<=127)return 0;else if(byte>>5===6)return 2;else if(byte>>4===14)return 3;else if(byte>>3===30)return 4;return-1;}function utf8CheckIncomplete(self,buf,i){var j=buf.length-1;if(j<i)return 0;var nb=utf8CheckByte(buf[j]);if(nb>=0){if(nb>0)self.lastNeed=nb-1;return nb;}if(--j<i)return 0;nb=utf8CheckByte(buf[j]);if(nb>=0){if(nb>0)self.lastNeed=nb-2;return nb;}if(--j<i)return 0;nb=utf8CheckByte(buf[j]);if(nb>=0){if(nb>0){if(nb===2)nb=0;else self.lastNeed=nb-3;}return nb;}return 0;}function utf8CheckExtraBytes(self,buf,p){if((buf[0]&192)!==128){self.lastNeed=0;return"".repeat(p);}if(self.lastNeed>1&&buf.length>1){if((buf[1]&192)!==128){self.lastNeed=1;return"".repeat(p+1);}if(self.lastNeed>2&&buf.length>2){if((buf[2]&192)!==128){self.lastNeed=2;return"".repeat(p+2);}}}}function utf8FillLast(buf){var p=this.lastTotal-this.lastNeed;var r=utf8CheckExtraBytes(this,buf,p);if(r!==undefined)return r;if(this.lastNeed<=buf.length){buf.copy(this.lastChar,p,0,this.lastNeed);return this.lastChar.toString(this.encoding,0,this.lastTotal);}buf.copy(this.lastChar,p,0,buf.length);this.lastNeed-=buf.length;}function utf8Text(buf,i){var total=utf8CheckIncomplete(this,buf,i);if(!this.lastNeed)return buf.toString("utf8",i);this.lastTotal=total;var end=buf.length-(total-this.lastNeed);buf.copy(this.lastChar,0,end);return buf.toString("utf8",i,end);}function utf8End(buf){var r=buf&&buf.length?this.write(buf):"";if(this.lastNeed)return r+"".repeat(this.lastTotal-this.lastNeed);return r;}function utf16Text(buf,i){if((buf.length-i)%2===0){var r=buf.toString("utf16le",i);if(r){var c=r.charCodeAt(r.length-1);if(c>=55296&&c<=56319){this.lastNeed=2;this.lastTotal=4;this.lastChar[0]=buf[buf.length-2];this.lastChar[1]=buf[buf.length-1];return r.slice(0,-1);}}return r;}this.lastNeed=1;this.lastTotal=2;this.lastChar[0]=buf[buf.length-1];return buf.toString("utf16le",i,buf.length-1);}function utf16End(buf){var r=buf&&buf.length?this.write(buf):"";if(this.lastNeed){var end=this.lastTotal-this.lastNeed;return r+this.lastChar.toString("utf16le",0,end);}return r;}function base64Text(buf,i){var n=(buf.length-i)%3;if(n===0)return buf.toString("base64",i);this.lastNeed=3-n;this.lastTotal=3;if(n===1){this.lastChar[0]=buf[buf.length-1];}else{this.lastChar[0]=buf[buf.length-2];this.lastChar[1]=buf[buf.length-1];}return buf.toString("base64",i,buf.length-n);}function base64End(buf){var r=buf&&buf.length?this.write(buf):"";if(this.lastNeed)return r+this.lastChar.toString("base64",0,3-this.lastNeed);return r;}function simpleWrite(buf){return buf.toString(this.encoding);}function simpleEnd(buf){return buf&&buf.length?this.write(buf):"";}},{"safe-buffer":177}],21:[function(require,module,exports){(function(process){module.exports=Client;var Buffer=require("safe-buffer").Buffer;var debug=require("debug")("bittorrent-tracker:client");var EventEmitter=require("events").EventEmitter;var extend=require("xtend");var inherits=require("inherits");var once=require("once");var parallel=require("run-parallel");var Peer=require("simple-peer");var uniq=require("uniq");var url=require("url");var common=require("./lib/common");var HTTPTracker=require("./lib/client/http-tracker");var UDPTracker=require("./lib/client/udp-tracker");var WebSocketTracker=require("./lib/client/websocket-tracker");inherits(Client,EventEmitter);function Client(opts){var self=this;if(!(self instanceof Client))return new Client(opts);EventEmitter.call(self);if(!opts)opts={};if(!opts.peerId)throw new Error("Option `peerId` is required");if(!opts.infoHash)throw new Error("Option `infoHash` is required");if(!opts.announce)throw new Error("Option `announce` is required");if(!process.browser&&!opts.port)throw new Error("Option `port` is required");self.peerId=typeof opts.peerId==="string"?opts.peerId:opts.peerId.toString("hex");self._peerIdBuffer=Buffer.from(self.peerId,"hex");self._peerIdBinary=self._peerIdBuffer.toString("binary");self.infoHash=typeof opts.infoHash==="string"?opts.infoHash:opts.infoHash.toString("hex");self._infoHashBuffer=Buffer.from(self.infoHash,"hex");self._infoHashBinary=self._infoHashBuffer.toString("binary");debug("new client %s",self.infoHash);self.destroyed=false;self._port=opts.port;self._getAnnounceOpts=opts.getAnnounceOpts;self._rtcConfig=opts.rtcConfig;self._userAgent=opts.userAgent;self._wrtc=typeof opts.wrtc==="function"?opts.wrtc():opts.wrtc;var announce=typeof opts.announce==="string"?[opts.announce]:opts.announce==null?[]:opts.announce;announce=announce.map(function(announceUrl){announceUrl=announceUrl.toString();if(announceUrl[announceUrl.length-1]==="/"){announceUrl=announceUrl.substring(0,announceUrl.length-1);}return announceUrl;});announce=uniq(announce);var webrtcSupport=self._wrtc!==false&&(!!self._wrtc||Peer.WEBRTC_SUPPORT);self._trackers=announce.map(function(announceUrl){var protocol=url.parse(announceUrl).protocol;if((protocol==="http:"||protocol==="https:")&&typeof HTTPTracker==="function"){return new HTTPTracker(self,announceUrl);}else if(protocol==="udp:"&&typeof UDPTracker==="function"){return new UDPTracker(self,announceUrl);}else if((protocol==="ws:"||protocol==="wss:")&&webrtcSupport){if(protocol==="ws:"&&typeof window!=="undefined"&&window.location.protocol==="https:"){nextTickWarn(new Error("Unsupported tracker protocol: "+announceUrl));return null;}return new WebSocketTracker(self,announceUrl);}else{nextTickWarn(new Error("Unsupported tracker protocol: "+announceUrl));return null;}}).filter(Boolean);function nextTickWarn(err){process.nextTick(function(){self.emit("warning",err);});}}Client.scrape=function(opts,cb){cb=once(cb);if(!opts.infoHash)throw new Error("Option `infoHash` is required");if(!opts.announce)throw new Error("Option `announce` is required");var clientOpts=extend(opts,{infoHash:Array.isArray(opts.infoHash)?opts.infoHash[0]:opts.infoHash,peerId:Buffer.from("01234567890123456789"),port:6881});var client=new Client(clientOpts);client.once("error",cb);client.once("warning",cb);var len=Array.isArray(opts.infoHash)?opts.infoHash.length:1;var results={};client.on("scrape",function(data){len-=1;results[data.infoHash]=data;if(len===0){client.destroy();var keys=Object.keys(results);if(keys.length===1){cb(null,results[keys[0]]);}else{cb(null,results);}}});opts.infoHash=Array.isArray(opts.infoHash)?opts.infoHash.map(function(infoHash){return Buffer.from(infoHash,"hex");}):Buffer.from(opts.infoHash,"hex");client.scrape({infoHash:opts.infoHash});return client;};Client.prototype.start=function(opts){var self=this;debug("send `start`");opts=self._defaultAnnounceOpts(opts);opts.event="started";self._announce(opts);self._trackers.forEach(function(tracker){tracker.setInterval();});};Client.prototype.stop=function(opts){var self=this;debug("send `stop`");opts=self._defaultAnnounceOpts(opts);opts.event="stopped";self._announce(opts);};Client.prototype.complete=function(opts){var self=this;debug("send `complete`");if(!opts)opts={};opts=self._defaultAnnounceOpts(opts);opts.event="completed";self._announce(opts);};Client.prototype.update=function(opts){var self=this;debug("send `update`");opts=self._defaultAnnounceOpts(opts);if(opts.event)delete opts.event;self._announce(opts);};Client.prototype._announce=function(opts){var self=this;self._trackers.forEach(function(tracker){tracker.announce(opts);});};Client.prototype.scrape=function(opts){var self=this;debug("send `scrape`");if(!opts)opts={};self._trackers.forEach(function(tracker){tracker.scrape(opts);});};Client.prototype.setInterval=function(intervalMs){var self=this;debug("setInterval %d",intervalMs);self._trackers.forEach(function(tracker){tracker.setInterval(intervalMs);});};Client.prototype.destroy=function(cb){var self=this;if(self.destroyed)return;self.destroyed=true;debug("destroy");var tasks=self._trackers.map(function(tracker){return function(cb){tracker.destroy(cb);};});parallel(tasks,cb);self._trackers=[];self._getAnnounceOpts=null;};Client.prototype._defaultAnnounceOpts=function(opts){var self=this;if(!opts)opts={};if(opts.numwant==null)opts.numwant=common.DEFAULT_ANNOUNCE_PEERS;if(opts.uploaded==null)opts.uploaded=0;if(opts.downloaded==null)opts.downloaded=0;if(self._getAnnounceOpts)opts=extend(opts,self._getAnnounceOpts());return opts;};}).call(this,require("_process"));},{"./lib/client/http-tracker":38,"./lib/client/udp-tracker":38,"./lib/client/websocket-tracker":23,"./lib/common":24,_process:40,debug:69,events:73,inherits:94,once:146,"run-parallel":175,"safe-buffer":177,"simple-peer":181,uniq:234,url:236,xtend:372}],22:[function(require,module,exports){module.exports=Tracker;var EventEmitter=require("events").EventEmitter;var inherits=require("inherits");inherits(Tracker,EventEmitter);function Tracker(client,announceUrl){var self=this;EventEmitter.call(self);self.client=client;self.announceUrl=announceUrl;self.interval=null;self.destroyed=false;}Tracker.prototype.setInterval=function(intervalMs){var self=this;if(intervalMs==null)intervalMs=self.DEFAULT_ANNOUNCE_INTERVAL;clearInterval(self.interval);if(intervalMs){self.interval=setInterval(function(){self.announce(self.client._defaultAnnounceOpts());},intervalMs);if(self.interval.unref)self.interval.unref();}};},{events:73,inherits:94}],23:[function(require,module,exports){module.exports=WebSocketTracker;var debug=require("debug")("bittorrent-tracker:websocket-tracker");var extend=require("xtend");var inherits=require("inherits");var Peer=require("simple-peer");var randombytes=require("randombytes");var Socket=require("simple-websocket");var common=require("../common");var Tracker=require("./tracker");var socketPool={};var RECONNECT_MINIMUM=15*1e3;var RECONNECT_MAXIMUM=30*60*1e3;var RECONNECT_VARIANCE=30*1e3;var OFFER_TIMEOUT=50*1e3;inherits(WebSocketTracker,Tracker);function WebSocketTracker(client,announceUrl,opts){var self=this;Tracker.call(self,client,announceUrl);debug("new websocket tracker %s",announceUrl);self.peers={};self.socket=null;self.reconnecting=false;self.retries=0;self.reconnectTimer=null;self.expectingResponse=false;self._openSocket();}WebSocketTracker.prototype.DEFAULT_ANNOUNCE_INTERVAL=30*1e3;WebSocketTracker.prototype.announce=function(opts){var self=this;if(self.destroyed||self.reconnecting)return;if(!self.socket.connected){self.socket.once("connect",function(){self.announce(opts);});return;}var params=extend(opts,{action:"announce",info_hash:self.client._infoHashBinary,peer_id:self.client._peerIdBinary});if(self._trackerId)params.trackerid=self._trackerId;if(opts.event==="stopped"||opts.event==="completed"){self._send(params);}else{var numwant=Math.min(opts.numwant,10);self._generateOffers(numwant,function(offers){params.numwant=numwant;params.offers=offers;self._send(params);});}};WebSocketTracker.prototype.scrape=function(opts){var self=this;if(self.destroyed||self.reconnecting)return;if(!self.socket.connected){self.socket.once("connect",function(){self.scrape(opts);});return;}var infoHashes=Array.isArray(opts.infoHash)&&opts.infoHash.length>0?opts.infoHash.map(function(infoHash){return infoHash.toString("binary");}):opts.infoHash&&opts.infoHash.toString("binary")||self.client._infoHashBinary;var params={action:"scrape",info_hash:infoHashes};self._send(params);};WebSocketTracker.prototype.destroy=function(cb){var self=this;if(!cb)cb=noop;if(self.destroyed)return cb(null);self.destroyed=true;clearInterval(self.interval);clearTimeout(self.reconnectTimer);for(var peerId in self.peers){var peer=self.peers[peerId];clearTimeout(peer.trackerTimeout);peer.destroy();}self.peers=null;if(self.socket){self.socket.removeListener("connect",self._onSocketConnectBound);self.socket.removeListener("data",self._onSocketDataBound);self.socket.removeListener("close",self._onSocketCloseBound);self.socket.removeListener("error",self._onSocketErrorBound);self.socket=null;}self._onSocketConnectBound=null;self._onSocketErrorBound=null;self._onSocketDataBound=null;self._onSocketCloseBound=null;if(socketPool[self.announceUrl]){socketPool[self.announceUrl].consumers-=1;}if(socketPool[self.announceUrl].consumers>0)return cb();var socket=socketPool[self.announceUrl];delete socketPool[self.announceUrl];socket.on("error",noop);socket.once("close",cb);if(!self.expectingResponse)return destroyCleanup();var timeout=setTimeout(destroyCleanup,common.DESTROY_TIMEOUT);socket.once("data",destroyCleanup);function destroyCleanup(){if(timeout){clearTimeout(timeout);timeout=null;}socket.removeListener("data",destroyCleanup);socket.destroy();socket=null;}};WebSocketTracker.prototype._openSocket=function(){var self=this;self.destroyed=false;if(!self.peers)self.peers={};self._onSocketConnectBound=function(){self._onSocketConnect();};self._onSocketErrorBound=function(err){self._onSocketError(err);};self._onSocketDataBound=function(data){self._onSocketData(data);};self._onSocketCloseBound=function(){self._onSocketClose();};self.socket=socketPool[self.announceUrl];if(self.socket){socketPool[self.announceUrl].consumers+=1;}else{self.socket=socketPool[self.announceUrl]=new Socket(self.announceUrl);self.socket.consumers=1;self.socket.once("connect",self._onSocketConnectBound);}self.socket.on("data",self._onSocketDataBound);self.socket.once("close",self._onSocketCloseBound);self.socket.once("error",self._onSocketErrorBound);};WebSocketTracker.prototype._onSocketConnect=function(){var self=this;if(self.destroyed)return;if(self.reconnecting){self.reconnecting=false;self.retries=0;self.announce(self.client._defaultAnnounceOpts());}};WebSocketTracker.prototype._onSocketData=function(data){var self=this;if(self.destroyed)return;self.expectingResponse=false;try{data=JSON.parse(data);}catch(err){self.client.emit("warning",new Error("Invalid tracker response"));return;}if(data.action==="announce"){self._onAnnounceResponse(data);}else if(data.action==="scrape"){self._onScrapeResponse(data);}else{self._onSocketError(new Error("invalid action in WS response: "+data.action));}};WebSocketTracker.prototype._onAnnounceResponse=function(data){var self=this;if(data.info_hash!==self.client._infoHashBinary){debug("ignoring websocket data from %s for %s (looking for %s: reused socket)",self.announceUrl,common.binaryToHex(data.info_hash),self.client.infoHash);return;}if(data.peer_id&&data.peer_id===self.client._peerIdBinary){return;}debug("received %s from %s for %s",JSON.stringify(data),self.announceUrl,self.client.infoHash);var failure=data["failure reason"];if(failure)return self.client.emit("warning",new Error(failure));var warning=data["warning message"];if(warning)self.client.emit("warning",new Error(warning));var interval=data.interval||data["min interval"];if(interval)self.setInterval(interval*1e3);var trackerId=data["tracker id"];if(trackerId){self._trackerId=trackerId;}if(data.complete!=null){var response=Object.assign({},data,{announce:self.announceUrl,infoHash:common.binaryToHex(data.info_hash)});self.client.emit("update",response);}var peer;if(data.offer&&data.peer_id){debug("creating peer (from remote offer)");peer=self._createPeer();peer.id=common.binaryToHex(data.peer_id);peer.once("signal",function(answer){var params={action:"announce",info_hash:self.client._infoHashBinary,peer_id:self.client._peerIdBinary,to_peer_id:data.peer_id,answer:answer,offer_id:data.offer_id};if(self._trackerId)params.trackerid=self._trackerId;self._send(params);});peer.signal(data.offer);self.client.emit("peer",peer);}if(data.answer&&data.peer_id){var offerId=common.binaryToHex(data.offer_id);peer=self.peers[offerId];if(peer){peer.id=common.binaryToHex(data.peer_id);peer.signal(data.answer);self.client.emit("peer",peer);clearTimeout(peer.trackerTimeout);peer.trackerTimeout=null;delete self.peers[offerId];}else{debug("got unexpected answer: "+JSON.stringify(data.answer));}}};WebSocketTracker.prototype._onScrapeResponse=function(data){var self=this;data=data.files||{};var keys=Object.keys(data);if(keys.length===0){self.client.emit("warning",new Error("invalid scrape response"));return;}keys.forEach(function(infoHash){var response=Object.assign(data[infoHash],{announce:self.announceUrl,infoHash:common.binaryToHex(infoHash)});self.client.emit("scrape",response);});};WebSocketTracker.prototype._onSocketClose=function(){var self=this;if(self.destroyed)return;self.destroy();self._startReconnectTimer();};WebSocketTracker.prototype._onSocketError=function(err){var self=this;if(self.destroyed)return;self.destroy();self.client.emit("warning",err);self._startReconnectTimer();};WebSocketTracker.prototype._startReconnectTimer=function(){var self=this;var ms=Math.floor(Math.random()*RECONNECT_VARIANCE)+Math.min(Math.pow(2,self.retries)*RECONNECT_MINIMUM,RECONNECT_MAXIMUM);self.reconnecting=true;clearTimeout(self.reconnectTimer);self.reconnectTimer=setTimeout(function(){self.retries++;self._openSocket();},ms);if(self.reconnectTimer.unref)self.reconnectTimer.unref();debug("reconnecting socket in %s ms",ms);};WebSocketTracker.prototype._send=function(params){var self=this;if(self.destroyed)return;self.expectingResponse=true;var message=JSON.stringify(params);debug("send %s",message);self.socket.send(message);};WebSocketTracker.prototype._generateOffers=function(numwant,cb){var self=this;var offers=[];debug("generating %s offers",numwant);for(var i=0;i<numwant;++i){generateOffer();}checkDone();function generateOffer(){var offerId=randombytes(20).toString("hex");debug("creating peer (from _generateOffers)");var peer=self.peers[offerId]=self._createPeer({initiator:true});peer.once("signal",function(offer){offers.push({offer:offer,offer_id:common.hexToBinary(offerId)});checkDone();});peer.trackerTimeout=setTimeout(function(){debug("tracker timeout: destroying peer");peer.trackerTimeout=null;delete self.peers[offerId];peer.destroy();},OFFER_TIMEOUT);if(peer.trackerTimeout.unref)peer.trackerTimeout.unref();}function checkDone(){if(offers.length===numwant){debug("generated %s offers",numwant);cb(offers);}}};WebSocketTracker.prototype._createPeer=function(opts){var self=this;opts=Object.assign({trickle:false,config:self.client._rtcConfig,wrtc:self.client._wrtc},opts);var peer=new Peer(opts);peer.once("error",onError);peer.once("connect",onConnect);return peer;function onError(err){self.client.emit("warning",new Error("Connection error: "+err.message));peer.destroy();}function onConnect(){peer.removeListener("error",onError);peer.removeListener("connect",onConnect);}};function noop(){}},{"../common":24,"./tracker":22,debug:69,inherits:94,randombytes:159,"simple-peer":181,"simple-websocket":194,xtend:372}],24:[function(require,module,exports){var Buffer=require("safe-buffer").Buffer;var extend=require("xtend/mutable");exports.DEFAULT_ANNOUNCE_PEERS=50;exports.MAX_ANNOUNCE_PEERS=82;exports.binaryToHex=function(str){if(typeof str!=="string"){str=String(str);}return Buffer.from(str,"binary").toString("hex");};exports.hexToBinary=function(str){if(typeof str!=="string"){str=String(str);}return Buffer.from(str,"hex").toString("binary");};var config=require("./common-node");extend(exports,config);},{"./common-node":38,"safe-buffer":177,"xtend/mutable":373}],25:[function(require,module,exports){(function(Buffer){module.exports=function blobToBuffer(blob,cb){if(typeof Blob==="undefined"||!(blob instanceof Blob)){throw new Error("first argument must be a Blob");}if(typeof cb!=="function"){throw new Error("second argument must be a function");}var reader=new FileReader();function onLoadEnd(e){reader.removeEventListener("loadend",onLoadEnd,false);if(e.error)cb(e.error);else cb(null,new Buffer(reader.result));}reader.addEventListener("loadend",onLoadEnd,false);reader.readAsArrayBuffer(blob);};}).call(this,require("buffer").Buffer);},{buffer:41}],26:[function(require,module,exports){(function(Buffer){var inherits=require("inherits");var Transform=require("readable-stream").Transform;var defined=require("defined");module.exports=Block;inherits(Block,Transform);function Block(size,opts){if(!(this instanceof Block))return new Block(size,opts);Transform.call(this);if(!opts)opts={};if((typeof size==="undefined"?"undefined":_typeof2(size))==="object"){opts=size;size=opts.size;}this.size=size||512;if(opts.nopad)this._zeroPadding=false;else this._zeroPadding=defined(opts.zeroPadding,true);this._buffered=[];this._bufferedBytes=0;}Block.prototype._transform=function(buf,enc,next){this._bufferedBytes+=buf.length;this._buffered.push(buf);while(this._bufferedBytes>=this.size){var b=Buffer.concat(this._buffered);this._bufferedBytes-=this.size;this.push(b.slice(0,this.size));this._buffered=[b.slice(this.size,b.length)];}next();};Block.prototype._flush=function(){if(this._bufferedBytes&&this._zeroPadding){var zeroes=new Buffer(this.size-this._bufferedBytes);zeroes.fill(0);this._buffered.push(zeroes);this.push(Buffer.concat(this._buffered));this._buffered=null;}else if(this._bufferedBytes){this.push(Buffer.concat(this._buffered));this._buffered=null;}this.push(null);};}).call(this,require("buffer").Buffer);},{buffer:41,defined:71,inherits:94,"readable-stream":36}],27:[function(require,module,exports){arguments[4][10][0].apply(exports,arguments);},{dup:10}],28:[function(require,module,exports){arguments[4][11][0].apply(exports,arguments);},{"./_stream_readable":30,"./_stream_writable":32,"core-util-is":56,dup:11,inherits:94,"process-nextick-args":152}],29:[function(require,module,exports){arguments[4][12][0].apply(exports,arguments);},{"./_stream_transform":31,"core-util-is":56,dup:12,inherits:94}],30:[function(require,module,exports){arguments[4][13][0].apply(exports,arguments);},{"./_stream_duplex":28,"./internal/streams/BufferList":33,"./internal/streams/destroy":34,"./internal/streams/stream":35,_process:40,"core-util-is":56,dup:13,events:73,inherits:94,isarray:27,"process-nextick-args":152,"safe-buffer":177,"string_decoder/":37,util:38}],31:[function(require,module,exports){arguments[4][14][0].apply(exports,arguments);},{"./_stream_duplex":28,"core-util-is":56,dup:14,inherits:94}],32:[function(require,module,exports){arguments[4][15][0].apply(exports,arguments);},{"./_stream_duplex":28,"./internal/streams/destroy":34,"./internal/streams/stream":35,_process:40,"core-util-is":56,dup:15,inherits:94,"process-nextick-args":152,"safe-buffer":177,"util-deprecate":239}],33:[function(require,module,exports){arguments[4][16][0].apply(exports,arguments);},{dup:16,"safe-buffer":177}],34:[function(require,module,exports){arguments[4][17][0].apply(exports,arguments);},{dup:17,"process-nextick-args":152}],35:[function(require,module,exports){arguments[4][18][0].apply(exports,arguments);},{dup:18,events:73}],36:[function(require,module,exports){arguments[4][19][0].apply(exports,arguments);},{"./lib/_stream_duplex.js":28,"./lib/_stream_passthrough.js":29,"./lib/_stream_readable.js":30,"./lib/_stream_transform.js":31,"./lib/_stream_writable.js":32,dup:19}],37:[function(require,module,exports){arguments[4][20][0].apply(exports,arguments);},{dup:20,"safe-buffer":177}],38:[function(require,module,exports){},{}],39:[function(require,module,exports){arguments[4][38][0].apply(exports,arguments);},{dup:38}],40:[function(require,module,exports){var process=module.exports={};var cachedSetTimeout;var cachedClearTimeout;function defaultSetTimout(){throw new Error("setTimeout has not been defined");}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined");}(function(){try{if(typeof setTimeout==="function"){cachedSetTimeout=setTimeout;}else{cachedSetTimeout=defaultSetTimout;}}catch(e){cachedSetTimeout=defaultSetTimout;}try{if(typeof clearTimeout==="function"){cachedClearTimeout=clearTimeout;}else{cachedClearTimeout=defaultClearTimeout;}}catch(e){cachedClearTimeout=defaultClearTimeout;}})();function runTimeout(fun){if(cachedSetTimeout===setTimeout){return setTimeout(fun,0);}if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout){cachedSetTimeout=setTimeout;return setTimeout(fun,0);}try{return cachedSetTimeout(fun,0);}catch(e){try{return cachedSetTimeout.call(null,fun,0);}catch(e){return cachedSetTimeout.call(this,fun,0);}}}function runClearTimeout(marker){if(cachedClearTimeout===clearTimeout){return clearTimeout(marker);}if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout){cachedClearTimeout=clearTimeout;return clearTimeout(marker);}try{return cachedClearTimeout(marker);}catch(e){try{return cachedClearTimeout.call(null,marker);}catch(e){return cachedClearTimeout.call(this,marker);}}}var queue=[];var draining=false;var currentQueue;var queueIndex=-1;function cleanUpNextTick(){if(!draining||!currentQueue){return;}draining=false;if(currentQueue.length){queue=currentQueue.concat(queue);}else{queueIndex=-1;}if(queue.length){drainQueue();}}function drainQueue(){if(draining){return;}var timeout=runTimeout(cleanUpNextTick);draining=true;var len=queue.length;while(len){currentQueue=queue;queue=[];while(++queueIndex<len){if(currentQueue){currentQueue[queueIndex].run();}}queueIndex=-1;len=queue.length;}currentQueue=null;draining=false;runClearTimeout(timeout);}process.nextTick=function(fun){var args=new Array(arguments.length-1);if(arguments.length>1){for(var i=1;i<arguments.length;i++){args[i-1]=arguments[i];}}queue.push(new Item(fun,args));if(queue.length===1&&!draining){runTimeout(drainQueue);}};function Item(fun,array){this.fun=fun;this.array=array;}Item.prototype.run=function(){this.fun.apply(null,this.array);};process.title="browser";process.browser=true;process.env={};process.argv=[];process.version="";process.versions={};function noop(){}process.on=noop;process.addListener=noop;process.once=noop;process.off=noop;process.removeListener=noop;process.removeAllListeners=noop;process.emit=noop;process.prependListener=noop;process.prependOnceListener=noop;process.listeners=function(name){return[];};process.binding=function(name){throw new Error("process.binding is not supported");};process.cwd=function(){return"/";};process.chdir=function(dir){throw new Error("process.chdir is not supported");};process.umask=function(){return 0;};},{}],41:[function(require,module,exports){"use strict";var base64=require("base64-js");var ieee754=require("ieee754");exports.Buffer=Buffer;exports.SlowBuffer=SlowBuffer;exports.INSPECT_MAX_BYTES=50;var K_MAX_LENGTH=2147483647;exports.kMaxLength=K_MAX_LENGTH;Buffer.TYPED_ARRAY_SUPPORT=typedArraySupport();if(!Buffer.TYPED_ARRAY_SUPPORT&&typeof console!=="undefined"&&typeof console.error==="function"){console.error("This browser lacks typed array (Uint8Array) support which is required by "+"`buffer` v5.x. Use `buffer` v4.x if you require old browser support.");}function typedArraySupport(){try{var arr=new Uint8Array(1);arr.__proto__={__proto__:Uint8Array.prototype,foo:function foo(){return 42;}};return arr.foo()===42;}catch(e){return false;}}function createBuffer(length){if(length>K_MAX_LENGTH){throw new RangeError("Invalid typed array length");}var buf=new Uint8Array(length);buf.__proto__=Buffer.prototype;return buf;}function Buffer(arg,encodingOrOffset,length){if(typeof arg==="number"){if(typeof encodingOrOffset==="string"){throw new Error("If encoding is specified then the first argument must be a string");}return allocUnsafe(arg);}return from(arg,encodingOrOffset,length);}if(typeof Symbol!=="undefined"&&Symbol.species&&Buffer[Symbol.species]===Buffer){Object.defineProperty(Buffer,Symbol.species,{value:null,configurable:true,enumerable:false,writable:false});}Buffer.poolSize=8192;function from(value,encodingOrOffset,length){if(typeof value==="number"){throw new TypeError('"value" argument must not be a number');}if(isArrayBuffer(value)){return fromArrayBuffer(value,encodingOrOffset,length);}if(typeof value==="string"){return fromString(value,encodingOrOffset);}return fromObject(value);}Buffer.from=function(value,encodingOrOffset,length){return from(value,encodingOrOffset,length);};Buffer.prototype.__proto__=Uint8Array.prototype;Buffer.__proto__=Uint8Array;function assertSize(size){if(typeof size!=="number"){throw new TypeError('"size" argument must be a number');}else if(size<0){throw new RangeError('"size" argument must not be negative');}}function alloc(size,fill,encoding){assertSize(size);if(size<=0){return createBuffer(size);}if(fill!==undefined){return typeof encoding==="string"?createBuffer(size).fill(fill,encoding):createBuffer(size).fill(fill);}return createBuffer(size);}Buffer.alloc=function(size,fill,encoding){return alloc(size,fill,encoding);};function allocUnsafe(size){assertSize(size);return createBuffer(size<0?0:checked(size)|0);}Buffer.allocUnsafe=function(size){return allocUnsafe(size);};Buffer.allocUnsafeSlow=function(size){return allocUnsafe(size);};function fromString(string,encoding){if(typeof encoding!=="string"||encoding===""){encoding="utf8";}if(!Buffer.isEncoding(encoding)){throw new TypeError('"encoding" must be a valid string encoding');}var length=byteLength(string,encoding)|0;var buf=createBuffer(length);var actual=buf.write(string,encoding);if(actual!==length){buf=buf.slice(0,actual);}return buf;}function fromArrayLike(array){var length=array.length<0?0:checked(array.length)|0;var buf=createBuffer(length);for(var i=0;i<length;i+=1){buf[i]=array[i]&255;}return buf;}function fromArrayBuffer(array,byteOffset,length){if(byteOffset<0||array.byteLength<byteOffset){throw new RangeError("'offset' is out of bounds");}if(array.byteLength<byteOffset+(length||0)){throw new RangeError("'length' is out of bounds");}var buf;if(byteOffset===undefined&&length===undefined){buf=new Uint8Array(array);}else if(length===undefined){buf=new Uint8Array(array,byteOffset);}else{buf=new Uint8Array(array,byteOffset,length);}buf.__proto__=Buffer.prototype;return buf;}function fromObject(obj){if(Buffer.isBuffer(obj)){var len=checked(obj.length)|0;var buf=createBuffer(len);if(buf.length===0){return buf;}obj.copy(buf,0,0,len);return buf;}if(obj){if(isArrayBufferView(obj)||"length"in obj){if(typeof obj.length!=="number"||numberIsNaN(obj.length)){return createBuffer(0);}return fromArrayLike(obj);}if(obj.type==="Buffer"&&Array.isArray(obj.data)){return fromArrayLike(obj.data);}}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.");}function checked(length){if(length>=K_MAX_LENGTH){throw new RangeError("Attempt to allocate Buffer larger than maximum "+"size: 0x"+K_MAX_LENGTH.toString(16)+" bytes");}return length|0;}function SlowBuffer(length){if(+length!=length){length=0;}return Buffer.alloc(+length);}Buffer.isBuffer=function isBuffer(b){return b!=null&&b._isBuffer===true;};Buffer.compare=function compare(a,b){if(!Buffer.isBuffer(a)||!Buffer.isBuffer(b)){throw new TypeError("Arguments must be Buffers");}if(a===b)return 0;var x=a.length;var y=b.length;for(var i=0,len=Math.min(x,y);i<len;++i){if(a[i]!==b[i]){x=a[i];y=b[i];break;}}if(x<y)return-1;if(y<x)return 1;return 0;};Buffer.isEncoding=function isEncoding(encoding){switch(String(encoding).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return true;default:return false;}};Buffer.concat=function concat(list,length){if(!Array.isArray(list)){throw new TypeError('"list" argument must be an Array of Buffers');}if(list.length===0){return Buffer.alloc(0);}var i;if(length===undefined){length=0;for(i=0;i<list.length;++i){length+=list[i].length;}}var buffer=Buffer.allocUnsafe(length);var pos=0;for(i=0;i<list.length;++i){var buf=list[i];if(!Buffer.isBuffer(buf)){throw new TypeError('"list" argument must be an Array of Buffers');}buf.copy(buffer,pos);pos+=buf.length;}return buffer;};function byteLength(string,encoding){if(Buffer.isBuffer(string)){return string.length;}if(isArrayBufferView(string)||isArrayBuffer(string)){return string.byteLength;}if(typeof string!=="string"){string=""+string;}var len=string.length;if(len===0)return 0;var loweredCase=false;for(;;){switch(encoding){case"ascii":case"latin1":case"binary":return len;case"utf8":case"utf-8":case undefined:return utf8ToBytes(string).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return len*2;case"hex":return len>>>1;case"base64":return base64ToBytes(string).length;default:if(loweredCase)return utf8ToBytes(string).length;encoding=(""+encoding).toLowerCase();loweredCase=true;}}}Buffer.byteLength=byteLength;function slowToString(encoding,start,end){var loweredCase=false;if(start===undefined||start<0){start=0;}if(start>this.length){return"";}if(end===undefined||end>this.length){end=this.length;}if(end<=0){return"";}end>>>=0;start>>>=0;if(end<=start){return"";}if(!encoding)encoding="utf8";while(true){switch(encoding){case"hex":return hexSlice(this,start,end);case"utf8":case"utf-8":return utf8Slice(this,start,end);case"ascii":return asciiSlice(this,start,end);case"latin1":case"binary":return latin1Slice(this,start,end);case"base64":return base64Slice(this,start,end);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return utf16leSlice(this,start,end);default:if(loweredCase)throw new TypeError("Unknown encoding: "+encoding);encoding=(encoding+"").toLowerCase();loweredCase=true;}}}Buffer.prototype._isBuffer=true;function swap(b,n,m){var i=b[n];b[n]=b[m];b[m]=i;}Buffer.prototype.swap16=function swap16(){var len=this.length;if(len%2!==0){throw new RangeError("Buffer size must be a multiple of 16-bits");}for(var i=0;i<len;i+=2){swap(this,i,i+1);}return this;};Buffer.prototype.swap32=function swap32(){var len=this.length;if(len%4!==0){throw new RangeError("Buffer size must be a multiple of 32-bits");}for(var i=0;i<len;i+=4){swap(this,i,i+3);swap(this,i+1,i+2);}return this;};Buffer.prototype.swap64=function swap64(){var len=this.length;if(len%8!==0){throw new RangeError("Buffer size must be a multiple of 64-bits");}for(var i=0;i<len;i+=8){swap(this,i,i+7);swap(this,i+1,i+6);swap(this,i+2,i+5);swap(this,i+3,i+4);}return this;};Buffer.prototype.toString=function toString(){var length=this.length;if(length===0)return"";if(arguments.length===0)return utf8Slice(this,0,length);return slowToString.apply(this,arguments);};Buffer.prototype.equals=function equals(b){if(!Buffer.isBuffer(b))throw new TypeError("Argument must be a Buffer");if(this===b)return true;return Buffer.compare(this,b)===0;};Buffer.prototype.inspect=function inspect(){var str="";var max=exports.INSPECT_MAX_BYTES;if(this.length>0){str=this.toString("hex",0,max).match(/.{2}/g).join(" ");if(this.length>max)str+=" ... ";}return"<Buffer "+str+">";};Buffer.prototype.compare=function compare(target,start,end,thisStart,thisEnd){if(!Buffer.isBuffer(target)){throw new TypeError("Argument must be a Buffer");}if(start===undefined){start=0;}if(end===undefined){end=target?target.length:0;}if(thisStart===undefined){thisStart=0;}if(thisEnd===undefined){thisEnd=this.length;}if(start<0||end>target.length||thisStart<0||thisEnd>this.length){throw new RangeError("out of range index");}if(thisStart>=thisEnd&&start>=end){return 0;}if(thisStart>=thisEnd){return-1;}if(start>=end){return 1;}start>>>=0;end>>>=0;thisStart>>>=0;thisEnd>>>=0;if(this===target)return 0;var x=thisEnd-thisStart;var y=end-start;var len=Math.min(x,y);var thisCopy=this.slice(thisStart,thisEnd);var targetCopy=target.slice(start,end);for(var i=0;i<len;++i){if(thisCopy[i]!==targetCopy[i]){x=thisCopy[i];y=targetCopy[i];break;}}if(x<y)return-1;if(y<x)return 1;return 0;};function bidirectionalIndexOf(buffer,val,byteOffset,encoding,dir){if(buffer.length===0)return-1;if(typeof byteOffset==="string"){encoding=byteOffset;byteOffset=0;}else if(byteOffset>2147483647){byteOffset=2147483647;}else if(byteOffset<-2147483648){byteOffset=-2147483648;}byteOffset=+byteOffset;if(numberIsNaN(byteOffset)){byteOffset=dir?0:buffer.length-1;}if(byteOffset<0)byteOffset=buffer.length+byteOffset;if(byteOffset>=buffer.length){if(dir)return-1;else byteOffset=buffer.length-1;}else if(byteOffset<0){if(dir)byteOffset=0;else return-1;}if(typeof val==="string"){val=Buffer.from(val,encoding);}if(Buffer.isBuffer(val)){if(val.length===0){return-1;}return arrayIndexOf(buffer,val,byteOffset,encoding,dir);}else if(typeof val==="number"){val=val&255;if(typeof Uint8Array.prototype.indexOf==="function"){if(dir){return Uint8Array.prototype.indexOf.call(buffer,val,byteOffset);}else{return Uint8Array.prototype.lastIndexOf.call(buffer,val,byteOffset);}}return arrayIndexOf(buffer,[val],byteOffset,encoding,dir);}throw new TypeError("val must be string, number or Buffer");}function arrayIndexOf(arr,val,byteOffset,encoding,dir){var indexSize=1;var arrLength=arr.length;var valLength=val.length;if(encoding!==undefined){encoding=String(encoding).toLowerCase();if(encoding==="ucs2"||encoding==="ucs-2"||encoding==="utf16le"||encoding==="utf-16le"){if(arr.length<2||val.length<2){return-1;}indexSize=2;arrLength/=2;valLength/=2;byteOffset/=2;}}function read(buf,i){if(indexSize===1){return buf[i];}else{return buf.readUInt16BE(i*indexSize);}}var i;if(dir){var foundIndex=-1;for(i=byteOffset;i<arrLength;i++){if(read(arr,i)===read(val,foundIndex===-1?0:i-foundIndex)){if(foundIndex===-1)foundIndex=i;if(i-foundIndex+1===valLength)return foundIndex*indexSize;}else{if(foundIndex!==-1)i-=i-foundIndex;foundIndex=-1;}}}else{if(byteOffset+valLength>arrLength)byteOffset=arrLength-valLength;for(i=byteOffset;i>=0;i--){var found=true;for(var j=0;j<valLength;j++){if(read(arr,i+j)!==read(val,j)){found=false;break;}}if(found)return i;}}return-1;}Buffer.prototype.includes=function includes(val,byteOffset,encoding){return this.indexOf(val,byteOffset,encoding)!==-1;};Buffer.prototype.indexOf=function indexOf(val,byteOffset,encoding){return bidirectionalIndexOf(this,val,byteOffset,encoding,true);};Buffer.prototype.lastIndexOf=function lastIndexOf(val,byteOffset,encoding){return bidirectionalIndexOf(this,val,byteOffset,encoding,false);};function hexWrite(buf,string,offset,length){offset=Number(offset)||0;var remaining=buf.length-offset;if(!length){length=remaining;}else{length=Number(length);if(length>remaining){length=remaining;}}var strLen=string.length;if(strLen%2!==0)throw new TypeError("Invalid hex string");if(length>strLen/2){length=strLen/2;}for(var i=0;i<length;++i){var parsed=parseInt(string.substr(i*2,2),16);if(numberIsNaN(parsed))return i;buf[offset+i]=parsed;}return i;}function utf8Write(buf,string,offset,length){return blitBuffer(utf8ToBytes(string,buf.length-offset),buf,offset,length);}function asciiWrite(buf,string,offset,length){return blitBuffer(asciiToBytes(string),buf,offset,length);}function latin1Write(buf,string,offset,length){return asciiWrite(buf,string,offset,length);}function base64Write(buf,string,offset,length){return blitBuffer(base64ToBytes(string),buf,offset,length);}function ucs2Write(buf,string,offset,length){return blitBuffer(utf16leToBytes(string,buf.length-offset),buf,offset,length);}Buffer.prototype.write=function write(string,offset,length,encoding){if(offset===undefined){encoding="utf8";length=this.length;offset=0;}else if(length===undefined&&typeof offset==="string"){encoding=offset;length=this.length;offset=0;}else if(isFinite(offset)){offset=offset>>>0;if(isFinite(length)){length=length>>>0;if(encoding===undefined)encoding="utf8";}else{encoding=length;length=undefined;}}else{throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");}var remaining=this.length-offset;if(length===undefined||length>remaining)length=remaining;if(string.length>0&&(length<0||offset<0)||offset>this.length){throw new RangeError("Attempt to write outside buffer bounds");}if(!encoding)encoding="utf8";var loweredCase=false;for(;;){switch(encoding){case"hex":return hexWrite(this,string,offset,length);case"utf8":case"utf-8":return utf8Write(this,string,offset,length);case"ascii":return asciiWrite(this,string,offset,length);case"latin1":case"binary":return latin1Write(this,string,offset,length);case"base64":return base64Write(this,string,offset,length);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ucs2Write(this,string,offset,length);default:if(loweredCase)throw new TypeError("Unknown encoding: "+encoding);encoding=(""+encoding).toLowerCase();loweredCase=true;}}};Buffer.prototype.toJSON=function toJSON(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)};};function base64Slice(buf,start,end){if(start===0&&end===buf.length){return base64.fromByteArray(buf);}else{return base64.fromByteArray(buf.slice(start,end));}}function utf8Slice(buf,start,end){end=Math.min(buf.length,end);var res=[];var i=start;while(i<end){var firstByte=buf[i];var codePoint=null;var bytesPerSequence=firstByte>239?4:firstByte>223?3:firstByte>191?2:1;if(i+bytesPerSequence<=end){var secondByte,thirdByte,fourthByte,tempCodePoint;switch(bytesPerSequence){case 1:if(firstByte<128){codePoint=firstByte;}break;case 2:secondByte=buf[i+1];if((secondByte&192)===128){tempCodePoint=(firstByte&31)<<6|secondByte&63;if(tempCodePoint>127){codePoint=tempCodePoint;}}break;case 3:secondByte=buf[i+1];thirdByte=buf[i+2];if((secondByte&192)===128&&(thirdByte&192)===128){tempCodePoint=(firstByte&15)<<12|(secondByte&63)<<6|thirdByte&63;if(tempCodePoint>2047&&(tempCodePoint<55296||tempCodePoint>57343)){codePoint=tempCodePoint;}}break;case 4:secondByte=buf[i+1];thirdByte=buf[i+2];fourthByte=buf[i+3];if((secondByte&192)===128&&(thirdByte&192)===128&&(fourthByte&192)===128){tempCodePoint=(firstByte&15)<<18|(secondByte&63)<<12|(thirdByte&63)<<6|fourthByte&63;if(tempCodePoint>65535&&tempCodePoint<1114112){codePoint=tempCodePoint;}}}}if(codePoint===null){codePoint=65533;bytesPerSequence=1;}else if(codePoint>65535){codePoint-=65536;res.push(codePoint>>>10&1023|55296);codePoint=56320|codePoint&1023;}res.push(codePoint);i+=bytesPerSequence;}return decodeCodePointsArray(res);}var MAX_ARGUMENTS_LENGTH=4096;function decodeCodePointsArray(codePoints){var len=codePoints.length;if(len<=MAX_ARGUMENTS_LENGTH){return String.fromCharCode.apply(String,codePoints);}var res="";var i=0;while(i<len){res+=String.fromCharCode.apply(String,codePoints.slice(i,i+=MAX_ARGUMENTS_LENGTH));}return res;}function asciiSlice(buf,start,end){var ret="";end=Math.min(buf.length,end);for(var i=start;i<end;++i){ret+=String.fromCharCode(buf[i]&127);}return ret;}function latin1Slice(buf,start,end){var ret="";end=Math.min(buf.length,end);for(var i=start;i<end;++i){ret+=String.fromCharCode(buf[i]);}return ret;}function hexSlice(buf,start,end){var len=buf.length;if(!start||start<0)start=0;if(!end||end<0||end>len)end=len;var out="";for(var i=start;i<end;++i){out+=toHex(buf[i]);}return out;}function utf16leSlice(buf,start,end){var bytes=buf.slice(start,end);var res="";for(var i=0;i<bytes.length;i+=2){res+=String.fromCharCode(bytes[i]+bytes[i+1]*256);}return res;}Buffer.prototype.slice=function slice(start,end){var len=this.length;start=~~start;end=end===undefined?len:~~end;if(start<0){start+=len;if(start<0)start=0;}else if(start>len){start=len;}if(end<0){end+=len;if(end<0)end=0;}else if(end>len){end=len;}if(end<start)end=start;var newBuf=this.subarray(start,end);newBuf.__proto__=Buffer.prototype;return newBuf;};function checkOffset(offset,ext,length){if(offset%1!==0||offset<0)throw new RangeError("offset is not uint");if(offset+ext>length)throw new RangeError("Trying to access beyond buffer length");}Buffer.prototype.readUIntLE=function readUIntLE(offset,byteLength,noAssert){offset=offset>>>0;byteLength=byteLength>>>0;if(!noAssert)checkOffset(offset,byteLength,this.length);var val=this[offset];var mul=1;var i=0;while(++i<byteLength&&(mul*=256)){val+=this[offset+i]*mul;}return val;};Buffer.prototype.readUIntBE=function readUIntBE(offset,byteLength,noAssert){offset=offset>>>0;byteLength=byteLength>>>0;if(!noAssert){checkOffset(offset,byteLength,this.length);}var val=this[offset+--byteLength];var mul=1;while(byteLength>0&&(mul*=256)){val+=this[offset+--byteLength]*mul;}return val;};Buffer.prototype.readUInt8=function readUInt8(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,1,this.length);return this[offset];};Buffer.prototype.readUInt16LE=function readUInt16LE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,2,this.length);return this[offset]|this[offset+1]<<8;};Buffer.prototype.readUInt16BE=function readUInt16BE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,2,this.length);return this[offset]<<8|this[offset+1];};Buffer.prototype.readUInt32LE=function readUInt32LE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,4,this.length);return(this[offset]|this[offset+1]<<8|this[offset+2]<<16)+this[offset+3]*16777216;};Buffer.prototype.readUInt32BE=function readUInt32BE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,4,this.length);return this[offset]*16777216+(this[offset+1]<<16|this[offset+2]<<8|this[offset+3]);};Buffer.prototype.readIntLE=function readIntLE(offset,byteLength,noAssert){offset=offset>>>0;byteLength=byteLength>>>0;if(!noAssert)checkOffset(offset,byteLength,this.length);var val=this[offset];var mul=1;var i=0;while(++i<byteLength&&(mul*=256)){val+=this[offset+i]*mul;}mul*=128;if(val>=mul)val-=Math.pow(2,8*byteLength);return val;};Buffer.prototype.readIntBE=function readIntBE(offset,byteLength,noAssert){offset=offset>>>0;byteLength=byteLength>>>0;if(!noAssert)checkOffset(offset,byteLength,this.length);var i=byteLength;var mul=1;var val=this[offset+--i];while(i>0&&(mul*=256)){val+=this[offset+--i]*mul;}mul*=128;if(val>=mul)val-=Math.pow(2,8*byteLength);return val;};Buffer.prototype.readInt8=function readInt8(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,1,this.length);if(!(this[offset]&128))return this[offset];return(255-this[offset]+1)*-1;};Buffer.prototype.readInt16LE=function readInt16LE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,2,this.length);var val=this[offset]|this[offset+1]<<8;return val&32768?val|4294901760:val;};Buffer.prototype.readInt16BE=function readInt16BE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,2,this.length);var val=this[offset+1]|this[offset]<<8;return val&32768?val|4294901760:val;};Buffer.prototype.readInt32LE=function readInt32LE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,4,this.length);return this[offset]|this[offset+1]<<8|this[offset+2]<<16|this[offset+3]<<24;};Buffer.prototype.readInt32BE=function readInt32BE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,4,this.length);return this[offset]<<24|this[offset+1]<<16|this[offset+2]<<8|this[offset+3];};Buffer.prototype.readFloatLE=function readFloatLE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,4,this.length);return ieee754.read(this,offset,true,23,4);};Buffer.prototype.readFloatBE=function readFloatBE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,4,this.length);return ieee754.read(this,offset,false,23,4);};Buffer.prototype.readDoubleLE=function readDoubleLE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,8,this.length);return ieee754.read(this,offset,true,52,8);};Buffer.prototype.readDoubleBE=function readDoubleBE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,8,this.length);return ieee754.read(this,offset,false,52,8);};function checkInt(buf,value,offset,ext,max,min){if(!Buffer.isBuffer(buf))throw new TypeError('"buffer" argument must be a Buffer instance');if(value>max||value<min)throw new RangeError('"value" argument is out of bounds');if(offset+ext>buf.length)throw new RangeError("Index out of range");}Buffer.prototype.writeUIntLE=function writeUIntLE(value,offset,byteLength,noAssert){value=+value;offset=offset>>>0;byteLength=byteLength>>>0;if(!noAssert){var maxBytes=Math.pow(2,8*byteLength)-1;checkInt(this,value,offset,byteLength,maxBytes,0);}var mul=1;var i=0;this[offset]=value&255;while(++i<byteLength&&(mul*=256)){this[offset+i]=value/mul&255;}return offset+byteLength;};Buffer.prototype.writeUIntBE=function writeUIntBE(value,offset,byteLength,noAssert){value=+value;offset=offset>>>0;byteLength=byteLength>>>0;if(!noAssert){var maxBytes=Math.pow(2,8*byteLength)-1;checkInt(this,value,offset,byteLength,maxBytes,0);}var i=byteLength-1;var mul=1;this[offset+i]=value&255;while(--i>=0&&(mul*=256)){this[offset+i]=value/mul&255;}return offset+byteLength;};Buffer.prototype.writeUInt8=function writeUInt8(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,1,255,0);this[offset]=value&255;return offset+1;};Buffer.prototype.writeUInt16LE=function writeUInt16LE(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,2,65535,0);this[offset]=value&255;this[offset+1]=value>>>8;return offset+2;};Buffer.prototype.writeUInt16BE=function writeUInt16BE(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,2,65535,0);this[offset]=value>>>8;this[offset+1]=value&255;return offset+2;};Buffer.prototype.writeUInt32LE=function writeUInt32LE(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,4,4294967295,0);this[offset+3]=value>>>24;this[offset+2]=value>>>16;this[offset+1]=value>>>8;this[offset]=value&255;return offset+4;};Buffer.prototype.writeUInt32BE=function writeUInt32BE(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,4,4294967295,0);this[offset]=value>>>24;this[offset+1]=value>>>16;this[offset+2]=value>>>8;this[offset+3]=value&255;return offset+4;};Buffer.prototype.writeIntLE=function writeIntLE(value,offset,byteLength,noAssert){value=+value;offset=offset>>>0;if(!noAssert){var limit=Math.pow(2,8*byteLength-1);checkInt(this,value,offset,byteLength,limit-1,-limit);}var i=0;var mul=1;var sub=0;this[offset]=value&255;while(++i<byteLength&&(mul*=256)){if(value<0&&sub===0&&this[offset+i-1]!==0){sub=1;}this[offset+i]=(value/mul>>0)-sub&255;}return offset+byteLength;};Buffer.prototype.writeIntBE=function writeIntBE(value,offset,byteLength,noAssert){value=+value;offset=offset>>>0;if(!noAssert){var limit=Math.pow(2,8*byteLength-1);checkInt(this,value,offset,byteLength,limit-1,-limit);}var i=byteLength-1;var mul=1;var sub=0;this[offset+i]=value&255;while(--i>=0&&(mul*=256)){if(value<0&&sub===0&&this[offset+i+1]!==0){sub=1;}this[offset+i]=(value/mul>>0)-sub&255;}return offset+byteLength;};Buffer.prototype.writeInt8=function writeInt8(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,1,127,-128);if(value<0)value=255+value+1;this[offset]=value&255;return offset+1;};Buffer.prototype.writeInt16LE=function writeInt16LE(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,2,32767,-32768);this[offset]=value&255;this[offset+1]=value>>>8;return offset+2;};Buffer.prototype.writeInt16BE=function writeInt16BE(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,2,32767,-32768);this[offset]=value>>>8;this[offset+1]=value&255;return offset+2;};Buffer.prototype.writeInt32LE=function writeInt32LE(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,4,2147483647,-2147483648);this[offset]=value&255;this[offset+1]=value>>>8;this[offset+2]=value>>>16;this[offset+3]=value>>>24;return offset+4;};Buffer.prototype.writeInt32BE=function writeInt32BE(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,4,2147483647,-2147483648);if(value<0)value=4294967295+value+1;this[offset]=value>>>24;this[offset+1]=value>>>16;this[offset+2]=value>>>8;this[offset+3]=value&255;return offset+4;};function checkIEEE754(buf,value,offset,ext,max,min){if(offset+ext>buf.length)throw new RangeError("Index out of range");if(offset<0)throw new RangeError("Index out of range");}function writeFloat(buf,value,offset,littleEndian,noAssert){value=+value;offset=offset>>>0;if(!noAssert){checkIEEE754(buf,value,offset,4,3.4028234663852886e38,-3.4028234663852886e38);}ieee754.write(buf,value,offset,littleEndian,23,4);return offset+4;}Buffer.prototype.writeFloatLE=function writeFloatLE(value,offset,noAssert){return writeFloat(this,value,offset,true,noAssert);};Buffer.prototype.writeFloatBE=function writeFloatBE(value,offset,noAssert){return writeFloat(this,value,offset,false,noAssert);};function writeDouble(buf,value,offset,littleEndian,noAssert){value=+value;offset=offset>>>0;if(!noAssert){checkIEEE754(buf,value,offset,8,1.7976931348623157e308,-1.7976931348623157e308);}ieee754.write(buf,value,offset,littleEndian,52,8);return offset+8;}Buffer.prototype.writeDoubleLE=function writeDoubleLE(value,offset,noAssert){return writeDouble(this,value,offset,true,noAssert);};Buffer.prototype.writeDoubleBE=function writeDoubleBE(value,offset,noAssert){return writeDouble(this,value,offset,false,noAssert);};Buffer.prototype.copy=function copy(target,targetStart,start,end){if(!start)start=0;if(!end&&end!==0)end=this.length;if(targetStart>=target.length)targetStart=target.length;if(!targetStart)targetStart=0;if(end>0&&end<start)end=start;if(end===start)return 0;if(target.length===0||this.length===0)return 0;if(targetStart<0){throw new RangeError("targetStart out of bounds");}if(start<0||start>=this.length)throw new RangeError("sourceStart out of bounds");if(end<0)throw new RangeError("sourceEnd out of bounds");if(end>this.length)end=this.length;if(target.length-targetStart<end-start){end=target.length-targetStart+start;}var len=end-start;var i;if(this===target&&start<targetStart&&targetStart<end){for(i=len-1;i>=0;--i){target[i+targetStart]=this[i+start];}}else if(len<1e3){for(i=0;i<len;++i){target[i+targetStart]=this[i+start];}}else{Uint8Array.prototype.set.call(target,this.subarray(start,start+len),targetStart);}return len;};Buffer.prototype.fill=function fill(val,start,end,encoding){if(typeof val==="string"){if(typeof start==="string"){encoding=start;start=0;end=this.length;}else if(typeof end==="string"){encoding=end;end=this.length;}if(val.length===1){var code=val.charCodeAt(0);if(code<256){val=code;}}if(encoding!==undefined&&typeof encoding!=="string"){throw new TypeError("encoding must be a string");}if(typeof encoding==="string"&&!Buffer.isEncoding(encoding)){throw new TypeError("Unknown encoding: "+encoding);}}else if(typeof val==="number"){val=val&255;}if(start<0||this.length<start||this.length<end){throw new RangeError("Out of range index");}if(end<=start){return this;}start=start>>>0;end=end===undefined?this.length:end>>>0;if(!val)val=0;var i;if(typeof val==="number"){for(i=start;i<end;++i){this[i]=val;}}else{var bytes=Buffer.isBuffer(val)?val:new Buffer(val,encoding);var len=bytes.length;for(i=0;i<end-start;++i){this[i+start]=bytes[i%len];}}return this;};var INVALID_BASE64_RE=/[^+/0-9A-Za-z-_]/g;function base64clean(str){str=str.trim().replace(INVALID_BASE64_RE,"");if(str.length<2)return"";while(str.length%4!==0){str=str+"=";}return str;}function toHex(n){if(n<16)return"0"+n.toString(16);return n.toString(16);}function utf8ToBytes(string,units){units=units||Infinity;var codePoint;var length=string.length;var leadSurrogate=null;var bytes=[];for(var i=0;i<length;++i){codePoint=string.charCodeAt(i);if(codePoint>55295&&codePoint<57344){if(!leadSurrogate){if(codePoint>56319){if((units-=3)>-1)bytes.push(239,191,189);continue;}else if(i+1===length){if((units-=3)>-1)bytes.push(239,191,189);continue;}leadSurrogate=codePoint;continue;}if(codePoint<56320){if((units-=3)>-1)bytes.push(239,191,189);leadSurrogate=codePoint;continue;}codePoint=(leadSurrogate-55296<<10|codePoint-56320)+65536;}else if(leadSurrogate){if((units-=3)>-1)bytes.push(239,191,189);}leadSurrogate=null;if(codePoint<128){if((units-=1)<0)break;bytes.push(codePoint);}else if(codePoint<2048){if((units-=2)<0)break;bytes.push(codePoint>>6|192,codePoint&63|128);}else if(codePoint<65536){if((units-=3)<0)break;bytes.push(codePoint>>12|224,codePoint>>6&63|128,codePoint&63|128);}else if(codePoint<1114112){if((units-=4)<0)break;bytes.push(codePoint>>18|240,codePoint>>12&63|128,codePoint>>6&63|128,codePoint&63|128);}else{throw new Error("Invalid code point");}}return bytes;}function asciiToBytes(str){var byteArray=[];for(var i=0;i<str.length;++i){byteArray.push(str.charCodeAt(i)&255);}return byteArray;}function utf16leToBytes(str,units){var c,hi,lo;var byteArray=[];for(var i=0;i<str.length;++i){if((units-=2)<0)break;c=str.charCodeAt(i);hi=c>>8;lo=c%256;byteArray.push(lo);byteArray.push(hi);}return byteArray;}function base64ToBytes(str){return base64.toByteArray(base64clean(str));}function blitBuffer(src,dst,offset,length){for(var i=0;i<length;++i){if(i+offset>=dst.length||i>=src.length)break;dst[i+offset]=src[i];}return i;}function isArrayBuffer(obj){return obj instanceof ArrayBuffer||obj!=null&&obj.constructor!=null&&obj.constructor.name==="ArrayBuffer"&&typeof obj.byteLength==="number";}function isArrayBufferView(obj){return typeof ArrayBuffer.isView==="function"&&ArrayBuffer.isView(obj);}function numberIsNaN(obj){return obj!==obj;}},{"base64-js":3,ieee754:92}],42:[function(require,module,exports){module.exports={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",208:"Already Reported",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",308:"Permanent Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Payload Too Large",414:"URI Too Long",415:"Unsupported Media Type",416:"Range Not Satisfiable",417:"Expectation Failed",418:"I'm a teapot",421:"Misdirected Request",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Unordered Collection",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",451:"Unavailable For Legal Reasons",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",508:"Loop Detected",509:"Bandwidth Limit Exceeded",510:"Not Extended",511:"Network Authentication Required"};},{}],43:[function(require,module,exports){arguments[4][10][0].apply(exports,arguments);},{dup:10}],44:[function(require,module,exports){arguments[4][11][0].apply(exports,arguments);},{"./_stream_readable":46,"./_stream_writable":48,"core-util-is":56,dup:11,inherits:94,"process-nextick-args":152}],45:[function(require,module,exports){arguments[4][12][0].apply(exports,arguments);},{"./_stream_transform":47,"core-util-is":56,dup:12,inherits:94}],46:[function(require,module,exports){arguments[4][13][0].apply(exports,arguments);},{"./_stream_duplex":44,"./internal/streams/BufferList":49,"./internal/streams/destroy":50,"./internal/streams/stream":51,_process:40,"core-util-is":56,dup:13,events:73,inherits:94,isarray:43,"process-nextick-args":152,"safe-buffer":177,"string_decoder/":53,util:38}],47:[function(require,module,exports){arguments[4][14][0].apply(exports,arguments);},{"./_stream_duplex":44,"core-util-is":56,dup:14,inherits:94}],48:[function(require,module,exports){arguments[4][15][0].apply(exports,arguments);},{"./_stream_duplex":44,"./internal/streams/destroy":50,"./internal/streams/stream":51,_process:40,"core-util-is":56,dup:15,inherits:94,"process-nextick-args":152,"safe-buffer":177,"util-deprecate":239}],49:[function(require,module,exports){arguments[4][16][0].apply(exports,arguments);},{dup:16,"safe-buffer":177}],50:[function(require,module,exports){arguments[4][17][0].apply(exports,arguments);},{dup:17,"process-nextick-args":152}],51:[function(require,module,exports){arguments[4][18][0].apply(exports,arguments);},{dup:18,events:73}],52:[function(require,module,exports){arguments[4][19][0].apply(exports,arguments);},{"./lib/_stream_duplex.js":44,"./lib/_stream_passthrough.js":45,"./lib/_stream_readable.js":46,"./lib/_stream_transform.js":47,"./lib/_stream_writable.js":48,dup:19}],53:[function(require,module,exports){arguments[4][20][0].apply(exports,arguments);},{dup:20,"safe-buffer":177}],54:[function(require,module,exports){module.exports=ChunkStoreWriteStream;var BlockStream=require("block-stream2");var inherits=require("inherits");var stream=require("readable-stream");inherits(ChunkStoreWriteStream,stream.Writable);function ChunkStoreWriteStream(store,chunkLength,opts){var self=this;if(!(self instanceof ChunkStoreWriteStream)){return new ChunkStoreWriteStream(store,chunkLength,opts);}stream.Writable.call(self,opts);if(!opts)opts={};if(!store||!store.put||!store.get){throw new Error("First argument must be an abstract-chunk-store compliant store");}chunkLength=Number(chunkLength);if(!chunkLength)throw new Error("Second argument must be a chunk length");self._blockstream=new BlockStream(chunkLength,{zeroPadding:false});self._blockstream.on("data",onData).on("error",function(err){self.destroy(err);});var index=0;function onData(chunk){if(self.destroyed)return;store.put(index,chunk);index+=1;}self.on("finish",function(){this._blockstream.end();});}ChunkStoreWriteStream.prototype._write=function(chunk,encoding,callback){this._blockstream.write(chunk,encoding,callback);};ChunkStoreWriteStream.prototype.destroy=function(err){if(this.destroyed)return;this.destroyed=true;if(err)this.emit("error",err);this.emit("close");};},{"block-stream2":26,inherits:94,"readable-stream":52}],55:[function(require,module,exports){var abs=Math.abs;module.exports=closest;function closest(n,arr,rndx){var i,ndx,diff,best=Infinity;var low=0,high=arr.length-1;while(low<=high){i=low+(high-low>>1);diff=arr[i]-n;diff<0?low=i+1:diff>0?high=i-1:void 0;diff=abs(diff);if(diff<best)best=diff,ndx=i;if(arr[i]===n)break;}return rndx?ndx:arr[ndx];}},{}],56:[function(require,module,exports){(function(Buffer){function isArray(arg){if(Array.isArray){return Array.isArray(arg);}return objectToString(arg)==="[object Array]";}exports.isArray=isArray;function isBoolean(arg){return typeof arg==="boolean";}exports.isBoolean=isBoolean;function isNull(arg){return arg===null;}exports.isNull=isNull;function isNullOrUndefined(arg){return arg==null;}exports.isNullOrUndefined=isNullOrUndefined;function isNumber(arg){return typeof arg==="number";}exports.isNumber=isNumber;function isString(arg){return typeof arg==="string";}exports.isString=isString;function isSymbol(arg){return(typeof arg==="undefined"?"undefined":_typeof2(arg))==="symbol";}exports.isSymbol=isSymbol;function isUndefined(arg){return arg===void 0;}exports.isUndefined=isUndefined;function isRegExp(re){return objectToString(re)==="[object RegExp]";}exports.isRegExp=isRegExp;function isObject(arg){return(typeof arg==="undefined"?"undefined":_typeof2(arg))==="object"&&arg!==null;}exports.isObject=isObject;function isDate(d){return objectToString(d)==="[object Date]";}exports.isDate=isDate;function isError(e){return objectToString(e)==="[object Error]"||e instanceof Error;}exports.isError=isError;function isFunction(arg){return typeof arg==="function";}exports.isFunction=isFunction;function isPrimitive(arg){return arg===null||typeof arg==="boolean"||typeof arg==="number"||typeof arg==="string"||(typeof arg==="undefined"?"undefined":_typeof2(arg))==="symbol"||typeof arg==="undefined";}exports.isPrimitive=isPrimitive;exports.isBuffer=Buffer.isBuffer;function objectToString(o){return Object.prototype.toString.call(o);}}).call(this,{isBuffer:require("../../is-buffer/index.js")});},{"../../is-buffer/index.js":96}],57:[function(require,module,exports){(function(process,global,Buffer){module.exports=createTorrent;module.exports.parseInput=parseInput;module.exports.announceList=[["udp://tracker.leechers-paradise.org:6969"],["udp://tracker.coppersurfer.tk:6969"],["udp://tracker.opentrackr.org:1337"],["udp://explodie.org:6969"],["udp://tracker.empire-js.us:1337"],["wss://tracker.btorrent.xyz"],["wss://tracker.openwebtorrent.com"],["wss://tracker.fastcast.nz"]];var bencode=require("bencode");var BlockStream=require("block-stream2");var calcPieceLength=require("piece-length");var corePath=require("path");var extend=require("xtend");var FileReadStream=require("filestream/read");var flatten=require("flatten");var fs=require("fs");var isFile=require("is-file");var junk=require("junk");var MultiStream=require("multistream");var once=require("once");var parallel=require("run-parallel");var sha1=require("simple-sha1");var stream=require("readable-stream");function createTorrent(input,opts,cb){if(typeof opts==="function")return createTorrent(input,null,opts);opts=opts?extend(opts):{};_parseInput(input,opts,function(err,files,singleFileTorrent){if(err)return cb(err);opts.singleFileTorrent=singleFileTorrent;onFiles(files,opts,cb);});}function parseInput(input,opts,cb){if(typeof opts==="function")return parseInput(input,null,opts);opts=opts?extend(opts):{};_parseInput(input,opts,cb);}function _parseInput(input,opts,cb){if(Array.isArray(input)&&input.length===0)throw new Error("invalid input type");if(isFileList(input))input=Array.prototype.slice.call(input);if(!Array.isArray(input))input=[input];input=input.map(function(item){if(isBlob(item)&&typeof item.path==="string"&&typeof fs.stat==="function")return item.path;return item;});if(input.length===1&&typeof input[0]!=="string"&&!input[0].name)input[0].name=opts.name;var commonPrefix=null;input.forEach(function(item,i){if(typeof item==="string"){return;}var path=item.fullPath||item.name;if(!path){path="Unknown File "+(i+1);item.unknownName=true;}item.path=path.split("/");if(!item.path[0]){item.path.shift();}if(item.path.length<2){commonPrefix=null;}else if(i===0&&input.length>1){commonPrefix=item.path[0];}else if(item.path[0]!==commonPrefix){commonPrefix=null;}});input=input.filter(function(item){if(typeof item==="string"){return true;}var filename=item.path[item.path.length-1];return notHidden(filename)&&junk.not(filename);});if(commonPrefix){input.forEach(function(item){var pathless=(Buffer.isBuffer(item)||isReadable(item))&&!item.path;if(typeof item==="string"||pathless)return;item.path.shift();});}if(!opts.name&&commonPrefix){opts.name=commonPrefix;}if(!opts.name){input.some(function(item){if(typeof item==="string"){opts.name=corePath.basename(item);return true;}else if(!item.unknownName){opts.name=item.path[item.path.length-1];return true;}});}if(!opts.name){opts.name="Unnamed Torrent "+Date.now();}var numPaths=input.reduce(function(sum,item){return sum+Number(typeof item==="string");},0);var isSingleFileTorrent=input.length===1;if(input.length===1&&typeof input[0]==="string"){if(typeof fs.stat!=="function"){throw new Error("filesystem paths do not work in the browser");}isFile(input[0],function(err,pathIsFile){if(err)return cb(err);isSingleFileTorrent=pathIsFile;processInput();});}else{process.nextTick(function(){processInput();});}function processInput(){parallel(input.map(function(item){return function(cb){var file={};if(isBlob(item)){file.getStream=getBlobStream(item);file.length=item.size;}else if(Buffer.isBuffer(item)){file.getStream=getBufferStream(item);file.length=item.length;}else if(isReadable(item)){file.getStream=getStreamStream(item,file);file.length=0;}else if(typeof item==="string"){if(typeof fs.stat!=="function"){throw new Error("filesystem paths do not work in the browser");}var keepRoot=numPaths>1||isSingleFileTorrent;getFiles(item,keepRoot,cb);return;}else{throw new Error("invalid input type");}file.path=item.path;cb(null,file);};}),function(err,files){if(err)return cb(err);files=flatten(files);cb(null,files,isSingleFileTorrent);});}}function getFiles(path,keepRoot,cb){traversePath(path,getFileInfo,function(err,files){if(err)return cb(err);if(Array.isArray(files))files=flatten(files);else files=[files];path=corePath.normalize(path);if(keepRoot){path=path.slice(0,path.lastIndexOf(corePath.sep)+1);}if(path[path.length-1]!==corePath.sep)path+=corePath.sep;files.forEach(function(file){file.getStream=getFilePathStream(file.path);file.path=file.path.replace(path,"").split(corePath.sep);});cb(null,files);});}function getFileInfo(path,cb){cb=once(cb);fs.stat(path,function(err,stat){if(err)return cb(err);var info={length:stat.size,path:path};cb(null,info);});}function traversePath(path,fn,cb){fs.stat(path,function(err,stats){if(err)return cb(err);if(stats.isDirectory()){fs.readdir(path,function(err,entries){if(err)return cb(err);parallel(entries.filter(notHidden).filter(junk.not).map(function(entry){return function(cb){traversePath(corePath.join(path,entry),fn,cb);};}),cb);});}else if(stats.isFile()){fn(path,cb);}});}function notHidden(file){return file[0]!==".";}function getPieceList(files,pieceLength,cb){cb=once(cb);var pieces=[];var length=0;var streams=files.map(function(file){return file.getStream;});var remainingHashes=0;var pieceNum=0;var ended=false;var multistream=new MultiStream(streams);var blockstream=new BlockStream(pieceLength,{zeroPadding:false});multistream.on("error",onError);multistream.pipe(blockstream).on("data",onData).on("end",onEnd).on("error",onError);function onData(chunk){length+=chunk.length;var i=pieceNum;sha1(chunk,function(hash){pieces[i]=hash;remainingHashes-=1;maybeDone();});remainingHashes+=1;pieceNum+=1;}function onEnd(){ended=true;maybeDone();}function onError(err){cleanup();cb(err);}function cleanup(){multistream.removeListener("error",onError);blockstream.removeListener("data",onData);blockstream.removeListener("end",onEnd);blockstream.removeListener("error",onError);}function maybeDone(){if(ended&&remainingHashes===0){cleanup();cb(null,Buffer.from(pieces.join(""),"hex"),length);}}}function onFiles(files,opts,cb){var announceList=opts.announceList;if(!announceList){if(typeof opts.announce==="string")announceList=[[opts.announce]];else if(Array.isArray(opts.announce)){announceList=opts.announce.map(function(u){return[u];});}}if(!announceList)announceList=[];if(global.WEBTORRENT_ANNOUNCE){if(typeof global.WEBTORRENT_ANNOUNCE==="string"){announceList.push([[global.WEBTORRENT_ANNOUNCE]]);}else if(Array.isArray(global.WEBTORRENT_ANNOUNCE)){announceList=announceList.concat(global.WEBTORRENT_ANNOUNCE.map(function(u){return[u];}));}}if(opts.announce===undefined&&opts.announceList===undefined){announceList=announceList.concat(module.exports.announceList);}if(typeof opts.urlList==="string")opts.urlList=[opts.urlList];var torrent={info:{name:opts.name},"creation date":Math.ceil((Number(opts.creationDate)||Date.now())/1e3),encoding:"UTF-8"};if(announceList.length!==0){torrent.announce=announceList[0][0];torrent["announce-list"]=announceList;}if(opts.comment!==undefined)torrent.comment=opts.comment;if(opts.createdBy!==undefined)torrent["created by"]=opts.createdBy;if(opts.private!==undefined)torrent.info.private=Number(opts.private);if(opts.sslCert!==undefined)torrent.info["ssl-cert"]=opts.sslCert;if(opts.urlList!==undefined)torrent["url-list"]=opts.urlList;var pieceLength=opts.pieceLength||calcPieceLength(files.reduce(sumLength,0));torrent.info["piece length"]=pieceLength;getPieceList(files,pieceLength,function(err,pieces,torrentLength){if(err)return cb(err);torrent.info.pieces=pieces;files.forEach(function(file){delete file.getStream;});if(opts.singleFileTorrent){torrent.info.length=torrentLength;}else{torrent.info.files=files;}cb(null,bencode.encode(torrent));});}function sumLength(sum,file){return sum+file.length;}function isBlob(obj){return typeof Blob!=="undefined"&&obj instanceof Blob;}function isFileList(obj){return typeof FileList!=="undefined"&&obj instanceof FileList;}function isReadable(obj){return(typeof obj==="undefined"?"undefined":_typeof2(obj))==="object"&&obj!=null&&typeof obj.pipe==="function";}function getBlobStream(file){return function(){return new FileReadStream(file);};}function getBufferStream(buffer){return function(){var s=new stream.PassThrough();s.end(buffer);return s;};}function getFilePathStream(path){return function(){return fs.createReadStream(path);};}function getStreamStream(readable,file){return function(){var counter=new stream.Transform();counter._transform=function(buf,enc,done){file.length+=buf.length;this.push(buf);done();};readable.pipe(counter);return counter;};}}).call(this,require("_process"),typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{},require("buffer").Buffer);},{_process:40,bencode:6,"block-stream2":26,buffer:41,"filestream/read":85,flatten:86,fs:39,"is-file":97,junk:100,multistream:133,once:146,path:150,"piece-length":151,"readable-stream":67,"run-parallel":175,"simple-sha1":193,xtend:372}],58:[function(require,module,exports){arguments[4][10][0].apply(exports,arguments);},{dup:10}],59:[function(require,module,exports){arguments[4][11][0].apply(exports,arguments);},{"./_stream_readable":61,"./_stream_writable":63,"core-util-is":56,dup:11,inherits:94,"process-nextick-args":152}],60:[function(require,module,exports){arguments[4][12][0].apply(exports,arguments);},{"./_stream_transform":62,"core-util-is":56,dup:12,inherits:94}],61:[function(require,module,exports){arguments[4][13][0].apply(exports,arguments);},{"./_stream_duplex":59,"./internal/streams/BufferList":64,"./internal/streams/destroy":65,"./internal/streams/stream":66,_process:40,"core-util-is":56,dup:13,events:73,inherits:94,isarray:58,"process-nextick-args":152,"safe-buffer":177,"string_decoder/":68,util:38}],62:[function(require,module,exports){arguments[4][14][0].apply(exports,arguments);},{"./_stream_duplex":59,"core-util-is":56,dup:14,inherits:94}],63:[function(require,module,exports){arguments[4][15][0].apply(exports,arguments);},{"./_stream_duplex":59,"./internal/streams/destroy":65,"./internal/streams/stream":66,_process:40,"core-util-is":56,dup:15,inherits:94,"process-nextick-args":152,"safe-buffer":177,"util-deprecate":239}],64:[function(require,module,exports){arguments[4][16][0].apply(exports,arguments);},{dup:16,"safe-buffer":177}],65:[function(require,module,exports){arguments[4][17][0].apply(exports,arguments);},{dup:17,"process-nextick-args":152}],66:[function(require,module,exports){arguments[4][18][0].apply(exports,arguments);},{dup:18,events:73}],67:[function(require,module,exports){arguments[4][19][0].apply(exports,arguments);},{"./lib/_stream_duplex.js":59,"./lib/_stream_passthrough.js":60,"./lib/_stream_readable.js":61,"./lib/_stream_transform.js":62,"./lib/_stream_writable.js":63,dup:19}],68:[function(require,module,exports){arguments[4][20][0].apply(exports,arguments);},{dup:20,"safe-buffer":177}],69:[function(require,module,exports){(function(process){exports=module.exports=require("./debug");exports.log=log;exports.formatArgs=formatArgs;exports.save=save;exports.load=load;exports.useColors=useColors;exports.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:localstorage();exports.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"];function useColors(){if(typeof window!=="undefined"&&window.process&&window.process.type==="renderer"){return true;}return typeof document!=="undefined"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window!=="undefined"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator!=="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator!=="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/);}exports.formatters.j=function(v){try{return JSON.stringify(v);}catch(err){return"[UnexpectedJSONParseError]: "+err.message;}};function formatArgs(args){var useColors=this.useColors;args[0]=(useColors?"%c":"")+this.namespace+(useColors?" %c":" ")+args[0]+(useColors?"%c ":" ")+"+"+exports.humanize(this.diff);if(!useColors)return;var c="color: "+this.color;args.splice(1,0,c,"color: inherit");var index=0;var lastC=0;args[0].replace(/%[a-zA-Z%]/g,function(match){if("%%"===match)return;index++;if("%c"===match){lastC=index;}});args.splice(lastC,0,c);}function log(){return"object"===(typeof console==="undefined"?"undefined":_typeof2(console))&&console.log&&Function.prototype.apply.call(console.log,console,arguments);}function save(namespaces){try{if(null==namespaces){exports.storage.removeItem("debug");}else{exports.storage.debug=namespaces;}}catch(e){}}function load(){var r;try{r=exports.storage.debug;}catch(e){}if(!r&&typeof process!=="undefined"&&"env"in process){r=process.env.DEBUG;}return r;}exports.enable(load());function localstorage(){try{return window.localStorage;}catch(e){}}}).call(this,require("_process"));},{"./debug":70,_process:40}],70:[function(require,module,exports){exports=module.exports=createDebug.debug=createDebug["default"]=createDebug;exports.coerce=coerce;exports.disable=disable;exports.enable=enable;exports.enabled=enabled;exports.humanize=require("ms");exports.names=[];exports.skips=[];exports.formatters={};var prevTime;function selectColor(namespace){var hash=0,i;for(i in namespace){hash=(hash<<5)-hash+namespace.charCodeAt(i);hash|=0;}return exports.colors[Math.abs(hash)%exports.colors.length];}function createDebug(namespace){function debug(){if(!debug.enabled)return;var self=debug;var curr=+new Date();var ms=curr-(prevTime||curr);self.diff=ms;self.prev=prevTime;self.curr=curr;prevTime=curr;var args=new Array(arguments.length);for(var i=0;i<args.length;i++){args[i]=arguments[i];}args[0]=exports.coerce(args[0]);if("string"!==typeof args[0]){args.unshift("%O");}var index=0;args[0]=args[0].replace(/%([a-zA-Z%])/g,function(match,format){if(match==="%%")return match;index++;var formatter=exports.formatters[format];if("function"===typeof formatter){var val=args[index];match=formatter.call(self,val);args.splice(index,1);index--;}return match;});exports.formatArgs.call(self,args);var logFn=debug.log||exports.log||console.log.bind(console);logFn.apply(self,args);}debug.namespace=namespace;debug.enabled=exports.enabled(namespace);debug.useColors=exports.useColors();debug.color=selectColor(namespace);if("function"===typeof exports.init){exports.init(debug);}return debug;}function enable(namespaces){exports.save(namespaces);exports.names=[];exports.skips=[];var split=(typeof namespaces==="string"?namespaces:"").split(/[\s,]+/);var len=split.length;for(var i=0;i<len;i++){if(!split[i])continue;namespaces=split[i].replace(/\*/g,".*?");if(namespaces[0]==="-"){exports.skips.push(new RegExp("^"+namespaces.substr(1)+"$"));}else{exports.names.push(new RegExp("^"+namespaces+"$"));}}}function disable(){exports.enable("");}function enabled(name){var i,len;for(i=0,len=exports.skips.length;i<len;i++){if(exports.skips[i].test(name)){return false;}}for(i=0,len=exports.names.length;i<len;i++){if(exports.names[i].test(name)){return true;}}return false;}function coerce(val){if(val instanceof Error)return val.stack||val.message;return val;}},{ms:132}],71:[function(require,module,exports){module.exports=function(){for(var i=0;i<arguments.length;i++){if(arguments[i]!==undefined)return arguments[i];}};},{}],72:[function(require,module,exports){var once=require("once");var noop=function noop(){};var isRequest=function isRequest(stream){return stream.setHeader&&typeof stream.abort==="function";};var isChildProcess=function isChildProcess(stream){return stream.stdio&&Array.isArray(stream.stdio)&&stream.stdio.length===3;};var eos=function eos(stream,opts,callback){if(typeof opts==="function")return eos(stream,null,opts);if(!opts)opts={};callback=once(callback||noop);var ws=stream._writableState;var rs=stream._readableState;var readable=opts.readable||opts.readable!==false&&stream.readable;var writable=opts.writable||opts.writable!==false&&stream.writable;var onlegacyfinish=function onlegacyfinish(){if(!stream.writable)onfinish();};var onfinish=function onfinish(){writable=false;if(!readable)callback.call(stream);};var onend=function onend(){readable=false;if(!writable)callback.call(stream);};var onexit=function onexit(exitCode){callback.call(stream,exitCode?new Error("exited with error code: "+exitCode):null);};var onclose=function onclose(){if(readable&&!(rs&&rs.ended))return callback.call(stream,new Error("premature close"));if(writable&&!(ws&&ws.ended))return callback.call(stream,new Error("premature close"));};var onrequest=function onrequest(){stream.req.on("finish",onfinish);};if(isRequest(stream)){stream.on("complete",onfinish);stream.on("abort",onclose);if(stream.req)onrequest();else stream.on("request",onrequest);}else if(writable&&!ws){stream.on("end",onlegacyfinish);stream.on("close",onlegacyfinish);}if(isChildProcess(stream))stream.on("exit",onexit);stream.on("end",onend);stream.on("finish",onfinish);if(opts.error!==false)stream.on("error",callback);stream.on("close",onclose);return function(){stream.removeListener("complete",onfinish);stream.removeListener("abort",onclose);stream.removeListener("request",onrequest);if(stream.req)stream.req.removeListener("finish",onfinish);stream.removeListener("end",onlegacyfinish);stream.removeListener("close",onlegacyfinish);stream.removeListener("finish",onfinish);stream.removeListener("exit",onexit);stream.removeListener("end",onend);stream.removeListener("error",callback);stream.removeListener("close",onclose);};};module.exports=eos;},{once:146}],73:[function(require,module,exports){function EventEmitter(){this._events=this._events||{};this._maxListeners=this._maxListeners||undefined;}module.exports=EventEmitter;EventEmitter.EventEmitter=EventEmitter;EventEmitter.prototype._events=undefined;EventEmitter.prototype._maxListeners=undefined;EventEmitter.defaultMaxListeners=10;EventEmitter.prototype.setMaxListeners=function(n){if(!isNumber(n)||n<0||isNaN(n))throw TypeError("n must be a positive number");this._maxListeners=n;return this;};EventEmitter.prototype.emit=function(type){var er,handler,len,args,i,listeners;if(!this._events)this._events={};if(type==="error"){if(!this._events.error||isObject(this._events.error)&&!this._events.error.length){er=arguments[1];if(er instanceof Error){throw er;}else{var err=new Error('Uncaught, unspecified "error" event. ('+er+")");err.context=er;throw err;}}}handler=this._events[type];if(isUndefined(handler))return false;if(isFunction(handler)){switch(arguments.length){case 1:handler.call(this);break;case 2:handler.call(this,arguments[1]);break;case 3:handler.call(this,arguments[1],arguments[2]);break;default:args=Array.prototype.slice.call(arguments,1);handler.apply(this,args);}}else if(isObject(handler)){args=Array.prototype.slice.call(arguments,1);listeners=handler.slice();len=listeners.length;for(i=0;i<len;i++){listeners[i].apply(this,args);}}return true;};EventEmitter.prototype.addListener=function(type,listener){var m;if(!isFunction(listener))throw TypeError("listener must be a function");if(!this._events)this._events={};if(this._events.newListener)this.emit("newListener",type,isFunction(listener.listener)?listener.listener:listener);if(!this._events[type])this._events[type]=listener;else if(isObject(this._events[type]))this._events[type].push(listener);else this._events[type]=[this._events[type],listener];if(isObject(this._events[type])&&!this._events[type].warned){if(!isUndefined(this._maxListeners)){m=this._maxListeners;}else{m=EventEmitter.defaultMaxListeners;}if(m&&m>0&&this._events[type].length>m){this._events[type].warned=true;console.error("(node) warning: possible EventEmitter memory "+"leak detected. %d listeners added. "+"Use emitter.setMaxListeners() to increase limit.",this._events[type].length);if(typeof console.trace==="function"){console.trace();}}}return this;};EventEmitter.prototype.on=EventEmitter.prototype.addListener;EventEmitter.prototype.once=function(type,listener){if(!isFunction(listener))throw TypeError("listener must be a function");var fired=false;function g(){this.removeListener(type,g);if(!fired){fired=true;listener.apply(this,arguments);}}g.listener=listener;this.on(type,g);return this;};EventEmitter.prototype.removeListener=function(type,listener){var list,position,length,i;if(!isFunction(listener))throw TypeError("listener must be a function");if(!this._events||!this._events[type])return this;list=this._events[type];length=list.length;position=-1;if(list===listener||isFunction(list.listener)&&list.listener===listener){delete this._events[type];if(this._events.removeListener)this.emit("removeListener",type,listener);}else if(isObject(list)){for(i=length;i-->0;){if(list[i]===listener||list[i].listener&&list[i].listener===listener){position=i;break;}}if(position<0)return this;if(list.length===1){list.length=0;delete this._events[type];}else{list.splice(position,1);}if(this._events.removeListener)this.emit("removeListener",type,listener);}return this;};EventEmitter.prototype.removeAllListeners=function(type){var key,listeners;if(!this._events)return this;if(!this._events.removeListener){if(arguments.length===0)this._events={};else if(this._events[type])delete this._events[type];return this;}if(arguments.length===0){for(key in this._events){if(key==="removeListener")continue;this.removeAllListeners(key);}this.removeAllListeners("removeListener");this._events={};return this;}listeners=this._events[type];if(isFunction(listeners)){this.removeListener(type,listeners);}else if(listeners){while(listeners.length){this.removeListener(type,listeners[listeners.length-1]);}}delete this._events[type];return this;};EventEmitter.prototype.listeners=function(type){var ret;if(!this._events||!this._events[type])ret=[];else if(isFunction(this._events[type]))ret=[this._events[type]];else ret=this._events[type].slice();return ret;};EventEmitter.prototype.listenerCount=function(type){if(this._events){var evlistener=this._events[type];if(isFunction(evlistener))return 1;else if(evlistener)return evlistener.length;}return 0;};EventEmitter.listenerCount=function(emitter,type){return emitter.listenerCount(type);};function isFunction(arg){return typeof arg==="function";}function isNumber(arg){return typeof arg==="number";}function isObject(arg){return(typeof arg==="undefined"?"undefined":_typeof2(arg))==="object"&&arg!==null;}function isUndefined(arg){return arg===void 0;}},{}],74:[function(require,module,exports){arguments[4][10][0].apply(exports,arguments);},{dup:10}],75:[function(require,module,exports){arguments[4][11][0].apply(exports,arguments);},{"./_stream_readable":77,"./_stream_writable":79,"core-util-is":56,dup:11,inherits:94,"process-nextick-args":152}],76:[function(require,module,exports){arguments[4][12][0].apply(exports,arguments);},{"./_stream_transform":78,"core-util-is":56,dup:12,inherits:94}],77:[function(require,module,exports){arguments[4][13][0].apply(exports,arguments);},{"./_stream_duplex":75,"./internal/streams/BufferList":80,"./internal/streams/destroy":81,"./internal/streams/stream":82,_process:40,"core-util-is":56,dup:13,events:73,inherits:94,isarray:74,"process-nextick-args":152,"safe-buffer":177,"string_decoder/":84,util:38}],78:[function(require,module,exports){arguments[4][14][0].apply(exports,arguments);},{"./_stream_duplex":75,"core-util-is":56,dup:14,inherits:94}],79:[function(require,module,exports){arguments[4][15][0].apply(exports,arguments);},{"./_stream_duplex":75,"./internal/streams/destroy":81,"./internal/streams/stream":82,_process:40,"core-util-is":56,dup:15,inherits:94,"process-nextick-args":152,"safe-buffer":177,"util-deprecate":239}],80:[function(require,module,exports){arguments[4][16][0].apply(exports,arguments);},{dup:16,"safe-buffer":177}],81:[function(require,module,exports){arguments[4][17][0].apply(exports,arguments);},{dup:17,"process-nextick-args":152}],82:[function(require,module,exports){arguments[4][18][0].apply(exports,arguments);},{dup:18,events:73}],83:[function(require,module,exports){arguments[4][19][0].apply(exports,arguments);},{"./lib/_stream_duplex.js":75,"./lib/_stream_passthrough.js":76,"./lib/_stream_readable.js":77,"./lib/_stream_transform.js":78,"./lib/_stream_writable.js":79,dup:19}],84:[function(require,module,exports){arguments[4][20][0].apply(exports,arguments);},{dup:20,"safe-buffer":177}],85:[function(require,module,exports){var Readable=require("readable-stream").Readable;var inherits=require("inherits");var reExtension=/^.*\.(\w+)$/;var toBuffer=require("typedarray-to-buffer");function FileReadStream(file,opts){var readStream=this;if(!(this instanceof FileReadStream)){return new FileReadStream(file,opts);}opts=opts||{};Readable.call(this,opts);this._offset=0;this._ready=false;this._file=file;this._size=file.size;this._chunkSize=opts.chunkSize||Math.max(this._size/1e3,200*1024);this.reader=new FileReader();this._generateHeaderBlocks(file,opts,function(err,blocks){if(err){return readStream.emit("error",err);}if(Array.isArray(blocks)){blocks.forEach(function(block){readStream.push(block);});}readStream._ready=true;readStream.emit("_ready");});}inherits(FileReadStream,Readable);module.exports=FileReadStream;FileReadStream.prototype._generateHeaderBlocks=function(file,opts,callback){callback(null,[]);};FileReadStream.prototype._read=function(){if(!this._ready){this.once("_ready",this._read.bind(this));return;}var readStream=this;var reader=this.reader;var startOffset=this._offset;var endOffset=this._offset+this._chunkSize;if(endOffset>this._size)endOffset=this._size;if(startOffset===this._size){this.destroy();this.push(null);return;}reader.onload=function(){readStream._offset=endOffset;readStream.push(toBuffer(reader.result));};reader.onerror=function(){readStream.emit("error",reader.error);};reader.readAsArrayBuffer(this._file.slice(startOffset,endOffset));};FileReadStream.prototype.destroy=function(){this._file=null;if(this.reader){this.reader.onload=null;this.reader.onerror=null;try{this.reader.abort();}catch(e){}}this.reader=null;};},{inherits:94,"readable-stream":83,"typedarray-to-buffer":232}],86:[function(require,module,exports){module.exports=function flatten(list,depth){depth=typeof depth=="number"?depth:Infinity;if(!depth){if(Array.isArray(list)){return list.map(function(i){return i;});}return list;}return _flatten(list,1);function _flatten(list,d){return list.reduce(function(acc,item){if(Array.isArray(item)&&d<depth){return acc.concat(_flatten(item,d+1));}else{return acc.concat(item);}},[]);}};},{}],87:[function(require,module,exports){var isFunction=require("is-function");module.exports=forEach;var toString=Object.prototype.toString;var hasOwnProperty=Object.prototype.hasOwnProperty;function forEach(list,iterator,context){if(!isFunction(iterator)){throw new TypeError("iterator must be a function");}if(arguments.length<3){context=this;}if(toString.call(list)==="[object Array]")forEachArray(list,iterator,context);else if(typeof list==="string")forEachString(list,iterator,context);else forEachObject(list,iterator,context);}function forEachArray(array,iterator,context){for(var i=0,len=array.length;i<len;i++){if(hasOwnProperty.call(array,i)){iterator.call(context,array[i],i,array);}}}function forEachString(string,iterator,context){for(var i=0,len=string.length;i<len;i++){iterator.call(context,string.charAt(i),i,string);}}function forEachObject(object,iterator,context){for(var k in object){if(hasOwnProperty.call(object,k)){iterator.call(context,object[k],k,object);}}}},{"is-function":98}],88:[function(require,module,exports){module.exports=function getBrowserRTC(){if(typeof window==="undefined")return null;var wrtc={RTCPeerConnection:window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection,RTCSessionDescription:window.RTCSessionDescription||window.mozRTCSessionDescription||window.webkitRTCSessionDescription,RTCIceCandidate:window.RTCIceCandidate||window.mozRTCIceCandidate||window.webkitRTCIceCandidate};if(!wrtc.RTCPeerConnection)return null;return wrtc;};},{}],89:[function(require,module,exports){(function(global){var topLevel=typeof global!=="undefined"?global:typeof window!=="undefined"?window:{};var minDoc=require("min-document");if(typeof document!=="undefined"){module.exports=document;}else{var doccy=topLevel["__GLOBAL_DOCUMENT_CACHE@4"];if(!doccy){doccy=topLevel["__GLOBAL_DOCUMENT_CACHE@4"]=minDoc;}module.exports=doccy;}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{});},{"min-document":38}],90:[function(require,module,exports){(function(global){if(typeof window!=="undefined"){module.exports=window;}else if(typeof global!=="undefined"){module.exports=global;}else if(typeof self!=="undefined"){module.exports=self;}else{module.exports={};}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{});},{}],91:[function(require,module,exports){var http=require("http");var url=require("url");var https=module.exports;for(var key in http){if(http.hasOwnProperty(key))https[key]=http[key];}https.request=function(params,cb){params=validateParams(params);return http.request.call(this,params,cb);};https.get=function(params,cb){params=validateParams(params);return http.get.call(this,params,cb);};function validateParams(params){if(typeof params==="string"){params=url.parse(params);}if(!params.protocol){params.protocol="https:";}if(params.protocol!=="https:"){throw new Error('Protocol "'+params.protocol+'" not supported. Expected "https:"');}return params;}},{http:207,url:236}],92:[function(require,module,exports){exports.read=function(buffer,offset,isLE,mLen,nBytes){var e,m;var eLen=nBytes*8-mLen-1;var eMax=(1<<eLen)-1;var eBias=eMax>>1;var nBits=-7;var i=isLE?nBytes-1:0;var d=isLE?-1:1;var s=buffer[offset+i];i+=d;e=s&(1<<-nBits)-1;s>>=-nBits;nBits+=eLen;for(;nBits>0;e=e*256+buffer[offset+i],i+=d,nBits-=8){}m=e&(1<<-nBits)-1;e>>=-nBits;nBits+=mLen;for(;nBits>0;m=m*256+buffer[offset+i],i+=d,nBits-=8){}if(e===0){e=1-eBias;}else if(e===eMax){return m?NaN:(s?-1:1)*Infinity;}else{m=m+Math.pow(2,mLen);e=e-eBias;}return(s?-1:1)*m*Math.pow(2,e-mLen);};exports.write=function(buffer,value,offset,isLE,mLen,nBytes){var e,m,c;var eLen=nBytes*8-mLen-1;var eMax=(1<<eLen)-1;var eBias=eMax>>1;var rt=mLen===23?Math.pow(2,-24)-Math.pow(2,-77):0;var i=isLE?0:nBytes-1;var d=isLE?1:-1;var s=value<0||value===0&&1/value<0?1:0;value=Math.abs(value);if(isNaN(value)||value===Infinity){m=isNaN(value)?1:0;e=eMax;}else{e=Math.floor(Math.log(value)/Math.LN2);if(value*(c=Math.pow(2,-e))<1){e--;c*=2;}if(e+eBias>=1){value+=rt/c;}else{value+=rt*Math.pow(2,1-eBias);}if(value*c>=2){e++;c/=2;}if(e+eBias>=eMax){m=0;e=eMax;}else if(e+eBias>=1){m=(value*c-1)*Math.pow(2,mLen);e=e+eBias;}else{m=value*Math.pow(2,eBias-1)*Math.pow(2,mLen);e=0;}}for(;mLen>=8;buffer[offset+i]=m&255,i+=d,m/=256,mLen-=8){}e=e<<mLen|m;eLen+=mLen;for(;eLen>0;buffer[offset+i]=e&255,i+=d,e/=256,eLen-=8){}buffer[offset+i-d]|=s*128;};},{}],93:[function(require,module,exports){(function(process){module.exports=ImmediateStore;function ImmediateStore(store){if(!(this instanceof ImmediateStore))return new ImmediateStore(store);this.store=store;this.chunkLength=store.chunkLength;if(!this.store||!this.store.get||!this.store.put){throw new Error("First argument must be abstract-chunk-store compliant");}this.mem=[];}ImmediateStore.prototype.put=function(index,buf,cb){var self=this;self.mem[index]=buf;self.store.put(index,buf,function(err){self.mem[index]=null;if(cb)cb(err);});};ImmediateStore.prototype.get=function(index,opts,cb){if(typeof opts==="function")return this.get(index,null,opts);var start=opts&&opts.offset||0;var end=opts&&opts.length&&start+opts.length;var buf=this.mem[index];if(buf)return nextTick(cb,null,opts?buf.slice(start,end):buf);this.store.get(index,opts,cb);};ImmediateStore.prototype.close=function(cb){this.store.close(cb);};ImmediateStore.prototype.destroy=function(cb){this.store.destroy(cb);};function nextTick(cb,err,val){process.nextTick(function(){if(cb)cb(err,val);});}}).call(this,require("_process"));},{_process:40}],94:[function(require,module,exports){if(typeof Object.create==="function"){module.exports=function inherits(ctor,superCtor){ctor.super_=superCtor;ctor.prototype=Object.create(superCtor.prototype,{constructor:{value:ctor,enumerable:false,writable:true,configurable:true}});};}else{module.exports=function inherits(ctor,superCtor){ctor.super_=superCtor;var TempCtor=function TempCtor(){};TempCtor.prototype=superCtor.prototype;ctor.prototype=new TempCtor();ctor.prototype.constructor=ctor;};}},{}],95:[function(require,module,exports){var MAX_ASCII_CHAR_CODE=127;module.exports=function isAscii(str){for(var i=0,strLen=str.length;i<strLen;++i){if(str.charCodeAt(i)>MAX_ASCII_CHAR_CODE)return false;}return true;};},{}],96:[function(require,module,exports){module.exports=function(obj){return obj!=null&&(isBuffer(obj)||isSlowBuffer(obj)||!!obj._isBuffer);};function isBuffer(obj){return!!obj.constructor&&typeof obj.constructor.isBuffer==="function"&&obj.constructor.isBuffer(obj);}function isSlowBuffer(obj){return typeof obj.readFloatLE==="function"&&typeof obj.slice==="function"&&isBuffer(obj.slice(0,0));}},{}],97:[function(require,module,exports){"use strict";var fs=require("fs");module.exports=function isFile(path,cb){if(!cb)return isFileSync(path);fs.stat(path,function(err,stats){if(err)return cb(err);return cb(null,stats.isFile());});};module.exports.sync=isFileSync;function isFileSync(path){return fs.existsSync(path)&&fs.statSync(path).isFile();}},{fs:39}],98:[function(require,module,exports){module.exports=isFunction;var toString=Object.prototype.toString;function isFunction(fn){var string=toString.call(fn);return string==="[object Function]"||typeof fn==="function"&&string!=="[object RegExp]"||typeof window!=="undefined"&&(fn===window.setTimeout||fn===window.alert||fn===window.confirm||fn===window.prompt);}},{}],99:[function(require,module,exports){module.exports=isTypedArray;isTypedArray.strict=isStrictTypedArray;isTypedArray.loose=isLooseTypedArray;var toString=Object.prototype.toString;var names={"[object Int8Array]":true,"[object Int16Array]":true,"[object Int32Array]":true,"[object Uint8Array]":true,"[object Uint8ClampedArray]":true,"[object Uint16Array]":true,"[object Uint32Array]":true,"[object Float32Array]":true,"[object Float64Array]":true};function isTypedArray(arr){return isStrictTypedArray(arr)||isLooseTypedArray(arr);}function isStrictTypedArray(arr){return arr instanceof Int8Array||arr instanceof Int16Array||arr instanceof Int32Array||arr instanceof Uint8Array||arr instanceof Uint8ClampedArray||arr instanceof Uint16Array||arr instanceof Uint32Array||arr instanceof Float32Array||arr instanceof Float64Array;}function isLooseTypedArray(arr){return names[toString.call(arr)];}},{}],100:[function(require,module,exports){"use strict";exports.regex=exports.re=/^npm-debug\.log$|^\..*\.swp$|^\.DS_Store$|^\.AppleDouble$|^\.LSOverride$|^Icon\r$|^\._.*|^\.Spotlight-V100(?:$|\/)|\.Trashes|^__MACOSX$|~$|^Thumbs\.db$|^ehthumbs\.db$|^Desktop\.ini$|^@eaDir$/;exports.is=function(filename){return exports.re.test(filename);};exports.not=function(filename){return!exports.is(filename);};},{}],101:[function(require,module,exports){module.exports=magnetURIDecode;module.exports.decode=magnetURIDecode;module.exports.encode=magnetURIEncode;var base32=require("thirty-two");var Buffer=require("safe-buffer").Buffer;var extend=require("xtend");var uniq=require("uniq");function magnetURIDecode(uri){var result={};var data=uri.split("magnet:?")[1];var params=data&&data.length>=0?data.split("&"):[];params.forEach(function(param){var keyval=param.split("=");if(keyval.length!==2)return;var key=keyval[0];var val=keyval[1];if(key==="dn")val=decodeURIComponent(val).replace(/\+/g," ");if(key==="tr"||key==="xs"||key==="as"||key==="ws"){val=decodeURIComponent(val);}if(key==="kt")val=decodeURIComponent(val).split("+");if(key==="ix")val=Number(val);if(result[key]){if(Array.isArray(result[key])){result[key].push(val);}else{var old=result[key];result[key]=[old,val];}}else{result[key]=val;}});var m;if(result.xt){var xts=Array.isArray(result.xt)?result.xt:[result.xt];xts.forEach(function(xt){if(m=xt.match(/^urn:btih:(.{40})/)){result.infoHash=m[1].toLowerCase();}else if(m=xt.match(/^urn:btih:(.{32})/)){var decodedStr=base32.decode(m[1]);result.infoHash=Buffer.from(decodedStr,"binary").toString("hex");}});}if(result.infoHash)result.infoHashBuffer=Buffer.from(result.infoHash,"hex");if(result.dn)result.name=result.dn;if(result.kt)result.keywords=result.kt;if(typeof result.tr==="string")result.announce=[result.tr];else if(Array.isArray(result.tr))result.announce=result.tr;else result.announce=[];result.urlList=[];if(typeof result.as==="string"||Array.isArray(result.as)){result.urlList=result.urlList.concat(result.as);}if(typeof result.ws==="string"||Array.isArray(result.ws)){result.urlList=result.urlList.concat(result.ws);}uniq(result.announce);uniq(result.urlList);return result;}function magnetURIEncode(obj){obj=extend(obj);if(obj.infoHashBuffer)obj.xt="urn:btih:"+obj.infoHashBuffer.toString("hex");if(obj.infoHash)obj.xt="urn:btih:"+obj.infoHash;if(obj.name)obj.dn=obj.name;if(obj.keywords)obj.kt=obj.keywords;if(obj.announce)obj.tr=obj.announce;if(obj.urlList){obj.ws=obj.urlList;delete obj.as;}var result="magnet:?";Object.keys(obj).filter(function(key){return key.length===2;}).forEach(function(key,i){var values=Array.isArray(obj[key])?obj[key]:[obj[key]];values.forEach(function(val,j){if((i>0||j>0)&&(key!=="kt"||j===0))result+="&";if(key==="dn")val=encodeURIComponent(val).replace(/%20/g,"+");if(key==="tr"||key==="xs"||key==="as"||key==="ws"){val=encodeURIComponent(val);}if(key==="kt")val=encodeURIComponent(val);if(key==="kt"&&j>0)result+="+"+val;else result+=key+"="+val;});});return result;}},{"safe-buffer":177,"thirty-two":225,uniq:234,xtend:372}],102:[function(require,module,exports){module.exports=MediaElementWrapper;var inherits=require("inherits");var stream=require("readable-stream");var toArrayBuffer=require("to-arraybuffer");var MediaSource=typeof window!=="undefined"&&window.MediaSource;var DEFAULT_BUFFER_DURATION=60;function MediaElementWrapper(elem,opts){var self=this;if(!(self instanceof MediaElementWrapper))return new MediaElementWrapper(elem,opts);if(!MediaSource)throw new Error("web browser lacks MediaSource support");if(!opts)opts={};self._bufferDuration=opts.bufferDuration||DEFAULT_BUFFER_DURATION;self._elem=elem;self._mediaSource=new MediaSource();self._streams=[];self.detailedError=null;self._errorHandler=function(){self._elem.removeEventListener("error",self._errorHandler);var streams=self._streams.slice();streams.forEach(function(stream){stream.destroy(self._elem.error);});};self._elem.addEventListener("error",self._errorHandler);self._elem.src=window.URL.createObjectURL(self._mediaSource);}MediaElementWrapper.prototype.createWriteStream=function(obj){var self=this;return new MediaSourceStream(self,obj);};MediaElementWrapper.prototype.error=function(err){var self=this;if(!self.detailedError){self.detailedError=err;}try{self._mediaSource.endOfStream("decode");}catch(err){}};inherits(MediaSourceStream,stream.Writable);function MediaSourceStream(wrapper,obj){var self=this;stream.Writable.call(self);self._wrapper=wrapper;self._elem=wrapper._elem;self._mediaSource=wrapper._mediaSource;self._allStreams=wrapper._streams;self._allStreams.push(self);self._bufferDuration=wrapper._bufferDuration;self._sourceBuffer=null;self._openHandler=function(){self._onSourceOpen();};self._flowHandler=function(){self._flow();};if(typeof obj==="string"){self._type=obj;if(self._mediaSource.readyState==="open"){self._createSourceBuffer();}else{self._mediaSource.addEventListener("sourceopen",self._openHandler);}}else if(obj._sourceBuffer===null){obj.destroy();self._type=obj._type;self._mediaSource.addEventListener("sourceopen",self._openHandler);}else if(obj._sourceBuffer){obj.destroy();self._type=obj._type;self._sourceBuffer=obj._sourceBuffer;self._sourceBuffer.addEventListener("updateend",self._flowHandler);}else{throw new Error("The argument to MediaElementWrapper.createWriteStream must be a string or a previous stream returned from that function");}self._elem.addEventListener("timeupdate",self._flowHandler);self.on("error",function(err){self._wrapper.error(err);});self.on("finish",function(){if(self.destroyed)return;self._finished=true;if(self._allStreams.every(function(other){return other._finished;})){try{self._mediaSource.endOfStream();}catch(err){}}});}MediaSourceStream.prototype._onSourceOpen=function(){var self=this;if(self.destroyed)return;self._mediaSource.removeEventListener("sourceopen",self._openHandler);self._createSourceBuffer();};MediaSourceStream.prototype.destroy=function(err){var self=this;if(self.destroyed)return;self.destroyed=true;self._allStreams.splice(self._allStreams.indexOf(self),1);self._mediaSource.removeEventListener("sourceopen",self._openHandler);self._elem.removeEventListener("timeupdate",self._flowHandler);if(self._sourceBuffer){self._sourceBuffer.removeEventListener("updateend",self._flowHandler);if(self._mediaSource.readyState==="open"){self._sourceBuffer.abort();}}if(err)self.emit("error",err);self.emit("close");};MediaSourceStream.prototype._createSourceBuffer=function(){var self=this;if(self.destroyed)return;if(MediaSource.isTypeSupported(self._type)){self._sourceBuffer=self._mediaSource.addSourceBuffer(self._type);self._sourceBuffer.addEventListener("updateend",self._flowHandler);if(self._cb){var cb=self._cb;self._cb=null;cb();}}else{self.destroy(new Error("The provided type is not supported"));}};MediaSourceStream.prototype._write=function(chunk,encoding,cb){var self=this;if(self.destroyed)return;if(!self._sourceBuffer){self._cb=function(err){if(err)return cb(err);self._write(chunk,encoding,cb);};return;}if(self._sourceBuffer.updating){return cb(new Error("Cannot append buffer while source buffer updating"));}try{self._sourceBuffer.appendBuffer(toArrayBuffer(chunk));}catch(err){self.destroy(err);return;}self._cb=cb;};MediaSourceStream.prototype._flow=function(){var self=this;if(self.destroyed||!self._sourceBuffer||self._sourceBuffer.updating){return;}if(self._mediaSource.readyState==="open"){if(self._getBufferDuration()>self._bufferDuration){return;}}if(self._cb){var cb=self._cb;self._cb=null;cb();}};var EPSILON=0;MediaSourceStream.prototype._getBufferDuration=function(){var self=this;var buffered=self._sourceBuffer.buffered;var currentTime=self._elem.currentTime;var bufferEnd=-1;for(var i=0;i<buffered.length;i++){var start=buffered.start(i);var end=buffered.end(i)+EPSILON;if(start>currentTime){break;}else if(bufferEnd>=0||currentTime<=end){bufferEnd=end;}}var bufferedTime=bufferEnd-currentTime;if(bufferedTime<0){bufferedTime=0;}return bufferedTime;};},{inherits:94,"readable-stream":112,"to-arraybuffer":227}],103:[function(require,module,exports){arguments[4][10][0].apply(exports,arguments);},{dup:10}],104:[function(require,module,exports){arguments[4][11][0].apply(exports,arguments);},{"./_stream_readable":106,"./_stream_writable":108,"core-util-is":56,dup:11,inherits:94,"process-nextick-args":152}],105:[function(require,module,exports){arguments[4][12][0].apply(exports,arguments);},{"./_stream_transform":107,"core-util-is":56,dup:12,inherits:94}],106:[function(require,module,exports){arguments[4][13][0].apply(exports,arguments);},{"./_stream_duplex":104,"./internal/streams/BufferList":109,"./internal/streams/destroy":110,"./internal/streams/stream":111,_process:40,"core-util-is":56,dup:13,events:73,inherits:94,isarray:103,"process-nextick-args":152,"safe-buffer":177,"string_decoder/":113,util:38}],107:[function(require,module,exports){arguments[4][14][0].apply(exports,arguments);},{"./_stream_duplex":104,"core-util-is":56,dup:14,inherits:94}],108:[function(require,module,exports){arguments[4][15][0].apply(exports,arguments);},{"./_stream_duplex":104,"./internal/streams/destroy":110,"./internal/streams/stream":111,_process:40,"core-util-is":56,dup:15,inherits:94,"process-nextick-args":152,"safe-buffer":177,"util-deprecate":239}],109:[function(require,module,exports){arguments[4][16][0].apply(exports,arguments);},{dup:16,"safe-buffer":177}],110:[function(require,module,exports){arguments[4][17][0].apply(exports,arguments);},{dup:17,"process-nextick-args":152}],111:[function(require,module,exports){arguments[4][18][0].apply(exports,arguments);},{dup:18,events:73}],112:[function(require,module,exports){arguments[4][19][0].apply(exports,arguments);},{"./lib/_stream_duplex.js":104,"./lib/_stream_passthrough.js":105,"./lib/_stream_readable.js":106,"./lib/_stream_transform.js":107,"./lib/_stream_writable.js":108,dup:19}],113:[function(require,module,exports){arguments[4][20][0].apply(exports,arguments);},{dup:20,"safe-buffer":177}],114:[function(require,module,exports){(function(process){module.exports=Storage;function Storage(chunkLength,opts){if(!(this instanceof Storage))return new Storage(chunkLength,opts);if(!opts)opts={};this.chunkLength=Number(chunkLength);if(!this.chunkLength)throw new Error("First argument must be a chunk length");this.chunks=[];this.closed=false;this.length=Number(opts.length)||Infinity;if(this.length!==Infinity){this.lastChunkLength=this.length%this.chunkLength||this.chunkLength;this.lastChunkIndex=Math.ceil(this.length/this.chunkLength)-1;}}Storage.prototype.put=function(index,buf,cb){if(this.closed)return nextTick(cb,new Error("Storage is closed"));var isLastChunk=index===this.lastChunkIndex;if(isLastChunk&&buf.length!==this.lastChunkLength){return nextTick(cb,new Error("Last chunk length must be "+this.lastChunkLength));}if(!isLastChunk&&buf.length!==this.chunkLength){return nextTick(cb,new Error("Chunk length must be "+this.chunkLength));}this.chunks[index]=buf;nextTick(cb,null);};Storage.prototype.get=function(index,opts,cb){if(typeof opts==="function")return this.get(index,null,opts);if(this.closed)return nextTick(cb,new Error("Storage is closed"));var buf=this.chunks[index];if(!buf){var err=new Error("Chunk not found");err.notFound=true;return nextTick(cb,err);}if(!opts)return nextTick(cb,null,buf);var offset=opts.offset||0;var len=opts.length||buf.length-offset;nextTick(cb,null,buf.slice(offset,len+offset));};Storage.prototype.close=Storage.prototype.destroy=function(cb){if(this.closed)return nextTick(cb,new Error("Storage is closed"));this.closed=true;this.chunks=null;nextTick(cb,null);};function nextTick(cb,err,val){process.nextTick(function(){if(cb)cb(err,val);});}}).call(this,require("_process"));},{_process:40}],115:[function(require,module,exports){(function(Buffer){var Box=require("./index");var Descriptor=require("./descriptor");var TIME_OFFSET=20828448e5;exports.fullBoxes={};var fullBoxes=["mvhd","tkhd","mdhd","vmhd","smhd","stsd","esds","stsz","stco","stss","stts","ctts","stsc","dref","elst","hdlr","mehd","trex","mfhd","tfhd","tfdt","trun"];fullBoxes.forEach(function(type){exports.fullBoxes[type]=true;});exports.ftyp={};exports.ftyp.encode=function(box,buf,offset){buf=buf?buf.slice(offset):new Buffer(exports.ftyp.encodingLength(box));var brands=box.compatibleBrands||[];buf.write(box.brand,0,4,"ascii");buf.writeUInt32BE(box.brandVersion,4);for(var i=0;i<brands.length;i++){buf.write(brands[i],8+i*4,4,"ascii");}exports.ftyp.encode.bytes=8+brands.length*4;return buf;};exports.ftyp.decode=function(buf,offset){buf=buf.slice(offset);var brand=buf.toString("ascii",0,4);var version=buf.readUInt32BE(4);var compatibleBrands=[];for(var i=8;i<buf.length;i+=4){compatibleBrands.push(buf.toString("ascii",i,i+4));}return{brand:brand,brandVersion:version,compatibleBrands:compatibleBrands};};exports.ftyp.encodingLength=function(box){return 8+(box.compatibleBrands||[]).length*4;};exports.mvhd={};exports.mvhd.encode=function(box,buf,offset){buf=buf?buf.slice(offset):new Buffer(96);writeDate(box.ctime||new Date(),buf,0);writeDate(box.mtime||new Date(),buf,4);buf.writeUInt32BE(box.timeScale||0,8);buf.writeUInt32BE(box.duration||0,12);writeFixed32(box.preferredRate||0,buf,16);writeFixed16(box.preferredVolume||0,buf,20);writeReserved(buf,22,32);writeMatrix(box.matrix,buf,32);buf.writeUInt32BE(box.previewTime||0,68);buf.writeUInt32BE(box.previewDuration||0,72);buf.writeUInt32BE(box.posterTime||0,76);buf.writeUInt32BE(box.selectionTime||0,80);buf.writeUInt32BE(box.selectionDuration||0,84);buf.writeUInt32BE(box.currentTime||0,88);buf.writeUInt32BE(box.nextTrackId||0,92);exports.mvhd.encode.bytes=96;return buf;};exports.mvhd.decode=function(buf,offset){buf=buf.slice(offset);return{ctime:readDate(buf,0),mtime:readDate(buf,4),timeScale:buf.readUInt32BE(8),duration:buf.readUInt32BE(12),preferredRate:readFixed32(buf,16),preferredVolume:readFixed16(buf,20),matrix:readMatrix(buf.slice(32,68)),previewTime:buf.readUInt32BE(68),previewDuration:buf.readUInt32BE(72),posterTime:buf.readUInt32BE(76),selectionTime:buf.readUInt32BE(80),selectionDuration:buf.readUInt32BE(84),currentTime:buf.readUInt32BE(88),nextTrackId:buf.readUInt32BE(92)};};exports.mvhd.encodingLength=function(box){return 96;};exports.tkhd={};exports.tkhd.encode=function(box,buf,offset){buf=buf?buf.slice(offset):new Buffer(80);writeDate(box.ctime||new Date(),buf,0);writeDate(box.mtime||new Date(),buf,4);buf.writeUInt32BE(box.trackId||0,8);writeReserved(buf,12,16);buf.writeUInt32BE(box.duration||0,16);writeReserved(buf,20,28);buf.writeUInt16BE(box.layer||0,28);buf.writeUInt16BE(box.alternateGroup||0,30);buf.writeUInt16BE(box.volume||0,32);writeMatrix(box.matrix,buf,36);buf.writeUInt32BE(box.trackWidth||0,72);buf.writeUInt32BE(box.trackHeight||0,76);exports.tkhd.encode.bytes=80;return buf;};exports.tkhd.decode=function(buf,offset){buf=buf.slice(offset);return{ctime:readDate(buf,0),mtime:readDate(buf,4),trackId:buf.readUInt32BE(8),duration:buf.readUInt32BE(16),layer:buf.readUInt16BE(28),alternateGroup:buf.readUInt16BE(30),volume:buf.readUInt16BE(32),matrix:readMatrix(buf.slice(36,72)),trackWidth:buf.readUInt32BE(72),trackHeight:buf.readUInt32BE(76)};};exports.tkhd.encodingLength=function(box){return 80;};exports.mdhd={};exports.mdhd.encode=function(box,buf,offset){buf=buf?buf.slice(offset):new Buffer(20);writeDate(box.ctime||new Date(),buf,0);writeDate(box.mtime||new Date(),buf,4);buf.writeUInt32BE(box.timeScale||0,8);buf.writeUInt32BE(box.duration||0,12);buf.writeUInt16BE(box.language||0,16);buf.writeUInt16BE(box.quality||0,18);exports.mdhd.encode.bytes=20;return buf;};exports.mdhd.decode=function(buf,offset){buf=buf.slice(offset);return{ctime:readDate(buf,0),mtime:readDate(buf,4),timeScale:buf.readUInt32BE(8),duration:buf.readUInt32BE(12),language:buf.readUInt16BE(16),quality:buf.readUInt16BE(18)};};exports.mdhd.encodingLength=function(box){return 20;};exports.vmhd={};exports.vmhd.encode=function(box,buf,offset){buf=buf?buf.slice(offset):new Buffer(8);buf.writeUInt16BE(box.graphicsMode||0,0);var opcolor=box.opcolor||[0,0,0];buf.writeUInt16BE(opcolor[0],2);buf.writeUInt16BE(opcolor[1],4);buf.writeUInt16BE(opcolor[2],6);exports.vmhd.encode.bytes=8;return buf;};exports.vmhd.decode=function(buf,offset){buf=buf.slice(offset);return{graphicsMode:buf.readUInt16BE(0),opcolor:[buf.readUInt16BE(2),buf.readUInt16BE(4),buf.readUInt16BE(6)]};};exports.vmhd.encodingLength=function(box){return 8;};exports.smhd={};exports.smhd.encode=function(box,buf,offset){buf=buf?buf.slice(offset):new Buffer(4);buf.writeUInt16BE(box.balance||0,0);writeReserved(buf,2,4);exports.smhd.encode.bytes=4;return buf;};exports.smhd.decode=function(buf,offset){buf=buf.slice(offset);return{balance:buf.readUInt16BE(0)};};exports.smhd.encodingLength=function(box){return 4;};exports.stsd={};exports.stsd.encode=function(box,buf,offset){buf=buf?buf.slice(offset):new Buffer(exports.stsd.encodingLength(box));var entries=box.entries||[];buf.writeUInt32BE(entries.length,0);var ptr=4;for(var i=0;i<entries.length;i++){var entry=entries[i];Box.encode(entry,buf,ptr);ptr+=Box.encode.bytes;}exports.stsd.encode.bytes=ptr;return buf;};exports.stsd.decode=function(buf,offset,end){buf=buf.slice(offset);var num=buf.readUInt32BE(0);var entries=new Array(num);var ptr=4;for(var i=0;i<num;i++){var entry=Box.decode(buf,ptr,end);entries[i]=entry;ptr+=entry.length;}return{entries:entries};};exports.stsd.encodingLength=function(box){var totalSize=4;if(!box.entries)return totalSize;for(var i=0;i<box.entries.length;i++){totalSize+=Box.encodingLength(box.entries[i]);}return totalSize;};exports.avc1=exports.VisualSampleEntry={};exports.VisualSampleEntry.encode=function(box,buf,offset){buf=buf?buf.slice(offset):new Buffer(exports.VisualSampleEntry.encodingLength(box));writeReserved(buf,0,6);buf.writeUInt16BE(box.dataReferenceIndex||0,6);writeReserved(buf,8,24);buf.writeUInt16BE(box.width||0,24);buf.writeUInt16BE(box.height||0,26);buf.writeUInt32BE(box.hResolution||4718592,28);buf.writeUInt32BE(box.vResolution||4718592,32);writeReserved(buf,36,40);buf.writeUInt16BE(box.frameCount||1,40);var compressorName=box.compressorName||"";var nameLen=Math.min(compressorName.length,31);buf.writeUInt8(nameLen,42);buf.write(compressorName,43,nameLen,"utf8");buf.writeUInt16BE(box.depth||24,74);buf.writeInt16BE(-1,76);var ptr=78;var children=box.children||[];children.forEach(function(child){Box.encode(child,buf,ptr);ptr+=Box.encode.bytes;});exports.VisualSampleEntry.encode.bytes=ptr;};exports.VisualSampleEntry.decode=function(buf,offset,end){buf=buf.slice(offset);var length=end-offset;var nameLen=Math.min(buf.readUInt8(42),31);var box={dataReferenceIndex:buf.readUInt16BE(6),width:buf.readUInt16BE(24),height:buf.readUInt16BE(26),hResolution:buf.readUInt32BE(28),vResolution:buf.readUInt32BE(32),frameCount:buf.readUInt16BE(40),compressorName:buf.toString("utf8",43,43+nameLen),depth:buf.readUInt16BE(74),children:[]};var ptr=78;while(length-ptr>=8){var child=Box.decode(buf,ptr,length);box.children.push(child);box[child.type]=child;ptr+=child.length;}return box;};exports.VisualSampleEntry.encodingLength=function(box){var len=78;var children=box.children||[];children.forEach(function(child){len+=Box.encodingLength(child);});return len;};exports.avcC={};exports.avcC.encode=function(box,buf,offset){buf=buf?buf.slice(offset):Buffer(box.buffer.length);box.buffer.copy(buf);exports.avcC.encode.bytes=box.buffer.length;};exports.avcC.decode=function(buf,offset,end){buf=buf.slice(offset,end);return{mimeCodec:buf.toString("hex",1,4),buffer:new Buffer(buf)};};exports.avcC.encodingLength=function(box){return box.buffer.length;};exports.mp4a=exports.AudioSampleEntry={};exports.AudioSampleEntry.encode=function(box,buf,offset){buf=buf?buf.slice(offset):new Buffer(exports.AudioSampleEntry.encodingLength(box));writeReserved(buf,0,6);buf.writeUInt16BE(box.dataReferenceIndex||0,6);writeReserved(buf,8,16);buf.writeUInt16BE(box.channelCount||2,16);buf.writeUInt16BE(box.sampleSize||16,18);writeReserved(buf,20,24);buf.writeUInt32BE(box.sampleRate||0,24);var ptr=28;var children=box.children||[];children.forEach(function(child){Box.encode(child,buf,ptr);ptr+=Box.encode.bytes;});exports.AudioSampleEntry.encode.bytes=ptr;};exports.AudioSampleEntry.decode=function(buf,offset,end){buf=buf.slice(offset,end);var length=end-offset;var box={dataReferenceIndex:buf.readUInt16BE(6),channelCount:buf.readUInt16BE(16),sampleSize:buf.readUInt16BE(18),sampleRate:buf.readUInt32BE(24),children:[]};var ptr=28;while(length-ptr>=8){var child=Box.decode(buf,ptr,length);box.children.push(child);box[child.type]=child;ptr+=child.length;}return box;};exports.AudioSampleEntry.encodingLength=function(box){var len=28;var children=box.children||[];children.forEach(function(child){len+=Box.encodingLength(child);});return len;};exports.esds={};exports.esds.encode=function(box,buf,offset){buf=buf?buf.slice(offset):Buffer(box.buffer.length);box.buffer.copy(buf,0);exports.esds.encode.bytes=box.buffer.length;};exports.esds.decode=function(buf,offset,end){buf=buf.slice(offset,end);var desc=Descriptor.Descriptor.decode(buf,0,buf.length);var esd=desc.tagName==="ESDescriptor"?desc:{};var dcd=esd.DecoderConfigDescriptor||{};var oti=dcd.oti||0;var dsi=dcd.DecoderSpecificInfo;var audioConfig=dsi?(dsi.buffer.readUInt8(0)&248)>>3:0;var mimeCodec=null;if(oti){mimeCodec=oti.toString(16);if(audioConfig){mimeCodec+="."+audioConfig;}}return{mimeCodec:mimeCodec,buffer:new Buffer(buf.slice(0))};};exports.esds.encodingLength=function(box){return box.buffer.length;};exports.stsz={};exports.stsz.encode=function(box,buf,offset){var entries=box.entries||[];buf=buf?buf.slice(offset):Buffer(exports.stsz.encodingLength(box));buf.writeUInt32BE(0,0);buf.writeUInt32BE(entries.length,4);for(var i=0;i<entries.length;i++){buf.writeUInt32BE(entries[i],i*4+8);}exports.stsz.encode.bytes=8+entries.length*4;return buf;};exports.stsz.decode=function(buf,offset){buf=buf.slice(offset);var size=buf.readUInt32BE(0);var num=buf.readUInt32BE(4);var entries=new Array(num);for(var i=0;i<num;i++){if(size===0){entries[i]=buf.readUInt32BE(i*4+8);}else{entries[i]=size;}}return{entries:entries};};exports.stsz.encodingLength=function(box){return 8+box.entries.length*4;};exports.stss=exports.stco={};exports.stco.encode=function(box,buf,offset){var entries=box.entries||[];buf=buf?buf.slice(offset):new Buffer(exports.stco.encodingLength(box));buf.writeUInt32BE(entries.length,0);for(var i=0;i<entries.length;i++){buf.writeUInt32BE(entries[i],i*4+4);}exports.stco.encode.bytes=4+entries.length*4;return buf;};exports.stco.decode=function(buf,offset){buf=buf.slice(offset);var num=buf.readUInt32BE(0);var entries=new Array(num);for(var i=0;i<num;i++){entries[i]=buf.readUInt32BE(i*4+4);}return{entries:entries};};exports.stco.encodingLength=function(box){return 4+box.entries.length*4;};exports.stts={};exports.stts.encode=function(box,buf,offset){var entries=box.entries||[];buf=buf?buf.slice(offset):new Buffer(exports.stts.encodingLength(box));buf.writeUInt32BE(entries.length,0);for(var i=0;i<entries.length;i++){var ptr=i*8+4;buf.writeUInt32BE(entries[i].count||0,ptr);buf.writeUInt32BE(entries[i].duration||0,ptr+4);}exports.stts.encode.bytes=4+box.entries.length*8;return buf;};exports.stts.decode=function(buf,offset){buf=buf.slice(offset);var num=buf.readUInt32BE(0);var entries=new Array(num);for(var i=0;i<num;i++){var ptr=i*8+4;entries[i]={count:buf.readUInt32BE(ptr),duration:buf.readUInt32BE(ptr+4)};}return{entries:entries};};exports.stts.encodingLength=function(box){return 4+box.entries.length*8;};exports.ctts={};exports.ctts.encode=function(box,buf,offset){var entries=box.entries||[];buf=buf?buf.slice(offset):new Buffer(exports.ctts.encodingLength(box));buf.writeUInt32BE(entries.length,0);for(var i=0;i<entries.length;i++){var ptr=i*8+4;buf.writeUInt32BE(entries[i].count||0,ptr);buf.writeUInt32BE(entries[i].compositionOffset||0,ptr+4);}exports.ctts.encode.bytes=4+entries.length*8;return buf;};exports.ctts.decode=function(buf,offset){buf=buf.slice(offset);var num=buf.readUInt32BE(0);var entries=new Array(num);for(var i=0;i<num;i++){var ptr=i*8+4;entries[i]={count:buf.readUInt32BE(ptr),compositionOffset:buf.readInt32BE(ptr+4)};}return{entries:entries};};exports.ctts.encodingLength=function(box){return 4+box.entries.length*8;};exports.stsc={};exports.stsc.encode=function(box,buf,offset){var entries=box.entries||[];buf=buf?buf.slice(offset):new Buffer(exports.stsc.encodingLength(box));buf.writeUInt32BE(entries.length,0);for(var i=0;i<entries.length;i++){var ptr=i*12+4;buf.writeUInt32BE(entries[i].firstChunk||0,ptr);buf.writeUInt32BE(entries[i].samplesPerChunk||0,ptr+4);buf.writeUInt32BE(entries[i].sampleDescriptionId||0,ptr+8);}exports.stsc.encode.bytes=4+entries.length*12;return buf;};exports.stsc.decode=function(buf,offset){buf=buf.slice(offset);var num=buf.readUInt32BE(0);var entries=new Array(num);for(var i=0;i<num;i++){var ptr=i*12+4;entries[i]={firstChunk:buf.readUInt32BE(ptr),samplesPerChunk:buf.readUInt32BE(ptr+4),sampleDescriptionId:buf.readUInt32BE(ptr+8)};}return{entries:entries};};exports.stsc.encodingLength=function(box){return 4+box.entries.length*12;};exports.dref={};exports.dref.encode=function(box,buf,offset){buf=buf?buf.slice(offset):new Buffer(exports.dref.encodingLength(box));var entries=box.entries||[];buf.writeUInt32BE(entries.length,0);var ptr=4;for(var i=0;i<entries.length;i++){var entry=entries[i];var size=(entry.buf?entry.buf.length:0)+4+4;buf.writeUInt32BE(size,ptr);ptr+=4;buf.write(entry.type,ptr,4,"ascii");ptr+=4;if(entry.buf){entry.buf.copy(buf,ptr);ptr+=entry.buf.length;}}exports.dref.encode.bytes=ptr;return buf;};exports.dref.decode=function(buf,offset){buf=buf.slice(offset);var num=buf.readUInt32BE(0);var entries=new Array(num);var ptr=4;for(var i=0;i<num;i++){var size=buf.readUInt32BE(ptr);var type=buf.toString("ascii",ptr+4,ptr+8);var tmp=buf.slice(ptr+8,ptr+size);ptr+=size;entries[i]={type:type,buf:tmp};}return{entries:entries};};exports.dref.encodingLength=function(box){var totalSize=4;if(!box.entries)return totalSize;for(var i=0;i<box.entries.length;i++){var buf=box.entries[i].buf;totalSize+=(buf?buf.length:0)+4+4;}return totalSize;};exports.elst={};exports.elst.encode=function(box,buf,offset){var entries=box.entries||[];buf=buf?buf.slice(offset):new Buffer(exports.elst.encodingLength(box));buf.writeUInt32BE(entries.length,0);for(var i=0;i<entries.length;i++){var ptr=i*12+4;buf.writeUInt32BE(entries[i].trackDuration||0,ptr);buf.writeUInt32BE(entries[i].mediaTime||0,ptr+4);writeFixed32(entries[i].mediaRate||0,buf,ptr+8);}exports.elst.encode.bytes=4+entries.length*12;return buf;};exports.elst.decode=function(buf,offset){buf=buf.slice(offset);var num=buf.readUInt32BE(0);var entries=new Array(num);for(var i=0;i<num;i++){var ptr=i*12+4;entries[i]={trackDuration:buf.readUInt32BE(ptr),mediaTime:buf.readInt32BE(ptr+4),mediaRate:readFixed32(buf,ptr+8)};}return{entries:entries};};exports.elst.encodingLength=function(box){return 4+box.entries.length*12;};exports.hdlr={};exports.hdlr.encode=function(box,buf,offset){buf=buf?buf.slice(offset):new Buffer(exports.hdlr.encodingLength(box));var len=21+(box.name||"").length;buf.fill(0,0,len);buf.write(box.handlerType||"",4,4,"ascii");writeString(box.name||"",buf,20);exports.hdlr.encode.bytes=len;return buf;};exports.hdlr.decode=function(buf,offset,end){buf=buf.slice(offset);return{handlerType:buf.toString("ascii",4,8),name:readString(buf,20,end)};};exports.hdlr.encodingLength=function(box){return 21+(box.name||"").length;};exports.mehd={};exports.mehd.encode=function(box,buf,offset){buf=buf?buf.slice(offset):new Buffer(4);buf.writeUInt32BE(box.fragmentDuration||0,0);exports.mehd.encode.bytes=4;return buf;};exports.mehd.decode=function(buf,offset){buf=buf.slice(offset);return{fragmentDuration:buf.readUInt32BE(0)};};exports.mehd.encodingLength=function(box){return 4;};exports.trex={};exports.trex.encode=function(box,buf,offset){buf=buf?buf.slice(offset):new Buffer(20);buf.writeUInt32BE(box.trackId||0,0);buf.writeUInt32BE(box.defaultSampleDescriptionIndex||0,4);buf.writeUInt32BE(box.defaultSampleDuration||0,8);buf.writeUInt32BE(box.defaultSampleSize||0,12);buf.writeUInt32BE(box.defaultSampleFlags||0,16);exports.trex.encode.bytes=20;return buf;};exports.trex.decode=function(buf,offset){buf=buf.slice(offset);return{trackId:buf.readUInt32BE(0),defaultSampleDescriptionIndex:buf.readUInt32BE(4),defaultSampleDuration:buf.readUInt32BE(8),defaultSampleSize:buf.readUInt32BE(12),defaultSampleFlags:buf.readUInt32BE(16)};};exports.trex.encodingLength=function(box){return 20;};exports.mfhd={};exports.mfhd.encode=function(box,buf,offset){buf=buf?buf.slice(offset):new Buffer(4);buf.writeUInt32BE(box.sequenceNumber||0,0);exports.mfhd.encode.bytes=4;return buf;};exports.mfhd.decode=function(buf,offset){return{sequenceNumber:buf.readUint32BE(0)};};exports.mfhd.encodingLength=function(box){return 4;};exports.tfhd={};exports.tfhd.encode=function(box,buf,offset){buf=buf?buf.slice(offset):new Buffer(4);buf.writeUInt32BE(box.trackId,0);exports.tfhd.encode.bytes=4;return buf;};exports.tfhd.decode=function(buf,offset){};exports.tfhd.encodingLength=function(box){return 4;};exports.tfdt={};exports.tfdt.encode=function(box,buf,offset){buf=buf?buf.slice(offset):new Buffer(4);buf.writeUInt32BE(box.baseMediaDecodeTime||0,0);exports.tfdt.encode.bytes=4;return buf;};exports.tfdt.decode=function(buf,offset){};exports.tfdt.encodingLength=function(box){return 4;};exports.trun={};exports.trun.encode=function(box,buf,offset){buf=buf?buf.slice(offset):new Buffer(8+box.entries.length*16);buf.writeUInt32BE(box.entries.length,0);buf.writeInt32BE(box.dataOffset,4);var ptr=8;for(var i=0;i<box.entries.length;i++){var entry=box.entries[i];buf.writeUInt32BE(entry.sampleDuration,ptr);ptr+=4;buf.writeUInt32BE(entry.sampleSize,ptr);ptr+=4;buf.writeUInt32BE(entry.sampleFlags,ptr);ptr+=4;buf.writeUInt32BE(entry.sampleCompositionTimeOffset,ptr);ptr+=4;}exports.trun.encode.bytes=ptr;};exports.trun.decode=function(buf,offset){};exports.trun.encodingLength=function(box){return 8+box.entries.length*16;};exports.mdat={};exports.mdat.encode=function(box,buf,offset){if(box.buffer){box.buffer.copy(buf,offset);exports.mdat.encode.bytes=box.buffer.length;}else{exports.mdat.encode.bytes=exports.mdat.encodingLength(box);}};exports.mdat.decode=function(buf,start,end){return{buffer:new Buffer(buf.slice(start,end))};};exports.mdat.encodingLength=function(box){return box.buffer?box.buffer.length:box.contentLength;};function writeReserved(buf,offset,end){for(var i=offset;i<end;i++){buf[i]=0;}}function writeDate(date,buf,offset){buf.writeUInt32BE(Math.floor((date.getTime()+TIME_OFFSET)/1e3),offset);}function writeFixed32(num,buf,offset){buf.writeUInt16BE(Math.floor(num)%(256*256),offset);buf.writeUInt16BE(Math.floor(num*256*256)%(256*256),offset+2);}function writeFixed16(num,buf,offset){buf[offset]=Math.floor(num)%256;buf[offset+1]=Math.floor(num*256)%256;}function writeMatrix(list,buf,offset){if(!list)list=[0,0,0,0,0,0,0,0,0];for(var i=0;i<list.length;i++){writeFixed32(list[i],buf,offset+i*4);}}function writeString(str,buf,offset){var strBuffer=new Buffer(str,"utf8");strBuffer.copy(buf,offset);buf[offset+strBuffer.length]=0;}function readMatrix(buf){var list=new Array(buf.length/4);for(var i=0;i<list.length;i++){list[i]=readFixed32(buf,i*4);}return list;}function readDate(buf,offset){return new Date(buf.readUInt32BE(offset)*1e3-TIME_OFFSET);}function readFixed32(buf,offset){return buf.readUInt16BE(offset)+buf.readUInt16BE(offset+2)/(256*256);}function readFixed16(buf,offset){return buf[offset]+buf[offset+1]/256;}function readString(buf,offset,length){var i;for(i=0;i<length;i++){if(buf[offset+i]===0){break;}}return buf.toString("utf8",offset,offset+i);}}).call(this,require("buffer").Buffer);},{"./descriptor":116,"./index":117,buffer:41}],116:[function(require,module,exports){(function(Buffer){var tagToName={3:"ESDescriptor",4:"DecoderConfigDescriptor",5:"DecoderSpecificInfo",6:"SLConfigDescriptor"};exports.Descriptor={};exports.Descriptor.decode=function(buf,start,end){var tag=buf.readUInt8(start);var ptr=start+1;var lenByte;var len=0;do{lenByte=buf.readUInt8(ptr++);len=len<<7|lenByte&127;}while(lenByte&128);var obj;var tagName=tagToName[tag];if(exports[tagName]){obj=exports[tagName].decode(buf,ptr,end);}else{obj={buffer:new Buffer(buf.slice(ptr,ptr+len))};}obj.tag=tag;obj.tagName=tagName;obj.length=ptr-start+len;obj.contentsLen=len;return obj;};exports.DescriptorArray={};exports.DescriptorArray.decode=function(buf,start,end){var ptr=start;var obj={};while(ptr+2<=end){var descriptor=exports.Descriptor.decode(buf,ptr,end);ptr+=descriptor.length;var tagName=tagToName[descriptor.tag]||"Descriptor"+descriptor.tag;obj[tagName]=descriptor;}return obj;};exports.ESDescriptor={};exports.ESDescriptor.decode=function(buf,start,end){var flags=buf.readUInt8(start+2);var ptr=start+3;if(flags&128){ptr+=2;}if(flags&64){var len=buf.readUInt8(ptr);ptr+=len+1;}if(flags&32){ptr+=2;}return exports.DescriptorArray.decode(buf,ptr,end);};exports.DecoderConfigDescriptor={};exports.DecoderConfigDescriptor.decode=function(buf,start,end){var oti=buf.readUInt8(start);var obj=exports.DescriptorArray.decode(buf,start+13,end);obj.oti=oti;return obj;};}).call(this,require("buffer").Buffer);},{buffer:41}],117:[function(require,module,exports){(function(Buffer){var uint64be=require("uint64be");var boxes=require("./boxes");var UINT32_MAX=4294967295;var Box=exports;var containers=exports.containers={moov:["mvhd","meta","traks","mvex"],trak:["tkhd","tref","trgr","edts","meta","mdia","udta"],edts:["elst"],mdia:["mdhd","hdlr","elng","minf"],minf:["vmhd","smhd","hmhd","sthd","nmhd","dinf","stbl"],dinf:["dref"],stbl:["stsd","stts","ctts","cslg","stsc","stsz","stz2","stco","co64","stss","stsh","padb","stdp","sdtp","sbgps","sgpds","subss","saizs","saios"],mvex:["mehd","trexs","leva"],moof:["mfhd","meta","trafs"],traf:["tfhd","trun","sbgps","sgpds","subss","saizs","saios","tfdt","meta"]};Box.encode=function(obj,buffer,offset){Box.encodingLength(obj);offset=offset||0;buffer=buffer||new Buffer(obj.length);return Box._encode(obj,buffer,offset);};Box._encode=function(obj,buffer,offset){var type=obj.type;var len=obj.length;if(len>UINT32_MAX){len=1;}buffer.writeUInt32BE(len,offset);buffer.write(obj.type,offset+4,4,"ascii");var ptr=offset+8;if(len===1){uint64be.encode(obj.length,buffer,ptr);ptr+=8;}if(boxes.fullBoxes[type]){buffer.writeUInt32BE(obj.flags||0,ptr);buffer.writeUInt8(obj.version||0,ptr);ptr+=4;}if(containers[type]){var contents=containers[type];contents.forEach(function(childType){if(childType.length===5){var entry=obj[childType]||[];childType=childType.substr(0,4);entry.forEach(function(child){Box._encode(child,buffer,ptr);ptr+=Box.encode.bytes;});}else if(obj[childType]){Box._encode(obj[childType],buffer,ptr);ptr+=Box.encode.bytes;}});if(obj.otherBoxes){obj.otherBoxes.forEach(function(child){Box._encode(child,buffer,ptr);ptr+=Box.encode.bytes;});}}else if(boxes[type]){var encode=boxes[type].encode;encode(obj,buffer,ptr);ptr+=encode.bytes;}else if(obj.buffer){var buf=obj.buffer;buf.copy(buffer,ptr);ptr+=obj.buffer.length;}else{throw new Error("Either `type` must be set to a known type (not'"+type+"') or `buffer` must be set");}Box.encode.bytes=ptr-offset;return buffer;};Box.readHeaders=function(buffer,start,end){start=start||0;end=end||buffer.length;if(end-start<8){return 8;}var len=buffer.readUInt32BE(start);var type=buffer.toString("ascii",start+4,start+8);var ptr=start+8;if(len===1){if(end-start<16){return 16;}len=uint64be.decode(buffer,ptr);ptr+=8;}var version;var flags;if(boxes.fullBoxes[type]){version=buffer.readUInt8(ptr);flags=buffer.readUInt32BE(ptr)&16777215;ptr+=4;}return{length:len,headersLen:ptr-start,contentLen:len-(ptr-start),type:type,version:version,flags:flags};};Box.decode=function(buffer,start,end){start=start||0;end=end||buffer.length;var headers=Box.readHeaders(buffer,start,end);if(!headers||headers.length>end-start){throw new Error("Data too short");}return Box.decodeWithoutHeaders(headers,buffer,start+headers.headersLen,start+headers.length);};Box.decodeWithoutHeaders=function(headers,buffer,start,end){start=start||0;end=end||buffer.length;var type=headers.type;var obj={};if(containers[type]){obj.otherBoxes=[];var contents=containers[type];var ptr=start;while(end-ptr>=8){var child=Box.decode(buffer,ptr,end);ptr+=child.length;if(contents.indexOf(child.type)>=0){obj[child.type]=child;}else if(contents.indexOf(child.type+"s")>=0){var childType=child.type+"s";var entry=obj[childType]=obj[childType]||[];entry.push(child);}else{obj.otherBoxes.push(child);}}}else if(boxes[type]){var decode=boxes[type].decode;obj=decode(buffer,start,end);}else{obj.buffer=new Buffer(buffer.slice(start,end));}obj.length=headers.length;obj.contentLen=headers.contentLen;obj.type=headers.type;obj.version=headers.version;obj.flags=headers.flags;return obj;};Box.encodingLength=function(obj){var type=obj.type;var len=8;if(boxes.fullBoxes[type]){len+=4;}if(containers[type]){var contents=containers[type];contents.forEach(function(childType){if(childType.length===5){var entry=obj[childType]||[];childType=childType.substr(0,4);entry.forEach(function(child){child.type=childType;len+=Box.encodingLength(child);});}else if(obj[childType]){var child=obj[childType];child.type=childType;len+=Box.encodingLength(child);}});if(obj.otherBoxes){obj.otherBoxes.forEach(function(child){len+=Box.encodingLength(child);});}}else if(boxes[type]){len+=boxes[type].encodingLength(obj);}else if(obj.buffer){len+=obj.buffer.length;}else{throw new Error("Either `type` must be set to a known type (not'"+type+"') or `buffer` must be set");}if(len>UINT32_MAX){len+=8;}obj.length=len;return len;};}).call(this,require("buffer").Buffer);},{"./boxes":115,buffer:41,uint64be:233}],118:[function(require,module,exports){(function(Buffer){var stream=require("readable-stream");var inherits=require("inherits");var nextEvent=require("next-event");var Box=require("mp4-box-encoding");var EMPTY=new Buffer(0);module.exports=Decoder;function Decoder(){if(!(this instanceof Decoder))return new Decoder();stream.Writable.call(this);this.destroyed=false;this._pending=0;this._missing=0;this._buf=null;this._str=null;this._cb=null;this._ondrain=null;this._writeBuffer=null;this._writeCb=null;this._ondrain=null;this._kick();}inherits(Decoder,stream.Writable);Decoder.prototype.destroy=function(err){if(this.destroyed)return;this.destroyed=true;if(err)this.emit("error",err);this.emit("close");};Decoder.prototype._write=function(data,enc,next){if(this.destroyed)return;var drained=!this._str||!this._str._writableState.needDrain;while(data.length&&!this.destroyed){if(!this._missing){this._writeBuffer=data;this._writeCb=next;return;}var consumed=data.length<this._missing?data.length:this._missing;if(this._buf)data.copy(this._buf,this._buf.length-this._missing);else if(this._str)drained=this._str.write(consumed===data.length?data:data.slice(0,consumed));this._missing-=consumed;if(!this._missing){var buf=this._buf;var cb=this._cb;var stream=this._str;this._buf=this._cb=this._str=this._ondrain=null;drained=true;if(stream)stream.end();if(cb)cb(buf);}data=consumed===data.length?EMPTY:data.slice(consumed);}if(this._pending&&!this._missing){this._writeBuffer=data;this._writeCb=next;return;}if(drained)next();else this._ondrain(next);};Decoder.prototype._buffer=function(size,cb){this._missing=size;this._buf=new Buffer(size);this._cb=cb;};Decoder.prototype._stream=function(size,cb){var self=this;this._missing=size;this._str=new MediaData(this);this._ondrain=nextEvent(this._str,"drain");this._pending++;this._str.on("end",function(){self._pending--;self._kick();});this._cb=cb;return this._str;};Decoder.prototype._readBox=function(){var self=this;bufferHeaders(8);function bufferHeaders(len,buf){self._buffer(len,function(additionalBuf){if(buf){buf=Buffer.concat([buf,additionalBuf]);}else{buf=additionalBuf;}var headers=Box.readHeaders(buf);if(typeof headers==="number"){bufferHeaders(headers-buf.length,buf);}else{self._pending++;self._headers=headers;self.emit("box",headers);}});}};Decoder.prototype.stream=function(){var self=this;if(!self._headers)throw new Error("this function can only be called once after 'box' is emitted");var headers=self._headers;self._headers=null;return self._stream(headers.contentLen,null);};Decoder.prototype.decode=function(cb){var self=this;if(!self._headers)throw new Error("this function can only be called once after 'box' is emitted");var headers=self._headers;self._headers=null;self._buffer(headers.contentLen,function(buf){var box=Box.decodeWithoutHeaders(headers,buf);cb(box);self._pending--;self._kick();});};Decoder.prototype.ignore=function(){var self=this;if(!self._headers)throw new Error("this function can only be called once after 'box' is emitted");var headers=self._headers;self._headers=null;this._missing=headers.contentLen;this._cb=function(){self._pending--;self._kick();};};Decoder.prototype._kick=function(){if(this._pending)return;if(!this._buf&&!this._str)this._readBox();if(this._writeBuffer){var next=this._writeCb;var buffer=this._writeBuffer;this._writeBuffer=null;this._writeCb=null;this._write(buffer,null,next);}};function MediaData(parent){this._parent=parent;this.destroyed=false;stream.PassThrough.call(this);}inherits(MediaData,stream.PassThrough);MediaData.prototype.destroy=function(err){if(this.destroyed)return;this.destroyed=true;this._parent.destroy(err);if(err)this.emit("error",err);this.emit("close");};}).call(this,require("buffer").Buffer);},{buffer:41,inherits:94,"mp4-box-encoding":117,"next-event":145,"readable-stream":130}],119:[function(require,module,exports){(function(process,Buffer){var stream=require("readable-stream");var inherits=require("inherits");var Box=require("mp4-box-encoding");module.exports=Encoder;function noop(){}function Encoder(){if(!(this instanceof Encoder))return new Encoder();stream.Readable.call(this);this.destroyed=false;this._reading=false;this._stream=null;this._drain=null;this._want=false;this._onreadable=onreadable;this._onend=onend;var self=this;function onreadable(){if(!self._want)return;self._want=false;self._read();}function onend(){self._stream=null;}}inherits(Encoder,stream.Readable);Encoder.prototype.mediaData=Encoder.prototype.mdat=function(size,cb){var stream=new MediaData(this);this.box({type:"mdat",contentLength:size,encodeBufferLen:8,stream:stream},cb);return stream;};Encoder.prototype.box=function(box,cb){if(!cb)cb=noop;if(this.destroyed)return cb(new Error("Encoder is destroyed"));var buf;if(box.encodeBufferLen){buf=new Buffer(box.encodeBufferLen);}if(box.stream){box.buffer=null;buf=Box.encode(box,buf);this.push(buf);this._stream=box.stream;this._stream.on("readable",this._onreadable);this._stream.on("end",this._onend);this._stream.on("end",cb);this._forward();}else{buf=Box.encode(box,buf);var drained=this.push(buf);if(drained)return process.nextTick(cb);this._drain=cb;}};Encoder.prototype.destroy=function(err){if(this.destroyed)return;this.destroyed=true;if(this._stream&&this._stream.destroy)this._stream.destroy();this._stream=null;if(this._drain){var cb=this._drain;this._drain=null;cb(err);}if(err)this.emit("error",err);this.emit("close");};Encoder.prototype.finalize=function(){this.push(null);};Encoder.prototype._forward=function(){if(!this._stream)return;while(!this.destroyed){var buf=this._stream.read();if(!buf){this._want=!!this._stream;return;}if(!this.push(buf))return;}};Encoder.prototype._read=function(){if(this._reading||this.destroyed)return;this._reading=true;if(this._stream)this._forward();if(this._drain){var drain=this._drain;this._drain=null;drain();}this._reading=false;};function MediaData(parent){this._parent=parent;this.destroyed=false;stream.PassThrough.call(this);}inherits(MediaData,stream.PassThrough);MediaData.prototype.destroy=function(err){if(this.destroyed)return;this.destroyed=true;this._parent.destroy(err);if(err)this.emit("error",err);this.emit("close");};}).call(this,require("_process"),require("buffer").Buffer);},{_process:40,buffer:41,inherits:94,"mp4-box-encoding":117,"readable-stream":130}],120:[function(require,module,exports){exports.decode=require("./decode");exports.encode=require("./encode");},{"./decode":118,"./encode":119}],121:[function(require,module,exports){arguments[4][10][0].apply(exports,arguments);},{dup:10}],122:[function(require,module,exports){arguments[4][11][0].apply(exports,arguments);},{"./_stream_readable":124,"./_stream_writable":126,"core-util-is":56,dup:11,inherits:94,"process-nextick-args":152}],123:[function(require,module,exports){arguments[4][12][0].apply(exports,arguments);},{"./_stream_transform":125,"core-util-is":56,dup:12,inherits:94}],124:[function(require,module,exports){arguments[4][13][0].apply(exports,arguments);},{"./_stream_duplex":122,"./internal/streams/BufferList":127,"./internal/streams/destroy":128,"./internal/streams/stream":129,_process:40,"core-util-is":56,dup:13,events:73,inherits:94,isarray:121,"process-nextick-args":152,"safe-buffer":177,"string_decoder/":131,util:38}],125:[function(require,module,exports){arguments[4][14][0].apply(exports,arguments);},{"./_stream_duplex":122,"core-util-is":56,dup:14,inherits:94}],126:[function(require,module,exports){arguments[4][15][0].apply(exports,arguments);},{"./_stream_duplex":122,"./internal/streams/destroy":128,"./internal/streams/stream":129,_process:40,"core-util-is":56,dup:15,inherits:94,"process-nextick-args":152,"safe-buffer":177,"util-deprecate":239}],127:[function(require,module,exports){arguments[4][16][0].apply(exports,arguments);},{dup:16,"safe-buffer":177}],128:[function(require,module,exports){arguments[4][17][0].apply(exports,arguments);},{dup:17,"process-nextick-args":152}],129:[function(require,module,exports){arguments[4][18][0].apply(exports,arguments);},{dup:18,events:73}],130:[function(require,module,exports){arguments[4][19][0].apply(exports,arguments);},{"./lib/_stream_duplex.js":122,"./lib/_stream_passthrough.js":123,"./lib/_stream_readable.js":124,"./lib/_stream_transform.js":125,"./lib/_stream_writable.js":126,dup:19}],131:[function(require,module,exports){arguments[4][20][0].apply(exports,arguments);},{dup:20,"safe-buffer":177}],132:[function(require,module,exports){var s=1e3;var m=s*60;var h=m*60;var d=h*24;var y=d*365.25;module.exports=function(val,options){options=options||{};var type=typeof val==="undefined"?"undefined":_typeof2(val);if(type==="string"&&val.length>0){return parse(val);}else if(type==="number"&&isNaN(val)===false){return options.long?fmtLong(val):fmtShort(val);}throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(val));};function parse(str){str=String(str);if(str.length>100){return;}var match=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(str);if(!match){return;}var n=parseFloat(match[1]);var type=(match[2]||"ms").toLowerCase();switch(type){case"years":case"year":case"yrs":case"yr":case"y":return n*y;case"days":case"day":case"d":return n*d;case"hours":case"hour":case"hrs":case"hr":case"h":return n*h;case"minutes":case"minute":case"mins":case"min":case"m":return n*m;case"seconds":case"second":case"secs":case"sec":case"s":return n*s;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n;default:return undefined;}}function fmtShort(ms){if(ms>=d){return Math.round(ms/d)+"d";}if(ms>=h){return Math.round(ms/h)+"h";}if(ms>=m){return Math.round(ms/m)+"m";}if(ms>=s){return Math.round(ms/s)+"s";}return ms+"ms";}function fmtLong(ms){return plural(ms,d,"day")||plural(ms,h,"hour")||plural(ms,m,"minute")||plural(ms,s,"second")||ms+" ms";}function plural(ms,n,name){if(ms<n){return;}if(ms<n*1.5){return Math.floor(ms/n)+" "+name;}return Math.ceil(ms/n)+" "+name+"s";}},{}],133:[function(require,module,exports){module.exports=MultiStream;var inherits=require("inherits");var stream=require("readable-stream");inherits(MultiStream,stream.Readable);function MultiStream(streams,opts){var self=this;if(!(self instanceof MultiStream))return new MultiStream(streams,opts);stream.Readable.call(self,opts);self.destroyed=false;self._drained=false;self._forwarding=false;self._current=null;if(typeof streams==="function"){self._queue=streams;}else{self._queue=streams.map(toStreams2);self._queue.forEach(function(stream){if(typeof stream!=="function")self._attachErrorListener(stream);});}self._next();}MultiStream.obj=function(streams){return new MultiStream(streams,{objectMode:true,highWaterMark:16});};MultiStream.prototype._read=function(){this._drained=true;this._forward();};MultiStream.prototype._forward=function(){if(this._forwarding||!this._drained||!this._current)return;this._forwarding=true;var chunk;while((chunk=this._current.read())!==null){this._drained=this.push(chunk);}this._forwarding=false;};MultiStream.prototype.destroy=function(err){if(this.destroyed)return;this.destroyed=true;if(this._current&&this._current.destroy)this._current.destroy();if(typeof this._queue!=="function"){this._queue.forEach(function(stream){if(stream.destroy)stream.destroy();});}if(err)this.emit("error",err);this.emit("close");};MultiStream.prototype._next=function(){var self=this;self._current=null;if(typeof self._queue==="function"){self._queue(function(err,stream){if(err)return self.destroy(err);stream=toStreams2(stream);self._attachErrorListener(stream);self._gotNextStream(stream);});}else{var stream=self._queue.shift();if(typeof stream==="function"){stream=toStreams2(stream());self._attachErrorListener(stream);}self._gotNextStream(stream);}};MultiStream.prototype._gotNextStream=function(stream){var self=this;if(!stream){self.push(null);self.destroy();return;}self._current=stream;self._forward();stream.on("readable",onReadable);stream.once("end",onEnd);stream.once("close",onClose);function onReadable(){self._forward();}function onClose(){if(!stream._readableState.ended){self.destroy();}}function onEnd(){self._current=null;stream.removeListener("readable",onReadable);stream.removeListener("end",onEnd);stream.removeListener("close",onClose);self._next();}};MultiStream.prototype._attachErrorListener=function(stream){var self=this;if(!stream)return;stream.once("error",onError);function onError(err){stream.removeListener("error",onError);self.destroy(err);}};function toStreams2(s){if(!s||typeof s==="function"||s._readableState)return s;var wrap=new stream.Readable().wrap(s);if(s.destroy){wrap.destroy=s.destroy.bind(s);}return wrap;}},{inherits:94,"readable-stream":143}],134:[function(require,module,exports){arguments[4][10][0].apply(exports,arguments);},{dup:10}],135:[function(require,module,exports){arguments[4][11][0].apply(exports,arguments);},{"./_stream_readable":137,"./_stream_writable":139,"core-util-is":56,dup:11,inherits:94,"process-nextick-args":152}],136:[function(require,module,exports){arguments[4][12][0].apply(exports,arguments);},{"./_stream_transform":138,"core-util-is":56,dup:12,inherits:94}],137:[function(require,module,exports){arguments[4][13][0].apply(exports,arguments);},{"./_stream_duplex":135,"./internal/streams/BufferList":140,"./internal/streams/destroy":141,"./internal/streams/stream":142,_process:40,"core-util-is":56,dup:13,events:73,inherits:94,isarray:134,"process-nextick-args":152,"safe-buffer":177,"string_decoder/":144,util:38}],138:[function(require,module,exports){arguments[4][14][0].apply(exports,arguments);},{"./_stream_duplex":135,"core-util-is":56,dup:14,inherits:94}],139:[function(require,module,exports){arguments[4][15][0].apply(exports,arguments);},{"./_stream_duplex":135,"./internal/streams/destroy":141,"./internal/streams/stream":142,_process:40,"core-util-is":56,dup:15,inherits:94,"process-nextick-args":152,"safe-buffer":177,"util-deprecate":239}],140:[function(require,module,exports){arguments[4][16][0].apply(exports,arguments);},{dup:16,"safe-buffer":177}],141:[function(require,module,exports){arguments[4][17][0].apply(exports,arguments);},{dup:17,"process-nextick-args":152}],142:[function(require,module,exports){arguments[4][18][0].apply(exports,arguments);},{dup:18,events:73}],143:[function(require,module,exports){arguments[4][19][0].apply(exports,arguments);},{"./lib/_stream_duplex.js":135,"./lib/_stream_passthrough.js":136,"./lib/_stream_readable.js":137,"./lib/_stream_transform.js":138,"./lib/_stream_writable.js":139,dup:19}],144:[function(require,module,exports){arguments[4][20][0].apply(exports,arguments);},{dup:20,"safe-buffer":177}],145:[function(require,module,exports){module.exports=nextEvent;function nextEvent(emitter,name){var next=null;emitter.on(name,function(data){if(!next)return;var fn=next;next=null;fn(data);});return function(once){next=once;};}},{}],146:[function(require,module,exports){var wrappy=require("wrappy");module.exports=wrappy(once);module.exports.strict=wrappy(onceStrict);once.proto=once(function(){Object.defineProperty(Function.prototype,"once",{value:function value(){return once(this);},configurable:true});Object.defineProperty(Function.prototype,"onceStrict",{value:function value(){return onceStrict(this);},configurable:true});});function once(fn){var f=function f(){if(f.called)return f.value;f.called=true;return f.value=fn.apply(this,arguments);};f.called=false;return f;}function onceStrict(fn){var f=function f(){if(f.called)throw new Error(f.onceError);f.called=true;return f.value=fn.apply(this,arguments);};var name=fn.name||"Function wrapped with `once`";f.onceError=name+" shouldn't be called more than once";f.called=false;return f;}},{wrappy:370}],147:[function(require,module,exports){var trim=require("trim"),forEach=require("for-each"),isArray=function isArray(arg){return Object.prototype.toString.call(arg)==="[object Array]";};module.exports=function(headers){if(!headers)return{};var result={};forEach(trim(headers).split("\n"),function(row){var index=row.indexOf(":"),key=trim(row.slice(0,index)).toLowerCase(),value=trim(row.slice(index+1));if(typeof result[key]==="undefined"){result[key]=value;}else if(isArray(result[key])){result[key].push(value);}else{result[key]=[result[key],value];}});return result;};},{"for-each":87,trim:230}],148:[function(require,module,exports){(function(Buffer){module.exports=decodeTorrentFile;module.exports.decode=decodeTorrentFile;module.exports.encode=encodeTorrentFile;var bencode=require("bencode");var path=require("path");var sha1=require("simple-sha1");var uniq=require("uniq");function decodeTorrentFile(torrent){if(Buffer.isBuffer(torrent)){torrent=bencode.decode(torrent);}ensure(torrent.info,"info");ensure(torrent.info["name.utf-8"]||torrent.info.name,"info.name");ensure(torrent.info["piece length"],"info['piece length']");ensure(torrent.info.pieces,"info.pieces");if(torrent.info.files){torrent.info.files.forEach(function(file){ensure(typeof file.length==="number","info.files[0].length");ensure(file["path.utf-8"]||file.path,"info.files[0].path");});}else{ensure(typeof torrent.info.length==="number","info.length");}var result={};result.info=torrent.info;result.infoBuffer=bencode.encode(torrent.info);result.infoHash=sha1.sync(result.infoBuffer);result.infoHashBuffer=Buffer.from(result.infoHash,"hex");result.name=(torrent.info["name.utf-8"]||torrent.info.name).toString();if(torrent.info.private!==undefined)result.private=!!torrent.info.private;if(torrent["creation date"])result.created=new Date(torrent["creation date"]*1e3);if(torrent["created by"])result.createdBy=torrent["created by"].toString();if(Buffer.isBuffer(torrent.comment))result.comment=torrent.comment.toString();result.announce=[];if(torrent["announce-list"]&&torrent["announce-list"].length){torrent["announce-list"].forEach(function(urls){urls.forEach(function(url){result.announce.push(url.toString());});});}else if(torrent.announce){result.announce.push(torrent.announce.toString());}if(Buffer.isBuffer(torrent["url-list"])){torrent["url-list"]=torrent["url-list"].length>0?[torrent["url-list"]]:[];}result.urlList=(torrent["url-list"]||[]).map(function(url){return url.toString();});uniq(result.announce);uniq(result.urlList);var files=torrent.info.files||[torrent.info];result.files=files.map(function(file,i){var parts=[].concat(result.name,file["path.utf-8"]||file.path||[]).map(function(p){return p.toString();});return{path:path.join.apply(null,[path.sep].concat(parts)).slice(1),name:parts[parts.length-1],length:file.length,offset:files.slice(0,i).reduce(sumLength,0)};});result.length=files.reduce(sumLength,0);var lastFile=result.files[result.files.length-1];result.pieceLength=torrent.info["piece length"];result.lastPieceLength=(lastFile.offset+lastFile.length)%result.pieceLength||result.pieceLength;result.pieces=splitPieces(torrent.info.pieces);return result;}function encodeTorrentFile(parsed){var torrent={info:parsed.info};torrent["announce-list"]=(parsed.announce||[]).map(function(url){if(!torrent.announce)torrent.announce=url;url=Buffer.from(url,"utf8");return[url];});torrent["url-list"]=parsed.urlList||[];if(parsed.created){torrent["creation date"]=parsed.created.getTime()/1e3|0;}if(parsed.createdBy){torrent["created by"]=parsed.createdBy;}if(parsed.comment){torrent.comment=parsed.comment;}return bencode.encode(torrent);}function sumLength(sum,file){return sum+file.length;}function splitPieces(buf){var pieces=[];for(var i=0;i<buf.length;i+=20){pieces.push(buf.slice(i,i+20).toString("hex"));}return pieces;}function ensure(bool,fieldName){if(!bool)throw new Error("Torrent is missing required field: "+fieldName);}}).call(this,require("buffer").Buffer);},{bencode:6,buffer:41,path:150,"simple-sha1":193,uniq:234}],149:[function(require,module,exports){(function(process,Buffer){module.exports=parseTorrent;module.exports.remote=parseTorrentRemote;var blobToBuffer=require("blob-to-buffer");var fs=require("fs");var get=require("simple-get");var magnet=require("magnet-uri");var parseTorrentFile=require("parse-torrent-file");module.exports.toMagnetURI=magnet.encode;module.exports.toTorrentFile=parseTorrentFile.encode;function parseTorrent(torrentId){if(typeof torrentId==="string"&&/^(stream-)?magnet:/.test(torrentId)){return magnet(torrentId);}else if(typeof torrentId==="string"&&(/^[a-f0-9]{40}$/i.test(torrentId)||/^[a-z2-7]{32}$/i.test(torrentId))){return magnet("magnet:?xt=urn:btih:"+torrentId);}else if(Buffer.isBuffer(torrentId)&&torrentId.length===20){return magnet("magnet:?xt=urn:btih:"+torrentId.toString("hex"));}else if(Buffer.isBuffer(torrentId)){return parseTorrentFile(torrentId);}else if(torrentId&&torrentId.infoHash){if(!torrentId.announce)torrentId.announce=[];if(typeof torrentId.announce==="string"){torrentId.announce=[torrentId.announce];}if(!torrentId.urlList)torrentId.urlList=[];return torrentId;}else{throw new Error("Invalid torrent identifier");}}function parseTorrentRemote(torrentId,cb){var parsedTorrent;if(typeof cb!=="function")throw new Error("second argument must be a Function");try{parsedTorrent=parseTorrent(torrentId);}catch(err){}if(parsedTorrent&&parsedTorrent.infoHash){process.nextTick(function(){cb(null,parsedTorrent);});}else if(isBlob(torrentId)){blobToBuffer(torrentId,function(err,torrentBuf){if(err)return cb(new Error("Error converting Blob: "+err.message));parseOrThrow(torrentBuf);});}else if(typeof get==="function"&&/^https?:/.test(torrentId)){get.concat({url:torrentId,timeout:30*1e3,headers:{"user-agent":"WebTorrent (http://webtorrent.io)"}},function(err,res,torrentBuf){if(err)return cb(new Error("Error downloading torrent: "+err.message));parseOrThrow(torrentBuf);});}else if(typeof fs.readFile==="function"&&typeof torrentId==="string"){fs.readFile(torrentId,function(err,torrentBuf){if(err)return cb(new Error("Invalid torrent identifier"));parseOrThrow(torrentBuf);});}else{process.nextTick(function(){cb(new Error("Invalid torrent identifier"));});}function parseOrThrow(torrentBuf){try{parsedTorrent=parseTorrent(torrentBuf);}catch(err){return cb(err);}if(parsedTorrent&&parsedTorrent.infoHash)cb(null,parsedTorrent);else cb(new Error("Invalid torrent identifier"));}}function isBlob(obj){return typeof Blob!=="undefined"&&obj instanceof Blob;}(function(){Buffer.alloc(0);})();}).call(this,require("_process"),require("buffer").Buffer);},{_process:40,"blob-to-buffer":25,buffer:41,fs:39,"magnet-uri":101,"parse-torrent-file":148,"simple-get":180}],150:[function(require,module,exports){(function(process){function normalizeArray(parts,allowAboveRoot){var up=0;for(var i=parts.length-1;i>=0;i--){var last=parts[i];if(last==="."){parts.splice(i,1);}else if(last===".."){parts.splice(i,1);up++;}else if(up){parts.splice(i,1);up--;}}if(allowAboveRoot){for(;up--;up){parts.unshift("..");}}return parts;}var splitPathRe=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/;var splitPath=function splitPath(filename){return splitPathRe.exec(filename).slice(1);};exports.resolve=function(){var resolvedPath="",resolvedAbsolute=false;for(var i=arguments.length-1;i>=-1&&!resolvedAbsolute;i--){var path=i>=0?arguments[i]:process.cwd();if(typeof path!=="string"){throw new TypeError("Arguments to path.resolve must be strings");}else if(!path){continue;}resolvedPath=path+"/"+resolvedPath;resolvedAbsolute=path.charAt(0)==="/";}resolvedPath=normalizeArray(filter(resolvedPath.split("/"),function(p){return!!p;}),!resolvedAbsolute).join("/");return(resolvedAbsolute?"/":"")+resolvedPath||".";};exports.normalize=function(path){var isAbsolute=exports.isAbsolute(path),trailingSlash=substr(path,-1)==="/";path=normalizeArray(filter(path.split("/"),function(p){return!!p;}),!isAbsolute).join("/");if(!path&&!isAbsolute){path=".";}if(path&&trailingSlash){path+="/";}return(isAbsolute?"/":"")+path;};exports.isAbsolute=function(path){return path.charAt(0)==="/";};exports.join=function(){var paths=Array.prototype.slice.call(arguments,0);return exports.normalize(filter(paths,function(p,index){if(typeof p!=="string"){throw new TypeError("Arguments to path.join must be strings");}return p;}).join("/"));};exports.relative=function(from,to){from=exports.resolve(from).substr(1);to=exports.resolve(to).substr(1);function trim(arr){var start=0;for(;start<arr.length;start++){if(arr[start]!=="")break;}var end=arr.length-1;for(;end>=0;end--){if(arr[end]!=="")break;}if(start>end)return[];return arr.slice(start,end-start+1);}var fromParts=trim(from.split("/"));var toParts=trim(to.split("/"));var length=Math.min(fromParts.length,toParts.length);var samePartsLength=length;for(var i=0;i<length;i++){if(fromParts[i]!==toParts[i]){samePartsLength=i;break;}}var outputParts=[];for(var i=samePartsLength;i<fromParts.length;i++){outputParts.push("..");}outputParts=outputParts.concat(toParts.slice(samePartsLength));return outputParts.join("/");};exports.sep="/";exports.delimiter=":";exports.dirname=function(path){var result=splitPath(path),root=result[0],dir=result[1];if(!root&&!dir){return".";}if(dir){dir=dir.substr(0,dir.length-1);}return root+dir;};exports.basename=function(path,ext){var f=splitPath(path)[2];if(ext&&f.substr(-1*ext.length)===ext){f=f.substr(0,f.length-ext.length);}return f;};exports.extname=function(path){return splitPath(path)[3];};function filter(xs,f){if(xs.filter)return xs.filter(f);var res=[];for(var i=0;i<xs.length;i++){if(f(xs[i],i,xs))res.push(xs[i]);}return res;}var substr="ab".substr(-1)==="b"?function(str,start,len){return str.substr(start,len);}:function(str,start,len){if(start<0)start=str.length+start;return str.substr(start,len);};}).call(this,require("_process"));},{_process:40}],151:[function(require,module,exports){var closest=require("closest-to");var kB=Math.pow(2,10);var p=13,range=[];while(p++<22){range.push(Math.pow(2,p));}module.exports=function(bytes){return closest(bytes/kB,range);};},{"closest-to":55}],152:[function(require,module,exports){(function(process){"use strict";if(!process.version||process.version.indexOf("v0.")===0||process.version.indexOf("v1.")===0&&process.version.indexOf("v1.8.")!==0){module.exports=nextTick;}else{module.exports=process.nextTick;}function nextTick(fn,arg1,arg2,arg3){if(typeof fn!=="function"){throw new TypeError('"callback" argument must be a function');}var len=arguments.length;var args,i;switch(len){case 0:case 1:return process.nextTick(fn);case 2:return process.nextTick(function afterTickOne(){fn.call(null,arg1);});case 3:return process.nextTick(function afterTickTwo(){fn.call(null,arg1,arg2);});case 4:return process.nextTick(function afterTickThree(){fn.call(null,arg1,arg2,arg3);});default:args=new Array(len-1);i=0;while(i<args.length){args[i++]=arguments[i];}return process.nextTick(function afterTick(){fn.apply(null,args);});}}}).call(this,require("_process"));},{_process:40}],153:[function(require,module,exports){var once=require("once");var eos=require("end-of-stream");var fs=require("fs");var noop=function noop(){};var isFn=function isFn(fn){return typeof fn==="function";};var isFS=function isFS(stream){if(!fs)return false;return(stream instanceof(fs.ReadStream||noop)||stream instanceof(fs.WriteStream||noop))&&isFn(stream.close);};var isRequest=function isRequest(stream){return stream.setHeader&&isFn(stream.abort);};var destroyer=function destroyer(stream,reading,writing,callback){callback=once(callback);var closed=false;stream.on("close",function(){closed=true;});eos(stream,{readable:reading,writable:writing},function(err){if(err)return callback(err);closed=true;callback();});var destroyed=false;return function(err){if(closed)return;if(destroyed)return;destroyed=true;if(isFS(stream))return stream.close();if(isRequest(stream))return stream.abort();if(isFn(stream.destroy))return stream.destroy();callback(err||new Error("stream was destroyed"));};};var call=function call(fn){fn();};var pipe=function pipe(from,to){return from.pipe(to);};var pump=function pump(){var streams=Array.prototype.slice.call(arguments);var callback=isFn(streams[streams.length-1]||noop)&&streams.pop()||noop;if(Array.isArray(streams[0]))streams=streams[0];if(streams.length<2)throw new Error("pump requires two streams per minimum");var error;var destroys=streams.map(function(stream,i){var reading=i<streams.length-1;var writing=i>0;return destroyer(stream,reading,writing,function(err){if(!error)error=err;if(err)destroys.forEach(call);if(reading)return;destroys.forEach(call);callback(error);});});return streams.reduce(pipe);};module.exports=pump;},{"end-of-stream":72,fs:38,once:146}],154:[function(require,module,exports){(function(global){(function(root){var freeExports=(typeof exports==="undefined"?"undefined":_typeof2(exports))=="object"&&exports&&!exports.nodeType&&exports;var freeModule=(typeof module==="undefined"?"undefined":_typeof2(module))=="object"&&module&&!module.nodeType&&module;var freeGlobal=(typeof global==="undefined"?"undefined":_typeof2(global))=="object"&&global;if(freeGlobal.global===freeGlobal||freeGlobal.window===freeGlobal||freeGlobal.self===freeGlobal){root=freeGlobal;}var punycode,maxInt=2147483647,base=36,tMin=1,tMax=26,skew=38,damp=700,initialBias=72,initialN=128,delimiter="-",regexPunycode=/^xn--/,regexNonASCII=/[^\x20-\x7E]/,regexSeparators=/[\x2E\u3002\uFF0E\uFF61]/g,errors={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},baseMinusTMin=base-tMin,floor=Math.floor,stringFromCharCode=String.fromCharCode,key;function error(type){throw new RangeError(errors[type]);}function map(array,fn){var length=array.length;var result=[];while(length--){result[length]=fn(array[length]);}return result;}function mapDomain(string,fn){var parts=string.split("@");var result="";if(parts.length>1){result=parts[0]+"@";string=parts[1];}string=string.replace(regexSeparators,".");var labels=string.split(".");var encoded=map(labels,fn).join(".");return result+encoded;}function ucs2decode(string){var output=[],counter=0,length=string.length,value,extra;while(counter<length){value=string.charCodeAt(counter++);if(value>=55296&&value<=56319&&counter<length){extra=string.charCodeAt(counter++);if((extra&64512)==56320){output.push(((value&1023)<<10)+(extra&1023)+65536);}else{output.push(value);counter--;}}else{output.push(value);}}return output;}function ucs2encode(array){return map(array,function(value){var output="";if(value>65535){value-=65536;output+=stringFromCharCode(value>>>10&1023|55296);value=56320|value&1023;}output+=stringFromCharCode(value);return output;}).join("");}function basicToDigit(codePoint){if(codePoint-48<10){return codePoint-22;}if(codePoint-65<26){return codePoint-65;}if(codePoint-97<26){return codePoint-97;}return base;}function digitToBasic(digit,flag){return digit+22+75*(digit<26)-((flag!=0)<<5);}function adapt(delta,numPoints,firstTime){var k=0;delta=firstTime?floor(delta/damp):delta>>1;delta+=floor(delta/numPoints);for(;delta>baseMinusTMin*tMax>>1;k+=base){delta=floor(delta/baseMinusTMin);}return floor(k+(baseMinusTMin+1)*delta/(delta+skew));}function decode(input){var output=[],inputLength=input.length,out,i=0,n=initialN,bias=initialBias,basic,j,index,oldi,w,k,digit,t,baseMinusT;basic=input.lastIndexOf(delimiter);if(basic<0){basic=0;}for(j=0;j<basic;++j){if(input.charCodeAt(j)>=128){error("not-basic");}output.push(input.charCodeAt(j));}for(index=basic>0?basic+1:0;index<inputLength;){for(oldi=i,w=1,k=base;;k+=base){if(index>=inputLength){error("invalid-input");}digit=basicToDigit(input.charCodeAt(index++));if(digit>=base||digit>floor((maxInt-i)/w)){error("overflow");}i+=digit*w;t=k<=bias?tMin:k>=bias+tMax?tMax:k-bias;if(digit<t){break;}baseMinusT=base-t;if(w>floor(maxInt/baseMinusT)){error("overflow");}w*=baseMinusT;}out=output.length+1;bias=adapt(i-oldi,out,oldi==0);if(floor(i/out)>maxInt-n){error("overflow");}n+=floor(i/out);i%=out;output.splice(i++,0,n);}return ucs2encode(output);}function encode(input){var n,delta,handledCPCount,basicLength,bias,j,m,q,k,t,currentValue,output=[],inputLength,handledCPCountPlusOne,baseMinusT,qMinusT;input=ucs2decode(input);inputLength=input.length;n=initialN;delta=0;bias=initialBias;for(j=0;j<inputLength;++j){currentValue=input[j];if(currentValue<128){output.push(stringFromCharCode(currentValue));}}handledCPCount=basicLength=output.length;if(basicLength){output.push(delimiter);}while(handledCPCount<inputLength){for(m=maxInt,j=0;j<inputLength;++j){currentValue=input[j];if(currentValue>=n&&currentValue<m){m=currentValue;}}handledCPCountPlusOne=handledCPCount+1;if(m-n>floor((maxInt-delta)/handledCPCountPlusOne)){error("overflow");}delta+=(m-n)*handledCPCountPlusOne;n=m;for(j=0;j<inputLength;++j){currentValue=input[j];if(currentValue<n&&++delta>maxInt){error("overflow");}if(currentValue==n){for(q=delta,k=base;;k+=base){t=k<=bias?tMin:k>=bias+tMax?tMax:k-bias;if(q<t){break;}qMinusT=q-t;baseMinusT=base-t;output.push(stringFromCharCode(digitToBasic(t+qMinusT%baseMinusT,0)));q=floor(qMinusT/baseMinusT);}output.push(stringFromCharCode(digitToBasic(q,0)));bias=adapt(delta,handledCPCountPlusOne,handledCPCount==basicLength);delta=0;++handledCPCount;}}++delta;++n;}return output.join("");}function toUnicode(input){return mapDomain(input,function(string){return regexPunycode.test(string)?decode(string.slice(4).toLowerCase()):string;});}function toASCII(input){return mapDomain(input,function(string){return regexNonASCII.test(string)?"xn--"+encode(string):string;});}punycode={version:"1.4.1",ucs2:{decode:ucs2decode,encode:ucs2encode},decode:decode,encode:encode,toASCII:toASCII,toUnicode:toUnicode};if(typeof define=="function"&&_typeof2(define.amd)=="object"&&define.amd){define("punycode",function(){return punycode;});}else if(freeExports&&freeModule){if(module.exports==freeExports){freeModule.exports=punycode;}else{for(key in punycode){punycode.hasOwnProperty(key)&&(freeExports[key]=punycode[key]);}}}else{root.punycode=punycode;}})(this);}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{});},{}],155:[function(require,module,exports){"use strict";function hasOwnProperty(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop);}module.exports=function(qs,sep,eq,options){sep=sep||"&";eq=eq||"=";var obj={};if(typeof qs!=="string"||qs.length===0){return obj;}var regexp=/\+/g;qs=qs.split(sep);var maxKeys=1e3;if(options&&typeof options.maxKeys==="number"){maxKeys=options.maxKeys;}var len=qs.length;if(maxKeys>0&&len>maxKeys){len=maxKeys;}for(var i=0;i<len;++i){var x=qs[i].replace(regexp,"%20"),idx=x.indexOf(eq),kstr,vstr,k,v;if(idx>=0){kstr=x.substr(0,idx);vstr=x.substr(idx+1);}else{kstr=x;vstr="";}k=decodeURIComponent(kstr);v=decodeURIComponent(vstr);if(!hasOwnProperty(obj,k)){obj[k]=v;}else if(isArray(obj[k])){obj[k].push(v);}else{obj[k]=[obj[k],v];}}return obj;};var isArray=Array.isArray||function(xs){return Object.prototype.toString.call(xs)==="[object Array]";};},{}],156:[function(require,module,exports){"use strict";var stringifyPrimitive=function stringifyPrimitive(v){switch(typeof v==="undefined"?"undefined":_typeof2(v)){case"string":return v;case"boolean":return v?"true":"false";case"number":return isFinite(v)?v:"";default:return"";}};module.exports=function(obj,sep,eq,name){sep=sep||"&";eq=eq||"=";if(obj===null){obj=undefined;}if((typeof obj==="undefined"?"undefined":_typeof2(obj))==="object"){return map(objectKeys(obj),function(k){var ks=encodeURIComponent(stringifyPrimitive(k))+eq;if(isArray(obj[k])){return map(obj[k],function(v){return ks+encodeURIComponent(stringifyPrimitive(v));}).join(sep);}else{return ks+encodeURIComponent(stringifyPrimitive(obj[k]));}}).join(sep);}if(!name)return"";return encodeURIComponent(stringifyPrimitive(name))+eq+encodeURIComponent(stringifyPrimitive(obj));};var isArray=Array.isArray||function(xs){return Object.prototype.toString.call(xs)==="[object Array]";};function map(xs,f){if(xs.map)return xs.map(f);var res=[];for(var i=0;i<xs.length;i++){res.push(f(xs[i],i));}return res;}var objectKeys=Object.keys||function(obj){var res=[];for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))res.push(key);}return res;};},{}],157:[function(require,module,exports){"use strict";exports.decode=exports.parse=require("./decode");exports.encode=exports.stringify=require("./encode");},{"./decode":155,"./encode":156}],158:[function(require,module,exports){var iterate=function iterate(list){var offset=0;return function(){if(offset===list.length)return null;var len=list.length-offset;var i=Math.random()*len|0;var el=list[offset+i];var tmp=list[offset];list[offset]=el;list[offset+i]=tmp;offset++;return el;};};module.exports=iterate;},{}],159:[function(require,module,exports){(function(process,global){"use strict";function oldBrowser(){throw new Error("secure random number generation not supported by this browser\nuse chrome, FireFox or Internet Explorer 11");}var Buffer=require("safe-buffer").Buffer;var crypto=global.crypto||global.msCrypto;if(crypto&&crypto.getRandomValues){module.exports=randomBytes;}else{module.exports=oldBrowser;}function randomBytes(size,cb){if(size>65536)throw new Error("requested too many random bytes");var rawBytes=new global.Uint8Array(size);if(size>0){crypto.getRandomValues(rawBytes);}var bytes=Buffer.from(rawBytes.buffer);if(typeof cb==="function"){return process.nextTick(function(){cb(null,bytes);});}return bytes;}}).call(this,require("_process"),typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{});},{_process:40,"safe-buffer":177}],160:[function(require,module,exports){var inherits=require("inherits");var stream=require("readable-stream");module.exports=RangeSliceStream;inherits(RangeSliceStream,stream.Writable);function RangeSliceStream(offset,opts){var self=this;if(!(self instanceof RangeSliceStream))return new RangeSliceStream(offset);stream.Writable.call(self,opts);self.destroyed=false;self._queue=[];self._position=offset||0;self._cb=null;self._buffer=null;self._out=null;}RangeSliceStream.prototype._write=function(chunk,encoding,cb){var self=this;var drained=true;while(true){if(self.destroyed){return;}if(self._queue.length===0){self._buffer=chunk;self._cb=cb;return;}self._buffer=null;var currRange=self._queue[0];var writeStart=Math.max(currRange.start-self._position,0);var writeEnd=currRange.end-self._position;if(writeStart>=chunk.length){self._position+=chunk.length;return cb(null);}var toWrite;if(writeEnd>chunk.length){self._position+=chunk.length;if(writeStart===0){toWrite=chunk;}else{toWrite=chunk.slice(writeStart);}drained=currRange.stream.write(toWrite)&&drained;break;}self._position+=writeEnd;if(writeStart===0&&writeEnd===chunk.length){toWrite=chunk;}else{toWrite=chunk.slice(writeStart,writeEnd);}drained=currRange.stream.write(toWrite)&&drained;if(currRange.last){currRange.stream.end();}chunk=chunk.slice(writeEnd);self._queue.shift();}if(drained){cb(null);}else{currRange.stream.once("drain",cb.bind(null,null));}};RangeSliceStream.prototype.slice=function(ranges){var self=this;if(self.destroyed)return null;if(!(ranges instanceof Array)){ranges=[ranges];}var str=new stream.PassThrough();ranges.forEach(function(range,i){self._queue.push({start:range.start,end:range.end,stream:str,last:i===ranges.length-1});});if(self._buffer){self._write(self._buffer,null,self._cb);}return str;};RangeSliceStream.prototype.destroy=function(err){var self=this;if(self.destroyed)return;self.destroyed=true;if(err)self.emit("error",err);};},{inherits:94,"readable-stream":170}],161:[function(require,module,exports){arguments[4][10][0].apply(exports,arguments);},{dup:10}],162:[function(require,module,exports){arguments[4][11][0].apply(exports,arguments);},{"./_stream_readable":164,"./_stream_writable":166,"core-util-is":56,dup:11,inherits:94,"process-nextick-args":152}],163:[function(require,module,exports){arguments[4][12][0].apply(exports,arguments);},{"./_stream_transform":165,"core-util-is":56,dup:12,inherits:94}],164:[function(require,module,exports){arguments[4][13][0].apply(exports,arguments);},{"./_stream_duplex":162,"./internal/streams/BufferList":167,"./internal/streams/destroy":168,"./internal/streams/stream":169,_process:40,"core-util-is":56,dup:13,events:73,inherits:94,isarray:161,"process-nextick-args":152,"safe-buffer":177,"string_decoder/":171,util:38}],165:[function(require,module,exports){arguments[4][14][0].apply(exports,arguments);},{"./_stream_duplex":162,"core-util-is":56,dup:14,inherits:94}],166:[function(require,module,exports){arguments[4][15][0].apply(exports,arguments);},{"./_stream_duplex":162,"./internal/streams/destroy":168,"./internal/streams/stream":169,_process:40,"core-util-is":56,dup:15,inherits:94,"process-nextick-args":152,"safe-buffer":177,"util-deprecate":239}],167:[function(require,module,exports){arguments[4][16][0].apply(exports,arguments);},{dup:16,"safe-buffer":177}],168:[function(require,module,exports){arguments[4][17][0].apply(exports,arguments);},{dup:17,"process-nextick-args":152}],169:[function(require,module,exports){arguments[4][18][0].apply(exports,arguments);},{dup:18,events:73}],170:[function(require,module,exports){arguments[4][19][0].apply(exports,arguments);},{"./lib/_stream_duplex.js":162,"./lib/_stream_passthrough.js":163,"./lib/_stream_readable.js":164,"./lib/_stream_transform.js":165,"./lib/_stream_writable.js":166,dup:19}],171:[function(require,module,exports){arguments[4][20][0].apply(exports,arguments);},{dup:20,"safe-buffer":177}],172:[function(require,module,exports){exports.render=render;exports.append=append;exports.mime=require("./lib/mime.json");var debug=require("debug")("render-media");var isAscii=require("is-ascii");var MediaElementWrapper=require("mediasource");var path=require("path");var streamToBlobURL=require("stream-to-blob-url");var videostream=require("videostream");var VIDEOSTREAM_EXTS=[".m4a",".m4v",".mp4"];var MEDIASOURCE_VIDEO_EXTS=[".m4v",".mkv",".mp4",".webm"];var MEDIASOURCE_AUDIO_EXTS=[".m4a",".mp3"];var MEDIASOURCE_EXTS=[].concat(MEDIASOURCE_VIDEO_EXTS,MEDIASOURCE_AUDIO_EXTS);var AUDIO_EXTS=[".aac",".oga",".ogg",".wav"];var IMAGE_EXTS=[".bmp",".gif",".jpeg",".jpg",".png",".svg"];var IFRAME_EXTS=[".css",".html",".js",".md",".pdf",".txt"];var MAX_BLOB_LENGTH=200*1e3*1e3;var MediaSource=typeof window!=="undefined"&&window.MediaSource;function render(file,elem,opts,cb){if(typeof opts==="function"){cb=opts;opts={};}if(!opts)opts={};if(!cb)cb=function cb(){};validateFile(file);parseOpts(opts);if(typeof elem==="string")elem=document.querySelector(elem);renderMedia(file,function(tagName){if(elem.nodeName!==tagName.toUpperCase()){var extname=path.extname(file.name).toLowerCase();throw new Error('Cannot render "'+extname+'" inside a "'+elem.nodeName.toLowerCase()+'" element, expected "'+tagName+'"');}return elem;},opts,cb);}function append(file,rootElem,opts,cb){if(typeof opts==="function"){cb=opts;opts={};}if(!opts)opts={};if(!cb)cb=function cb(){};validateFile(file);parseOpts(opts);if(typeof rootElem==="string")rootElem=document.querySelector(rootElem);if(rootElem&&(rootElem.nodeName==="VIDEO"||rootElem.nodeName==="AUDIO")){throw new Error("Invalid video/audio node argument. Argument must be root element that "+"video/audio tag will be appended to.");}renderMedia(file,getElem,opts,done);function getElem(tagName){if(tagName==="video"||tagName==="audio")return createMedia(tagName);else return createElem(tagName);}function createMedia(tagName){var elem=createElem(tagName);if(opts.controls)elem.controls=true;if(opts.autoplay)elem.autoplay=true;rootElem.appendChild(elem);return elem;}function createElem(tagName){var elem=document.createElement(tagName);rootElem.appendChild(elem);return elem;}function done(err,elem){if(err&&elem)elem.remove();cb(err,elem);}}function renderMedia(file,getElem,opts,cb){var extname=path.extname(file.name).toLowerCase();var currentTime=0;var elem;if(MEDIASOURCE_EXTS.indexOf(extname)>=0){renderMediaSource();}else if(AUDIO_EXTS.indexOf(extname)>=0){renderAudio();}else if(IMAGE_EXTS.indexOf(extname)>=0){renderImage();}else if(IFRAME_EXTS.indexOf(extname)>=0){renderIframe();}else{tryRenderIframe();}function renderMediaSource(){var tagName=MEDIASOURCE_VIDEO_EXTS.indexOf(extname)>=0?"video":"audio";if(MediaSource){if(VIDEOSTREAM_EXTS.indexOf(extname)>=0){useVideostream();}else{useMediaSource();}}else{useBlobURL();}function useVideostream(){debug("Use `videostream` package for "+file.name);prepareElem();elem.addEventListener("error",fallbackToMediaSource);elem.addEventListener("loadstart",onLoadStart);elem.addEventListener("canplay",onCanPlay);videostream(file,elem);}function useMediaSource(){debug("Use MediaSource API for "+file.name);prepareElem();elem.addEventListener("error",fallbackToBlobURL);elem.addEventListener("loadstart",onLoadStart);elem.addEventListener("canplay",onCanPlay);var wrapper=new MediaElementWrapper(elem);var writable=wrapper.createWriteStream(getCodec(file.name));file.createReadStream().pipe(writable);if(currentTime)elem.currentTime=currentTime;}function useBlobURL(){debug("Use Blob URL for "+file.name);prepareElem();elem.addEventListener("error",fatalError);elem.addEventListener("loadstart",onLoadStart);elem.addEventListener("canplay",onCanPlay);getBlobURL(file,function(err,url){if(err)return fatalError(err);elem.src=url;if(currentTime)elem.currentTime=currentTime;});}function fallbackToMediaSource(err){debug("videostream error: fallback to MediaSource API: %o",err.message||err);elem.removeEventListener("error",fallbackToMediaSource);elem.removeEventListener("canplay",onCanPlay);useMediaSource();}function fallbackToBlobURL(err){debug("MediaSource API error: fallback to Blob URL: %o",err.message||err);if(typeof file.length==="number"&&file.length>opts.maxBlobLength){debug("File length too large for Blob URL approach: %d (max: %d)",file.length,opts.maxBlobLength);return fatalError(new Error("File length too large for Blob URL approach: "+file.length+" (max: "+opts.maxBlobLength+")"));}elem.removeEventListener("error",fallbackToBlobURL);elem.removeEventListener("canplay",onCanPlay);useBlobURL();}function prepareElem(){if(!elem){elem=getElem(tagName);elem.addEventListener("progress",function(){currentTime=elem.currentTime;});}}}function renderAudio(){elem=getElem("audio");getBlobURL(file,function(err,url){if(err)return fatalError(err);elem.addEventListener("error",fatalError);elem.addEventListener("loadstart",onLoadStart);elem.addEventListener("canplay",onCanPlay);elem.src=url;});}function onLoadStart(){elem.removeEventListener("loadstart",onLoadStart);if(opts.autoplay)elem.play();}function onCanPlay(){elem.removeEventListener("canplay",onCanPlay);cb(null,elem);}function renderImage(){elem=getElem("img");getBlobURL(file,function(err,url){if(err)return fatalError(err);elem.src=url;elem.alt=file.name;cb(null,elem);});}function renderIframe(){elem=getElem("iframe");getBlobURL(file,function(err,url){if(err)return fatalError(err);elem.src=url;if(extname!==".pdf")elem.sandbox="allow-forms allow-scripts";cb(null,elem);});}function tryRenderIframe(){debug('Unknown file extension "%s" - will attempt to render into iframe',extname);var str="";file.createReadStream({start:0,end:1e3}).setEncoding("utf8").on("data",function(chunk){str+=chunk;}).on("end",done).on("error",cb);function done(){if(isAscii(str)){debug('File extension "%s" appears ascii, so will render.',extname);renderIframe();}else{debug('File extension "%s" appears non-ascii, will not render.',extname);cb(new Error('Unsupported file type "'+extname+'": Cannot append to DOM'));}}}function fatalError(err){err.message='Error rendering file "'+file.name+'": '+err.message;debug(err.message);cb(err);}}function getBlobURL(file,cb){var extname=path.extname(file.name).toLowerCase();streamToBlobURL(file.createReadStream(),exports.mime[extname],cb);}function validateFile(file){if(file==null){throw new Error("file cannot be null or undefined");}if(typeof file.name!=="string"){throw new Error("missing or invalid file.name property");}if(typeof file.createReadStream!=="function"){throw new Error("missing or invalid file.createReadStream property");}}function getCodec(name){var extname=path.extname(name).toLowerCase();return{".m4a":'audio/mp4; codecs="mp4a.40.5"',".m4v":'video/mp4; codecs="avc1.640029, mp4a.40.5"',".mkv":'video/webm; codecs="avc1.640029, mp4a.40.5"',".mp3":"audio/mpeg",".mp4":'video/mp4; codecs="avc1.640029, mp4a.40.5"',".webm":'video/webm; codecs="vorbis, vp8"'}[extname];}function parseOpts(opts){if(opts.autoplay==null)opts.autoplay=true;if(opts.controls==null)opts.controls=true;if(opts.maxBlobLength==null)opts.maxBlobLength=MAX_BLOB_LENGTH;}},{"./lib/mime.json":173,debug:69,"is-ascii":95,mediasource:102,path:150,"stream-to-blob-url":222,videostream:350}],173:[function(require,module,exports){module.exports={".3gp":"video/3gpp",".aac":"audio/aac",".aif":"audio/x-aiff",".aiff":"audio/x-aiff",".atom":"application/atom+xml",".avi":"video/x-msvideo",".bmp":"image/bmp",".bz2":"application/x-bzip2",".conf":"text/plain",".css":"text/css",".csv":"text/plain",".diff":"text/x-diff",".doc":"application/msword",".flv":"video/x-flv",".gif":"image/gif",".gz":"application/x-gzip",".htm":"text/html",".html":"text/html",".ico":"image/vnd.microsoft.icon",".ics":"text/calendar",".iso":"application/octet-stream",".jar":"application/java-archive",".jpeg":"image/jpeg",".jpg":"image/jpeg",".js":"application/javascript",".json":"application/json",".less":"text/css",".log":"text/plain",".m3u":"audio/x-mpegurl",".m4a":"audio/mp4",".m4v":"video/mp4",".manifest":"text/cache-manifest",".markdown":"text/x-markdown",".mathml":"application/mathml+xml",".md":"text/x-markdown",".mid":"audio/midi",".midi":"audio/midi",".mov":"video/quicktime",".mp3":"audio/mpeg",".mp4":"video/mp4",".mp4v":"video/mp4",".mpeg":"video/mpeg",".mpg":"video/mpeg",".odp":"application/vnd.oasis.opendocument.presentation",".ods":"application/vnd.oasis.opendocument.spreadsheet",".odt":"application/vnd.oasis.opendocument.text",".oga":"audio/ogg",".ogg":"application/ogg",".pdf":"application/pdf",".png":"image/png",".pps":"application/vnd.ms-powerpoint",".ppt":"application/vnd.ms-powerpoint",".ps":"application/postscript",".psd":"image/vnd.adobe.photoshop",".qt":"video/quicktime",".rar":"application/x-rar-compressed",".rdf":"application/rdf+xml",".rss":"application/rss+xml",".rtf":"application/rtf",".svg":"image/svg+xml",".svgz":"image/svg+xml",".swf":"application/x-shockwave-flash",".tar":"application/x-tar",".tbz":"application/x-bzip-compressed-tar",".text":"text/plain",".tif":"image/tiff",".tiff":"image/tiff",".torrent":"application/x-bittorrent",".ttf":"application/x-font-ttf",".txt":"text/plain",".wav":"audio/wav",".webm":"video/webm",".wma":"audio/x-ms-wma",".wmv":"video/x-ms-wmv",".xls":"application/vnd.ms-excel",".xml":"application/xml",".yaml":"text/yaml",".yml":"text/yaml",".zip":"application/zip"};},{}],174:[function(require,module,exports){(function(process){module.exports=function(tasks,limit,cb){if(typeof limit!=="number")throw new Error("second argument must be a Number");var results,len,pending,keys,isErrored;var isSync=true;if(Array.isArray(tasks)){results=[];pending=len=tasks.length;}else{keys=Object.keys(tasks);results={};pending=len=keys.length;}function done(err){function end(){if(cb)cb(err,results);cb=null;}if(isSync)process.nextTick(end);else end();}function each(i,err,result){results[i]=result;if(err)isErrored=true;if(--pending===0||err){done(err);}else if(!isErrored&&next<len){var key;if(keys){key=keys[next];next+=1;tasks[key](function(err,result){each(key,err,result);});}else{key=next;next+=1;tasks[key](function(err,result){each(key,err,result);});}}}var next=limit;if(!pending){done(null);}else if(keys){keys.some(function(key,i){tasks[key](function(err,result){each(key,err,result);});if(i===limit-1)return true;});}else{tasks.some(function(task,i){task(function(err,result){each(i,err,result);});if(i===limit-1)return true;});}isSync=false;};}).call(this,require("_process"));},{_process:40}],175:[function(require,module,exports){(function(process){module.exports=function(tasks,cb){var results,pending,keys;var isSync=true;if(Array.isArray(tasks)){results=[];pending=tasks.length;}else{keys=Object.keys(tasks);results={};pending=keys.length;}function done(err){function end(){if(cb)cb(err,results);cb=null;}if(isSync)process.nextTick(end);else end();}function each(i,err,result){results[i]=result;if(--pending===0||err){done(err);}}if(!pending){done(null);}else if(keys){keys.forEach(function(key){tasks[key](function(err,result){each(key,err,result);});});}else{tasks.forEach(function(task,i){task(function(err,result){each(i,err,result);});});}isSync=false;};}).call(this,require("_process"));},{_process:40}],176:[function(require,module,exports){(function(global){(function(){var util={getDataType:function getDataType(data){if(typeof data==="string"){return"string";}if(data instanceof Array){return"array";}if(typeof global!=="undefined"&&global.Buffer&&global.Buffer.isBuffer(data)){return"buffer";}if(data instanceof ArrayBuffer){return"arraybuffer";}if(data.buffer instanceof ArrayBuffer){return"view";}if(data instanceof Blob){return"blob";}throw new Error("Unsupported data type.");}};function Rusha(chunkSize){"use strict";var self$2={fill:0};var padlen=function padlen(len){for(len+=9;len%64>0;len+=1){}return len;};var padZeroes=function padZeroes(bin,len){var h8=new Uint8Array(bin.buffer);var om=len%4,align=len-om;switch(om){case 0:h8[align+3]=0;case 1:h8[align+2]=0;case 2:h8[align+1]=0;case 3:h8[align+0]=0;}for(var i$2=(len>>2)+1;i$2<bin.length;i$2++){bin[i$2]=0;}};var padData=function padData(bin,chunkLen,msgLen){bin[chunkLen>>2]|=128<<24-(chunkLen%4<<3);bin[((chunkLen>>2)+2&~15)+14]=msgLen/(1<<29)|0;bin[((chunkLen>>2)+2&~15)+15]=msgLen<<3;};var convStr=function convStr(H8,H32,start,len,off){var str=this,i$2,om=off%4,lm=(len+om)%4,j=len-lm;switch(om){case 0:H8[off]=str.charCodeAt(start+3);case 1:H8[off+1-(om<<1)|0]=str.charCodeAt(start+2);case 2:H8[off+2-(om<<1)|0]=str.charCodeAt(start+1);case 3:H8[off+3-(om<<1)|0]=str.charCodeAt(start);}if(len<lm+om){return;}for(i$2=4-om;i$2<j;i$2=i$2+4|0){H32[off+i$2>>2]=str.charCodeAt(start+i$2)<<24|str.charCodeAt(start+i$2+1)<<16|str.charCodeAt(start+i$2+2)<<8|str.charCodeAt(start+i$2+3);}switch(lm){case 3:H8[off+j+1|0]=str.charCodeAt(start+j+2);case 2:H8[off+j+2|0]=str.charCodeAt(start+j+1);case 1:H8[off+j+3|0]=str.charCodeAt(start+j);}};var convBuf=function convBuf(H8,H32,start,len,off){var buf=this,i$2,om=off%4,lm=(len+om)%4,j=len-lm;switch(om){case 0:H8[off]=buf[start+3];case 1:H8[off+1-(om<<1)|0]=buf[start+2];case 2:H8[off+2-(om<<1)|0]=buf[start+1];case 3:H8[off+3-(om<<1)|0]=buf[start];}if(len<lm+om){return;}for(i$2=4-om;i$2<j;i$2=i$2+4|0){H32[off+i$2>>2|0]=buf[start+i$2]<<24|buf[start+i$2+1]<<16|buf[start+i$2+2]<<8|buf[start+i$2+3];}switch(lm){case 3:H8[off+j+1|0]=buf[start+j+2];case 2:H8[off+j+2|0]=buf[start+j+1];case 1:H8[off+j+3|0]=buf[start+j];}};var convBlob=function convBlob(H8,H32,start,len,off){var blob=this,i$2,om=off%4,lm=(len+om)%4,j=len-lm;var buf=new Uint8Array(reader.readAsArrayBuffer(blob.slice(start,start+len)));switch(om){case 0:H8[off]=buf[3];case 1:H8[off+1-(om<<1)|0]=buf[2];case 2:H8[off+2-(om<<1)|0]=buf[1];case 3:H8[off+3-(om<<1)|0]=buf[0];}if(len<lm+om){return;}for(i$2=4-om;i$2<j;i$2=i$2+4|0){H32[off+i$2>>2|0]=buf[i$2]<<24|buf[i$2+1]<<16|buf[i$2+2]<<8|buf[i$2+3];}switch(lm){case 3:H8[off+j+1|0]=buf[j+2];case 2:H8[off+j+2|0]=buf[j+1];case 1:H8[off+j+3|0]=buf[j];}};var convFn=function convFn(data){switch(util.getDataType(data)){case"string":return convStr.bind(data);case"array":return convBuf.bind(data);case"buffer":return convBuf.bind(data);case"arraybuffer":return convBuf.bind(new Uint8Array(data));case"view":return convBuf.bind(new Uint8Array(data.buffer,data.byteOffset,data.byteLength));case"blob":return convBlob.bind(data);}};var slice=function slice(data,offset){switch(util.getDataType(data)){case"string":return data.slice(offset);case"array":return data.slice(offset);case"buffer":return data.slice(offset);case"arraybuffer":return data.slice(offset);case"view":return data.buffer.slice(offset);}};var precomputedHex=new Array(256);for(var i=0;i<256;i++){precomputedHex[i]=(i<16?"0":"")+i.toString(16);}var hex=function hex(arrayBuffer){var binarray=new Uint8Array(arrayBuffer);var res=new Array(arrayBuffer.byteLength);for(var i$2=0;i$2<res.length;i$2++){res[i$2]=precomputedHex[binarray[i$2]];}return res.join("");};var ceilHeapSize=function ceilHeapSize(v){var p;if(v<=65536)return 65536;if(v<16777216){for(p=1;p<v;p=p<<1){}}else{for(p=16777216;p<v;p+=16777216){}}return p;};var init=function init(size){if(size%64>0){throw new Error("Chunk size must be a multiple of 128 bit");}self$2.offset=0;self$2.maxChunkLen=size;self$2.padMaxChunkLen=padlen(size);self$2.heap=new ArrayBuffer(ceilHeapSize(self$2.padMaxChunkLen+320+20));self$2.h32=new Int32Array(self$2.heap);self$2.h8=new Int8Array(self$2.heap);self$2.core=new Rusha._core({Int32Array:Int32Array,DataView:DataView},{},self$2.heap);self$2.buffer=null;};init(chunkSize||64*1024);var initState=function initState(heap,padMsgLen){self$2.offset=0;var io=new Int32Array(heap,padMsgLen+320,5);io[0]=1732584193;io[1]=-271733879;io[2]=-1732584194;io[3]=271733878;io[4]=-1009589776;};var padChunk=function padChunk(chunkLen,msgLen){var padChunkLen=padlen(chunkLen);var view=new Int32Array(self$2.heap,0,padChunkLen>>2);padZeroes(view,chunkLen);padData(view,chunkLen,msgLen);return padChunkLen;};var write=function write(data,chunkOffset,chunkLen,off){convFn(data)(self$2.h8,self$2.h32,chunkOffset,chunkLen,off||0);};var coreCall=function coreCall(data,chunkOffset,chunkLen,msgLen,finalize){var padChunkLen=chunkLen;write(data,chunkOffset,chunkLen);if(finalize){padChunkLen=padChunk(chunkLen,msgLen);}self$2.core.hash(padChunkLen,self$2.padMaxChunkLen);};var getRawDigest=function getRawDigest(heap,padMaxChunkLen){var io=new Int32Array(heap,padMaxChunkLen+320,5);var out=new Int32Array(5);var arr=new DataView(out.buffer);arr.setInt32(0,io[0],false);arr.setInt32(4,io[1],false);arr.setInt32(8,io[2],false);arr.setInt32(12,io[3],false);arr.setInt32(16,io[4],false);return out;};var rawDigest=this.rawDigest=function(str){var msgLen=str.byteLength||str.length||str.size||0;initState(self$2.heap,self$2.padMaxChunkLen);var chunkOffset=0,chunkLen=self$2.maxChunkLen;for(chunkOffset=0;msgLen>chunkOffset+chunkLen;chunkOffset+=chunkLen){coreCall(str,chunkOffset,chunkLen,msgLen,false);}coreCall(str,chunkOffset,msgLen-chunkOffset,msgLen,true);return getRawDigest(self$2.heap,self$2.padMaxChunkLen);};this.digest=this.digestFromString=this.digestFromBuffer=this.digestFromArrayBuffer=function(str){return hex(rawDigest(str).buffer);};this.resetState=function(){initState(self$2.heap,self$2.padMaxChunkLen);return this;};this.append=function(chunk){var chunkOffset=0;var chunkLen=chunk.byteLength||chunk.length||chunk.size||0;var turnOffset=self$2.offset%self$2.maxChunkLen;var inputLen;self$2.offset+=chunkLen;while(chunkOffset<chunkLen){inputLen=Math.min(chunkLen-chunkOffset,self$2.maxChunkLen-turnOffset);write(chunk,chunkOffset,inputLen,turnOffset);turnOffset+=inputLen;chunkOffset+=inputLen;if(turnOffset===self$2.maxChunkLen){self$2.core.hash(self$2.maxChunkLen,self$2.padMaxChunkLen);turnOffset=0;}}return this;};this.getState=function(){var turnOffset=self$2.offset%self$2.maxChunkLen;var heap;if(!turnOffset){var io=new Int32Array(self$2.heap,self$2.padMaxChunkLen+320,5);heap=io.buffer.slice(io.byteOffset,io.byteOffset+io.byteLength);}else{heap=self$2.heap.slice(0);}return{offset:self$2.offset,heap:heap};};this.setState=function(state){self$2.offset=state.offset;if(state.heap.byteLength===20){var io=new Int32Array(self$2.heap,self$2.padMaxChunkLen+320,5);io.set(new Int32Array(state.heap));}else{self$2.h32.set(new Int32Array(state.heap));}return this;};var rawEnd=this.rawEnd=function(){var msgLen=self$2.offset;var chunkLen=msgLen%self$2.maxChunkLen;var padChunkLen=padChunk(chunkLen,msgLen);self$2.core.hash(padChunkLen,self$2.padMaxChunkLen);var result=getRawDigest(self$2.heap,self$2.padMaxChunkLen);initState(self$2.heap,self$2.padMaxChunkLen);return result;};this.end=function(){return hex(rawEnd().buffer);};}Rusha._core=function RushaCore(stdlib,foreign,heap){"use asm";var H=new stdlib.Int32Array(heap);function hash(k,x){k=k|0;x=x|0;var i=0,j=0,y0=0,z0=0,y1=0,z1=0,y2=0,z2=0,y3=0,z3=0,y4=0,z4=0,t0=0,t1=0;y0=H[x+320>>2]|0;y1=H[x+324>>2]|0;y2=H[x+328>>2]|0;y3=H[x+332>>2]|0;y4=H[x+336>>2]|0;for(i=0;(i|0)<(k|0);i=i+64|0){z0=y0;z1=y1;z2=y2;z3=y3;z4=y4;for(j=0;(j|0)<64;j=j+4|0){t1=H[i+j>>2]|0;t0=((y0<<5|y0>>>27)+(y1&y2|~y1&y3)|0)+((t1+y4|0)+1518500249|0)|0;y4=y3;y3=y2;y2=y1<<30|y1>>>2;y1=y0;y0=t0;H[k+j>>2]=t1;}for(j=k+64|0;(j|0)<(k+80|0);j=j+4|0){t1=(H[j-12>>2]^H[j-32>>2]^H[j-56>>2]^H[j-64>>2])<<1|(H[j-12>>2]^H[j-32>>2]^H[j-56>>2]^H[j-64>>2])>>>31;t0=((y0<<5|y0>>>27)+(y1&y2|~y1&y3)|0)+((t1+y4|0)+1518500249|0)|0;y4=y3;y3=y2;y2=y1<<30|y1>>>2;y1=y0;y0=t0;H[j>>2]=t1;}for(j=k+80|0;(j|0)<(k+160|0);j=j+4|0){t1=(H[j-12>>2]^H[j-32>>2]^H[j-56>>2]^H[j-64>>2])<<1|(H[j-12>>2]^H[j-32>>2]^H[j-56>>2]^H[j-64>>2])>>>31;t0=((y0<<5|y0>>>27)+(y1^y2^y3)|0)+((t1+y4|0)+1859775393|0)|0;y4=y3;y3=y2;y2=y1<<30|y1>>>2;y1=y0;y0=t0;H[j>>2]=t1;}for(j=k+160|0;(j|0)<(k+240|0);j=j+4|0){t1=(H[j-12>>2]^H[j-32>>2]^H[j-56>>2]^H[j-64>>2])<<1|(H[j-12>>2]^H[j-32>>2]^H[j-56>>2]^H[j-64>>2])>>>31;t0=((y0<<5|y0>>>27)+(y1&y2|y1&y3|y2&y3)|0)+((t1+y4|0)-1894007588|0)|0;y4=y3;y3=y2;y2=y1<<30|y1>>>2;y1=y0;y0=t0;H[j>>2]=t1;}for(j=k+240|0;(j|0)<(k+320|0);j=j+4|0){t1=(H[j-12>>2]^H[j-32>>2]^H[j-56>>2]^H[j-64>>2])<<1|(H[j-12>>2]^H[j-32>>2]^H[j-56>>2]^H[j-64>>2])>>>31;t0=((y0<<5|y0>>>27)+(y1^y2^y3)|0)+((t1+y4|0)-899497514|0)|0;y4=y3;y3=y2;y2=y1<<30|y1>>>2;y1=y0;y0=t0;H[j>>2]=t1;}y0=y0+z0|0;y1=y1+z1|0;y2=y2+z2|0;y3=y3+z3|0;y4=y4+z4|0;}H[x+320>>2]=y0;H[x+324>>2]=y1;H[x+328>>2]=y2;H[x+332>>2]=y3;H[x+336>>2]=y4;}return{hash:hash};};if(typeof module!=="undefined"){module.exports=Rusha;}else if(typeof window!=="undefined"){window.Rusha=Rusha;}if(typeof FileReaderSync!=="undefined"){var reader=new FileReaderSync();var hashData=function hash(hasher,data,cb){try{return cb(null,hasher.digest(data));}catch(e){return cb(e);}};var hashFile=function hashArrayBuffer(hasher,readTotal,blockSize,file,cb){var reader$2=new self.FileReader();reader$2.onloadend=function onloadend(){var buffer=reader$2.result;readTotal+=reader$2.result.byteLength;try{hasher.append(buffer);}catch(e){cb(e);return;}if(readTotal<file.size){hashFile(hasher,readTotal,blockSize,file,cb);}else{cb(null,hasher.end());}};reader$2.readAsArrayBuffer(file.slice(readTotal,readTotal+blockSize));};self.onmessage=function onMessage(event){var data=event.data.data,file=event.data.file,id=event.data.id;if(typeof id==="undefined")return;if(!file&&!data)return;var blockSize=event.data.blockSize||4*1024*1024;var hasher=new Rusha(blockSize);hasher.resetState();var done=function done$2(err,hash){if(!err){self.postMessage({id:id,hash:hash});}else{self.postMessage({id:id,error:err.name});}};if(data)hashData(hasher,data,done);if(file)hashFile(hasher,0,blockSize,file,done);};}})();}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{});},{}],177:[function(require,module,exports){var buffer=require("buffer");var Buffer=buffer.Buffer;function copyProps(src,dst){for(var key in src){dst[key]=src[key];}}if(Buffer.from&&Buffer.alloc&&Buffer.allocUnsafe&&Buffer.allocUnsafeSlow){module.exports=buffer;}else{copyProps(buffer,exports);exports.Buffer=SafeBuffer;}function SafeBuffer(arg,encodingOrOffset,length){return Buffer(arg,encodingOrOffset,length);}copyProps(Buffer,SafeBuffer);SafeBuffer.from=function(arg,encodingOrOffset,length){if(typeof arg==="number"){throw new TypeError("Argument must not be a number");}return Buffer(arg,encodingOrOffset,length);};SafeBuffer.alloc=function(size,fill,encoding){if(typeof size!=="number"){throw new TypeError("Argument must be a number");}var buf=Buffer(size);if(fill!==undefined){if(typeof encoding==="string"){buf.fill(fill,encoding);}else{buf.fill(fill);}}else{buf.fill(0);}return buf;};SafeBuffer.allocUnsafe=function(size){if(typeof size!=="number"){throw new TypeError("Argument must be a number");}return Buffer(size);};SafeBuffer.allocUnsafeSlow=function(size){if(typeof size!=="number"){throw new TypeError("Argument must be a number");}return buffer.SlowBuffer(size);};},{buffer:41}],178:[function(require,module,exports){module.exports=SafeParseTuple;function SafeParseTuple(obj,reviver){var json;var error=null;try{json=JSON.parse(obj,reviver);}catch(err){error=err;}return[error,json];}},{}],179:[function(require,module,exports){(function(Buffer){module.exports=function(stream,cb){var chunks=[];stream.on("data",function(chunk){chunks.push(chunk);});stream.once("end",function(){if(cb)cb(null,Buffer.concat(chunks));cb=null;});stream.once("error",function(err){if(cb)cb(err);cb=null;});};}).call(this,require("buffer").Buffer);},{buffer:41}],180:[function(require,module,exports){(function(Buffer){module.exports=simpleGet;var concat=require("simple-concat");var http=require("http");var https=require("https");var once=require("once");var querystring=require("querystring");var decompressResponse=require("decompress-response");var url=require("url");function simpleGet(opts,cb){opts=typeof opts==="string"?{url:opts}:Object.assign({},opts);opts.headers=Object.assign({},opts.headers);cb=once(cb);if(opts.url)parseOptsUrl(opts);if(opts.maxRedirects==null)opts.maxRedirects=10;var body;if(opts.form)body=typeof opts.form==="string"?opts.form:querystring.stringify(opts.form);if(opts.body)body=opts.json&&!isStream(opts.body)?JSON.stringify(opts.body):opts.body;if(opts.json)opts.headers.accept="application/json";if(opts.json&&body)opts.headers["content-type"]="application/json";if(opts.form)opts.headers["content-type"]="application/x-www-form-urlencoded";if(body&&!isStream(body))opts.headers["content-length"]=Buffer.byteLength(body);delete opts.body;delete opts.form;if(body&&!opts.method)opts.method="POST";if(opts.method)opts.method=opts.method.toUpperCase();var customAcceptEncoding=Object.keys(opts.headers).some(function(h){return h.toLowerCase()==="accept-encoding";});if(!customAcceptEncoding)opts.headers["accept-encoding"]="gzip, deflate";var protocol=opts.protocol==="https:"?https:http;var req=protocol.request(opts,function(res){if(res.statusCode>=300&&res.statusCode<400&&"location"in res.headers){opts.url=res.headers.location;res.resume();if(opts.maxRedirects>0){opts.maxRedirects-=1;simpleGet(opts,cb);}else{cb(new Error("too many redirects"));}return;}var tryUnzip=typeof decompressResponse==="function"&&opts.method!=="HEAD";cb(null,tryUnzip?decompressResponse(res):res);});req.on("timeout",function(){req.abort();cb(new Error("Request timed out"));});req.on("error",cb);if(body&&isStream(body))body.on("error",cb).pipe(req);else req.end(body);return req;}simpleGet.concat=function(opts,cb){return simpleGet(opts,function(err,res){if(err)return cb(err);concat(res,function(err,data){if(err)return cb(err);if(opts.json){try{data=JSON.parse(data.toString());}catch(err){return cb(err,res,data);}}cb(null,res,data);});});};["get","post","put","patch","head","delete"].forEach(function(method){simpleGet[method]=function(opts,cb){if(typeof opts==="string")opts={url:opts};opts.method=method.toUpperCase();return simpleGet(opts,cb);};});function parseOptsUrl(opts){var loc=url.parse(opts.url);if(loc.hostname)opts.hostname=loc.hostname;if(loc.port)opts.port=loc.port;if(loc.protocol)opts.protocol=loc.protocol;if(loc.auth)opts.auth=loc.auth;opts.path=loc.path;delete opts.url;}function isStream(obj){return typeof obj.pipe==="function";}}).call(this,require("buffer").Buffer);},{buffer:41,"decompress-response":38,http:207,https:91,once:146,querystring:157,"simple-concat":179,url:236}],181:[function(require,module,exports){(function(Buffer){module.exports=Peer;var debug=require("debug")("simple-peer");var getBrowserRTC=require("get-browser-rtc");var inherits=require("inherits");var randombytes=require("randombytes");var stream=require("readable-stream");var MAX_BUFFERED_AMOUNT=64*1024;inherits(Peer,stream.Duplex);function Peer(opts){var self=this;if(!(self instanceof Peer))return new Peer(opts);self._id=randombytes(4).toString("hex").slice(0,7);self._debug("new peer %o",opts);opts=Object.assign({allowHalfOpen:false},opts);stream.Duplex.call(self,opts);self.channelName=opts.initiator?opts.channelName||randombytes(20).toString("hex"):null;self._isChromium=typeof window!=="undefined"&&!!window.webkitRTCPeerConnection;self.initiator=opts.initiator||false;self.channelConfig=opts.channelConfig||Peer.channelConfig;self.config=opts.config||Peer.config;self.constraints=self._transformConstraints(opts.constraints||Peer.constraints);self.offerConstraints=self._transformConstraints(opts.offerConstraints||{});self.answerConstraints=self._transformConstraints(opts.answerConstraints||{});self.reconnectTimer=opts.reconnectTimer||false;self.sdpTransform=opts.sdpTransform||function(sdp){return sdp;};self.stream=opts.stream||false;self.trickle=opts.trickle!==undefined?opts.trickle:true;self._earlyMessage=null;self.destroyed=false;self.connected=false;self.remoteAddress=undefined;self.remoteFamily=undefined;self.remotePort=undefined;self.localAddress=undefined;self.localPort=undefined;self._wrtc=opts.wrtc&&_typeof2(opts.wrtc)==="object"?opts.wrtc:getBrowserRTC();if(!self._wrtc){if(typeof window==="undefined"){throw new Error("No WebRTC support: Specify `opts.wrtc` option in this environment");}else{throw new Error("No WebRTC support: Not a supported browser");}}self._pcReady=false;self._channelReady=false;self._iceComplete=false;self._channel=null;self._pendingCandidates=[];self._previousStreams=[];self._chunk=null;self._cb=null;self._interval=null;self._reconnectTimeout=null;self._pc=new self._wrtc.RTCPeerConnection(self.config,self.constraints);self._isWrtc=Array.isArray(self._pc.RTCIceConnectionStates);self._isReactNativeWebrtc=typeof self._pc._peerConnectionId==="number";self._pc.oniceconnectionstatechange=function(){self._onIceStateChange();};self._pc.onicegatheringstatechange=function(){self._onIceStateChange();};self._pc.onsignalingstatechange=function(){self._onSignalingStateChange();};self._pc.onicecandidate=function(event){self._onIceCandidate(event);};if(self.initiator){var createdOffer=false;self._pc.onnegotiationneeded=function(){if(!createdOffer)self._createOffer();createdOffer=true;};self._setupData({channel:self._pc.createDataChannel(self.channelName,self.channelConfig)});}else{self._pc.ondatachannel=function(event){self._setupData(event);};}if("addTrack"in self._pc){if(self.stream){self.stream.getTracks().forEach(function(track){self._pc.addTrack(track,self.stream);});}self._pc.ontrack=function(event){self._onTrack(event);};}else{if(self.stream)self._pc.addStream(self.stream);self._pc.onaddstream=function(event){self._onAddStream(event);};}if(self.initiator&&self._isWrtc){self._pc.onnegotiationneeded();}self._onFinishBound=function(){self._onFinish();};self.once("finish",self._onFinishBound);}Peer.WEBRTC_SUPPORT=!!getBrowserRTC();Peer.config={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:global.stun.twilio.com:3478?transport=udp"}]};Peer.constraints={};Peer.channelConfig={};Object.defineProperty(Peer.prototype,"bufferSize",{get:function get(){var self=this;return self._channel&&self._channel.bufferedAmount||0;}});Peer.prototype.address=function(){var self=this;return{port:self.localPort,family:"IPv4",address:self.localAddress};};Peer.prototype.signal=function(data){var self=this;if(self.destroyed)throw new Error("cannot signal after peer is destroyed");if(typeof data==="string"){try{data=JSON.parse(data);}catch(err){data={};}}self._debug("signal()");if(data.candidate){if(self._pc.remoteDescription)self._addIceCandidate(data.candidate);else self._pendingCandidates.push(data.candidate);}if(data.sdp){self._pc.setRemoteDescription(new self._wrtc.RTCSessionDescription(data),function(){if(self.destroyed)return;self._pendingCandidates.forEach(function(candidate){self._addIceCandidate(candidate);});self._pendingCandidates=[];if(self._pc.remoteDescription.type==="offer")self._createAnswer();},function(err){self._destroy(err);});}if(!data.sdp&&!data.candidate){self._destroy(new Error("signal() called with invalid signal data"));}};Peer.prototype._addIceCandidate=function(candidate){var self=this;try{self._pc.addIceCandidate(new self._wrtc.RTCIceCandidate(candidate),noop,function(err){self._destroy(err);});}catch(err){self._destroy(new Error("error adding candidate: "+err.message));}};Peer.prototype.send=function(chunk){var self=this;if(self._isWrtc&&Buffer.isBuffer(chunk)){chunk=new Uint8Array(chunk);}self._channel.send(chunk);};Peer.prototype.destroy=function(onclose){var self=this;self._destroy(null,onclose);};Peer.prototype._destroy=function(err,onclose){var self=this;if(self.destroyed)return;if(onclose)self.once("close",onclose);self._debug("destroy (error: %s)",err&&(err.message||err));self.readable=self.writable=false;if(!self._readableState.ended)self.push(null);if(!self._writableState.finished)self.end();self.destroyed=true;self.connected=false;self._pcReady=false;self._channelReady=false;self._previousStreams=null;self._earlyMessage=null;clearInterval(self._interval);clearTimeout(self._reconnectTimeout);self._interval=null;self._reconnectTimeout=null;self._chunk=null;self._cb=null;if(self._onFinishBound)self.removeListener("finish",self._onFinishBound);self._onFinishBound=null;if(self._pc){try{self._pc.close();}catch(err){}self._pc.oniceconnectionstatechange=null;self._pc.onicegatheringstatechange=null;self._pc.onsignalingstatechange=null;self._pc.onicecandidate=null;if("addTrack"in self._pc){self._pc.ontrack=null;}else{self._pc.onaddstream=null;}self._pc.onnegotiationneeded=null;self._pc.ondatachannel=null;}if(self._channel){try{self._channel.close();}catch(err){}self._channel.onmessage=null;self._channel.onopen=null;self._channel.onclose=null;self._channel.onerror=null;}self._pc=null;self._channel=null;if(err)self.emit("error",err);self.emit("close");};Peer.prototype._setupData=function(event){var self=this;if(!event.channel){return self._destroy(new Error("Data channel event is missing `channel` property"));}self._channel=event.channel;self._channel.binaryType="arraybuffer";if(typeof self._channel.bufferedAmountLowThreshold==="number"){self._channel.bufferedAmountLowThreshold=MAX_BUFFERED_AMOUNT;}self.channelName=self._channel.label;self._channel.onmessage=function(event){if(!self._channelReady){self._earlyMessage=event;self._onChannelOpen();}else{self._onChannelMessage(event);}};self._channel.onbufferedamountlow=function(){self._onChannelBufferedAmountLow();};self._channel.onopen=function(){if(!self._channelReady)self._onChannelOpen();};self._channel.onclose=function(){self._onChannelClose();};self._channel.onerror=function(err){self._destroy(err);};};Peer.prototype._read=function(){};Peer.prototype._write=function(chunk,encoding,cb){var self=this;if(self.destroyed)return cb(new Error("cannot write after peer is destroyed"));if(self.connected){try{self.send(chunk);}catch(err){return self._destroy(err);}if(self._channel.bufferedAmount>MAX_BUFFERED_AMOUNT){self._debug("start backpressure: bufferedAmount %d",self._channel.bufferedAmount);self._cb=cb;}else{cb(null);}}else{self._debug("write before connect");self._chunk=chunk;self._cb=cb;}};Peer.prototype._onFinish=function(){var self=this;if(self.destroyed)return;if(self.connected){destroySoon();}else{self.once("connect",destroySoon);}function destroySoon(){setTimeout(function(){self._destroy();},1e3);}};Peer.prototype._createOffer=function(){var self=this;if(self.destroyed)return;self._pc.createOffer(function(offer){if(self.destroyed)return;offer.sdp=self.sdpTransform(offer.sdp);self._pc.setLocalDescription(offer,onSuccess,onError);function onSuccess(){if(self.destroyed)return;if(self.trickle||self._iceComplete)sendOffer();else self.once("_iceComplete",sendOffer);}function onError(err){self._destroy(err);}function sendOffer(){var signal=self._pc.localDescription||offer;self._debug("signal");self.emit("signal",{type:signal.type,sdp:signal.sdp});}},function(err){self._destroy(err);},self.offerConstraints);};Peer.prototype._createAnswer=function(){var self=this;if(self.destroyed)return;self._pc.createAnswer(function(answer){if(self.destroyed)return;answer.sdp=self.sdpTransform(answer.sdp);self._pc.setLocalDescription(answer,onSuccess,onError);function onSuccess(){if(self.destroyed)return;if(self.trickle||self._iceComplete)sendAnswer();else self.once("_iceComplete",sendAnswer);}function onError(err){self._destroy(err);}function sendAnswer(){var signal=self._pc.localDescription||answer;self._debug("signal");self.emit("signal",{type:signal.type,sdp:signal.sdp});}},function(err){self._destroy(err);},self.answerConstraints);};Peer.prototype._onIceStateChange=function(){var self=this;if(self.destroyed)return;var iceConnectionState=self._pc.iceConnectionState;var iceGatheringState=self._pc.iceGatheringState;self._debug("iceStateChange (connection: %s) (gathering: %s)",iceConnectionState,iceGatheringState);self.emit("iceStateChange",iceConnectionState,iceGatheringState);if(iceConnectionState==="connected"||iceConnectionState==="completed"){clearTimeout(self._reconnectTimeout);self._pcReady=true;self._maybeReady();}if(iceConnectionState==="disconnected"){if(self.reconnectTimer){clearTimeout(self._reconnectTimeout);self._reconnectTimeout=setTimeout(function(){self._destroy();},self.reconnectTimer);}else{self._destroy();}}if(iceConnectionState==="failed"){self._destroy(new Error("Ice connection failed."));}if(iceConnectionState==="closed"){self._destroy();}};Peer.prototype.getStats=function(cb){var self=this;if(self._pc.getStats.length===0){self._pc.getStats().then(function(res){var reports=[];res.forEach(function(report){reports.push(report);});cb(null,reports);},function(err){cb(err);});}else if(self._isReactNativeWebrtc){self._pc.getStats(null,function(res){var reports=[];res.forEach(function(report){reports.push(report);});cb(null,reports);},function(err){cb(err);});}else if(self._pc.getStats.length>0){self._pc.getStats(function(res){var reports=[];res.result().forEach(function(result){var report={};result.names().forEach(function(name){report[name]=result.stat(name);});report.id=result.id;report.type=result.type;report.timestamp=result.timestamp;reports.push(report);});cb(null,reports);},function(err){cb(err);});}else{cb(null,[]);}};Peer.prototype._maybeReady=function(){var self=this;self._debug("maybeReady pc %s channel %s",self._pcReady,self._channelReady);if(self.connected||self._connecting||!self._pcReady||!self._channelReady)return;self._connecting=true;self.getStats(function(err,items){if(self.destroyed)return;if(err)items=[];self._connecting=false;self.connected=true;var remoteCandidates={};var localCandidates={};var candidatePairs={};items.forEach(function(item){if(item.type==="remotecandidate"||item.type==="remote-candidate"){remoteCandidates[item.id]=item;}if(item.type==="localcandidate"||item.type==="local-candidate"){localCandidates[item.id]=item;}if(item.type==="candidatepair"||item.type==="candidate-pair"){candidatePairs[item.id]=item;}});items.forEach(function(item){if(item.type==="transport"){setSelectedCandidatePair(candidatePairs[item.selectedCandidatePairId]);}if(item.type==="googCandidatePair"&&item.googActiveConnection==="true"||(item.type==="candidatepair"||item.type==="candidate-pair")&&item.selected){setSelectedCandidatePair(item);}});function setSelectedCandidatePair(selectedCandidatePair){var local=localCandidates[selectedCandidatePair.localCandidateId];if(local&&local.ip){self.localAddress=local.ip;self.localPort=Number(local.port);}else if(local&&local.ipAddress){self.localAddress=local.ipAddress;self.localPort=Number(local.portNumber);}else if(typeof selectedCandidatePair.googLocalAddress==="string"){local=selectedCandidatePair.googLocalAddress.split(":");self.localAddress=local[0];self.localPort=Number(local[1]);}var remote=remoteCandidates[selectedCandidatePair.remoteCandidateId];if(remote&&remote.ip){self.remoteAddress=remote.ip;self.remotePort=Number(remote.port);}else if(remote&&remote.ipAddress){self.remoteAddress=remote.ipAddress;self.remotePort=Number(remote.portNumber);}else if(typeof selectedCandidatePair.googRemoteAddress==="string"){remote=selectedCandidatePair.googRemoteAddress.split(":");self.remoteAddress=remote[0];self.remotePort=Number(remote[1]);}self.remoteFamily="IPv4";self._debug("connect local: %s:%s remote: %s:%s",self.localAddress,self.localPort,self.remoteAddress,self.remotePort);}if(self._chunk){try{self.send(self._chunk);}catch(err){return self._destroy(err);}self._chunk=null;self._debug('sent chunk from "write before connect"');var cb=self._cb;self._cb=null;cb(null);}if(typeof self._channel.bufferedAmountLowThreshold!=="number"){self._interval=setInterval(function(){self._onInterval();},150);if(self._interval.unref)self._interval.unref();}self._debug("connect");self.emit("connect");if(self._earlyMessage){self._onChannelMessage(self._earlyMessage);self._earlyMessage=null;}});};Peer.prototype._onInterval=function(){if(!this._cb||!this._channel||this._channel.bufferedAmount>MAX_BUFFERED_AMOUNT){return;}this._onChannelBufferedAmountLow();};Peer.prototype._onSignalingStateChange=function(){var self=this;if(self.destroyed)return;self._debug("signalingStateChange %s",self._pc.signalingState);self.emit("signalingStateChange",self._pc.signalingState);};Peer.prototype._onIceCandidate=function(event){var self=this;if(self.destroyed)return;if(event.candidate&&self.trickle){self.emit("signal",{candidate:{candidate:event.candidate.candidate,sdpMLineIndex:event.candidate.sdpMLineIndex,sdpMid:event.candidate.sdpMid}});}else if(!event.candidate){self._iceComplete=true;self.emit("_iceComplete");}};Peer.prototype._onChannelMessage=function(event){var self=this;if(self.destroyed)return;var data=event.data;if(data instanceof ArrayBuffer)data=Buffer.from(data);self.push(data);};Peer.prototype._onChannelBufferedAmountLow=function(){var self=this;if(self.destroyed||!self._cb)return;self._debug("ending backpressure: bufferedAmount %d",self._channel.bufferedAmount);var cb=self._cb;self._cb=null;cb(null);};Peer.prototype._onChannelOpen=function(){var self=this;if(self.connected||self.destroyed)return;self._debug("on channel open");self._channelReady=true;self._maybeReady();};Peer.prototype._onChannelClose=function(){var self=this;if(self.destroyed)return;self._debug("on channel close");self._destroy();};Peer.prototype._onAddStream=function(event){var self=this;if(self.destroyed)return;self._debug("on add stream");self.emit("stream",event.stream);};Peer.prototype._onTrack=function(event){var self=this;if(self.destroyed)return;self._debug("on track");var id=event.streams[0].id;if(self._previousStreams.indexOf(id)!==-1)return;self._previousStreams.push(id);self.emit("stream",event.streams[0]);};Peer.prototype._debug=function(){var self=this;var args=[].slice.call(arguments);args[0]="["+self._id+"] "+args[0];debug.apply(null,args);};Peer.prototype._transformConstraints=function(constraints){var self=this;if(Object.keys(constraints).length===0){return constraints;}if((constraints.mandatory||constraints.optional)&&!self._isChromium){var newConstraints=Object.assign({},constraints.optional,constraints.mandatory);if(newConstraints.OfferToReceiveVideo!==undefined){newConstraints.offerToReceiveVideo=newConstraints.OfferToReceiveVideo;delete newConstraints["OfferToReceiveVideo"];}if(newConstraints.OfferToReceiveAudio!==undefined){newConstraints.offerToReceiveAudio=newConstraints.OfferToReceiveAudio;delete newConstraints["OfferToReceiveAudio"];}return newConstraints;}else if(!constraints.mandatory&&!constraints.optional&&self._isChromium){if(constraints.offerToReceiveVideo!==undefined){constraints.OfferToReceiveVideo=constraints.offerToReceiveVideo;delete constraints["offerToReceiveVideo"];}if(constraints.offerToReceiveAudio!==undefined){constraints.OfferToReceiveAudio=constraints.offerToReceiveAudio;delete constraints["offerToReceiveAudio"];}return{mandatory:constraints};}return constraints;};function noop(){}}).call(this,require("buffer").Buffer);},{buffer:41,debug:69,"get-browser-rtc":88,inherits:94,randombytes:159,"readable-stream":191}],182:[function(require,module,exports){arguments[4][10][0].apply(exports,arguments);},{dup:10}],183:[function(require,module,exports){arguments[4][11][0].apply(exports,arguments);},{"./_stream_readable":185,"./_stream_writable":187,"core-util-is":56,dup:11,inherits:94,"process-nextick-args":152}],184:[function(require,module,exports){arguments[4][12][0].apply(exports,arguments);},{"./_stream_transform":186,"core-util-is":56,dup:12,inherits:94}],185:[function(require,module,exports){arguments[4][13][0].apply(exports,arguments);},{"./_stream_duplex":183,"./internal/streams/BufferList":188,"./internal/streams/destroy":189,"./internal/streams/stream":190,_process:40,"core-util-is":56,dup:13,events:73,inherits:94,isarray:182,"process-nextick-args":152,"safe-buffer":177,"string_decoder/":192,util:38}],186:[function(require,module,exports){arguments[4][14][0].apply(exports,arguments);},{"./_stream_duplex":183,"core-util-is":56,dup:14,inherits:94}],187:[function(require,module,exports){arguments[4][15][0].apply(exports,arguments);},{"./_stream_duplex":183,"./internal/streams/destroy":189,"./internal/streams/stream":190,_process:40,"core-util-is":56,dup:15,inherits:94,"process-nextick-args":152,"safe-buffer":177,"util-deprecate":239}],188:[function(require,module,exports){arguments[4][16][0].apply(exports,arguments);},{dup:16,"safe-buffer":177}],189:[function(require,module,exports){arguments[4][17][0].apply(exports,arguments);},{dup:17,"process-nextick-args":152}],190:[function(require,module,exports){arguments[4][18][0].apply(exports,arguments);},{dup:18,events:73}],191:[function(require,module,exports){arguments[4][19][0].apply(exports,arguments);},{"./lib/_stream_duplex.js":183,"./lib/_stream_passthrough.js":184,"./lib/_stream_readable.js":185,"./lib/_stream_transform.js":186,"./lib/_stream_writable.js":187,dup:19}],192:[function(require,module,exports){arguments[4][20][0].apply(exports,arguments);},{dup:20,"safe-buffer":177}],193:[function(require,module,exports){var Rusha=require("rusha");var rusha=new Rusha();var scope=typeof window!=="undefined"?window:self;var crypto=scope.crypto||scope.msCrypto||{};var subtle=crypto.subtle||crypto.webkitSubtle;function sha1sync(buf){return rusha.digest(buf);}try{subtle.digest({name:"sha-1"},new Uint8Array()).catch(function(){subtle=false;});}catch(err){subtle=false;}function sha1(buf,cb){if(!subtle){setTimeout(cb,0,sha1sync(buf));return;}if(typeof buf==="string"){buf=uint8array(buf);}subtle.digest({name:"sha-1"},buf).then(function succeed(result){cb(hex(new Uint8Array(result)));},function fail(error){cb(sha1sync(buf));});}function uint8array(s){var l=s.length;var array=new Uint8Array(l);for(var i=0;i<l;i++){array[i]=s.charCodeAt(i);}return array;}function hex(buf){var l=buf.length;var chars=[];for(var i=0;i<l;i++){var bite=buf[i];chars.push((bite>>>4).toString(16));chars.push((bite&15).toString(16));}return chars.join("");}module.exports=sha1;module.exports.sync=sha1sync;},{rusha:176}],194:[function(require,module,exports){(function(process){module.exports=Socket;var Buffer=require("safe-buffer").Buffer;var debug=require("debug")("simple-websocket");var inherits=require("inherits");var randombytes=require("randombytes");var stream=require("readable-stream");var ws=require("ws");var _WebSocket=typeof ws!=="function"?WebSocket:ws;var MAX_BUFFERED_AMOUNT=64*1024;inherits(Socket,stream.Duplex);function Socket(opts){var self=this;if(!(self instanceof Socket))return new Socket(opts);if(!opts)opts={};if(typeof opts==="string"){opts={url:opts};}if(opts.url==null&&opts.socket==null){throw new Error("Missing required `url` or `socket` option");}if(opts.url!=null&&opts.socket!=null){throw new Error("Must specify either `url` or `socket` option, not both");}self._id=randombytes(4).toString("hex").slice(0,7);self._debug("new websocket: %o",opts);opts=Object.assign({allowHalfOpen:false},opts);stream.Duplex.call(self,opts);self.connected=false;self.destroyed=false;self._chunk=null;self._cb=null;self._interval=null;if(opts.socket){self.url=opts.socket.url;self._ws=opts.socket;}else{self.url=opts.url;try{if(typeof ws==="function"){self._ws=new _WebSocket(opts.url,opts);}else{self._ws=new _WebSocket(opts.url);}}catch(err){process.nextTick(function(){self._destroy(err);});return;}}self._ws.binaryType="arraybuffer";self._ws.onopen=function(){self._onOpen();};self._ws.onmessage=function(event){self._onMessage(event);};self._ws.onclose=function(){self._onClose();};self._ws.onerror=function(){self._destroy(new Error("connection error to "+self.url));};self._onFinishBound=function(){self._onFinish();};self.once("finish",self._onFinishBound);}Socket.WEBSOCKET_SUPPORT=!!_WebSocket;Socket.prototype.send=function(chunk){this._ws.send(chunk);};Socket.prototype.destroy=function(onclose){this._destroy(null,onclose);};Socket.prototype._destroy=function(err,onclose){var self=this;if(self.destroyed)return;if(onclose)self.once("close",onclose);self._debug("destroy (error: %s)",err&&(err.message||err));self.readable=self.writable=false;if(!self._readableState.ended)self.push(null);if(!self._writableState.finished)self.end();self.connected=false;self.destroyed=true;clearInterval(self._interval);self._interval=null;self._chunk=null;self._cb=null;if(self._onFinishBound)self.removeListener("finish",self._onFinishBound);self._onFinishBound=null;if(self._ws){var ws=self._ws;var onClose=function onClose(){ws.onclose=null;};if(ws.readyState===_WebSocket.CLOSED){onClose();}else{try{ws.onclose=onClose;ws.close();}catch(err){onClose();}}ws.onopen=null;ws.onmessage=null;ws.onerror=null;}self._ws=null;if(err)self.emit("error",err);self.emit("close");};Socket.prototype._read=function(){};Socket.prototype._write=function(chunk,encoding,cb){if(this.destroyed)return cb(new Error("cannot write after socket is destroyed"));if(this.connected){try{this.send(chunk);}catch(err){return this._destroy(err);}if(typeof ws!=="function"&&this._ws.bufferedAmount>MAX_BUFFERED_AMOUNT){this._debug("start backpressure: bufferedAmount %d",this._ws.bufferedAmount);this._cb=cb;}else{cb(null);}}else{this._debug("write before connect");this._chunk=chunk;this._cb=cb;}};Socket.prototype._onFinish=function(){var self=this;if(self.destroyed)return;if(self.connected){destroySoon();}else{self.once("connect",destroySoon);}function destroySoon(){setTimeout(function(){self._destroy();},1e3);}};Socket.prototype._onMessage=function(event){if(this.destroyed)return;var data=event.data;if(data instanceof ArrayBuffer)data=Buffer.from(data);this.push(data);};Socket.prototype._onOpen=function(){var self=this;if(self.connected||self.destroyed)return;self.connected=true;if(self._chunk){try{self.send(self._chunk);}catch(err){return self._destroy(err);}self._chunk=null;self._debug('sent chunk from "write before connect"');var cb=self._cb;self._cb=null;cb(null);}if(typeof ws!=="function"){self._interval=setInterval(function(){self._onInterval();},150);if(self._interval.unref)self._interval.unref();}self._debug("connect");self.emit("connect");};Socket.prototype._onInterval=function(){if(!this._cb||!this._ws||this._ws.bufferedAmount>MAX_BUFFERED_AMOUNT){return;}this._debug("ending backpressure: bufferedAmount %d",this._ws.bufferedAmount);var cb=this._cb;this._cb=null;cb(null);};Socket.prototype._onClose=function(){if(this.destroyed)return;this._debug("on close");this._destroy();};Socket.prototype._debug=function(){var args=[].slice.call(arguments);args[0]="["+this._id+"] "+args[0];debug.apply(null,args);};}).call(this,require("_process"));},{_process:40,debug:69,inherits:94,randombytes:159,"readable-stream":204,"safe-buffer":177,ws:38}],195:[function(require,module,exports){arguments[4][10][0].apply(exports,arguments);},{dup:10}],196:[function(require,module,exports){arguments[4][11][0].apply(exports,arguments);},{"./_stream_readable":198,"./_stream_writable":200,"core-util-is":56,dup:11,inherits:94,"process-nextick-args":152}],197:[function(require,module,exports){arguments[4][12][0].apply(exports,arguments);},{"./_stream_transform":199,"core-util-is":56,dup:12,inherits:94}],198:[function(require,module,exports){arguments[4][13][0].apply(exports,arguments);},{"./_stream_duplex":196,"./internal/streams/BufferList":201,"./internal/streams/destroy":202,"./internal/streams/stream":203,_process:40,"core-util-is":56,dup:13,events:73,inherits:94,isarray:195,"process-nextick-args":152,"safe-buffer":177,"string_decoder/":205,util:38}],199:[function(require,module,exports){arguments[4][14][0].apply(exports,arguments);},{"./_stream_duplex":196,"core-util-is":56,dup:14,inherits:94}],200:[function(require,module,exports){arguments[4][15][0].apply(exports,arguments);},{"./_stream_duplex":196,"./internal/streams/destroy":202,"./internal/streams/stream":203,_process:40,"core-util-is":56,dup:15,inherits:94,"process-nextick-args":152,"safe-buffer":177,"util-deprecate":239}],201:[function(require,module,exports){arguments[4][16][0].apply(exports,arguments);},{dup:16,"safe-buffer":177}],202:[function(require,module,exports){arguments[4][17][0].apply(exports,arguments);},{dup:17,"process-nextick-args":152}],203:[function(require,module,exports){arguments[4][18][0].apply(exports,arguments);},{dup:18,events:73}],204:[function(require,module,exports){arguments[4][19][0].apply(exports,arguments);},{"./lib/_stream_duplex.js":196,"./lib/_stream_passthrough.js":197,"./lib/_stream_readable.js":198,"./lib/_stream_transform.js":199,"./lib/_stream_writable.js":200,dup:19}],205:[function(require,module,exports){arguments[4][20][0].apply(exports,arguments);},{dup:20,"safe-buffer":177}],206:[function(require,module,exports){var tick=1;var maxTick=65535;var resolution=4;var inc=function inc(){tick=tick+1&maxTick;};var timer=setInterval(inc,1e3/resolution|0);if(timer.unref)timer.unref();module.exports=function(seconds){var size=resolution*(seconds||5);var buffer=[0];var pointer=1;var last=tick-1&maxTick;return function(delta){var dist=tick-last&maxTick;if(dist>size)dist=size;last=tick;while(dist--){if(pointer===size)pointer=0;buffer[pointer]=buffer[pointer===0?size-1:pointer-1];pointer++;}if(delta)buffer[pointer-1]+=delta;var top=buffer[pointer-1];var btm=buffer.length<size?0:buffer[pointer===size?0:pointer];return buffer.length<resolution?top:(top-btm)*resolution/buffer.length;};};},{}],207:[function(require,module,exports){(function(global){var ClientRequest=require("./lib/request");var extend=require("xtend");var statusCodes=require("builtin-status-codes");var url=require("url");var http=exports;http.request=function(opts,cb){if(typeof opts==="string")opts=url.parse(opts);else opts=extend(opts);var defaultProtocol=global.location.protocol.search(/^https?:$/)===-1?"http:":"";var protocol=opts.protocol||defaultProtocol;var host=opts.hostname||opts.host;var port=opts.port;var path=opts.path||"/";if(host&&host.indexOf(":")!==-1)host="["+host+"]";opts.url=(host?protocol+"//"+host:"")+(port?":"+port:"")+path;opts.method=(opts.method||"GET").toUpperCase();opts.headers=opts.headers||{};var req=new ClientRequest(opts);if(cb)req.on("response",cb);return req;};http.get=function get(opts,cb){var req=http.request(opts,cb);req.end();return req;};http.Agent=function(){};http.Agent.defaultMaxSockets=4;http.STATUS_CODES=statusCodes;http.METHODS=["CHECKOUT","CONNECT","COPY","DELETE","GET","HEAD","LOCK","M-SEARCH","MERGE","MKACTIVITY","MKCOL","MOVE","NOTIFY","OPTIONS","PATCH","POST","PROPFIND","PROPPATCH","PURGE","PUT","REPORT","SEARCH","SUBSCRIBE","TRACE","UNLOCK","UNSUBSCRIBE"];}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{});},{"./lib/request":209,"builtin-status-codes":42,url:236,xtend:372}],208:[function(require,module,exports){(function(global){exports.fetch=isFunction(global.fetch)&&isFunction(global.ReadableStream);exports.blobConstructor=false;try{new Blob([new ArrayBuffer(1)]);exports.blobConstructor=true;}catch(e){}var xhr;function getXHR(){if(xhr!==undefined)return xhr;if(global.XMLHttpRequest){xhr=new global.XMLHttpRequest();try{xhr.open("GET",global.XDomainRequest?"/":"https://example.com");}catch(e){xhr=null;}}else{xhr=null;}return xhr;}function checkTypeSupport(type){var xhr=getXHR();if(!xhr)return false;try{xhr.responseType=type;return xhr.responseType===type;}catch(e){}return false;}var haveArrayBuffer=typeof global.ArrayBuffer!=="undefined";var haveSlice=haveArrayBuffer&&isFunction(global.ArrayBuffer.prototype.slice);exports.arraybuffer=exports.fetch||haveArrayBuffer&&checkTypeSupport("arraybuffer");exports.msstream=!exports.fetch&&haveSlice&&checkTypeSupport("ms-stream");exports.mozchunkedarraybuffer=!exports.fetch&&haveArrayBuffer&&checkTypeSupport("moz-chunked-arraybuffer");exports.overrideMimeType=exports.fetch||(getXHR()?isFunction(getXHR().overrideMimeType):false);exports.vbArray=isFunction(global.VBArray);function isFunction(value){return typeof value==="function";}xhr=null;}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{});},{}],209:[function(require,module,exports){(function(process,global,Buffer){var capability=require("./capability");var inherits=require("inherits");var response=require("./response");var stream=require("readable-stream");var toArrayBuffer=require("to-arraybuffer");var IncomingMessage=response.IncomingMessage;var rStates=response.readyStates;function decideMode(preferBinary,useFetch){if(capability.fetch&&useFetch){return"fetch";}else if(capability.mozchunkedarraybuffer){return"moz-chunked-arraybuffer";}else if(capability.msstream){return"ms-stream";}else if(capability.arraybuffer&&preferBinary){return"arraybuffer";}else if(capability.vbArray&&preferBinary){return"text:vbarray";}else{return"text";}}var ClientRequest=module.exports=function(opts){var self=this;stream.Writable.call(self);self._opts=opts;self._body=[];self._headers={};if(opts.auth)self.setHeader("Authorization","Basic "+new Buffer(opts.auth).toString("base64"));Object.keys(opts.headers).forEach(function(name){self.setHeader(name,opts.headers[name]);});var preferBinary;var useFetch=true;if(opts.mode==="disable-fetch"||"timeout"in opts){useFetch=false;preferBinary=true;}else if(opts.mode==="prefer-streaming"){preferBinary=false;}else if(opts.mode==="allow-wrong-content-type"){preferBinary=!capability.overrideMimeType;}else if(!opts.mode||opts.mode==="default"||opts.mode==="prefer-fast"){preferBinary=true;}else{throw new Error("Invalid value for opts.mode");}self._mode=decideMode(preferBinary,useFetch);self.on("finish",function(){self._onFinish();});};inherits(ClientRequest,stream.Writable);ClientRequest.prototype.setHeader=function(name,value){var self=this;var lowerName=name.toLowerCase();if(unsafeHeaders.indexOf(lowerName)!==-1)return;self._headers[lowerName]={name:name,value:value};};ClientRequest.prototype.getHeader=function(name){var header=this._headers[name.toLowerCase()];if(header)return header.value;return null;};ClientRequest.prototype.removeHeader=function(name){var self=this;delete self._headers[name.toLowerCase()];};ClientRequest.prototype._onFinish=function(){var self=this;if(self._destroyed)return;var opts=self._opts;var headersObj=self._headers;var body=null;if(opts.method!=="GET"&&opts.method!=="HEAD"){if(capability.blobConstructor){body=new global.Blob(self._body.map(function(buffer){return toArrayBuffer(buffer);}),{type:(headersObj["content-type"]||{}).value||""});}else{body=Buffer.concat(self._body).toString();}}var headersList=[];Object.keys(headersObj).forEach(function(keyName){var name=headersObj[keyName].name;var value=headersObj[keyName].value;if(Array.isArray(value)){value.forEach(function(v){headersList.push([name,v]);});}else{headersList.push([name,value]);}});if(self._mode==="fetch"){global.fetch(self._opts.url,{method:self._opts.method,headers:headersList,body:body||undefined,mode:"cors",credentials:opts.withCredentials?"include":"same-origin"}).then(function(response){self._fetchResponse=response;self._connect();},function(reason){self.emit("error",reason);});}else{var xhr=self._xhr=new global.XMLHttpRequest();try{xhr.open(self._opts.method,self._opts.url,true);}catch(err){process.nextTick(function(){self.emit("error",err);});return;}if("responseType"in xhr)xhr.responseType=self._mode.split(":")[0];if("withCredentials"in xhr)xhr.withCredentials=!!opts.withCredentials;if(self._mode==="text"&&"overrideMimeType"in xhr)xhr.overrideMimeType("text/plain; charset=x-user-defined");if("timeout"in opts){xhr.timeout=opts.timeout;xhr.ontimeout=function(){self.emit("timeout");};}headersList.forEach(function(header){xhr.setRequestHeader(header[0],header[1]);});self._response=null;xhr.onreadystatechange=function(){switch(xhr.readyState){case rStates.LOADING:case rStates.DONE:self._onXHRProgress();break;}};if(self._mode==="moz-chunked-arraybuffer"){xhr.onprogress=function(){self._onXHRProgress();};}xhr.onerror=function(){if(self._destroyed)return;self.emit("error",new Error("XHR error"));};try{xhr.send(body);}catch(err){process.nextTick(function(){self.emit("error",err);});return;}}};function statusValid(xhr){try{var status=xhr.status;return status!==null&&status!==0;}catch(e){return false;}}ClientRequest.prototype._onXHRProgress=function(){var self=this;if(!statusValid(self._xhr)||self._destroyed)return;if(!self._response)self._connect();self._response._onXHRProgress();};ClientRequest.prototype._connect=function(){var self=this;if(self._destroyed)return;self._response=new IncomingMessage(self._xhr,self._fetchResponse,self._mode);self._response.on("error",function(err){self.emit("error",err);});self.emit("response",self._response);};ClientRequest.prototype._write=function(chunk,encoding,cb){var self=this;self._body.push(chunk);cb();};ClientRequest.prototype.abort=ClientRequest.prototype.destroy=function(){var self=this;self._destroyed=true;if(self._response)self._response._destroyed=true;if(self._xhr)self._xhr.abort();};ClientRequest.prototype.end=function(data,encoding,cb){var self=this;if(typeof data==="function"){cb=data;data=undefined;}stream.Writable.prototype.end.call(self,data,encoding,cb);};ClientRequest.prototype.flushHeaders=function(){};ClientRequest.prototype.setTimeout=function(){};ClientRequest.prototype.setNoDelay=function(){};ClientRequest.prototype.setSocketKeepAlive=function(){};var unsafeHeaders=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","date","dnt","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","user-agent","via"];}).call(this,require("_process"),typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{},require("buffer").Buffer);},{"./capability":208,"./response":210,_process:40,buffer:41,inherits:94,"readable-stream":220,"to-arraybuffer":227}],210:[function(require,module,exports){(function(process,global,Buffer){var capability=require("./capability");var inherits=require("inherits");var stream=require("readable-stream");var rStates=exports.readyStates={UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4};var IncomingMessage=exports.IncomingMessage=function(xhr,response,mode){var self=this;stream.Readable.call(self);self._mode=mode;self.headers={};self.rawHeaders=[];self.trailers={};self.rawTrailers=[];self.on("end",function(){process.nextTick(function(){self.emit("close");});});if(mode==="fetch"){var read=function read(){reader.read().then(function(result){if(self._destroyed)return;if(result.done){self.push(null);return;}self.push(new Buffer(result.value));read();}).catch(function(err){self.emit("error",err);});};self._fetchResponse=response;self.url=response.url;self.statusCode=response.status;self.statusMessage=response.statusText;response.headers.forEach(function(header,key){self.headers[key.toLowerCase()]=header;self.rawHeaders.push(key,header);});var reader=response.body.getReader();read();}else{self._xhr=xhr;self._pos=0;self.url=xhr.responseURL;self.statusCode=xhr.status;self.statusMessage=xhr.statusText;var headers=xhr.getAllResponseHeaders().split(/\r?\n/);headers.forEach(function(header){var matches=header.match(/^([^:]+):\s*(.*)/);if(matches){var key=matches[1].toLowerCase();if(key==="set-cookie"){if(self.headers[key]===undefined){self.headers[key]=[];}self.headers[key].push(matches[2]);}else if(self.headers[key]!==undefined){self.headers[key]+=", "+matches[2];}else{self.headers[key]=matches[2];}self.rawHeaders.push(matches[1],matches[2]);}});self._charset="x-user-defined";if(!capability.overrideMimeType){var mimeType=self.rawHeaders["mime-type"];if(mimeType){var charsetMatch=mimeType.match(/;\s*charset=([^;])(;|$)/);if(charsetMatch){self._charset=charsetMatch[1].toLowerCase();}}if(!self._charset)self._charset="utf-8";}}};inherits(IncomingMessage,stream.Readable);IncomingMessage.prototype._read=function(){};IncomingMessage.prototype._onXHRProgress=function(){var self=this;var xhr=self._xhr;var response=null;switch(self._mode){case"text:vbarray":if(xhr.readyState!==rStates.DONE)break;try{response=new global.VBArray(xhr.responseBody).toArray();}catch(e){}if(response!==null){self.push(new Buffer(response));break;}case"text":try{response=xhr.responseText;}catch(e){self._mode="text:vbarray";break;}if(response.length>self._pos){var newData=response.substr(self._pos);if(self._charset==="x-user-defined"){var buffer=new Buffer(newData.length);for(var i=0;i<newData.length;i++){buffer[i]=newData.charCodeAt(i)&255;}self.push(buffer);}else{self.push(newData,self._charset);}self._pos=response.length;}break;case"arraybuffer":if(xhr.readyState!==rStates.DONE||!xhr.response)break;response=xhr.response;self.push(new Buffer(new Uint8Array(response)));break;case"moz-chunked-arraybuffer":response=xhr.response;if(xhr.readyState!==rStates.LOADING||!response)break;self.push(new Buffer(new Uint8Array(response)));break;case"ms-stream":response=xhr.response;if(xhr.readyState!==rStates.LOADING)break;var reader=new global.MSStreamReader();reader.onprogress=function(){if(reader.result.byteLength>self._pos){self.push(new Buffer(new Uint8Array(reader.result.slice(self._pos))));self._pos=reader.result.byteLength;}};reader.onload=function(){self.push(null);};reader.readAsArrayBuffer(response);break;}if(self._xhr.readyState===rStates.DONE&&self._mode!=="ms-stream"){self.push(null);}};}).call(this,require("_process"),typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{},require("buffer").Buffer);},{"./capability":208,_process:40,buffer:41,inherits:94,"readable-stream":220}],211:[function(require,module,exports){arguments[4][10][0].apply(exports,arguments);},{dup:10}],212:[function(require,module,exports){arguments[4][11][0].apply(exports,arguments);},{"./_stream_readable":214,"./_stream_writable":216,"core-util-is":56,dup:11,inherits:94,"process-nextick-args":152}],213:[function(require,module,exports){arguments[4][12][0].apply(exports,arguments);},{"./_stream_transform":215,"core-util-is":56,dup:12,inherits:94}],214:[function(require,module,exports){arguments[4][13][0].apply(exports,arguments);},{"./_stream_duplex":212,"./internal/streams/BufferList":217,"./internal/streams/destroy":218,"./internal/streams/stream":219,_process:40,"core-util-is":56,dup:13,events:73,inherits:94,isarray:211,"process-nextick-args":152,"safe-buffer":177,"string_decoder/":221,util:38}],215:[function(require,module,exports){arguments[4][14][0].apply(exports,arguments);},{"./_stream_duplex":212,"core-util-is":56,dup:14,inherits:94}],216:[function(require,module,exports){arguments[4][15][0].apply(exports,arguments);},{"./_stream_duplex":212,"./internal/streams/destroy":218,"./internal/streams/stream":219,_process:40,"core-util-is":56,dup:15,inherits:94,"process-nextick-args":152,"safe-buffer":177,"util-deprecate":239}],217:[function(require,module,exports){arguments[4][16][0].apply(exports,arguments);},{dup:16,"safe-buffer":177}],218:[function(require,module,exports){arguments[4][17][0].apply(exports,arguments);},{dup:17,"process-nextick-args":152}],219:[function(require,module,exports){arguments[4][18][0].apply(exports,arguments);},{dup:18,events:73}],220:[function(require,module,exports){arguments[4][19][0].apply(exports,arguments);},{"./lib/_stream_duplex.js":212,"./lib/_stream_passthrough.js":213,"./lib/_stream_readable.js":214,"./lib/_stream_transform.js":215,"./lib/_stream_writable.js":216,dup:19}],221:[function(require,module,exports){arguments[4][20][0].apply(exports,arguments);},{dup:20,"safe-buffer":177}],222:[function(require,module,exports){var getBlob=require("stream-to-blob");module.exports=function getBlobURL(stream,mimeType,cb){if(typeof mimeType==="function")return getBlobURL(stream,null,mimeType);getBlob(stream,mimeType,function(err,blob){if(err)return cb(err);var url=URL.createObjectURL(blob);cb(null,url);});};},{"stream-to-blob":223}],223:[function(require,module,exports){var once=require("once");module.exports=function getBlob(stream,mimeType,cb){if(typeof mimeType==="function")return getBlob(stream,null,mimeType);cb=once(cb);var chunks=[];stream.on("data",function(chunk){chunks.push(chunk);}).on("end",function(){var blob=mimeType?new Blob(chunks,{type:mimeType}):new Blob(chunks);cb(null,blob);}).on("error",cb);};},{once:146}],224:[function(require,module,exports){(function(Buffer){var once=require("once");module.exports=function getBuffer(stream,length,cb){cb=once(cb);var buf=new Buffer(length);var offset=0;stream.on("data",function(chunk){chunk.copy(buf,offset);offset+=chunk.length;}).on("end",function(){cb(null,buf);}).on("error",cb);};}).call(this,require("buffer").Buffer);},{buffer:41,once:146}],225:[function(require,module,exports){var base32=require("./thirty-two");exports.encode=base32.encode;exports.decode=base32.decode;},{"./thirty-two":226}],226:[function(require,module,exports){(function(Buffer){"use strict";var charTable="ABCDEFGHIJKLMNOPQRSTUVWXYZ234567";var byteTable=[255,255,26,27,28,29,30,31,255,255,255,255,255,255,255,255,255,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,255,255,255,255,255,255,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,255,255,255,255,255];function quintetCount(buff){var quintets=Math.floor(buff.length/5);return buff.length%5===0?quintets:quintets+1;}exports.encode=function(plain){if(!Buffer.isBuffer(plain)){plain=new Buffer(plain);}var i=0;var j=0;var shiftIndex=0;var digit=0;var encoded=new Buffer(quintetCount(plain)*8);while(i<plain.length){var current=plain[i];if(shiftIndex>3){digit=current&255>>shiftIndex;shiftIndex=(shiftIndex+5)%8;digit=digit<<shiftIndex|(i+1<plain.length?plain[i+1]:0)>>8-shiftIndex;i++;}else{digit=current>>8-(shiftIndex+5)&31;shiftIndex=(shiftIndex+5)%8;if(shiftIndex===0)i++;}encoded[j]=charTable.charCodeAt(digit);j++;}for(i=j;i<encoded.length;i++){encoded[i]=61;}return encoded;};exports.decode=function(encoded){var shiftIndex=0;var plainDigit=0;var plainChar;var plainPos=0;if(!Buffer.isBuffer(encoded)){encoded=new Buffer(encoded);}var decoded=new Buffer(Math.ceil(encoded.length*5/8));for(var i=0;i<encoded.length;i++){if(encoded[i]===61){break;}var encodedByte=encoded[i]-48;if(encodedByte<byteTable.length){plainDigit=byteTable[encodedByte];if(shiftIndex<=3){shiftIndex=(shiftIndex+5)%8;if(shiftIndex===0){plainChar|=plainDigit;decoded[plainPos]=plainChar;plainPos++;plainChar=0;}else{plainChar|=255&plainDigit<<8-shiftIndex;}}else{shiftIndex=(shiftIndex+5)%8;plainChar|=255&plainDigit>>>shiftIndex;decoded[plainPos]=plainChar;plainPos++;plainChar=255&plainDigit<<8-shiftIndex;}}else{throw new Error("Invalid input - it is not base32 encoded string");}}return decoded.slice(0,plainPos);};}).call(this,require("buffer").Buffer);},{buffer:41}],227:[function(require,module,exports){var Buffer=require("buffer").Buffer;module.exports=function(buf){if(buf instanceof Uint8Array){if(buf.byteOffset===0&&buf.byteLength===buf.buffer.byteLength){return buf.buffer;}else if(typeof buf.buffer.slice==="function"){return buf.buffer.slice(buf.byteOffset,buf.byteOffset+buf.byteLength);}}if(Buffer.isBuffer(buf)){var arrayCopy=new Uint8Array(buf.length);var len=buf.length;for(var i=0;i<len;i++){arrayCopy[i]=buf[i];}return arrayCopy.buffer;}else{throw new Error("Argument must be a Buffer");}};},{buffer:41}],228:[function(require,module,exports){(function(process){module.exports=Discovery;var debug=require("debug")("torrent-discovery");var DHT=require("bittorrent-dht/client");var EventEmitter=require("events").EventEmitter;var extend=require("xtend");var inherits=require("inherits");var parallel=require("run-parallel");var Tracker=require("bittorrent-tracker/client");inherits(Discovery,EventEmitter);function Discovery(opts){var self=this;if(!(self instanceof Discovery))return new Discovery(opts);EventEmitter.call(self);if(!opts.peerId)throw new Error("Option `peerId` is required");if(!opts.infoHash)throw new Error("Option `infoHash` is required");if(!process.browser&&!opts.port)throw new Error("Option `port` is required");self.peerId=typeof opts.peerId==="string"?opts.peerId:opts.peerId.toString("hex");self.infoHash=typeof opts.infoHash==="string"?opts.infoHash:opts.infoHash.toString("hex");self._port=opts.port;self._userAgent=opts.userAgent;self.destroyed=false;self._announce=opts.announce||[];self._intervalMs=opts.intervalMs||15*60*1e3;self._trackerOpts=null;self._dhtAnnouncing=false;self._dhtTimeout=false;self._internalDHT=false;self._onWarning=function(err){self.emit("warning",err);};self._onError=function(err){self.emit("error",err);};self._onDHTPeer=function(peer,infoHash){if(infoHash.toString("hex")!==self.infoHash)return;self.emit("peer",peer.host+":"+peer.port,"dht");};self._onTrackerPeer=function(peer){self.emit("peer",peer,"tracker");};self._onTrackerAnnounce=function(){self.emit("trackerAnnounce");};if(opts.tracker===false){self.tracker=null;}else if(opts.tracker&&_typeof2(opts.tracker)==="object"){self._trackerOpts=extend(opts.tracker);self.tracker=self._createTracker();}else{self.tracker=self._createTracker();}if(opts.dht===false||typeof DHT!=="function"){self.dht=null;}else if(opts.dht&&typeof opts.dht.addNode==="function"){self.dht=opts.dht;}else if(opts.dht&&_typeof2(opts.dht)==="object"){self.dht=createDHT(opts.dhtPort,opts.dht);}else{self.dht=createDHT(opts.dhtPort);}if(self.dht){self.dht.on("peer",self._onDHTPeer);self._dhtAnnounce();}function createDHT(port,opts){var dht=new DHT(opts);dht.on("warning",self._onWarning);dht.on("error",self._onError);dht.listen(port);self._internalDHT=true;return dht;}}Discovery.prototype.updatePort=function(port){var self=this;if(port===self._port)return;self._port=port;if(self.dht)self._dhtAnnounce();if(self.tracker){self.tracker.stop();self.tracker.destroy(function(){self.tracker=self._createTracker();});}};Discovery.prototype.complete=function(opts){if(this.tracker){this.tracker.complete(opts);}};Discovery.prototype.destroy=function(cb){var self=this;if(self.destroyed)return;self.destroyed=true;clearTimeout(self._dhtTimeout);var tasks=[];if(self.tracker){self.tracker.stop();self.tracker.removeListener("warning",self._onWarning);self.tracker.removeListener("error",self._onError);self.tracker.removeListener("peer",self._onTrackerPeer);self.tracker.removeListener("update",self._onTrackerAnnounce);tasks.push(function(cb){self.tracker.destroy(cb);});}if(self.dht){self.dht.removeListener("peer",self._onDHTPeer);}if(self._internalDHT){self.dht.removeListener("warning",self._onWarning);self.dht.removeListener("error",self._onError);tasks.push(function(cb){self.dht.destroy(cb);});}parallel(tasks,cb);self.dht=null;self.tracker=null;self._announce=null;};Discovery.prototype._createTracker=function(){var opts=extend(this._trackerOpts,{infoHash:this.infoHash,announce:this._announce,peerId:this.peerId,port:this._port,userAgent:this._userAgent});var tracker=new Tracker(opts);tracker.on("warning",this._onWarning);tracker.on("error",this._onError);tracker.on("peer",this._onTrackerPeer);tracker.on("update",this._onTrackerAnnounce);tracker.setInterval(this._intervalMs);tracker.start();return tracker;};Discovery.prototype._dhtAnnounce=function(){var self=this;if(self._dhtAnnouncing)return;debug("dht announce");self._dhtAnnouncing=true;clearTimeout(self._dhtTimeout);self.dht.announce(self.infoHash,self._port,function(err){self._dhtAnnouncing=false;debug("dht announce complete");if(err)self.emit("warning",err);self.emit("dhtAnnounce");if(!self.destroyed){self._dhtTimeout=setTimeout(function(){self._dhtAnnounce();},getRandomTimeout());if(self._dhtTimeout.unref)self._dhtTimeout.unref();}});function getRandomTimeout(){return self._intervalMs+Math.floor(Math.random()*self._intervalMs/5);}};}).call(this,require("_process"));},{_process:40,"bittorrent-dht/client":38,"bittorrent-tracker/client":21,debug:69,events:73,inherits:94,"run-parallel":175,xtend:372}],229:[function(require,module,exports){(function(Buffer){module.exports=Piece;var BLOCK_LENGTH=1<<14;function Piece(length){if(!(this instanceof Piece))return new Piece(length);this.length=length;this.missing=length;this.sources=null;this._chunks=Math.ceil(length/BLOCK_LENGTH);this._remainder=length%BLOCK_LENGTH||BLOCK_LENGTH;this._buffered=0;this._buffer=null;this._cancellations=null;this._reservations=0;this._flushed=false;}Piece.BLOCK_LENGTH=BLOCK_LENGTH;Piece.prototype.chunkLength=function(i){return i===this._chunks-1?this._remainder:BLOCK_LENGTH;};Piece.prototype.chunkLengthRemaining=function(i){return this.length-i*BLOCK_LENGTH;};Piece.prototype.chunkOffset=function(i){return i*BLOCK_LENGTH;};Piece.prototype.reserve=function(){if(!this.init())return-1;if(this._cancellations.length)return this._cancellations.pop();if(this._reservations<this._chunks)return this._reservations++;return-1;};Piece.prototype.reserveRemaining=function(){if(!this.init())return-1;if(this._reservations<this._chunks){var min=this._reservations;this._reservations=this._chunks;return min;}return-1;};Piece.prototype.cancel=function(i){if(!this.init())return;this._cancellations.push(i);};Piece.prototype.cancelRemaining=function(i){if(!this.init())return;this._reservations=i;};Piece.prototype.get=function(i){if(!this.init())return null;return this._buffer[i];};Piece.prototype.set=function(i,data,source){if(!this.init())return false;var len=data.length;var blocks=Math.ceil(len/BLOCK_LENGTH);for(var j=0;j<blocks;j++){if(!this._buffer[i+j]){var offset=j*BLOCK_LENGTH;var splitData=data.slice(offset,offset+BLOCK_LENGTH);this._buffered++;this._buffer[i+j]=splitData;this.missing-=splitData.length;if(this.sources.indexOf(source)===-1){this.sources.push(source);}}}return this._buffered===this._chunks;};Piece.prototype.flush=function(){if(!this._buffer||this._chunks!==this._buffered)return null;var buffer=Buffer.concat(this._buffer,this.length);this._buffer=null;this._cancellations=null;this.sources=null;this._flushed=true;return buffer;};Piece.prototype.init=function(){if(this._flushed)return false;if(this._buffer)return true;this._buffer=new Array(this._chunks);this._cancellations=[];this.sources=[];return true;};}).call(this,require("buffer").Buffer);},{buffer:41}],230:[function(require,module,exports){exports=module.exports=trim;function trim(str){return str.replace(/^\s*|\s*$/g,"");}exports.left=function(str){return str.replace(/^\s*/,"");};exports.right=function(str){return str.replace(/\s*$/,"");};},{}],231:[function(require,module,exports){function clean(s){return s.replace(/\n\r?\s*/g,"");}module.exports=function tsml(sa){var s="",i=0;for(;i<arguments.length;i++){s+=clean(sa[i])+(arguments[i+1]||"");}return s;};},{}],232:[function(require,module,exports){(function(Buffer){var isTypedArray=require("is-typedarray").strict;module.exports=function typedarrayToBuffer(arr){if(isTypedArray(arr)){var buf=new Buffer(arr.buffer);if(arr.byteLength!==arr.buffer.byteLength){buf=buf.slice(arr.byteOffset,arr.byteOffset+arr.byteLength);}return buf;}else{return new Buffer(arr);}};}).call(this,require("buffer").Buffer);},{buffer:41,"is-typedarray":99}],233:[function(require,module,exports){(function(Buffer){var UINT_32_MAX=4294967295;exports.encodingLength=function(){return 8;};exports.encode=function(num,buf,offset){if(!buf)buf=new Buffer(8);if(!offset)offset=0;var top=Math.floor(num/UINT_32_MAX);var rem=num-top*UINT_32_MAX;buf.writeUInt32BE(top,offset);buf.writeUInt32BE(rem,offset+4);return buf;};exports.decode=function(buf,offset){if(!offset)offset=0;if(!buf)buf=new Buffer(4);if(!offset)offset=0;var top=buf.readUInt32BE(offset);var rem=buf.readUInt32BE(offset+4);return top*UINT_32_MAX+rem;};exports.encode.bytes=8;exports.decode.bytes=8;}).call(this,require("buffer").Buffer);},{buffer:41}],234:[function(require,module,exports){"use strict";function unique_pred(list,compare){var ptr=1,len=list.length,a=list[0],b=list[0];for(var i=1;i<len;++i){b=a;a=list[i];if(compare(a,b)){if(i===ptr){ptr++;continue;}list[ptr++]=a;}}list.length=ptr;return list;}function unique_eq(list){var ptr=1,len=list.length,a=list[0],b=list[0];for(var i=1;i<len;++i,b=a){b=a;a=list[i];if(a!==b){if(i===ptr){ptr++;continue;}list[ptr++]=a;}}list.length=ptr;return list;}function unique(list,compare,sorted){if(list.length===0){return list;}if(compare){if(!sorted){list.sort(compare);}return unique_pred(list,compare);}if(!sorted){list.sort();}return unique_eq(list);}module.exports=unique;},{}],235:[function(require,module,exports){module.exports=remove;function remove(arr,i){if(i>=arr.length||i<0)return;var last=arr.pop();if(i<arr.length){var tmp=arr[i];arr[i]=last;return tmp;}return last;}},{}],236:[function(require,module,exports){"use strict";var punycode=require("punycode");var util=require("./util");exports.parse=urlParse;exports.resolve=urlResolve;exports.resolveObject=urlResolveObject;exports.format=urlFormat;exports.Url=Url;function Url(){this.protocol=null;this.slashes=null;this.auth=null;this.host=null;this.port=null;this.hostname=null;this.hash=null;this.search=null;this.query=null;this.pathname=null;this.path=null;this.href=null;}var protocolPattern=/^([a-z0-9.+-]+:)/i,portPattern=/:[0-9]*$/,simplePathPattern=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,delims=["<",">",'"',"`"," ","\r","\n","\t"],unwise=["{","}","|","\\","^","`"].concat(delims),autoEscape=["'"].concat(unwise),nonHostChars=["%","/","?",";","#"].concat(autoEscape),hostEndingChars=["/","?","#"],hostnameMaxLen=255,hostnamePartPattern=/^[+a-z0-9A-Z_-]{0,63}$/,hostnamePartStart=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,unsafeProtocol={javascript:true,"javascript:":true},hostlessProtocol={javascript:true,"javascript:":true},slashedProtocol={http:true,https:true,ftp:true,gopher:true,file:true,"http:":true,"https:":true,"ftp:":true,"gopher:":true,"file:":true},querystring=require("querystring");function urlParse(url,parseQueryString,slashesDenoteHost){if(url&&util.isObject(url)&&url instanceof Url)return url;var u=new Url();u.parse(url,parseQueryString,slashesDenoteHost);return u;}Url.prototype.parse=function(url,parseQueryString,slashesDenoteHost){if(!util.isString(url)){throw new TypeError("Parameter 'url' must be a string, not "+(typeof url==="undefined"?"undefined":_typeof2(url)));}var queryIndex=url.indexOf("?"),splitter=queryIndex!==-1&&queryIndex<url.indexOf("#")?"?":"#",uSplit=url.split(splitter),slashRegex=/\\/g;uSplit[0]=uSplit[0].replace(slashRegex,"/");url=uSplit.join(splitter);var rest=url;rest=rest.trim();if(!slashesDenoteHost&&url.split("#").length===1){var simplePath=simplePathPattern.exec(rest);if(simplePath){this.path=rest;this.href=rest;this.pathname=simplePath[1];if(simplePath[2]){this.search=simplePath[2];if(parseQueryString){this.query=querystring.parse(this.search.substr(1));}else{this.query=this.search.substr(1);}}else if(parseQueryString){this.search="";this.query={};}return this;}}var proto=protocolPattern.exec(rest);if(proto){proto=proto[0];var lowerProto=proto.toLowerCase();this.protocol=lowerProto;rest=rest.substr(proto.length);}if(slashesDenoteHost||proto||rest.match(/^\/\/[^@\/]+@[^@\/]+/)){var slashes=rest.substr(0,2)==="//";if(slashes&&!(proto&&hostlessProtocol[proto])){rest=rest.substr(2);this.slashes=true;}}if(!hostlessProtocol[proto]&&(slashes||proto&&!slashedProtocol[proto])){var hostEnd=-1;for(var i=0;i<hostEndingChars.length;i++){var hec=rest.indexOf(hostEndingChars[i]);if(hec!==-1&&(hostEnd===-1||hec<hostEnd))hostEnd=hec;}var auth,atSign;if(hostEnd===-1){atSign=rest.lastIndexOf("@");}else{atSign=rest.lastIndexOf("@",hostEnd);}if(atSign!==-1){auth=rest.slice(0,atSign);rest=rest.slice(atSign+1);this.auth=decodeURIComponent(auth);}hostEnd=-1;for(var i=0;i<nonHostChars.length;i++){var hec=rest.indexOf(nonHostChars[i]);if(hec!==-1&&(hostEnd===-1||hec<hostEnd))hostEnd=hec;}if(hostEnd===-1)hostEnd=rest.length;this.host=rest.slice(0,hostEnd);rest=rest.slice(hostEnd);this.parseHost();this.hostname=this.hostname||"";var ipv6Hostname=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!ipv6Hostname){var hostparts=this.hostname.split(/\./);for(var i=0,l=hostparts.length;i<l;i++){var part=hostparts[i];if(!part)continue;if(!part.match(hostnamePartPattern)){var newpart="";for(var j=0,k=part.length;j<k;j++){if(part.charCodeAt(j)>127){newpart+="x";}else{newpart+=part[j];}}if(!newpart.match(hostnamePartPattern)){var validParts=hostparts.slice(0,i);var notHost=hostparts.slice(i+1);var bit=part.match(hostnamePartStart);if(bit){validParts.push(bit[1]);notHost.unshift(bit[2]);}if(notHost.length){rest="/"+notHost.join(".")+rest;}this.hostname=validParts.join(".");break;}}}}if(this.hostname.length>hostnameMaxLen){this.hostname="";}else{this.hostname=this.hostname.toLowerCase();}if(!ipv6Hostname){this.hostname=punycode.toASCII(this.hostname);}var p=this.port?":"+this.port:"";var h=this.hostname||"";this.host=h+p;this.href+=this.host;if(ipv6Hostname){this.hostname=this.hostname.substr(1,this.hostname.length-2);if(rest[0]!=="/"){rest="/"+rest;}}}if(!unsafeProtocol[lowerProto]){for(var i=0,l=autoEscape.length;i<l;i++){var ae=autoEscape[i];if(rest.indexOf(ae)===-1)continue;var esc=encodeURIComponent(ae);if(esc===ae){esc=escape(ae);}rest=rest.split(ae).join(esc);}}var hash=rest.indexOf("#");if(hash!==-1){this.hash=rest.substr(hash);rest=rest.slice(0,hash);}var qm=rest.indexOf("?");if(qm!==-1){this.search=rest.substr(qm);this.query=rest.substr(qm+1);if(parseQueryString){this.query=querystring.parse(this.query);}rest=rest.slice(0,qm);}else if(parseQueryString){this.search="";this.query={};}if(rest)this.pathname=rest;if(slashedProtocol[lowerProto]&&this.hostname&&!this.pathname){this.pathname="/";}if(this.pathname||this.search){var p=this.pathname||"";var s=this.search||"";this.path=p+s;}this.href=this.format();return this;};function urlFormat(obj){if(util.isString(obj))obj=urlParse(obj);if(!(obj instanceof Url))return Url.prototype.format.call(obj);return obj.format();}Url.prototype.format=function(){var auth=this.auth||"";if(auth){auth=encodeURIComponent(auth);auth=auth.replace(/%3A/i,":");auth+="@";}var protocol=this.protocol||"",pathname=this.pathname||"",hash=this.hash||"",host=false,query="";if(this.host){host=auth+this.host;}else if(this.hostname){host=auth+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]");if(this.port){host+=":"+this.port;}}if(this.query&&util.isObject(this.query)&&Object.keys(this.query).length){query=querystring.stringify(this.query);}var search=this.search||query&&"?"+query||"";if(protocol&&protocol.substr(-1)!==":")protocol+=":";if(this.slashes||(!protocol||slashedProtocol[protocol])&&host!==false){host="//"+(host||"");if(pathname&&pathname.charAt(0)!=="/")pathname="/"+pathname;}else if(!host){host="";}if(hash&&hash.charAt(0)!=="#")hash="#"+hash;if(search&&search.charAt(0)!=="?")search="?"+search;pathname=pathname.replace(/[?#]/g,function(match){return encodeURIComponent(match);});search=search.replace("#","%23");return protocol+host+pathname+search+hash;};function urlResolve(source,relative){return urlParse(source,false,true).resolve(relative);}Url.prototype.resolve=function(relative){return this.resolveObject(urlParse(relative,false,true)).format();};function urlResolveObject(source,relative){if(!source)return relative;return urlParse(source,false,true).resolveObject(relative);}Url.prototype.resolveObject=function(relative){if(util.isString(relative)){var rel=new Url();rel.parse(relative,false,true);relative=rel;}var result=new Url();var tkeys=Object.keys(this);for(var tk=0;tk<tkeys.length;tk++){var tkey=tkeys[tk];result[tkey]=this[tkey];}result.hash=relative.hash;if(relative.href===""){result.href=result.format();return result;}if(relative.slashes&&!relative.protocol){var rkeys=Object.keys(relative);for(var rk=0;rk<rkeys.length;rk++){var rkey=rkeys[rk];if(rkey!=="protocol")result[rkey]=relative[rkey];}if(slashedProtocol[result.protocol]&&result.hostname&&!result.pathname){result.path=result.pathname="/";}result.href=result.format();return result;}if(relative.protocol&&relative.protocol!==result.protocol){if(!slashedProtocol[relative.protocol]){var keys=Object.keys(relative);for(var v=0;v<keys.length;v++){var k=keys[v];result[k]=relative[k];}result.href=result.format();return result;}result.protocol=relative.protocol;if(!relative.host&&!hostlessProtocol[relative.protocol]){var relPath=(relative.pathname||"").split("/");while(relPath.length&&!(relative.host=relPath.shift())){}if(!relative.host)relative.host="";if(!relative.hostname)relative.hostname="";if(relPath[0]!=="")relPath.unshift("");if(relPath.length<2)relPath.unshift("");result.pathname=relPath.join("/");}else{result.pathname=relative.pathname;}result.search=relative.search;result.query=relative.query;result.host=relative.host||"";result.auth=relative.auth;result.hostname=relative.hostname||relative.host;result.port=relative.port;if(result.pathname||result.search){var p=result.pathname||"";var s=result.search||"";result.path=p+s;}result.slashes=result.slashes||relative.slashes;result.href=result.format();return result;}var isSourceAbs=result.pathname&&result.pathname.charAt(0)==="/",isRelAbs=relative.host||relative.pathname&&relative.pathname.charAt(0)==="/",mustEndAbs=isRelAbs||isSourceAbs||result.host&&relative.pathname,removeAllDots=mustEndAbs,srcPath=result.pathname&&result.pathname.split("/")||[],relPath=relative.pathname&&relative.pathname.split("/")||[],psychotic=result.protocol&&!slashedProtocol[result.protocol];if(psychotic){result.hostname="";result.port=null;if(result.host){if(srcPath[0]==="")srcPath[0]=result.host;else srcPath.unshift(result.host);}result.host="";if(relative.protocol){relative.hostname=null;relative.port=null;if(relative.host){if(relPath[0]==="")relPath[0]=relative.host;else relPath.unshift(relative.host);}relative.host=null;}mustEndAbs=mustEndAbs&&(relPath[0]===""||srcPath[0]==="");}if(isRelAbs){result.host=relative.host||relative.host===""?relative.host:result.host;result.hostname=relative.hostname||relative.hostname===""?relative.hostname:result.hostname;result.search=relative.search;result.query=relative.query;srcPath=relPath;}else if(relPath.length){if(!srcPath)srcPath=[];srcPath.pop();srcPath=srcPath.concat(relPath);result.search=relative.search;result.query=relative.query;}else if(!util.isNullOrUndefined(relative.search)){if(psychotic){result.hostname=result.host=srcPath.shift();var authInHost=result.host&&result.host.indexOf("@")>0?result.host.split("@"):false;if(authInHost){result.auth=authInHost.shift();result.host=result.hostname=authInHost.shift();}}result.search=relative.search;result.query=relative.query;if(!util.isNull(result.pathname)||!util.isNull(result.search)){result.path=(result.pathname?result.pathname:"")+(result.search?result.search:"");}result.href=result.format();return result;}if(!srcPath.length){result.pathname=null;if(result.search){result.path="/"+result.search;}else{result.path=null;}result.href=result.format();return result;}var last=srcPath.slice(-1)[0];var hasTrailingSlash=(result.host||relative.host||srcPath.length>1)&&(last==="."||last==="..")||last==="";var up=0;for(var i=srcPath.length;i>=0;i--){last=srcPath[i];if(last==="."){srcPath.splice(i,1);}else if(last===".."){srcPath.splice(i,1);up++;}else if(up){srcPath.splice(i,1);up--;}}if(!mustEndAbs&&!removeAllDots){for(;up--;up){srcPath.unshift("..");}}if(mustEndAbs&&srcPath[0]!==""&&(!srcPath[0]||srcPath[0].charAt(0)!=="/")){srcPath.unshift("");}if(hasTrailingSlash&&srcPath.join("/").substr(-1)!=="/"){srcPath.push("");}var isAbsolute=srcPath[0]===""||srcPath[0]&&srcPath[0].charAt(0)==="/";if(psychotic){result.hostname=result.host=isAbsolute?"":srcPath.length?srcPath.shift():"";var authInHost=result.host&&result.host.indexOf("@")>0?result.host.split("@"):false;if(authInHost){result.auth=authInHost.shift();result.host=result.hostname=authInHost.shift();}}mustEndAbs=mustEndAbs||result.host&&srcPath.length;if(mustEndAbs&&!isAbsolute){srcPath.unshift("");}if(!srcPath.length){result.pathname=null;result.path=null;}else{result.pathname=srcPath.join("/");}if(!util.isNull(result.pathname)||!util.isNull(result.search)){result.path=(result.pathname?result.pathname:"")+(result.search?result.search:"");}result.auth=relative.auth||result.auth;result.slashes=result.slashes||relative.slashes;result.href=result.format();return result;};Url.prototype.parseHost=function(){var host=this.host;var port=portPattern.exec(host);if(port){port=port[0];if(port!==":"){this.port=port.substr(1);}host=host.substr(0,host.length-port.length);}if(host)this.hostname=host;};},{"./util":237,punycode:154,querystring:157}],237:[function(require,module,exports){"use strict";module.exports={isString:function isString(arg){return typeof arg==="string";},isObject:function isObject(arg){return(typeof arg==="undefined"?"undefined":_typeof2(arg))==="object"&&arg!==null;},isNull:function isNull(arg){return arg===null;},isNullOrUndefined:function isNullOrUndefined(arg){return arg==null;}};},{}],238:[function(require,module,exports){var bencode=require("bencode");var BitField=require("bitfield");var Buffer=require("safe-buffer").Buffer;var debug=require("debug")("ut_metadata");var EventEmitter=require("events").EventEmitter;var inherits=require("inherits");var sha1=require("simple-sha1");var MAX_METADATA_SIZE=1e7;var BITFIELD_GROW=1e3;var PIECE_LENGTH=16*1024;module.exports=function(metadata){inherits(utMetadata,EventEmitter);function utMetadata(wire){EventEmitter.call(this);this._wire=wire;this._metadataComplete=false;this._metadataSize=null;this._remainingRejects=null;this._fetching=false;this._bitfield=new BitField(0,{grow:BITFIELD_GROW});if(Buffer.isBuffer(metadata)){this.setMetadata(metadata);}}utMetadata.prototype.name="ut_metadata";utMetadata.prototype.onHandshake=function(infoHash,peerId,extensions){this._infoHash=infoHash;};utMetadata.prototype.onExtendedHandshake=function(handshake){if(!handshake.m||!handshake.m.ut_metadata){return this.emit("warning",new Error("Peer does not support ut_metadata"));}if(!handshake.metadata_size){return this.emit("warning",new Error("Peer does not have metadata"));}if(typeof handshake.metadata_size!=="number"||MAX_METADATA_SIZE<handshake.metadata_size||handshake.metadata_size<=0){return this.emit("warning",new Error("Peer gave invalid metadata size"));}this._metadataSize=handshake.metadata_size;this._numPieces=Math.ceil(this._metadataSize/PIECE_LENGTH);this._remainingRejects=this._numPieces*2;if(this._fetching){this._requestPieces();}};utMetadata.prototype.onMessage=function(buf){var dict,trailer;try{var str=buf.toString();var trailerIndex=str.indexOf("ee")+2;dict=bencode.decode(str.substring(0,trailerIndex));trailer=buf.slice(trailerIndex);}catch(err){return;}switch(dict.msg_type){case 0:this._onRequest(dict.piece);break;case 1:this._onData(dict.piece,trailer,dict.total_size);break;case 2:this._onReject(dict.piece);break;}};utMetadata.prototype.fetch=function(){if(this._metadataComplete){return;}this._fetching=true;if(this._metadataSize){this._requestPieces();}};utMetadata.prototype.cancel=function(){this._fetching=false;};utMetadata.prototype.setMetadata=function(metadata){if(this._metadataComplete)return true;debug("set metadata");try{var info=bencode.decode(metadata).info;if(info){metadata=bencode.encode(info);}}catch(err){}if(this._infoHash&&this._infoHash!==sha1.sync(metadata)){return false;}this.cancel();this.metadata=metadata;this._metadataComplete=true;this._metadataSize=this.metadata.length;this._wire.extendedHandshake.metadata_size=this._metadataSize;this.emit("metadata",bencode.encode({info:bencode.decode(this.metadata)}));return true;};utMetadata.prototype._send=function(dict,trailer){var buf=bencode.encode(dict);if(Buffer.isBuffer(trailer)){buf=Buffer.concat([buf,trailer]);}this._wire.extended("ut_metadata",buf);};utMetadata.prototype._request=function(piece){this._send({msg_type:0,piece:piece});};utMetadata.prototype._data=function(piece,buf,totalSize){var msg={msg_type:1,piece:piece};if(typeof totalSize==="number"){msg.total_size=totalSize;}this._send(msg,buf);};utMetadata.prototype._reject=function(piece){this._send({msg_type:2,piece:piece});};utMetadata.prototype._onRequest=function(piece){if(!this._metadataComplete){this._reject(piece);return;}var start=piece*PIECE_LENGTH;var end=start+PIECE_LENGTH;if(end>this._metadataSize){end=this._metadataSize;}var buf=this.metadata.slice(start,end);this._data(piece,buf,this._metadataSize);};utMetadata.prototype._onData=function(piece,buf,totalSize){if(buf.length>PIECE_LENGTH){return;}buf.copy(this.metadata,piece*PIECE_LENGTH);this._bitfield.set(piece);this._checkDone();};utMetadata.prototype._onReject=function(piece){if(this._remainingRejects>0&&this._fetching){this._request(piece);this._remainingRejects-=1;}else{this.emit("warning",new Error('Peer sent "reject" too much'));}};utMetadata.prototype._requestPieces=function(){this.metadata=Buffer.alloc(this._metadataSize);for(var piece=0;piece<this._numPieces;piece++){this._request(piece);}};utMetadata.prototype._checkDone=function(){var done=true;for(var piece=0;piece<this._numPieces;piece++){if(!this._bitfield.get(piece)){done=false;break;}}if(!done)return;var success=this.setMetadata(this.metadata);if(!success){this._failedMetadata();}};utMetadata.prototype._failedMetadata=function(){this._bitfield=new BitField(0,{grow:BITFIELD_GROW});this._remainingRejects-=this._numPieces;if(this._remainingRejects>0){this._requestPieces();}else{this.emit("warning",new Error("Peer sent invalid metadata"));}};return utMetadata;};},{bencode:6,bitfield:8,debug:69,events:73,inherits:94,"safe-buffer":177,"simple-sha1":193}],239:[function(require,module,exports){(function(global){module.exports=deprecate;function deprecate(fn,msg){if(config("noDeprecation")){return fn;}var warned=false;function deprecated(){if(!warned){if(config("throwDeprecation")){throw new Error(msg);}else if(config("traceDeprecation")){console.trace(msg);}else{console.warn(msg);}warned=true;}return fn.apply(this,arguments);}return deprecated;}function config(name){try{if(!global.localStorage)return false;}catch(_){return false;}var val=global.localStorage[name];if(null==val)return false;return String(val).toLowerCase()==="true";}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{});},{}],240:[function(require,module,exports){"use strict";exports.__esModule=true;var _button=require("./button.js");var _button2=_interopRequireDefault(_button);var _component=require("./component.js");var _component2=_interopRequireDefault(_component);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&((typeof call==="undefined"?"undefined":_typeof2(call))==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var BigPlayButton=function(_Button){_inherits(BigPlayButton,_Button);function BigPlayButton(){_classCallCheck(this,BigPlayButton);return _possibleConstructorReturn(this,_Button.apply(this,arguments));}BigPlayButton.prototype.buildCSSClass=function buildCSSClass(){return"vjs-big-play-button";};BigPlayButton.prototype.handleClick=function handleClick(event){this.player_.play();var cb=this.player_.getChild("controlBar");var playToggle=cb&&cb.getChild("playToggle");if(!playToggle){this.player_.focus();return;}this.setTimeout(function(){playToggle.focus();},1);};return BigPlayButton;}(_button2["default"]);BigPlayButton.prototype.controlText_="Play Video";_component2["default"].registerComponent("BigPlayButton",BigPlayButton);exports["default"]=BigPlayButton;},{"./button.js":241,"./component.js":244}],241:[function(require,module,exports){"use strict";exports.__esModule=true;var _clickableComponent=require("./clickable-component.js");var _clickableComponent2=_interopRequireDefault(_clickableComponent);var _component=require("./component");var _component2=_interopRequireDefault(_component);var _log=require("./utils/log.js");var _log2=_interopRequireDefault(_log);var _obj=require("./utils/obj");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&((typeof call==="undefined"?"undefined":_typeof2(call))==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var Button=function(_ClickableComponent){_inherits(Button,_ClickableComponent);function Button(){_classCallCheck(this,Button);return _possibleConstructorReturn(this,_ClickableComponent.apply(this,arguments));}Button.prototype.createEl=function createEl(){var tag=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"button";var props=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var attributes=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};props=(0,_obj.assign)({className:this.buildCSSClass()},props);if(tag!=="button"){_log2["default"].warn("Creating a Button with an HTML element of "+tag+" is deprecated; use ClickableComponent instead.");props=(0,_obj.assign)({tabIndex:0},props);attributes=(0,_obj.assign)({role:"button"},attributes);}attributes=(0,_obj.assign)({type:"button","aria-live":"polite"},attributes);var el=_component2["default"].prototype.createEl.call(this,tag,props,attributes);this.createControlTextEl(el);return el;};Button.prototype.addChild=function addChild(child){var options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var className=this.constructor.name;_log2["default"].warn("Adding an actionable (user controllable) child to a Button ("+className+") is not supported; use a ClickableComponent instead.");return _component2["default"].prototype.addChild.call(this,child,options);};Button.prototype.enable=function enable(){_ClickableComponent.prototype.enable.call(this);this.el_.removeAttribute("disabled");};Button.prototype.disable=function disable(){_ClickableComponent.prototype.disable.call(this);this.el_.setAttribute("disabled","disabled");};Button.prototype.handleKeyPress=function handleKeyPress(event){if(event.which===32||event.which===13){return;}_ClickableComponent.prototype.handleKeyPress.call(this,event);};return Button;}(_clickableComponent2["default"]);_component2["default"].registerComponent("Button",Button);exports["default"]=Button;},{"./clickable-component.js":242,"./component":244,"./utils/log.js":325,"./utils/obj":327}],242:[function(require,module,exports){"use strict";exports.__esModule=true;var _component=require("./component");var _component2=_interopRequireDefault(_component);var _dom=require("./utils/dom.js");var Dom=_interopRequireWildcard(_dom);var _events=require("./utils/events.js");var Events=_interopRequireWildcard(_events);var _fn=require("./utils/fn.js");var Fn=_interopRequireWildcard(_fn);var _log=require("./utils/log.js");var _log2=_interopRequireDefault(_log);var _document=require("global/document");var _document2=_interopRequireDefault(_document);var _obj=require("./utils/obj");function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&((typeof call==="undefined"?"undefined":_typeof2(call))==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var ClickableComponent=function(_Component){_inherits(ClickableComponent,_Component);function ClickableComponent(player,options){_classCallCheck(this,ClickableComponent);var _this=_possibleConstructorReturn(this,_Component.call(this,player,options));_this.emitTapEvents();_this.enable();return _this;}ClickableComponent.prototype.createEl=function createEl(){var tag=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"div";var props=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var attributes=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};props=(0,_obj.assign)({className:this.buildCSSClass(),tabIndex:0},props);if(tag==="button"){_log2["default"].error("Creating a ClickableComponent with an HTML element of "+tag+" is not supported; use a Button instead.");}attributes=(0,_obj.assign)({role:"button","aria-live":"polite"},attributes);this.tabIndex_=props.tabIndex;var el=_Component.prototype.createEl.call(this,tag,props,attributes);this.createControlTextEl(el);return el;};ClickableComponent.prototype.createControlTextEl=function createControlTextEl(el){this.controlTextEl_=Dom.createEl("span",{className:"vjs-control-text"});if(el){el.appendChild(this.controlTextEl_);}this.controlText(this.controlText_,el);return this.controlTextEl_;};ClickableComponent.prototype.controlText=function controlText(text){var el=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.el();if(!text){return this.controlText_||"Need Text";}var localizedText=this.localize(text);this.controlText_=text;this.controlTextEl_.innerHTML=localizedText;if(!this.nonIconControl){el.setAttribute("title",localizedText);}return this;};ClickableComponent.prototype.buildCSSClass=function buildCSSClass(){return"vjs-control vjs-button "+_Component.prototype.buildCSSClass.call(this);};ClickableComponent.prototype.enable=function enable(){this.removeClass("vjs-disabled");this.el_.setAttribute("aria-disabled","false");if(typeof this.tabIndex_!=="undefined"){this.el_.setAttribute("tabIndex",this.tabIndex_);}this.on("tap",this.handleClick);this.on("click",this.handleClick);this.on("focus",this.handleFocus);this.on("blur",this.handleBlur);return this;};ClickableComponent.prototype.disable=function disable(){this.addClass("vjs-disabled");this.el_.setAttribute("aria-disabled","true");if(typeof this.tabIndex_!=="undefined"){this.el_.removeAttribute("tabIndex");}this.off("tap",this.handleClick);this.off("click",this.handleClick);this.off("focus",this.handleFocus);this.off("blur",this.handleBlur);return this;};ClickableComponent.prototype.handleClick=function handleClick(event){};ClickableComponent.prototype.handleFocus=function handleFocus(event){Events.on(_document2["default"],"keydown",Fn.bind(this,this.handleKeyPress));};ClickableComponent.prototype.handleKeyPress=function handleKeyPress(event){if(event.which===32||event.which===13){event.preventDefault();this.handleClick(event);}else if(_Component.prototype.handleKeyPress){_Component.prototype.handleKeyPress.call(this,event);}};ClickableComponent.prototype.handleBlur=function handleBlur(event){Events.off(_document2["default"],"keydown",Fn.bind(this,this.handleKeyPress));};return ClickableComponent;}(_component2["default"]);_component2["default"].registerComponent("ClickableComponent",ClickableComponent);exports["default"]=ClickableComponent;},{"./component":244,"./utils/dom.js":320,"./utils/events.js":321,"./utils/fn.js":322,"./utils/log.js":325,"./utils/obj":327,"global/document":89}],243:[function(require,module,exports){"use strict";exports.__esModule=true;var _button=require("./button");var _button2=_interopRequireDefault(_button);var _component=require("./component");var _component2=_interopRequireDefault(_component);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&((typeof call==="undefined"?"undefined":_typeof2(call))==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var CloseButton=function(_Button){_inherits(CloseButton,_Button);function CloseButton(player,options){_classCallCheck(this,CloseButton);var _this=_possibleConstructorReturn(this,_Button.call(this,player,options));_this.controlText(options&&options.controlText||_this.localize("Close"));return _this;}CloseButton.prototype.buildCSSClass=function buildCSSClass(){return"vjs-close-button "+_Button.prototype.buildCSSClass.call(this);};CloseButton.prototype.handleClick=function handleClick(event){this.trigger({type:"close",bubbles:false});};return CloseButton;}(_button2["default"]);_component2["default"].registerComponent("CloseButton",CloseButton);exports["default"]=CloseButton;},{"./button":241,"./component":244}],244:[function(require,module,exports){"use strict";exports.__esModule=true;var _window=require("global/window");var _window2=_interopRequireDefault(_window);var _dom=require("./utils/dom.js");var Dom=_interopRequireWildcard(_dom);var _fn=require("./utils/fn.js");var Fn=_interopRequireWildcard(_fn);var _guid=require("./utils/guid.js");var Guid=_interopRequireWildcard(_guid);var _events=require("./utils/events.js");var Events=_interopRequireWildcard(_events);var _log=require("./utils/log.js");var _log2=_interopRequireDefault(_log);var _toTitleCase=require("./utils/to-title-case.js");var _toTitleCase2=_interopRequireDefault(_toTitleCase);var _mergeOptions=require("./utils/merge-options.js");var _mergeOptions2=_interopRequireDefault(_mergeOptions);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}var Component=function(){function Component(player,options,ready){_classCallCheck(this,Component);if(!player&&this.play){this.player_=player=this;}else{this.player_=player;}this.options_=(0,_mergeOptions2["default"])({},this.options_);options=this.options_=(0,_mergeOptions2["default"])(this.options_,options);this.id_=options.id||options.el&&options.el.id;if(!this.id_){var id=player&&player.id&&player.id()||"no_player";this.id_=id+"_component_"+Guid.newGUID();}this.name_=options.name||null;if(options.el){this.el_=options.el;}else if(options.createEl!==false){this.el_=this.createEl();}this.children_=[];this.childIndex_={};this.childNameIndex_={};if(options.initChildren!==false){this.initChildren();}this.ready(ready);if(options.reportTouchActivity!==false){this.enableTouchActivity();}}Component.prototype.dispose=function dispose(){this.trigger({type:"dispose",bubbles:false});if(this.children_){for(var i=this.children_.length-1;i>=0;i--){if(this.children_[i].dispose){this.children_[i].dispose();}}}this.children_=null;this.childIndex_=null;this.childNameIndex_=null;this.off();if(this.el_.parentNode){this.el_.parentNode.removeChild(this.el_);}Dom.removeElData(this.el_);this.el_=null;};Component.prototype.player=function player(){return this.player_;};Component.prototype.options=function options(obj){_log2["default"].warn("this.options() has been deprecated and will be moved to the constructor in 6.0");if(!obj){return this.options_;}this.options_=(0,_mergeOptions2["default"])(this.options_,obj);return this.options_;};Component.prototype.el=function el(){return this.el_;};Component.prototype.createEl=function createEl(tagName,properties,attributes){return Dom.createEl(tagName,properties,attributes);};Component.prototype.localize=function localize(string){var code=this.player_.language&&this.player_.language();var languages=this.player_.languages&&this.player_.languages();if(!code||!languages){return string;}var language=languages[code];if(language&&language[string]){return language[string];}var primaryCode=code.split("-")[0];var primaryLang=languages[primaryCode];if(primaryLang&&primaryLang[string]){return primaryLang[string];}return string;};Component.prototype.contentEl=function contentEl(){return this.contentEl_||this.el_;};Component.prototype.id=function id(){return this.id_;};Component.prototype.name=function name(){return this.name_;};Component.prototype.children=function children(){return this.children_;};Component.prototype.getChildById=function getChildById(id){return this.childIndex_[id];};Component.prototype.getChild=function getChild(name){if(!name){return;}name=(0,_toTitleCase2["default"])(name);return this.childNameIndex_[name];};Component.prototype.addChild=function addChild(child){var options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var index=arguments.length>2&&arguments[2]!==undefined?arguments[2]:this.children_.length;var component=void 0;var componentName=void 0;if(typeof child==="string"){componentName=(0,_toTitleCase2["default"])(child);if(!options){options={};}if(options===true){_log2["default"].warn("Initializing a child component with `true` is deprecated."+"Children should be defined in an array when possible, "+"but if necessary use an object instead of `true`.");options={};}var componentClassName=options.componentClass||componentName;options.name=componentName;var ComponentClass=Component.getComponent(componentClassName);if(!ComponentClass){throw new Error("Component "+componentClassName+" does not exist");}if(typeof ComponentClass!=="function"){return null;}component=new ComponentClass(this.player_||this,options);}else{component=child;}this.children_.splice(index,0,component);if(typeof component.id==="function"){this.childIndex_[component.id()]=component;}componentName=componentName||component.name&&(0,_toTitleCase2["default"])(component.name());if(componentName){this.childNameIndex_[componentName]=component;}if(typeof component.el==="function"&&component.el()){var childNodes=this.contentEl().children;var refNode=childNodes[index]||null;this.contentEl().insertBefore(component.el(),refNode);}return component;};Component.prototype.removeChild=function removeChild(component){if(typeof component==="string"){component=this.getChild(component);}if(!component||!this.children_){return;}var childFound=false;for(var i=this.children_.length-1;i>=0;i--){if(this.children_[i]===component){childFound=true;this.children_.splice(i,1);break;}}if(!childFound){return;}this.childIndex_[component.id()]=null;this.childNameIndex_[component.name()]=null;var compEl=component.el();if(compEl&&compEl.parentNode===this.contentEl()){this.contentEl().removeChild(component.el());}};Component.prototype.initChildren=function initChildren(){var _this=this;var children=this.options_.children;if(children){var parentOptions=this.options_;var handleAdd=function handleAdd(child){var name=child.name;var opts=child.opts;if(parentOptions[name]!==undefined){opts=parentOptions[name];}if(opts===false){return;}if(opts===true){opts={};}opts.playerOptions=_this.options_.playerOptions;var newChild=_this.addChild(name,opts);if(newChild){_this[name]=newChild;}};var workingChildren=void 0;var Tech=Component.getComponent("Tech");if(Array.isArray(children)){workingChildren=children;}else{workingChildren=Object.keys(children);}workingChildren.concat(Object.keys(this.options_).filter(function(child){return!workingChildren.some(function(wchild){if(typeof wchild==="string"){return child===wchild;}return child===wchild.name;});})).map(function(child){var name=void 0;var opts=void 0;if(typeof child==="string"){name=child;opts=children[name]||_this.options_[name]||{};}else{name=child.name;opts=child;}return{name:name,opts:opts};}).filter(function(child){var c=Component.getComponent(child.opts.componentClass||(0,_toTitleCase2["default"])(child.name));return c&&!Tech.isTech(c);}).forEach(handleAdd);}};Component.prototype.buildCSSClass=function buildCSSClass(){return"";};Component.prototype.on=function on(first,second,third){var _this2=this;if(typeof first==="string"||Array.isArray(first)){Events.on(this.el_,first,Fn.bind(this,second));}else{var target=first;var type=second;var fn=Fn.bind(this,third);var removeOnDispose=function removeOnDispose(){return _this2.off(target,type,fn);};removeOnDispose.guid=fn.guid;this.on("dispose",removeOnDispose);var cleanRemover=function cleanRemover(){return _this2.off("dispose",removeOnDispose);};cleanRemover.guid=fn.guid;if(first.nodeName){Events.on(target,type,fn);Events.on(target,"dispose",cleanRemover);}else if(typeof first.on==="function"){target.on(type,fn);target.on("dispose",cleanRemover);}}return this;};Component.prototype.off=function off(first,second,third){if(!first||typeof first==="string"||Array.isArray(first)){Events.off(this.el_,first,second);}else{var target=first;var type=second;var fn=Fn.bind(this,third);this.off("dispose",fn);if(first.nodeName){Events.off(target,type,fn);Events.off(target,"dispose",fn);}else{target.off(type,fn);target.off("dispose",fn);}}return this;};Component.prototype.one=function one(first,second,third){var _this3=this,_arguments=arguments;if(typeof first==="string"||Array.isArray(first)){Events.one(this.el_,first,Fn.bind(this,second));}else{var target=first;var type=second;var fn=Fn.bind(this,third);var newFunc=function newFunc(){_this3.off(target,type,newFunc);fn.apply(null,_arguments);};newFunc.guid=fn.guid;this.on(target,type,newFunc);}return this;};Component.prototype.trigger=function trigger(event,hash){Events.trigger(this.el_,event,hash);return this;};Component.prototype.ready=function ready(fn){var sync=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;if(fn){if(this.isReady_){if(sync){fn.call(this);}else{this.setTimeout(fn,1);}}else{this.readyQueue_=this.readyQueue_||[];this.readyQueue_.push(fn);}}return this;};Component.prototype.triggerReady=function triggerReady(){this.isReady_=true;this.setTimeout(function(){var readyQueue=this.readyQueue_;this.readyQueue_=[];if(readyQueue&&readyQueue.length>0){readyQueue.forEach(function(fn){fn.call(this);},this);}this.trigger("ready");},1);};Component.prototype.$=function $(selector,context){return Dom.$(selector,context||this.contentEl());};Component.prototype.$$=function $$(selector,context){return Dom.$$(selector,context||this.contentEl());};Component.prototype.hasClass=function hasClass(classToCheck){return Dom.hasElClass(this.el_,classToCheck);};Component.prototype.addClass=function addClass(classToAdd){Dom.addElClass(this.el_,classToAdd);return this;};Component.prototype.removeClass=function removeClass(classToRemove){Dom.removeElClass(this.el_,classToRemove);return this;};Component.prototype.toggleClass=function toggleClass(classToToggle,predicate){Dom.toggleElClass(this.el_,classToToggle,predicate);return this;};Component.prototype.show=function show(){this.removeClass("vjs-hidden");return this;};Component.prototype.hide=function hide(){this.addClass("vjs-hidden");return this;};Component.prototype.lockShowing=function lockShowing(){this.addClass("vjs-lock-showing");return this;};Component.prototype.unlockShowing=function unlockShowing(){this.removeClass("vjs-lock-showing");return this;};Component.prototype.getAttribute=function getAttribute(attribute){return Dom.getAttribute(this.el_,attribute);};Component.prototype.setAttribute=function setAttribute(attribute,value){Dom.setAttribute(this.el_,attribute,value);return this;};Component.prototype.removeAttribute=function removeAttribute(attribute){Dom.removeAttribute(this.el_,attribute);return this;};Component.prototype.width=function width(num,skipListeners){return this.dimension("width",num,skipListeners);};Component.prototype.height=function height(num,skipListeners){return this.dimension("height",num,skipListeners);};Component.prototype.dimensions=function dimensions(width,height){return this.width(width,true).height(height);};Component.prototype.dimension=function dimension(widthOrHeight,num,skipListeners){if(num!==undefined){if(num===null||num!==num){num=0;}if((""+num).indexOf("%")!==-1||(""+num).indexOf("px")!==-1){this.el_.style[widthOrHeight]=num;}else if(num==="auto"){this.el_.style[widthOrHeight]="";}else{this.el_.style[widthOrHeight]=num+"px";}if(!skipListeners){this.trigger("resize");}return this;}if(!this.el_){return 0;}var val=this.el_.style[widthOrHeight];var pxIndex=val.indexOf("px");if(pxIndex!==-1){return parseInt(val.slice(0,pxIndex),10);}return parseInt(this.el_["offset"+(0,_toTitleCase2["default"])(widthOrHeight)],10);};Component.prototype.currentDimension=function currentDimension(widthOrHeight){var computedWidthOrHeight=0;if(widthOrHeight!=="width"&&widthOrHeight!=="height"){throw new Error("currentDimension only accepts width or height value");}if(typeof _window2["default"].getComputedStyle==="function"){var computedStyle=_window2["default"].getComputedStyle(this.el_);computedWidthOrHeight=computedStyle.getPropertyValue(widthOrHeight)||computedStyle[widthOrHeight];}computedWidthOrHeight=parseFloat(computedWidthOrHeight);if(computedWidthOrHeight===0){var rule="offset"+(0,_toTitleCase2["default"])(widthOrHeight);computedWidthOrHeight=this.el_[rule];}return computedWidthOrHeight;};Component.prototype.currentDimensions=function currentDimensions(){return{width:this.currentDimension("width"),height:this.currentDimension("height")};};Component.prototype.currentWidth=function currentWidth(){return this.currentDimension("width");};Component.prototype.currentHeight=function currentHeight(){return this.currentDimension("height");};Component.prototype.focus=function focus(){this.el_.focus();};Component.prototype.blur=function blur(){this.el_.blur();};Component.prototype.emitTapEvents=function emitTapEvents(){var touchStart=0;var firstTouch=null;var tapMovementThreshold=10;var touchTimeThreshold=200;var couldBeTap=void 0;this.on("touchstart",function(event){if(event.touches.length===1){firstTouch={pageX:event.touches[0].pageX,pageY:event.touches[0].pageY};touchStart=new Date().getTime();couldBeTap=true;}});this.on("touchmove",function(event){if(event.touches.length>1){couldBeTap=false;}else if(firstTouch){var xdiff=event.touches[0].pageX-firstTouch.pageX;var ydiff=event.touches[0].pageY-firstTouch.pageY;var touchDistance=Math.sqrt(xdiff*xdiff+ydiff*ydiff);if(touchDistance>tapMovementThreshold){couldBeTap=false;}}});var noTap=function noTap(){couldBeTap=false;};this.on("touchleave",noTap);this.on("touchcancel",noTap);this.on("touchend",function(event){firstTouch=null;if(couldBeTap===true){var touchTime=new Date().getTime()-touchStart;if(touchTime<touchTimeThreshold){event.preventDefault();this.trigger("tap");}}});};Component.prototype.enableTouchActivity=function enableTouchActivity(){if(!this.player()||!this.player().reportUserActivity){return;}var report=Fn.bind(this.player(),this.player().reportUserActivity);var touchHolding=void 0;this.on("touchstart",function(){report();this.clearInterval(touchHolding);touchHolding=this.setInterval(report,250);});var touchEnd=function touchEnd(event){report();this.clearInterval(touchHolding);};this.on("touchmove",report);this.on("touchend",touchEnd);this.on("touchcancel",touchEnd);};Component.prototype.setTimeout=function setTimeout(fn,timeout){fn=Fn.bind(this,fn);var timeoutId=_window2["default"].setTimeout(fn,timeout);var disposeFn=function disposeFn(){this.clearTimeout(timeoutId);};disposeFn.guid="vjs-timeout-"+timeoutId;this.on("dispose",disposeFn);return timeoutId;};Component.prototype.clearTimeout=function clearTimeout(timeoutId){_window2["default"].clearTimeout(timeoutId);var disposeFn=function disposeFn(){};disposeFn.guid="vjs-timeout-"+timeoutId;this.off("dispose",disposeFn);return timeoutId;};Component.prototype.setInterval=function setInterval(fn,interval){fn=Fn.bind(this,fn);var intervalId=_window2["default"].setInterval(fn,interval);var disposeFn=function disposeFn(){this.clearInterval(intervalId);};disposeFn.guid="vjs-interval-"+intervalId;this.on("dispose",disposeFn);return intervalId;};Component.prototype.clearInterval=function clearInterval(intervalId){_window2["default"].clearInterval(intervalId);var disposeFn=function disposeFn(){};disposeFn.guid="vjs-interval-"+intervalId;this.off("dispose",disposeFn);return intervalId;};Component.registerComponent=function registerComponent(name,comp){if(!name){return;}name=(0,_toTitleCase2["default"])(name);if(!Component.components_){Component.components_={};}if(name==="Player"&&Component.components_[name]){var Player=Component.components_[name];if(Player.players&&Object.keys(Player.players).length>0&&Object.keys(Player.players).map(function(playerName){return Player.players[playerName];}).every(Boolean)){throw new Error("Can not register Player component after player has been created");}}Component.components_[name]=comp;return comp;};Component.getComponent=function getComponent(name){if(!name){return;}name=(0,_toTitleCase2["default"])(name);if(Component.components_&&Component.components_[name]){return Component.components_[name];}if(_window2["default"]&&_window2["default"].videojs&&_window2["default"].videojs[name]){_log2["default"].warn("The "+name+" component was added to the videojs object when it should be registered using videojs.registerComponent(name, component)");return _window2["default"].videojs[name];}};Component.extend=function extend(props){props=props||{};_log2["default"].warn("Component.extend({}) has been deprecated, "+" use videojs.extend(Component, {}) instead");var init=props.init||props.init||this.prototype.init||this.prototype.init||function(){};var subObj=function subObj(){init.apply(this,arguments);};subObj.prototype=Object.create(this.prototype);subObj.prototype.constructor=subObj;subObj.extend=Component.extend;for(var name in props){if(props.hasOwnProperty(name)){subObj.prototype[name]=props[name];}}return subObj;};return Component;}();Component.registerComponent("Component",Component);exports["default"]=Component;},{"./utils/dom.js":320,"./utils/events.js":321,"./utils/fn.js":322,"./utils/guid.js":324,"./utils/log.js":325,"./utils/merge-options.js":326,"./utils/to-title-case.js":330,"global/window":90}],245:[function(require,module,exports){"use strict";exports.__esModule=true;var _trackButton=require("../track-button.js");var _trackButton2=_interopRequireDefault(_trackButton);var _component=require("../../component.js");var _component2=_interopRequireDefault(_component);var _audioTrackMenuItem=require("./audio-track-menu-item.js");var _audioTrackMenuItem2=_interopRequireDefault(_audioTrackMenuItem);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&((typeof call==="undefined"?"undefined":_typeof2(call))==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var AudioTrackButton=function(_TrackButton){_inherits(AudioTrackButton,_TrackButton);function AudioTrackButton(player){var options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};_classCallCheck(this,AudioTrackButton);options.tracks=player.audioTracks&&player.audioTracks();var _this=_possibleConstructorReturn(this,_TrackButton.call(this,player,options));_this.el_.setAttribute("aria-label","Audio Menu");return _this;}AudioTrackButton.prototype.buildCSSClass=function buildCSSClass(){return"vjs-audio-button "+_TrackButton.prototype.buildCSSClass.call(this);};AudioTrackButton.prototype.createItems=function createItems(){var items=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];this.hideThreshold_=1;var tracks=this.player_.audioTracks&&this.player_.audioTracks();if(!tracks){return items;}for(var i=0;i<tracks.length;i++){var track=tracks[i];items.push(new _audioTrackMenuItem2["default"](this.player_,{track:track,selectable:true}));}return items;};return AudioTrackButton;}(_trackButton2["default"]);AudioTrackButton.prototype.controlText_="Audio Track";_component2["default"].registerComponent("AudioTrackButton",AudioTrackButton);exports["default"]=AudioTrackButton;},{"../../component.js":244,"../track-button.js":275,"./audio-track-menu-item.js":246}],246:[function(require,module,exports){"use strict";exports.__esModule=true;var _menuItem=require("../../menu/menu-item.js");var _menuItem2=_interopRequireDefault(_menuItem);var _component=require("../../component.js");var _component2=_interopRequireDefault(_component);var _fn=require("../../utils/fn.js");var Fn=_interopRequireWildcard(_fn);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&((typeof call==="undefined"?"undefined":_typeof2(call))==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var AudioTrackMenuItem=function(_MenuItem){_inherits(AudioTrackMenuItem,_MenuItem);function AudioTrackMenuItem(player,options){_classCallCheck(this,AudioTrackMenuItem);var track=options.track;var tracks=player.audioTracks();options.label=track.label||track.language||"Unknown";options.selected=track.enabled;var _this=_possibleConstructorReturn(this,_MenuItem.call(this,player,options));_this.track=track;if(tracks){var changeHandler=Fn.bind(_this,_this.handleTracksChange);tracks.addEventListener("change",changeHandler);_this.on("dispose",function(){tracks.removeEventListener("change",changeHandler);});}return _this;}AudioTrackMenuItem.prototype.handleClick=function handleClick(event){var tracks=this.player_.audioTracks();_MenuItem.prototype.handleClick.call(this,event);if(!tracks){return;}for(var i=0;i<tracks.length;i++){var track=tracks[i];track.enabled=track===this.track;}};AudioTrackMenuItem.prototype.handleTracksChange=function handleTracksChange(event){this.selected(this.track.enabled);};return AudioTrackMenuItem;}(_menuItem2["default"]);_component2["default"].registerComponent("AudioTrackMenuItem",AudioTrackMenuItem);exports["default"]=AudioTrackMenuItem;},{"../../component.js":244,"../../menu/menu-item.js":287,"../../utils/fn.js":322}],247:[function(require,module,exports){"use strict";exports.__esModule=true;var _component=require("../component.js");var _component2=_interopRequireDefault(_component);require("./play-toggle.js");require("./time-controls/current-time-display.js");require("./time-controls/duration-display.js");require("./time-controls/time-divider.js");require("./time-controls/remaining-time-display.js");require("./live-display.js");require("./progress-control/progress-control.js");require("./fullscreen-toggle.js");require("./volume-control/volume-control.js");require("./volume-menu-button.js");require("./mute-toggle.js");require("./text-track-controls/chapters-button.js");require("./text-track-controls/descriptions-button.js");require("./text-track-controls/subtitles-button.js");require("./text-track-controls/captions-button.js");require("./audio-track-controls/audio-track-button.js");require("./playback-rate-menu/playback-rate-menu-button.js");require("./spacer-controls/custom-control-spacer.js");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&((typeof call==="undefined"?"undefined":_typeof2(call))==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var ControlBar=function(_Component){_inherits(ControlBar,_Component);function ControlBar(){_classCallCheck(this,ControlBar);return _possibleConstructorReturn(this,_Component.apply(this,arguments));}ControlBar.prototype.createEl=function createEl(){return _Component.prototype.createEl.call(this,"div",{className:"vjs-control-bar",dir:"ltr"},{role:"group"});};return ControlBar;}(_component2["default"]);ControlBar.prototype.options_={children:["playToggle","volumeMenuButton","currentTimeDisplay","timeDivider","durationDisplay","progressControl","liveDisplay","remainingTimeDisplay","customControlSpacer","playbackRateMenuButton","chaptersButton","descriptionsButton","subtitlesButton","captionsButton","audioTrackButton","fullscreenToggle"]};_component2["default"].registerComponent("ControlBar",ControlBar);exports["default"]=ControlBar;},{"../component.js":244,"./audio-track-controls/audio-track-button.js":245,"./fullscreen-toggle.js":248,"./live-display.js":249,"./mute-toggle.js":250,"./play-toggle.js":251,"./playback-rate-menu/playback-rate-menu-button.js":252,"./progress-control/progress-control.js":257,"./spacer-controls/custom-control-spacer.js":260,"./text-track-controls/captions-button.js":263,"./text-track-controls/chapters-button.js":264,"./text-track-controls/descriptions-button.js":266,"./text-track-controls/subtitles-button.js":268,"./time-controls/current-time-display.js":271,"./time-controls/duration-display.js":272,"./time-controls/remaining-time-display.js":273,"./time-controls/time-divider.js":274,"./volume-control/volume-control.js":277,"./volume-menu-button.js":279}],248:[function(require,module,exports){"use strict";exports.__esModule=true;var _button=require("../button.js");var _button2=_interopRequireDefault(_button);var _component=require("../component.js");var _component2=_interopRequireDefault(_component);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&((typeof call==="undefined"?"undefined":_typeof2(call))==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var FullscreenToggle=function(_Button){_inherits(FullscreenToggle,_Button);function FullscreenToggle(player,options){_classCallCheck(this,FullscreenToggle);var _this=_possibleConstructorReturn(this,_Button.call(this,player,options));_this.on(player,"fullscreenchange",_this.handleFullscreenChange);return _this;}FullscreenToggle.prototype.buildCSSClass=function buildCSSClass(){return"vjs-fullscreen-control "+_Button.prototype.buildCSSClass.call(this);};FullscreenToggle.prototype.handleFullscreenChange=function handleFullscreenChange(event){if(this.player_.isFullscreen()){this.controlText("Non-Fullscreen");}else{this.controlText("Fullscreen");}};FullscreenToggle.prototype.handleClick=function handleClick(event){if(!this.player_.isFullscreen()){this.player_.requestFullscreen();}else{this.player_.exitFullscreen();}};return FullscreenToggle;}(_button2["default"]);FullscreenToggle.prototype.controlText_="Fullscreen";_component2["default"].registerComponent("FullscreenToggle",FullscreenToggle);exports["default"]=FullscreenToggle;},{"../button.js":241,"../component.js":244}],249:[function(require,module,exports){"use strict";exports.__esModule=true;var _component=require("../component");var _component2=_interopRequireDefault(_component);var _dom=require("../utils/dom.js");var Dom=_interopRequireWildcard(_dom);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&((typeof call==="undefined"?"undefined":_typeof2(call))==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var LiveDisplay=function(_Component){_inherits(LiveDisplay,_Component);function LiveDisplay(player,options){_classCallCheck(this,LiveDisplay);var _this=_possibleConstructorReturn(this,_Component.call(this,player,options));_this.updateShowing();_this.on(_this.player(),"durationchange",_this.updateShowing);return _this;}LiveDisplay.prototype.createEl=function createEl(){var el=_Component.prototype.createEl.call(this,"div",{className:"vjs-live-control vjs-control"});this.contentEl_=Dom.createEl("div",{className:"vjs-live-display",innerHTML:'<span class="vjs-control-text">'+this.localize("Stream Type")+"</span>"+this.localize("LIVE")},{"aria-live":"off"});el.appendChild(this.contentEl_);return el;};LiveDisplay.prototype.updateShowing=function updateShowing(event){if(this.player().duration()===Infinity){this.show();}else{this.hide();}};return LiveDisplay;}(_component2["default"]);_component2["default"].registerComponent("LiveDisplay",LiveDisplay);exports["default"]=LiveDisplay;},{"../component":244,"../utils/dom.js":320}],250:[function(require,module,exports){"use strict";exports.__esModule=true;var _button=require("../button");var _button2=_interopRequireDefault(_button);var _component=require("../component");var _component2=_interopRequireDefault(_component);var _dom=require("../utils/dom.js");var Dom=_interopRequireWildcard(_dom);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&((typeof call==="undefined"?"undefined":_typeof2(call))==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var MuteToggle=function(_Button){_inherits(MuteToggle,_Button);function MuteToggle(player,options){_classCallCheck(this,MuteToggle);var _this=_possibleConstructorReturn(this,_Button.call(this,player,options));_this.on(player,"volumechange",_this.update);if(player.tech_&&player.tech_.featuresVolumeControl===false){_this.addClass("vjs-hidden");}_this.on(player,"loadstart",function(){this.update();if(player.tech_.featuresVolumeControl===false){this.addClass("vjs-hidden");}else{this.removeClass("vjs-hidden");}});return _this;}MuteToggle.prototype.buildCSSClass=function buildCSSClass(){return"vjs-mute-control "+_Button.prototype.buildCSSClass.call(this);};MuteToggle.prototype.handleClick=function handleClick(event){this.player_.muted(this.player_.muted()?false:true);};MuteToggle.prototype.update=function update(event){var vol=this.player_.volume();var level=3;if(vol===0||this.player_.muted()){level=0;}else if(vol<.33){level=1;}else if(vol<.67){level=2;}var toMute=this.player_.muted()?"Unmute":"Mute";if(this.controlText()!==toMute){this.controlText(toMute);}for(var i=0;i<4;i++){Dom.removeElClass(this.el_,"vjs-vol-"+i);}Dom.addElClass(this.el_,"vjs-vol-"+level);};return MuteToggle;}(_button2["default"]);MuteToggle.prototype.controlText_="Mute";_component2["default"].registerComponent("MuteToggle",MuteToggle);exports["default"]=MuteToggle;},{"../button":241,"../component":244,"../utils/dom.js":320}],251:[function(require,module,exports){"use strict";exports.__esModule=true;var _button=require("../button.js");var _button2=_interopRequireDefault(_button);var _component=require("../component.js");var _component2=_interopRequireDefault(_component);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&((typeof call==="undefined"?"undefined":_typeof2(call))==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var PlayToggle=function(_Button){_inherits(PlayToggle,_Button);function PlayToggle(player,options){_classCallCheck(this,PlayToggle);var _this=_possibleConstructorReturn(this,_Button.call(this,player,options));_this.on(player,"play",_this.handlePlay);_this.on(player,"pause",_this.handlePause);return _this;}PlayToggle.prototype.buildCSSClass=function buildCSSClass(){return"vjs-play-control "+_Button.prototype.buildCSSClass.call(this);};PlayToggle.prototype.handleClick=function handleClick(event){if(this.player_.paused()){this.player_.play();}else{this.player_.pause();}};PlayToggle.prototype.handlePlay=function handlePlay(event){this.removeClass("vjs-paused");this.addClass("vjs-playing");this.controlText("Pause");};PlayToggle.prototype.handlePause=function handlePause(event){this.removeClass("vjs-playing");this.addClass("vjs-paused");this.controlText("Play");};return PlayToggle;}(_button2["default"]);PlayToggle.prototype.controlText_="Play";_component2["default"].registerComponent("PlayToggle",PlayToggle);exports["default"]=PlayToggle;},{"../button.js":241,"../component.js":244}],252:[function(require,module,exports){"use strict";exports.__esModule=true;var _menuButton=require("../../menu/menu-button.js");var _menuButton2=_interopRequireDefault(_menuButton);var _menu=require("../../menu/menu.js");var _menu2=_interopRequireDefault(_menu);var _playbackRateMenuItem=require("./playback-rate-menu-item.js");var _playbackRateMenuItem2=_interopRequireDefault(_playbackRateMenuItem);var _component=require("../../component.js");var _component2=_interopRequireDefault(_component);var _dom=require("../../utils/dom.js");var Dom=_interopRequireWildcard(_dom);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&((typeof call==="undefined"?"undefined":_typeof2(call))==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var PlaybackRateMenuButton=function(_MenuButton){_inherits(PlaybackRateMenuButton,_MenuButton);function PlaybackRateMenuButton(player,options){_classCallCheck(this,PlaybackRateMenuButton);var _this=_possibleConstructorReturn(this,_MenuButton.call(this,player,options));_this.updateVisibility();_this.updateLabel();_this.on(player,"loadstart",_this.updateVisibility);_this.on(player,"ratechange",_this.updateLabel);return _this;}PlaybackRateMenuButton.prototype.createEl=function createEl(){var el=_MenuButton.prototype.createEl.call(this);this.labelEl_=Dom.createEl("div",{className:"vjs-playback-rate-value",innerHTML:1});el.appendChild(this.labelEl_);return el;};PlaybackRateMenuButton.prototype.buildCSSClass=function buildCSSClass(){return"vjs-playback-rate "+_MenuButton.prototype.buildCSSClass.call(this);};PlaybackRateMenuButton.prototype.createMenu=function createMenu(){var menu=new _menu2["default"](this.player());var rates=this.playbackRates();if(rates){for(var i=rates.length-1;i>=0;i--){menu.addChild(new _playbackRateMenuItem2["default"](this.player(),{rate:rates[i]+"x"}));}}return menu;};PlaybackRateMenuButton.prototype.updateARIAAttributes=function updateARIAAttributes(){this.el().setAttribute("aria-valuenow",this.player().playbackRate());};PlaybackRateMenuButton.prototype.handleClick=function handleClick(event){var currentRate=this.player().playbackRate();var rates=this.playbackRates();var newRate=rates[0];for(var i=0;i<rates.length;i++){if(rates[i]>currentRate){newRate=rates[i];break;}}this.player().playbackRate(newRate);};PlaybackRateMenuButton.prototype.playbackRates=function playbackRates(){return this.options_.playbackRates||this.options_.playerOptions&&this.options_.playerOptions.playbackRates;};PlaybackRateMenuButton.prototype.playbackRateSupported=function playbackRateSupported(){return this.player().tech_&&this.player().tech_.featuresPlaybackRate&&this.playbackRates()&&this.playbackRates().length>0;};PlaybackRateMenuButton.prototype.updateVisibility=function updateVisibility(event){if(this.playbackRateSupported()){this.removeClass("vjs-hidden");}else{this.addClass("vjs-hidden");}};PlaybackRateMenuButton.prototype.updateLabel=function updateLabel(event){if(this.playbackRateSupported()){this.labelEl_.innerHTML=this.player().playbackRate()+"x";}};return PlaybackRateMenuButton;}(_menuButton2["default"]);PlaybackRateMenuButton.prototype.controlText_="Playback Rate";_component2["default"].registerComponent("PlaybackRateMenuButton",PlaybackRateMenuButton);exports["default"]=PlaybackRateMenuButton;},{"../../component.js":244,"../../menu/menu-button.js":286,"../../menu/menu.js":288,"../../utils/dom.js":320,"./playback-rate-menu-item.js":253}],253:[function(require,module,exports){"use strict";exports.__esModule=true;var _menuItem=require("../../menu/menu-item.js");var _menuItem2=_interopRequireDefault(_menuItem);var _component=require("../../component.js");var _component2=_interopRequireDefault(_component);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&((typeof call==="undefined"?"undefined":_typeof2(call))==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var PlaybackRateMenuItem=function(_MenuItem){_inherits(PlaybackRateMenuItem,_MenuItem);function PlaybackRateMenuItem(player,options){_classCallCheck(this,PlaybackRateMenuItem);var label=options.rate;var rate=parseFloat(label,10);options.label=label;options.selected=rate===1;options.selectable=true;var _this=_possibleConstructorReturn(this,_MenuItem.call(this,player,options));_this.label=label;_this.rate=rate;_this.on(player,"ratechange",_this.update);return _this;}PlaybackRateMenuItem.prototype.handleClick=function handleClick(event){_MenuItem.prototype.handleClick.call(this);this.player().playbackRate(this.rate);};PlaybackRateMenuItem.prototype.update=function update(event){this.selected(this.player().playbackRate()===this.rate);};return PlaybackRateMenuItem;}(_menuItem2["default"]);PlaybackRateMenuItem.prototype.contentElType="button";_component2["default"].registerComponent("PlaybackRateMenuItem",PlaybackRateMenuItem);exports["default"]=PlaybackRateMenuItem;},{"../../component.js":244,"../../menu/menu-item.js":287}],254:[function(require,module,exports){"use strict";exports.__esModule=true;var _component=require("../../component.js");var _component2=_interopRequireDefault(_component);var _dom=require("../../utils/dom.js");var Dom=_interopRequireWildcard(_dom);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&((typeof call==="undefined"?"undefined":_typeof2(call))==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var LoadProgressBar=function(_Component){_inherits(LoadProgressBar,_Component);function LoadProgressBar(player,options){_classCallCheck(this,LoadProgressBar);var _this=_possibleConstructorReturn(this,_Component.call(this,player,options));_this.partEls_=[];_this.on(player,"progress",_this.update);return _this;}LoadProgressBar.prototype.createEl=function createEl(){return _Component.prototype.createEl.call(this,"div",{className:"vjs-load-progress",innerHTML:'<span class="vjs-control-text"><span>'+this.localize("Loaded")+"</span>: 0%</span>"});};LoadProgressBar.prototype.update=function update(event){var buffered=this.player_.buffered();var duration=this.player_.duration();var bufferedEnd=this.player_.bufferedEnd();var children=this.partEls_;var percentify=function percentify(time,end){var percent=time/end||0;return(percent>=1?1:percent)*100+"%";};this.el_.style.width=percentify(bufferedEnd,duration);for(var i=0;i<buffered.length;i++){var start=buffered.start(i);var end=buffered.end(i);var part=children[i];if(!part){part=this.el_.appendChild(Dom.createEl());children[i]=part;}part.style.left=percentify(start,bufferedEnd);part.style.width=percentify(end-start,bufferedEnd);}for(var _i=children.length;_i>buffered.length;_i--){this.el_.removeChild(children[_i-1]);}children.length=buffered.length;};return LoadProgressBar;}(_component2["default"]);_component2["default"].registerComponent("LoadProgressBar",LoadProgressBar);exports["default"]=LoadProgressBar;},{"../../component.js":244,"../../utils/dom.js":320}],255:[function(require,module,exports){"use strict";exports.__esModule=true;var _component=require("../../component.js");var _component2=_interopRequireDefault(_component);var _dom=require("../../utils/dom.js");var Dom=_interopRequireWildcard(_dom);var _fn=require("../../utils/fn.js");var Fn=_interopRequireWildcard(_fn);var _formatTime=require("../../utils/format-time.js");var _formatTime2=_interopRequireDefault(_formatTime);var _computedStyle=require("../../utils/computed-style.js");var _computedStyle2=_interopRequireDefault(_computedStyle);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&((typeof call==="undefined"?"undefined":_typeof2(call))==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var MouseTimeDisplay=function(_Component){_inherits(MouseTimeDisplay,_Component);function MouseTimeDisplay(player,options){_classCallCheck(this,MouseTimeDisplay);var _this=_possibleConstructorReturn(this,_Component.call(this,player,options));if(options.playerOptions&&options.playerOptions.controlBar&&options.playerOptions.controlBar.progressControl&&options.playerOptions.controlBar.progressControl.keepTooltipsInside){_this.keepTooltipsInside=options.playerOptions.controlBar.progressControl.keepTooltipsInside;}if(_this.keepTooltipsInside){_this.tooltip=Dom.createEl("div",{className:"vjs-time-tooltip"});_this.el().appendChild(_this.tooltip);_this.addClass("vjs-keep-tooltips-inside");}_this.update(0,0);player.on("ready",function(){_this.on(player.controlBar.progressControl.el(),"mousemove",Fn.throttle(Fn.bind(_this,_this.handleMouseMove),25));});return _this;}MouseTimeDisplay.prototype.createEl=function createEl(){return _Component.prototype.createEl.call(this,"div",{className:"vjs-mouse-display"});};MouseTimeDisplay.prototype.handleMouseMove=function handleMouseMove(event){var duration=this.player_.duration();var newTime=this.calculateDistance(event)*duration;var position=event.pageX-Dom.findElPosition(this.el().parentNode).left;this.update(newTime,position);};MouseTimeDisplay.prototype.update=function update(newTime,position){var time=(0,_formatTime2["default"])(newTime,this.player_.duration());this.el().style.left=position+"px";this.el().setAttribute("data-current-time",time);if(this.keepTooltipsInside){var clampedPosition=this.clampPosition_(position);var difference=position-clampedPosition+1;var tooltipWidth=parseFloat((0,_computedStyle2["default"])(this.tooltip,"width"));var tooltipWidthHalf=tooltipWidth/2;this.tooltip.innerHTML=time;this.tooltip.style.right="-"+(tooltipWidthHalf-difference)+"px";}};MouseTimeDisplay.prototype.calculateDistance=function calculateDistance(event){return Dom.getPointerPosition(this.el().parentNode,event).x;};MouseTimeDisplay.prototype.clampPosition_=function clampPosition_(position){if(!this.keepTooltipsInside){return position;}var playerWidth=parseFloat((0,_computedStyle2["default"])(this.player().el(),"width"));var tooltipWidth=parseFloat((0,_computedStyle2["default"])(this.tooltip,"width"));var tooltipWidthHalf=tooltipWidth/2;var actualPosition=position;if(position<tooltipWidthHalf){actualPosition=Math.ceil(tooltipWidthHalf);}else if(position>playerWidth-tooltipWidthHalf){actualPosition=Math.floor(playerWidth-tooltipWidthHalf);}return actualPosition;};return MouseTimeDisplay;}(_component2["default"]);_component2["default"].registerComponent("MouseTimeDisplay",MouseTimeDisplay);exports["default"]=MouseTimeDisplay;},{"../../component.js":244,"../../utils/computed-style.js":319,"../../utils/dom.js":320,"../../utils/fn.js":322,"../../utils/format-time.js":323}],256:[function(require,module,exports){"use strict";exports.__esModule=true;var _component=require("../../component.js");var _component2=_interopRequireDefault(_component);var _fn=require("../../utils/fn.js");var Fn=_interopRequireWildcard(_fn);var _formatTime=require("../../utils/format-time.js");var _formatTime2=_interopRequireDefault(_formatTime);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&((typeof call==="undefined"?"undefined":_typeof2(call))==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var PlayProgressBar=function(_Component){_inherits(PlayProgressBar,_Component);function PlayProgressBar(player,options){_classCallCheck(this,PlayProgressBar);var _this=_possibleConstructorReturn(this,_Component.call(this,player,options));_this.updateDataAttr();_this.on(player,"timeupdate",_this.updateDataAttr);player.ready(Fn.bind(_this,_this.updateDataAttr));if(options.playerOptions&&options.playerOptions.controlBar&&options.playerOptions.controlBar.progressControl&&options.playerOptions.controlBar.progressControl.keepTooltipsInside){_this.keepTooltipsInside=options.playerOptions.controlBar.progressControl.keepTooltipsInside;}if(_this.keepTooltipsInside){_this.addClass("vjs-keep-tooltips-inside");}return _this;}PlayProgressBar.prototype.createEl=function createEl(){return _Component.prototype.createEl.call(this,"div",{className:"vjs-play-progress vjs-slider-bar",innerHTML:'<span class="vjs-control-text"><span>'+this.localize("Progress")+"</span>: 0%</span>"});};PlayProgressBar.prototype.updateDataAttr=function updateDataAttr(event){var time=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime();this.el_.setAttribute("data-current-time",(0,_formatTime2["default"])(time,this.player_.duration()));};return PlayProgressBar;}(_component2["default"]);_component2["default"].registerComponent("PlayProgressBar",PlayProgressBar);exports["default"]=PlayProgressBar;},{"../../component.js":244,"../../utils/fn.js":322,"../../utils/format-time.js":323}],257:[function(require,module,exports){"use strict";exports.__esModule=true;var _component=require("../../component.js");var _component2=_interopRequireDefault(_component);require("./seek-bar.js");require("./mouse-time-display.js");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&((typeof call==="undefined"?"undefined":_typeof2(call))==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var ProgressControl=function(_Component){_inherits(ProgressControl,_Component);function ProgressControl(){_classCallCheck(this,ProgressControl);return _possibleConstructorReturn(this,_Component.apply(this,arguments));}ProgressControl.prototype.createEl=function createEl(){return _Component.prototype.createEl.call(this,"div",{className:"vjs-progress-control vjs-control"});};return ProgressControl;}(_component2["default"]);ProgressControl.prototype.options_={children:["seekBar"]};_component2["default"].registerComponent("ProgressControl",ProgressControl);exports["default"]=ProgressControl;},{"../../component.js":244,"./mouse-time-display.js":255,"./seek-bar.js":258}],258:[function(require,module,exports){"use strict";exports.__esModule=true;var _slider=require("../../slider/slider.js");var _slider2=_interopRequireDefault(_slider);var _component=require("../../component.js");var _component2=_interopRequireDefault(_component);var _fn=require("../../utils/fn.js");var Fn=_interopRequireWildcard(_fn);var _formatTime=require("../../utils/format-time.js");var _formatTime2=_interopRequireDefault(_formatTime);var _computedStyle=require("../../utils/computed-style.js");var _computedStyle2=_interopRequireDefault(_computedStyle);require("./load-progress-bar.js");require("./play-progress-bar.js");require("./tooltip-progress-bar.js");function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&((typeof call==="undefined"?"undefined":_typeof2(call))==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var SeekBar=function(_Slider){_inherits(SeekBar,_Slider);function SeekBar(player,options){_classCallCheck(this,SeekBar);var _this=_possibleConstructorReturn(this,_Slider.call(this,player,options));_this.on(player,"timeupdate",_this.updateProgress);_this.on(player,"ended",_this.updateProgress);player.ready(Fn.bind(_this,_this.updateProgress));if(options.playerOptions&&options.playerOptions.controlBar&&options.playerOptions.controlBar.progressControl&&options.playerOptions.controlBar.progressControl.keepTooltipsInside){_this.keepTooltipsInside=options.playerOptions.controlBar.progressControl.keepTooltipsInside;}if(_this.keepTooltipsInside){_this.tooltipProgressBar=_this.addChild("TooltipProgressBar");}return _this;}SeekBar.prototype.createEl=function createEl(){return _Slider.prototype.createEl.call(this,"div",{className:"vjs-progress-holder"},{"aria-label":"progress bar"});};SeekBar.prototype.updateProgress=function updateProgress(event){this.updateAriaAttributes(this.el_);if(this.keepTooltipsInside){this.updateAriaAttributes(this.tooltipProgressBar.el_);this.tooltipProgressBar.el_.style.width=this.bar.el_.style.width;var playerWidth=parseFloat((0,_computedStyle2["default"])(this.player().el(),"width"));var tooltipWidth=parseFloat((0,_computedStyle2["default"])(this.tooltipProgressBar.tooltip,"width"));var tooltipStyle=this.tooltipProgressBar.el().style;tooltipStyle.maxWidth=Math.floor(playerWidth-tooltipWidth/2)+"px";tooltipStyle.minWidth=Math.ceil(tooltipWidth/2)+"px";tooltipStyle.right="-"+tooltipWidth/2+"px";}};SeekBar.prototype.updateAriaAttributes=function updateAriaAttributes(el){var time=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime();el.setAttribute("aria-valuenow",(this.getPercent()*100).toFixed(2));el.setAttribute("aria-valuetext",(0,_formatTime2["default"])(time,this.player_.duration()));};SeekBar.prototype.getPercent=function getPercent(){var percent=this.player_.currentTime()/this.player_.duration();return percent>=1?1:percent;};SeekBar.prototype.handleMouseDown=function handleMouseDown(event){this.player_.scrubbing(true);this.videoWasPlaying=!this.player_.paused();this.player_.pause();_Slider.prototype.handleMouseDown.call(this,event);};SeekBar.prototype.handleMouseMove=function handleMouseMove(event){var newTime=this.calculateDistance(event)*this.player_.duration();if(newTime===this.player_.duration()){newTime=newTime-.1;}this.player_.currentTime(newTime);};SeekBar.prototype.handleMouseUp=function handleMouseUp(event){_Slider.prototype.handleMouseUp.call(this,event);this.player_.scrubbing(false);if(this.videoWasPlaying){this.player_.play();}};SeekBar.prototype.stepForward=function stepForward(){this.player_.currentTime(this.player_.currentTime()+5);};SeekBar.prototype.stepBack=function stepBack(){this.player_.currentTime(this.player_.currentTime()-5);};return SeekBar;}(_slider2["default"]);SeekBar.prototype.options_={children:["loadProgressBar","mouseTimeDisplay","playProgressBar"],barName:"playProgressBar"};SeekBar.prototype.playerEvent="timeupdate";_component2["default"].registerComponent("SeekBar",SeekBar);exports["default"]=SeekBar;},{"../../component.js":244,"../../slider/slider.js":296,"../../utils/computed-style.js":319,"../../utils/fn.js":322,"../../utils/format-time.js":323,"./load-progress-bar.js":254,"./play-progress-bar.js":256,"./tooltip-progress-bar.js":259}],259:[function(require,module,exports){"use strict";exports.__esModule=true;var _component=require("../../component.js");var _component2=_interopRequireDefault(_component);var _fn=require("../../utils/fn.js");var Fn=_interopRequireWildcard(_fn);var _formatTime=require("../../utils/format-time.js");var _formatTime2=_interopRequireDefault(_formatTime);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&((typeof call==="undefined"?"undefined":_typeof2(call))==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var TooltipProgressBar=function(_Component){_inherits(TooltipProgressBar,_Component);function TooltipProgressBar(player,options){_classCallCheck(this,TooltipProgressBar);var _this=_possibleConstructorReturn(this,_Component.call(this,player,options));_this.updateDataAttr();_this.on(player,"timeupdate",_this.updateDataAttr);player.ready(Fn.bind(_this,_this.updateDataAttr));return _this;}TooltipProgressBar.prototype.createEl=function createEl(){var el=_Component.prototype.createEl.call(this,"div",{className:"vjs-tooltip-progress-bar vjs-slider-bar",innerHTML:'<div class="vjs-time-tooltip"></div>\n        <span class="vjs-control-text"><span>'+this.localize("Progress")+"</span>: 0%</span>"});this.tooltip=el.querySelector(".vjs-time-tooltip");return el;};TooltipProgressBar.prototype.updateDataAttr=function updateDataAttr(event){var time=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime();var formattedTime=(0,_formatTime2["default"])(time,this.player_.duration());this.el_.setAttribute("data-current-time",formattedTime);this.tooltip.innerHTML=formattedTime;};return TooltipProgressBar;}(_component2["default"]);_component2["default"].registerComponent("TooltipProgressBar",TooltipProgressBar);exports["default"]=TooltipProgressBar;},{"../../component.js":244,"../../utils/fn.js":322,"../../utils/format-time.js":323}],260:[function(require,module,exports){"use strict";exports.__esModule=true;var _spacer=require("./spacer.js");var _spacer2=_interopRequireDefault(_spacer);var _component=require("../../component.js");var _component2=_interopRequireDefault(_component);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&((typeof call==="undefined"?"undefined":_typeof2(call))==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var CustomControlSpacer=function(_Spacer){_inherits(CustomControlSpacer,_Spacer);function CustomControlSpacer(){_classCallCheck(this,CustomControlSpacer);return _possibleConstructorReturn(this,_Spacer.apply(this,arguments));}CustomControlSpacer.prototype.buildCSSClass=function buildCSSClass(){return"vjs-custom-control-spacer "+_Spacer.prototype.buildCSSClass.call(this);};CustomControlSpacer.prototype.createEl=function createEl(){var el=_Spacer.prototype.createEl.call(this,{className:this.buildCSSClass()});el.innerHTML="&nbsp;";return el;};return CustomControlSpacer;}(_spacer2["default"]);_component2["default"].registerComponent("CustomControlSpacer",CustomControlSpacer);exports["default"]=CustomControlSpacer;},{"../../component.js":244,"./spacer.js":261}],261:[function(require,module,exports){"use strict";exports.__esModule=true;var _component=require("../../component.js");var _component2=_interopRequireDefault(_component);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&((typeof call==="undefined"?"undefined":_typeof2(call))==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var Spacer=function(_Component){_inherits(Spacer,_Component);function Spacer(){_classCallCheck(this,Spacer);return _possibleConstructorReturn(this,_Component.apply(this,arguments));}Spacer.prototype.buildCSSClass=function buildCSSClass(){return"vjs-spacer "+_Component.prototype.buildCSSClass.call(this);};Spacer.prototype.createEl=function createEl(){return _Component.prototype.createEl.call(this,"div",{className:this.buildCSSClass()});};return Spacer;}(_component2["default"]);_component2["default"].registerComponent("Spacer",Spacer);exports["default"]=Spacer;},{"../../component.js":244}],262:[function(require,module,exports){"use strict";exports.__esModule=true;var _textTrackMenuItem=require("./text-track-menu-item.js");var _textTrackMenuItem2=_interopRequireDefault(_textTrackMenuItem);var _component=require("../../component.js");var _component2=_interopRequireDefault(_component);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&((typeof call==="undefined"?"undefined":_typeof2(call))==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var CaptionSettingsMenuItem=function(_TextTrackMenuItem){_inherits(CaptionSettingsMenuItem,_TextTrackMenuItem);function CaptionSettingsMenuItem(player,options){_classCallCheck(this,CaptionSettingsMenuItem);options.track={player:player,kind:options.kind,label:options.kind+" settings",selectable:false,default:false,mode:"disabled"};options.selectable=false;var _this=_possibleConstructorReturn(this,_TextTrackMenuItem.call(this,player,options));_this.addClass("vjs-texttrack-settings");_this.controlText(", opens "+options.kind+" settings dialog");return _this;}CaptionSettingsMenuItem.prototype.handleClick=function handleClick(event){this.player().getChild("textTrackSettings").show();this.player().getChild("textTrackSettings").el_.focus();};return CaptionSettingsMenuItem;}(_textTrackMenuItem2["default"]);_component2["default"].registerComponent("CaptionSettingsMenuItem",CaptionSettingsMenuItem);exports["default"]=CaptionSettingsMenuItem;},{"../../component.js":244,"./text-track-menu-item.js":270}],263:[function(require,module,exports){"use strict";exports.__esModule=true;var _textTrackButton=require("./text-track-button.js");var _textTrackButton2=_interopRequireDefault(_textTrackButton);var _component=require("../../component.js");var _component2=_interopRequireDefault(_component);var _captionSettingsMenuItem=require("./caption-settings-menu-item.js");var _captionSettingsMenuItem2=_interopRequireDefault(_captionSettingsMenuItem);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&((typeof call==="undefined"?"undefined":_typeof2(call))==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var CaptionsButton=function(_TextTrackButton){_inherits(CaptionsButton,_TextTrackButton);function CaptionsButton(player,options,ready){_classCallCheck(this,CaptionsButton);var _this=_possibleConstructorReturn(this,_TextTrackButton.call(this,player,options,ready));_this.el_.setAttribute("aria-label","Captions Menu");return _this;}CaptionsButton.prototype.buildCSSClass=function buildCSSClass(){return"vjs-captions-button "+_TextTrackButton.prototype.buildCSSClass.call(this);};CaptionsButton.prototype.createItems=function createItems(){var items=[];if(!(this.player().tech_&&this.player().tech_.featuresNativeTextTracks)){items.push(new _captionSettingsMenuItem2["default"](this.player_,{kind:this.kind_}));this.hideThreshold_+=1;}return _TextTrackButton.prototype.createItems.call(this,items);};return CaptionsButton;}(_textTrackButton2["default"]);CaptionsButton.prototype.kind_="captions";CaptionsButton.prototype.controlText_="Captions";_component2["default"].registerComponent("CaptionsButton",CaptionsButton);exports["default"]=CaptionsButton;},{"../../component.js":244,"./caption-settings-menu-item.js":262,"./text-track-button.js":269}],264:[function(require,module,exports){"use strict";exports.__esModule=true;var _textTrackButton=require("./text-track-button.js");var _textTrackButton2=_interopRequireDefault(_textTrackButton);var _component=require("../../component.js");var _component2=_interopRequireDefault(_component);var _chaptersTrackMenuItem=require("./chapters-track-menu-item.js");var _chaptersTrackMenuItem2=_interopRequireDefault(_chaptersTrackMenuItem);var _toTitleCase=require("../../utils/to-title-case.js");var _toTitleCase2=_interopRequireDefault(_toTitleCase);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&((typeof call==="undefined"?"undefined":_typeof2(call))==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var ChaptersButton=function(_TextTrackButton){_inherits(ChaptersButton,_TextTrackButton);function ChaptersButton(player,options,ready){_classCallCheck(this,ChaptersButton);var _this=_possibleConstructorReturn(this,_TextTrackButton.call(this,player,options,ready));_this.el_.setAttribute("aria-label","Chapters Menu");return _this;}ChaptersButton.prototype.buildCSSClass=function buildCSSClass(){return"vjs-chapters-button "+_TextTrackButton.prototype.buildCSSClass.call(this);};ChaptersButton.prototype.update=function update(event){if(!this.track_||event&&(event.type==="addtrack"||event.type==="removetrack")){this.setTrack(this.findChaptersTrack());}_TextTrackButton.prototype.update.call(this);};ChaptersButton.prototype.setTrack=function setTrack(track){if(this.track_===track){return;}if(!this.updateHandler_){this.updateHandler_=this.update.bind(this);}if(this.track_){var remoteTextTrackEl=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);if(remoteTextTrackEl){remoteTextTrackEl.removeEventListener("load",this.updateHandler_);}this.track_=null;}this.track_=track;if(this.track_){this.track_.mode="hidden";var _remoteTextTrackEl=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);if(_remoteTextTrackEl){_remoteTextTrackEl.addEventListener("load",this.updateHandler_);}}};ChaptersButton.prototype.findChaptersTrack=function findChaptersTrack(){var tracks=this.player_.textTracks()||[];for(var i=tracks.length-1;i>=0;i--){var track=tracks[i];if(track.kind===this.kind_){return track;}}};ChaptersButton.prototype.getMenuCaption=function getMenuCaption(){if(this.track_&&this.track_.label){return this.track_.label;}return this.localize((0,_toTitleCase2["default"])(this.kind_));};ChaptersButton.prototype.createMenu=function createMenu(){this.options_.title=this.getMenuCaption();return _TextTrackButton.prototype.createMenu.call(this);};ChaptersButton.prototype.createItems=function createItems(){var items=[];if(!this.track_){return items;}var cues=this.track_.cues;if(!cues){return items;}for(var i=0,l=cues.length;i<l;i++){var cue=cues[i];var mi=new _chaptersTrackMenuItem2["default"](this.player_,{track:this.track_,cue:cue});items.push(mi);}return items;};return ChaptersButton;}(_textTrackButton2["default"]);ChaptersButton.prototype.kind_="chapters";ChaptersButton.prototype.controlText_="Chapters";_component2["default"].registerComponent("ChaptersButton",ChaptersButton);exports["default"]=ChaptersButton;},{"../../component.js":244,"../../utils/to-title-case.js":330,"./chapters-track-menu-item.js":265,"./text-track-button.js":269}],265:[function(require,module,exports){"use strict";exports.__esModule=true;var _menuItem=require("../../menu/menu-item.js");var _menuItem2=_interopRequireDefault(_menuItem);var _component=require("../../component.js");var _component2=_interopRequireDefault(_component);var _fn=require("../../utils/fn.js");var Fn=_interopRequireWildcard(_fn);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&((typeof call==="undefined"?"undefined":_typeof2(call))==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var ChaptersTrackMenuItem=function(_MenuItem){_inherits(ChaptersTrackMenuItem,_MenuItem);function ChaptersTrackMenuItem(player,options){_classCallCheck(this,ChaptersTrackMenuItem);var track=options.track;var cue=options.cue;var currentTime=player.currentTime();options.selectable=true;options.label=cue.text;options.selected=cue.startTime<=currentTime&&currentTime<cue.endTime;var _this=_possibleConstructorReturn(this,_MenuItem.call(this,player,options));_this.track=track;_this.cue=cue;track.addEventListener("cuechange",Fn.bind(_this,_this.update));return _this;}ChaptersTrackMenuItem.prototype.handleClick=function handleClick(event){_MenuItem.prototype.handleClick.call(this);this.player_.currentTime(this.cue.startTime);this.update(this.cue.startTime);};ChaptersTrackMenuItem.prototype.update=function update(event){var cue=this.cue;var currentTime=this.player_.currentTime();this.selected(cue.startTime<=currentTime&&currentTime<cue.endTime);};return ChaptersTrackMenuItem;}(_menuItem2["default"]);_component2["default"].registerComponent("ChaptersTrackMenuItem",ChaptersTrackMenuItem);exports["default"]=ChaptersTrackMenuItem;},{"../../component.js":244,"../../menu/menu-item.js":287,"../../utils/fn.js":322}],266:[function(require,module,exports){"use strict";exports.__esModule=true;var _textTrackButton=require("./text-track-button.js");var _textTrackButton2=_interopRequireDefault(_textTrackButton);var _component=require("../../component.js");var _component2=_interopRequireDefault(_component);var _fn=require("../../utils/fn.js");var Fn=_interopRequireWildcard(_fn);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&((typeof call==="undefined"?"undefined":_typeof2(call))==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var DescriptionsButton=function(_TextTrackButton){_inherits(DescriptionsButton,_TextTrackButton);function DescriptionsButton(player,options,ready){_classCallCheck(this,DescriptionsButton);var _this=_possibleConstructorReturn(this,_TextTrackButton.call(this,player,options,ready));_this.el_.setAttribute("aria-label","Descriptions Menu");var tracks=player.textTracks();if(tracks){var changeHandler=Fn.bind(_this,_this.handleTracksChange);tracks.addEventListener("change",changeHandler);_this.on("dispose",function(){tracks.removeEventListener("change",changeHandler);});}return _this;}DescriptionsButton.prototype.handleTracksChange=function handleTracksChange(event){var tracks=this.player().textTracks();var disabled=false;for(var i=0,l=tracks.length;i<l;i++){var track=tracks[i];if(track.kind!==this.kind_&&track.mode==="showing"){disabled=true;break;}}if(disabled){this.disable();}else{this.enable();}};DescriptionsButton.prototype.buildCSSClass=function buildCSSClass(){return"vjs-descriptions-button "+_TextTrackButton.prototype.buildCSSClass.call(this);};return DescriptionsButton;}(_textTrackButton2["default"]);DescriptionsButton.prototype.kind_="descriptions";DescriptionsButton.prototype.controlText_="Descriptions";_component2["default"].registerComponent("DescriptionsButton",DescriptionsButton);exports["default"]=DescriptionsButton;},{"../../component.js":244,"../../utils/fn.js":322,"./text-track-button.js":269}],267:[function(require,module,exports){"use strict";exports.__esModule=true;var _textTrackMenuItem=require("./text-track-menu-item.js");var _textTrackMenuItem2=_interopRequireDefault(_textTrackMenuItem);var _component=require("../../component.js");var _component2=_interopRequireDefault(_component);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&((typeof call==="undefined"?"undefined":_typeof2(call))==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var OffTextTrackMenuItem=function(_TextTrackMenuItem){_inherits(OffTextTrackMenuItem,_TextTrackMenuItem);function OffTextTrackMenuItem(player,options){_classCallCheck(this,OffTextTrackMenuItem);options.track={player:player,kind:options.kind,label:options.kind+" off",default:false,mode:"disabled"};options.selectable=true;var _this=_possibleConstructorReturn(this,_TextTrackMenuItem.call(this,player,options));_this.selected(true);return _this;}OffTextTrackMenuItem.prototype.handleTracksChange=function handleTracksChange(event){var tracks=this.player().textTracks();var selected=true;for(var i=0,l=tracks.length;i<l;i++){var track=tracks[i];if(track.kind===this.track.kind&&track.mode==="showing"){selected=false;break;}}this.selected(selected);};return OffTextTrackMenuItem;}(_textTrackMenuItem2["default"]);_component2["default"].registerComponent("OffTextTrackMenuItem",OffTextTrackMenuItem);exports["default"]=OffTextTrackMenuItem;},{"../../component.js":244,"./text-track-menu-item.js":270}],268:[function(require,module,exports){"use strict";exports.__esModule=true;var _textTrackButton=require("./text-track-button.js");var _textTrackButton2=_interopRequireDefault(_textTrackButton);var _component=require("../../component.js");var _component2=_interopRequireDefault(_component);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&((typeof call==="undefined"?"undefined":_typeof2(call))==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var SubtitlesButton=function(_TextTrackButton){_inherits(SubtitlesButton,_TextTrackButton);function SubtitlesButton(player,options,ready){_classCallCheck(this,SubtitlesButton);var _this=_possibleConstructorReturn(this,_TextTrackButton.call(this,player,options,ready));_this.el_.setAttribute("aria-label","Subtitles Menu");return _this;}SubtitlesButton.prototype.buildCSSClass=function buildCSSClass(){return"vjs-subtitles-button "+_TextTrackButton.prototype.buildCSSClass.call(this);};return SubtitlesButton;}(_textTrackButton2["default"]);SubtitlesButton.prototype.kind_="subtitles";SubtitlesButton.prototype.controlText_="Subtitles";_component2["default"].registerComponent("SubtitlesButton",SubtitlesButton);exports["default"]=SubtitlesButton;},{"../../component.js":244,"./text-track-button.js":269}],269:[function(require,module,exports){"use strict";exports.__esModule=true;var _trackButton=require("../track-button.js");var _trackButton2=_interopRequireDefault(_trackButton);var _component=require("../../component.js");var _component2=_interopRequireDefault(_component);var _textTrackMenuItem=require("./text-track-menu-item.js");var _textTrackMenuItem2=_interopRequireDefault(_textTrackMenuItem);var _offTextTrackMenuItem=require("./off-text-track-menu-item.js");var _offTextTrackMenuItem2=_interopRequireDefault(_offTextTrackMenuItem);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&((typeof call==="undefined"?"undefined":_typeof2(call))==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var TextTrackButton=function(_TrackButton){_inherits(TextTrackButton,_TrackButton);function TextTrackButton(player){var options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};_classCallCheck(this,TextTrackButton);options.tracks=player.textTracks();return _possibleConstructorReturn(this,_TrackButton.call(this,player,options));}TextTrackButton.prototype.createItems=function createItems(){var items=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];items.push(new _offTextTrackMenuItem2["default"](this.player_,{kind:this.kind_}));this.hideThreshold_+=1;var tracks=this.player_.textTracks();if(!tracks){return items;}for(var i=0;i<tracks.length;i++){var track=tracks[i];if(track.kind===this.kind_){items.push(new _textTrackMenuItem2["default"](this.player_,{track:track,selectable:true}));}}return items;};return TextTrackButton;}(_trackButton2["default"]);_component2["default"].registerComponent("TextTrackButton",TextTrackButton);exports["default"]=TextTrackButton;},{"../../component.js":244,"../track-button.js":275,"./off-text-track-menu-item.js":267,"./text-track-menu-item.js":270}],270:[function(require,module,exports){"use strict";exports.__esModule=true;var _typeof=typeof Symbol==="function"&&_typeof2(Symbol.iterator)==="symbol"?function(obj){return typeof obj==="undefined"?"undefined":_typeof2(obj);}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj==="undefined"?"undefined":_typeof2(obj);};var _menuItem=require("../../menu/menu-item.js");var _menuItem2=_interopRequireDefault(_menuItem);var _component=require("../../component.js");var _component2=_interopRequireDefault(_component);var _fn=require("../../utils/fn.js");var Fn=_interopRequireWildcard(_fn);var _window=require("global/window");var _window2=_interopRequireDefault(_window);var _document=require("global/document");var _document2=_interopRequireDefault(_document);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&((typeof call==="undefined"?"undefined":_typeof2(call))==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var TextTrackMenuItem=function(_MenuItem){_inherits(TextTrackMenuItem,_MenuItem);function TextTrackMenuItem(player,options){_classCallCheck(this,TextTrackMenuItem);var track=options.track;var tracks=player.textTracks();options.label=track.label||track.language||"Unknown";options.selected=track["default"]||track.mode==="showing";var _this=_possibleConstructorReturn(this,_MenuItem.call(this,player,options));_this.track=track;if(tracks){var changeHandler=Fn.bind(_this,_this.handleTracksChange);player.on(["loadstart","texttrackchange"],changeHandler);tracks.addEventListener("change",changeHandler);_this.on("dispose",function(){tracks.removeEventListener("change",changeHandler);});}if(tracks&&tracks.onchange===undefined){var event=void 0;_this.on(["tap","click"],function(){if(_typeof(_window2["default"].Event)!=="object"){try{event=new _window2["default"].Event("change");}catch(err){}}if(!event){event=_document2["default"].createEvent("Event");event.initEvent("change",true,true);}tracks.dispatchEvent(event);});}return _this;}TextTrackMenuItem.prototype.handleClick=function handleClick(event){var kind=this.track.kind;var tracks=this.player_.textTracks();_MenuItem.prototype.handleClick.call(this,event);if(!tracks){return;}for(var i=0;i<tracks.length;i++){var track=tracks[i];if(track.kind!==kind){continue;}if(track===this.track){track.mode="showing";}else{track.mode="disabled";}}};TextTrackMenuItem.prototype.handleTracksChange=function handleTracksChange(event){this.selected(this.track.mode==="showing");};return TextTrackMenuItem;}(_menuItem2["default"]);_component2["default"].registerComponent("TextTrackMenuItem",TextTrackMenuItem);exports["default"]=TextTrackMenuItem;},{"../../component.js":244,"../../menu/menu-item.js":287,"../../utils/fn.js":322,"global/document":89,"global/window":90}],271:[function(require,module,exports){"use strict";exports.__esModule=true;var _component=require("../../component.js");var _component2=_interopRequireDefault(_component);var _dom=require("../../utils/dom.js");var Dom=_interopRequireWildcard(_dom);var _formatTime=require("../../utils/format-time.js");var _formatTime2=_interopRequireDefault(_formatTime);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&((typeof call==="undefined"?"undefined":_typeof2(call))==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var CurrentTimeDisplay=function(_Component){_inherits(CurrentTimeDisplay,_Component);function CurrentTimeDisplay(player,options){_classCallCheck(this,CurrentTimeDisplay);var _this=_possibleConstructorReturn(this,_Component.call(this,player,options));_this.on(player,"timeupdate",_this.updateContent);return _this;}CurrentTimeDisplay.prototype.createEl=function createEl(){var el=_Component.prototype.createEl.call(this,"div",{className:"vjs-current-time vjs-time-control vjs-control"});this.contentEl_=Dom.createEl("div",{className:"vjs-current-time-display",innerHTML:'<span class="vjs-control-text">Current Time </span>'+"0:00"},{"aria-live":"off"});el.appendChild(this.contentEl_);return el;};CurrentTimeDisplay.prototype.updateContent=function updateContent(event){var time=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime();var localizedText=this.localize("Current Time");var formattedTime=(0,_formatTime2["default"])(time,this.player_.duration());if(formattedTime!==this.formattedTime_){this.formattedTime_=formattedTime;this.contentEl_.innerHTML='<span class="vjs-control-text">'+localizedText+"</span> "+formattedTime;}};return CurrentTimeDisplay;}(_component2["default"]);_component2["default"].registerComponent("CurrentTimeDisplay",CurrentTimeDisplay);exports["default"]=CurrentTimeDisplay;},{"../../component.js":244,"../../utils/dom.js":320,"../../utils/format-time.js":323}],272:[function(require,module,exports){"use strict";exports.__esModule=true;var _component=require("../../component.js");var _component2=_interopRequireDefault(_component);var _dom=require("../../utils/dom.js");var Dom=_interopRequireWildcard(_dom);var _formatTime=require("../../utils/format-time.js");var _formatTime2=_interopRequireDefault(_formatTime);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&((typeof call==="undefined"?"undefined":_typeof2(call))==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var DurationDisplay=function(_Component){_inherits(DurationDisplay,_Component);function DurationDisplay(player,options){_classCallCheck(this,DurationDisplay);var _this=_possibleConstructorReturn(this,_Component.call(this,player,options));_this.on(player,"durationchange",_this.updateContent);_this.on(player,"timeupdate",_this.updateContent);_this.on(player,"loadedmetadata",_this.updateContent);return _this;}DurationDisplay.prototype.createEl=function createEl(){var el=_Component.prototype.createEl.call(this,"div",{className:"vjs-duration vjs-time-control vjs-control"});this.contentEl_=Dom.createEl("div",{className:"vjs-duration-display",innerHTML:'<span class="vjs-control-text">'+this.localize("Duration Time")+"</span> 0:00"},{"aria-live":"off"});el.appendChild(this.contentEl_);return el;};DurationDisplay.prototype.updateContent=function updateContent(event){var duration=this.player_.duration();if(duration&&this.duration_!==duration){this.duration_=duration;var localizedText=this.localize("Duration Time");var formattedTime=(0,_formatTime2["default"])(duration);this.contentEl_.innerHTML='<span class="vjs-control-text">'+localizedText+"</span> "+formattedTime;}};return DurationDisplay;}(_component2["default"]);_component2["default"].registerComponent("DurationDisplay",DurationDisplay);exports["default"]=DurationDisplay;},{"../../component.js":244,"../../utils/dom.js":320,"../../utils/format-time.js":323}],273:[function(require,module,exports){"use strict";exports.__esModule=true;var _component=require("../../component.js");var _component2=_interopRequireDefault(_component);var _dom=require("../../utils/dom.js");var Dom=_interopRequireWildcard(_dom);var _formatTime=require("../../utils/format-time.js");var _formatTime2=_interopRequireDefault(_formatTime);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&((typeof call==="undefined"?"undefined":_typeof2(call))==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var RemainingTimeDisplay=function(_Component){_inherits(RemainingTimeDisplay,_Component);function RemainingTimeDisplay(player,options){_classCallCheck(this,RemainingTimeDisplay);var _this=_possibleConstructorReturn(this,_Component.call(this,player,options));_this.on(player,"timeupdate",_this.updateContent);_this.on(player,"durationchange",_this.updateContent);return _this;}RemainingTimeDisplay.prototype.createEl=function createEl(){var el=_Component.prototype.createEl.call(this,"div",{className:"vjs-remaining-time vjs-time-control vjs-control"});this.contentEl_=Dom.createEl("div",{className:"vjs-remaining-time-display",innerHTML:'<span class="vjs-control-text">'+this.localize("Remaining Time")+"</span> -0:00"},{"aria-live":"off"});el.appendChild(this.contentEl_);return el;};RemainingTimeDisplay.prototype.updateContent=function updateContent(event){if(this.player_.duration()){var localizedText=this.localize("Remaining Time");var formattedTime=(0,_formatTime2["default"])(this.player_.remainingTime());if(formattedTime!==this.formattedTime_){this.formattedTime_=formattedTime;this.contentEl_.innerHTML='<span class="vjs-control-text">'+localizedText+"</span> -"+formattedTime;}}};return RemainingTimeDisplay;}(_component2["default"]);_component2["default"].registerComponent("RemainingTimeDisplay",RemainingTimeDisplay);exports["default"]=RemainingTimeDisplay;},{"../../component.js":244,"../../utils/dom.js":320,"../../utils/format-time.js":323}],274:[function(require,module,exports){"use strict";exports.__esModule=true;var _component=require("../../component.js");var _component2=_interopRequireDefault(_component);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&((typeof call==="undefined"?"undefined":_typeof2(call))==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var TimeDivider=function(_Component){_inherits(TimeDivider,_Component);function TimeDivider(){_classCallCheck(this,TimeDivider);return _possibleConstructorReturn(this,_Component.apply(this,arguments));}TimeDivider.prototype.createEl=function createEl(){return _Component.prototype.createEl.call(this,"div",{className:"vjs-time-control vjs-time-divider",innerHTML:"<div><span>/</span></div>"});};return TimeDivider;}(_component2["default"]);_component2["default"].registerComponent("TimeDivider",TimeDivider);exports["default"]=TimeDivider;},{"../../component.js":244}],275:[function(require,module,exports){"use strict";exports.__esModule=true;var _menuButton=require("../menu/menu-button.js");var _menuButton2=_interopRequireDefault(_menuButton);var _component=require("../component.js");var _component2=_interopRequireDefault(_component);var _fn=require("../utils/fn.js");var Fn=_interopRequireWildcard(_fn);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&((typeof call==="undefined"?"undefined":_typeof2(call))==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var TrackButton=function(_MenuButton){_inherits(TrackButton,_MenuButton);function TrackButton(player,options){_classCallCheck(this,TrackButton);var tracks=options.tracks;var _this=_possibleConstructorReturn(this,_MenuButton.call(this,player,options));if(_this.items.length<=1){_this.hide();}if(!tracks){return _possibleConstructorReturn(_this);}var updateHandler=Fn.bind(_this,_this.update);tracks.addEventListener("removetrack",updateHandler);tracks.addEventListener("addtrack",updateHandler);_this.player_.on("dispose",function(){tracks.removeEventListener("removetrack",updateHandler);tracks.removeEventListener("addtrack",updateHandler);});return _this;}return TrackButton;}(_menuButton2["default"]);_component2["default"].registerComponent("TrackButton",TrackButton);exports["default"]=TrackButton;},{"../component.js":244,"../menu/menu-button.js":286,"../utils/fn.js":322}],276:[function(require,module,exports){"use strict";exports.__esModule=true;var _slider=require("../../slider/slider.js");var _slider2=_interopRequireDefault(_slider);var _component=require("../../component.js");var _component2=_interopRequireDefault(_component);var _fn=require("../../utils/fn.js");var Fn=_interopRequireWildcard(_fn);require("./volume-level.js");function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&((typeof call==="undefined"?"undefined":_typeof2(call))==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var VolumeBar=function(_Slider){_inherits(VolumeBar,_Slider);function VolumeBar(player,options){_classCallCheck(this,VolumeBar);var _this=_possibleConstructorReturn(this,_Slider.call(this,player,options));_this.on(player,"volumechange",_this.updateARIAAttributes);player.ready(Fn.bind(_this,_this.updateARIAAttributes));return _this;}VolumeBar.prototype.createEl=function createEl(){return _Slider.prototype.createEl.call(this,"div",{className:"vjs-volume-bar vjs-slider-bar"},{"aria-label":"volume level"});};VolumeBar.prototype.handleMouseMove=function handleMouseMove(event){this.checkMuted();this.player_.volume(this.calculateDistance(event));};VolumeBar.prototype.checkMuted=function checkMuted(){if(this.player_.muted()){this.player_.muted(false);}};VolumeBar.prototype.getPercent=function getPercent(){if(this.player_.muted()){return 0;}return this.player_.volume();};VolumeBar.prototype.stepForward=function stepForward(){this.checkMuted();this.player_.volume(this.player_.volume()+.1);};VolumeBar.prototype.stepBack=function stepBack(){this.checkMuted();this.player_.volume(this.player_.volume()-.1);};VolumeBar.prototype.updateARIAAttributes=function updateARIAAttributes(event){var volume=(this.player_.volume()*100).toFixed(2);this.el_.setAttribute("aria-valuenow",volume);this.el_.setAttribute("aria-valuetext",volume+"%");};return VolumeBar;}(_slider2["default"]);VolumeBar.prototype.options_={children:["volumeLevel"],barName:"volumeLevel"};VolumeBar.prototype.playerEvent="volumechange";_component2["default"].registerComponent("VolumeBar",VolumeBar);exports["default"]=VolumeBar;},{"../../component.js":244,"../../slider/slider.js":296,"../../utils/fn.js":322,"./volume-level.js":278}],277:[function(require,module,exports){"use strict";exports.__esModule=true;var _component=require("../../component.js");var _component2=_interopRequireDefault(_component);require("./volume-bar.js");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&((typeof call==="undefined"?"undefined":_typeof2(call))==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var VolumeControl=function(_Component){_inherits(VolumeControl,_Component);function VolumeControl(player,options){_classCallCheck(this,VolumeControl);var _this=_possibleConstructorReturn(this,_Component.call(this,player,options));if(player.tech_&&player.tech_.featuresVolumeControl===false){_this.addClass("vjs-hidden");}_this.on(player,"loadstart",function(){if(player.tech_.featuresVolumeControl===false){this.addClass("vjs-hidden");}else{this.removeClass("vjs-hidden");}});return _this;}VolumeControl.prototype.createEl=function createEl(){return _Component.prototype.createEl.call(this,"div",{className:"vjs-volume-control vjs-control"});};return VolumeControl;}(_component2["default"]);VolumeControl.prototype.options_={children:["volumeBar"]};_component2["default"].registerComponent("VolumeControl",VolumeControl);exports["default"]=VolumeControl;},{"../../component.js":244,"./volume-bar.js":276}],278:[function(require,module,exports){"use strict";exports.__esModule=true;var _component=require("../../component.js");var _component2=_interopRequireDefault(_component);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&((typeof call==="undefined"?"undefined":_typeof2(call))==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var VolumeLevel=function(_Component){_inherits(VolumeLevel,_Component);function VolumeLevel(){_classCallCheck(this,VolumeLevel);return _possibleConstructorReturn(this,_Component.apply(this,arguments));}VolumeLevel.prototype.createEl=function createEl(){return _Component.prototype.createEl.call(this,"div",{className:"vjs-volume-level",innerHTML:'<span class="vjs-control-text"></span>'});};return VolumeLevel;}(_component2["default"]);_component2["default"].registerComponent("VolumeLevel",VolumeLevel);exports["default"]=VolumeLevel;},{"../../component.js":244}],279:[function(require,module,exports){"use strict";exports.__esModule=true;var _fn=require("../utils/fn.js");var Fn=_interopRequireWildcard(_fn);var _component=require("../component.js");var _component2=_interopRequireDefault(_component);var _popup=require("../popup/popup.js");var _popup2=_interopRequireDefault(_popup);var _popupButton=require("../popup/popup-button.js");var _popupButton2=_interopRequireDefault(_popupButton);var _muteToggle=require("./mute-toggle.js");var _muteToggle2=_interopRequireDefault(_muteToggle);var _volumeBar=require("./volume-control/volume-bar.js");var _volumeBar2=_interopRequireDefault(_volumeBar);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&((typeof call==="undefined"?"undefined":_typeof2(call))==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var VolumeMenuButton=function(_PopupButton){_inherits(VolumeMenuButton,_PopupButton);function VolumeMenuButton(player){var options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};_classCallCheck(this,VolumeMenuButton);if(options.inline===undefined){options.inline=true;}if(options.vertical===undefined){if(options.inline){options.vertical=false;}else{options.vertical=true;}}options.volumeBar=options.volumeBar||{};options.volumeBar.vertical=!!options.vertical;var _this=_possibleConstructorReturn(this,_PopupButton.call(this,player,options));_this.on(player,"volumechange",_this.volumeUpdate);_this.on(player,"loadstart",_this.volumeUpdate);function updateVisibility(){if(player.tech_&&player.tech_.featuresVolumeControl===false){this.addClass("vjs-hidden");}else{this.removeClass("vjs-hidden");}}updateVisibility.call(_this);_this.on(player,"loadstart",updateVisibility);_this.on(_this.volumeBar,["slideractive","focus"],function(){this.addClass("vjs-slider-active");});_this.on(_this.volumeBar,["sliderinactive","blur"],function(){this.removeClass("vjs-slider-active");});_this.on(_this.volumeBar,["focus"],function(){this.addClass("vjs-lock-showing");});_this.on(_this.volumeBar,["blur"],function(){this.removeClass("vjs-lock-showing");});return _this;}VolumeMenuButton.prototype.buildCSSClass=function buildCSSClass(){var orientationClass="";if(this.options_.vertical){orientationClass="vjs-volume-menu-button-vertical";}else{orientationClass="vjs-volume-menu-button-horizontal";}return"vjs-volume-menu-button "+_PopupButton.prototype.buildCSSClass.call(this)+" "+orientationClass;};VolumeMenuButton.prototype.createPopup=function createPopup(){var popup=new _popup2["default"](this.player_,{contentElType:"div"});var vb=new _volumeBar2["default"](this.player_,this.options_.volumeBar);popup.addChild(vb);this.menuContent=popup;this.volumeBar=vb;this.attachVolumeBarEvents();return popup;};VolumeMenuButton.prototype.handleClick=function handleClick(event){_muteToggle2["default"].prototype.handleClick.call(this);_PopupButton.prototype.handleClick.call(this);};VolumeMenuButton.prototype.attachVolumeBarEvents=function attachVolumeBarEvents(){this.menuContent.on(["mousedown","touchdown"],Fn.bind(this,this.handleMouseDown));};VolumeMenuButton.prototype.handleMouseDown=function handleMouseDown(event){this.on(["mousemove","touchmove"],Fn.bind(this.volumeBar,this.volumeBar.handleMouseMove));this.on(this.el_.ownerDocument,["mouseup","touchend"],this.handleMouseUp);};VolumeMenuButton.prototype.handleMouseUp=function handleMouseUp(event){this.off(["mousemove","touchmove"],Fn.bind(this.volumeBar,this.volumeBar.handleMouseMove));};return VolumeMenuButton;}(_popupButton2["default"]);VolumeMenuButton.prototype.volumeUpdate=_muteToggle2["default"].prototype.update;VolumeMenuButton.prototype.controlText_="Mute";_component2["default"].registerComponent("VolumeMenuButton",VolumeMenuButton);exports["default"]=VolumeMenuButton;},{"../component.js":244,"../popup/popup-button.js":292,"../popup/popup.js":293,"../utils/fn.js":322,"./mute-toggle.js":250,"./volume-control/volume-bar.js":276}],280:[function(require,module,exports){"use strict";exports.__esModule=true;var _component=require("./component");var _component2=_interopRequireDefault(_component);var _modalDialog=require("./modal-dialog");var _modalDialog2=_interopRequireDefault(_modalDialog);var _mergeOptions=require("./utils/merge-options");var _mergeOptions2=_interopRequireDefault(_mergeOptions);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&((typeof call==="undefined"?"undefined":_typeof2(call))==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var ErrorDisplay=function(_ModalDialog){_inherits(ErrorDisplay,_ModalDialog);function ErrorDisplay(player,options){_classCallCheck(this,ErrorDisplay);var _this=_possibleConstructorReturn(this,_ModalDialog.call(this,player,options));_this.on(player,"error",_this.open);return _this;}ErrorDisplay.prototype.buildCSSClass=function buildCSSClass(){return"vjs-error-display "+_ModalDialog.prototype.buildCSSClass.call(this);};ErrorDisplay.prototype.content=function content(){var error=this.player().error();return error?this.localize(error.message):"";};return ErrorDisplay;}(_modalDialog2["default"]);ErrorDisplay.prototype.options_=(0,_mergeOptions2["default"])(_modalDialog2["default"].prototype.options_,{pauseOnOpen:false,fillAlways:true,temporary:false,uncloseable:true});_component2["default"].registerComponent("ErrorDisplay",ErrorDisplay);exports["default"]=ErrorDisplay;},{"./component":244,"./modal-dialog":289,"./utils/merge-options":326}],281:[function(require,module,exports){"use strict";exports.__esModule=true;var _events=require("./utils/events.js");var Events=_interopRequireWildcard(_events);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}var EventTarget=function EventTarget(){};EventTarget.prototype.allowedEvents_={};EventTarget.prototype.on=function(type,fn){var ael=this.addEventListener;this.addEventListener=function(){};Events.on(this,type,fn);this.addEventListener=ael;};EventTarget.prototype.addEventListener=EventTarget.prototype.on;EventTarget.prototype.off=function(type,fn){Events.off(this,type,fn);};EventTarget.prototype.removeEventListener=EventTarget.prototype.off;EventTarget.prototype.one=function(type,fn){var ael=this.addEventListener;this.addEventListener=function(){};Events.one(this,type,fn);this.addEventListener=ael;};EventTarget.prototype.trigger=function(event){var type=event.type||event;if(typeof event==="string"){event={type:type};}event=Events.fixEvent(event);if(this.allowedEvents_[type]&&this["on"+type]){this["on"+type](event);}Events.trigger(this,event);};EventTarget.prototype.dispatchEvent=EventTarget.prototype.trigger;exports["default"]=EventTarget;},{"./utils/events.js":321}],282:[function(require,module,exports){"use strict";exports.__esModule=true;var _typeof=typeof Symbol==="function"&&_typeof2(Symbol.iterator)==="symbol"?function(obj){return typeof obj==="undefined"?"undefined":_typeof2(obj);}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj==="undefined"?"undefined":_typeof2(obj);};var _log=require("./utils/log");var _log2=_interopRequireDefault(_log);var _obj=require("./utils/obj");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}var _inherits=function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass){subClass.super_=superClass;}};var extendFn=function extendFn(superClass){var subClassMethods=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var subClass=function subClass(){superClass.apply(this,arguments);};var methods={};if((0,_obj.isObject)(subClassMethods)){if(typeof subClassMethods.init==="function"){_log2["default"].warn("Constructor logic via init() is deprecated; please use constructor() instead.");subClassMethods.constructor=subClassMethods.init;}if(subClassMethods.constructor!==Object.prototype.constructor){subClass=subClassMethods.constructor;}methods=subClassMethods;}else if(typeof subClassMethods==="function"){subClass=subClassMethods;}_inherits(subClass,superClass);for(var name in methods){if(methods.hasOwnProperty(name)){subClass.prototype[name]=methods[name];}}return subClass;};exports["default"]=extendFn;},{"./utils/log":325,"./utils/obj":327}],283:[function(require,module,exports){"use strict";exports.__esModule=true;var _document=require("global/document");var _document2=_interopRequireDefault(_document);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}var FullscreenApi={};var apiMap=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]];var specApi=apiMap[0];var browserApi=void 0;for(var i=0;i<apiMap.length;i++){if(apiMap[i][1]in _document2["default"]){browserApi=apiMap[i];break;}}if(browserApi){for(var _i=0;_i<browserApi.length;_i++){FullscreenApi[specApi[_i]]=browserApi[_i];}}exports["default"]=FullscreenApi;},{"global/document":89}],284:[function(require,module,exports){"use strict";exports.__esModule=true;var _component=require("./component");var _component2=_interopRequireDefault(_component);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&((typeof call==="undefined"?"undefined":_typeof2(call))==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var LoadingSpinner=function(_Component){_inherits(LoadingSpinner,_Component);function LoadingSpinner(){_classCallCheck(this,LoadingSpinner);return _possibleConstructorReturn(this,_Component.apply(this,arguments));}LoadingSpinner.prototype.createEl=function createEl(){return _Component.prototype.createEl.call(this,"div",{className:"vjs-loading-spinner",dir:"ltr"});};return LoadingSpinner;}(_component2["default"]);_component2["default"].registerComponent("LoadingSpinner",LoadingSpinner);exports["default"]=LoadingSpinner;},{"./component":244}],285:[function(require,module,exports){"use strict";exports.__esModule=true;var _obj=require("./utils/obj");function MediaError(value){if(value instanceof MediaError){return value;}if(typeof value==="number"){this.code=value;}else if(typeof value==="string"){this.message=value;}else if((0,_obj.isObject)(value)){if(typeof value.code==="number"){this.code=value.code;}(0,_obj.assign)(this,value);}if(!this.message){this.message=MediaError.defaultMessages[this.code]||"";}}MediaError.prototype.code=0;MediaError.prototype.message="";MediaError.prototype.status=null;MediaError.errorTypes=["MEDIA_ERR_CUSTOM","MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED","MEDIA_ERR_ENCRYPTED"];MediaError.defaultMessages={1:"You aborted the media playback",2:"A network error caused the media download to fail part-way.",3:"The media playback was aborted due to a corruption problem or because the media used features your browser did not support.",4:"The media could not be loaded, either because the server or network failed or because the format is not supported.",5:"The media is encrypted and we do not have the keys to decrypt it."};for(var errNum=0;errNum<MediaError.errorTypes.length;errNum++){MediaError[MediaError.errorTypes[errNum]]=errNum;MediaError.prototype[MediaError.errorTypes[errNum]]=errNum;}exports["default"]=MediaError;},{"./utils/obj":327}],286:[function(require,module,exports){"use strict";exports.__esModule=true;var _clickableComponent=require("../clickable-component.js");var _clickableComponent2=_interopRequireDefault(_clickableComponent);var _component=require("../component.js");var _component2=_interopRequireDefault(_component);var _menu=require("./menu.js");var _menu2=_interopRequireDefault(_menu);var _dom=require("../utils/dom.js");var Dom=_interopRequireWildcard(_dom);var _fn=require("../utils/fn.js");var Fn=_interopRequireWildcard(_fn);var _toTitleCase=require("../utils/to-title-case.js");var _toTitleCase2=_interopRequireDefault(_toTitleCase);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&((typeof call==="undefined"?"undefined":_typeof2(call))==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var MenuButton=function(_ClickableComponent){_inherits(MenuButton,_ClickableComponent);function MenuButton(player){var options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};_classCallCheck(this,MenuButton);var _this=_possibleConstructorReturn(this,_ClickableComponent.call(this,player,options));_this.update();_this.enabled_=true;_this.el_.setAttribute("aria-haspopup","true");_this.el_.setAttribute("role","menuitem");_this.on("keydown",_this.handleSubmenuKeyPress);return _this;}MenuButton.prototype.update=function update(){var menu=this.createMenu();if(this.menu){this.removeChild(this.menu);}this.menu=menu;this.addChild(menu);this.buttonPressed_=false;this.el_.setAttribute("aria-expanded","false");if(this.items&&this.items.length<=this.hideThreshold_){this.hide();}else{this.show();}};MenuButton.prototype.createMenu=function createMenu(){var menu=new _menu2["default"](this.player_);this.hideThreshold_=0;if(this.options_.title){var title=Dom.createEl("li",{className:"vjs-menu-title",innerHTML:(0,_toTitleCase2["default"])(this.options_.title),tabIndex:-1});this.hideThreshold_+=1;menu.children_.unshift(title);Dom.insertElFirst(title,menu.contentEl());}this.items=this.createItems();if(this.items){for(var i=0;i<this.items.length;i++){menu.addItem(this.items[i]);}}return menu;};MenuButton.prototype.createItems=function createItems(){};MenuButton.prototype.createEl=function createEl(){return _ClickableComponent.prototype.createEl.call(this,"div",{className:this.buildCSSClass()});};MenuButton.prototype.buildCSSClass=function buildCSSClass(){var menuButtonClass="vjs-menu-button";if(this.options_.inline===true){menuButtonClass+="-inline";}else{menuButtonClass+="-popup";}return"vjs-menu-button "+menuButtonClass+" "+_ClickableComponent.prototype.buildCSSClass.call(this);};MenuButton.prototype.handleClick=function handleClick(event){this.one(this.menu.contentEl(),"mouseleave",Fn.bind(this,function(e){this.unpressButton();this.el_.blur();}));if(this.buttonPressed_){this.unpressButton();}else{this.pressButton();}};MenuButton.prototype.handleKeyPress=function handleKeyPress(event){if(event.which===27||event.which===9){if(this.buttonPressed_){this.unpressButton();}if(event.which!==9){event.preventDefault();}}else if(event.which===38||event.which===40){if(!this.buttonPressed_){this.pressButton();event.preventDefault();}}else{_ClickableComponent.prototype.handleKeyPress.call(this,event);}};MenuButton.prototype.handleSubmenuKeyPress=function handleSubmenuKeyPress(event){if(event.which===27||event.which===9){if(this.buttonPressed_){this.unpressButton();}if(event.which!==9){event.preventDefault();}}};MenuButton.prototype.pressButton=function pressButton(){if(this.enabled_){this.buttonPressed_=true;this.menu.lockShowing();this.el_.setAttribute("aria-expanded","true");this.menu.focus();}};MenuButton.prototype.unpressButton=function unpressButton(){if(this.enabled_){this.buttonPressed_=false;this.menu.unlockShowing();this.el_.setAttribute("aria-expanded","false");this.el_.focus();}};MenuButton.prototype.disable=function disable(){this.buttonPressed_=false;this.menu.unlockShowing();this.el_.setAttribute("aria-expanded","false");this.enabled_=false;return _ClickableComponent.prototype.disable.call(this);};MenuButton.prototype.enable=function enable(){this.enabled_=true;return _ClickableComponent.prototype.enable.call(this);};return MenuButton;}(_clickableComponent2["default"]);_component2["default"].registerComponent("MenuButton",MenuButton);exports["default"]=MenuButton;},{"../clickable-component.js":242,"../component.js":244,"../utils/dom.js":320,"../utils/fn.js":322,"../utils/to-title-case.js":330,"./menu.js":288}],287:[function(require,module,exports){"use strict";exports.__esModule=true;var _clickableComponent=require("../clickable-component.js");var _clickableComponent2=_interopRequireDefault(_clickableComponent);var _component=require("../component.js");var _component2=_interopRequireDefault(_component);var _obj=require("../utils/obj");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&((typeof call==="undefined"?"undefined":_typeof2(call))==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var MenuItem=function(_ClickableComponent){_inherits(MenuItem,_ClickableComponent);function MenuItem(player,options){_classCallCheck(this,MenuItem);var _this=_possibleConstructorReturn(this,_ClickableComponent.call(this,player,options));_this.selectable=options.selectable;_this.selected(options.selected);if(_this.selectable){_this.el_.setAttribute("role","menuitemcheckbox");}else{_this.el_.setAttribute("role","menuitem");}return _this;}MenuItem.prototype.createEl=function createEl(type,props,attrs){this.nonIconControl=true;return _ClickableComponent.prototype.createEl.call(this,"li",(0,_obj.assign)({className:"vjs-menu-item",innerHTML:this.localize(this.options_.label),tabIndex:-1},props),attrs);};MenuItem.prototype.handleClick=function handleClick(event){this.selected(true);};MenuItem.prototype.selected=function selected(_selected){if(this.selectable){if(_selected){this.addClass("vjs-selected");this.el_.setAttribute("aria-checked","true");this.controlText(", selected");}else{this.removeClass("vjs-selected");this.el_.setAttribute("aria-checked","false");this.controlText(" ");}}};return MenuItem;}(_clickableComponent2["default"]);_component2["default"].registerComponent("MenuItem",MenuItem);exports["default"]=MenuItem;},{"../clickable-component.js":242,"../component.js":244,"../utils/obj":327}],288:[function(require,module,exports){"use strict";exports.__esModule=true;var _component=require("../component.js");var _component2=_interopRequireDefault(_component);var _dom=require("../utils/dom.js");var Dom=_interopRequireWildcard(_dom);var _fn=require("../utils/fn.js");var Fn=_interopRequireWildcard(_fn);var _events=require("../utils/events.js");var Events=_interopRequireWildcard(_events);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&((typeof call==="undefined"?"undefined":_typeof2(call))==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var Menu=function(_Component){_inherits(Menu,_Component);function Menu(player,options){_classCallCheck(this,Menu);var _this=_possibleConstructorReturn(this,_Component.call(this,player,options));_this.focusedChild_=-1;_this.on("keydown",_this.handleKeyPress);return _this;}Menu.prototype.addItem=function addItem(component){this.addChild(component);component.on("click",Fn.bind(this,function(event){this.unlockShowing();}));};Menu.prototype.createEl=function createEl(){var contentElType=this.options_.contentElType||"ul";this.contentEl_=Dom.createEl(contentElType,{className:"vjs-menu-content"});this.contentEl_.setAttribute("role","menu");var el=_Component.prototype.createEl.call(this,"div",{append:this.contentEl_,className:"vjs-menu"});el.setAttribute("role","presentation");el.appendChild(this.contentEl_);Events.on(el,"click",function(event){event.preventDefault();event.stopImmediatePropagation();});return el;};Menu.prototype.handleKeyPress=function handleKeyPress(event){if(event.which===37||event.which===40){event.preventDefault();this.stepForward();}else if(event.which===38||event.which===39){event.preventDefault();this.stepBack();}};Menu.prototype.stepForward=function stepForward(){var stepChild=0;if(this.focusedChild_!==undefined){stepChild=this.focusedChild_+1;}this.focus(stepChild);};Menu.prototype.stepBack=function stepBack(){var stepChild=0;if(this.focusedChild_!==undefined){stepChild=this.focusedChild_-1;}this.focus(stepChild);};Menu.prototype.focus=function focus(){var item=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;var children=this.children().slice();var haveTitle=children.length&&children[0].className&&/vjs-menu-title/.test(children[0].className);if(haveTitle){children.shift();}if(children.length>0){if(item<0){item=0;}else if(item>=children.length){item=children.length-1;}this.focusedChild_=item;children[item].el_.focus();}};return Menu;}(_component2["default"]);_component2["default"].registerComponent("Menu",Menu);exports["default"]=Menu;},{"../component.js":244,"../utils/dom.js":320,"../utils/events.js":321,"../utils/fn.js":322}],289:[function(require,module,exports){"use strict";exports.__esModule=true;var _dom=require("./utils/dom");var Dom=_interopRequireWildcard(_dom);var _fn=require("./utils/fn");var Fn=_interopRequireWildcard(_fn);var _component=require("./component");var _component2=_interopRequireDefault(_component);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&((typeof call==="undefined"?"undefined":_typeof2(call))==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var MODAL_CLASS_NAME="vjs-modal-dialog";var ESC=27;var ModalDialog=function(_Component){_inherits(ModalDialog,_Component);function ModalDialog(player,options){_classCallCheck(this,ModalDialog);var _this=_possibleConstructorReturn(this,_Component.call(this,player,options));_this.opened_=_this.hasBeenOpened_=_this.hasBeenFilled_=false;_this.closeable(!_this.options_.uncloseable);_this.content(_this.options_.content);_this.contentEl_=Dom.createEl("div",{className:MODAL_CLASS_NAME+"-content"},{role:"document"});_this.descEl_=Dom.createEl("p",{className:MODAL_CLASS_NAME+"-description vjs-offscreen",id:_this.el().getAttribute("aria-describedby")});Dom.textContent(_this.descEl_,_this.description());_this.el_.appendChild(_this.descEl_);_this.el_.appendChild(_this.contentEl_);return _this;}ModalDialog.prototype.createEl=function createEl(){return _Component.prototype.createEl.call(this,"div",{className:this.buildCSSClass(),tabIndex:-1},{"aria-describedby":this.id()+"_description","aria-hidden":"true","aria-label":this.label(),role:"dialog"});};ModalDialog.prototype.buildCSSClass=function buildCSSClass(){return MODAL_CLASS_NAME+" vjs-hidden "+_Component.prototype.buildCSSClass.call(this);};ModalDialog.prototype.handleKeyPress=function handleKeyPress(e){if(e.which===ESC&&this.closeable()){this.close();}};ModalDialog.prototype.label=function label(){return this.options_.label||this.localize("Modal Window");};ModalDialog.prototype.description=function description(){var desc=this.options_.description||this.localize("This is a modal window.");if(this.closeable()){desc+=" "+this.localize("This modal can be closed by pressing the Escape key or activating the close button.");}return desc;};ModalDialog.prototype.open=function open(){if(!this.opened_){var player=this.player();this.trigger("beforemodalopen");this.opened_=true;if(this.options_.fillAlways||!this.hasBeenOpened_&&!this.hasBeenFilled_){this.fill();}this.wasPlaying_=!player.paused();if(this.options_.pauseOnOpen&&this.wasPlaying_){player.pause();}if(this.closeable()){this.on(this.el_.ownerDocument,"keydown",Fn.bind(this,this.handleKeyPress));}player.controls(false);this.show();this.el().setAttribute("aria-hidden","false");this.trigger("modalopen");this.hasBeenOpened_=true;}return this;};ModalDialog.prototype.opened=function opened(value){if(typeof value==="boolean"){this[value?"open":"close"]();}return this.opened_;};ModalDialog.prototype.close=function close(){if(this.opened_){var player=this.player();this.trigger("beforemodalclose");this.opened_=false;if(this.wasPlaying_&&this.options_.pauseOnOpen){player.play();}if(this.closeable()){this.off(this.el_.ownerDocument,"keydown",Fn.bind(this,this.handleKeyPress));}player.controls(true);this.hide();this.el().setAttribute("aria-hidden","true");this.trigger("modalclose");if(this.options_.temporary){this.dispose();}}return this;};ModalDialog.prototype.closeable=function closeable(value){if(typeof value==="boolean"){var closeable=this.closeable_=!!value;var close=this.getChild("closeButton");if(closeable&&!close){var temp=this.contentEl_;this.contentEl_=this.el_;close=this.addChild("closeButton",{controlText:"Close Modal Dialog"});this.contentEl_=temp;this.on(close,"close",this.close);}if(!closeable&&close){this.off(close,"close",this.close);this.removeChild(close);close.dispose();}}return this.closeable_;};ModalDialog.prototype.fill=function fill(){return this.fillWith(this.content());};ModalDialog.prototype.fillWith=function fillWith(content){var contentEl=this.contentEl();var parentEl=contentEl.parentNode;var nextSiblingEl=contentEl.nextSibling;this.trigger("beforemodalfill");this.hasBeenFilled_=true;parentEl.removeChild(contentEl);this.empty();Dom.insertContent(contentEl,content);this.trigger("modalfill");if(nextSiblingEl){parentEl.insertBefore(contentEl,nextSiblingEl);}else{parentEl.appendChild(contentEl);}return this;};ModalDialog.prototype.empty=function empty(){this.trigger("beforemodalempty");Dom.emptyEl(this.contentEl());this.trigger("modalempty");return this;};ModalDialog.prototype.content=function content(value){if(typeof value!=="undefined"){this.content_=value;}return this.content_;};return ModalDialog;}(_component2["default"]);ModalDialog.prototype.options_={pauseOnOpen:true,temporary:true};_component2["default"].registerComponent("ModalDialog",ModalDialog);exports["default"]=ModalDialog;},{"./component":244,"./utils/dom":320,"./utils/fn":322}],290:[function(require,module,exports){"use strict";exports.__esModule=true;var _component=require("./component.js");var _component2=_interopRequireDefault(_component);var _document=require("global/document");var _document2=_interopRequireDefault(_document);var _window=require("global/window");var _window2=_interopRequireDefault(_window);var _events=require("./utils/events.js");var Events=_interopRequireWildcard(_events);var _dom=require("./utils/dom.js");var Dom=_interopRequireWildcard(_dom);var _fn=require("./utils/fn.js");var Fn=_interopRequireWildcard(_fn);var _guid=require("./utils/guid.js");var Guid=_interopRequireWildcard(_guid);var _browser=require("./utils/browser.js");var browser=_interopRequireWildcard(_browser);var _log=require("./utils/log.js");var _log2=_interopRequireDefault(_log);var _toTitleCase=require("./utils/to-title-case.js");var _toTitleCase2=_interopRequireDefault(_toTitleCase);var _timeRanges=require("./utils/time-ranges.js");var _buffer=require("./utils/buffer.js");var _stylesheet=require("./utils/stylesheet.js");var stylesheet=_interopRequireWildcard(_stylesheet);var _fullscreenApi=require("./fullscreen-api.js");var _fullscreenApi2=_interopRequireDefault(_fullscreenApi);var _mediaError=require("./media-error.js");var _mediaError2=_interopRequireDefault(_mediaError);var _tuple=require("safe-json-parse/tuple");var _tuple2=_interopRequireDefault(_tuple);var _obj=require("./utils/obj");var _mergeOptions=require("./utils/merge-options.js");var _mergeOptions2=_interopRequireDefault(_mergeOptions);var _textTrackListConverter=require("./tracks/text-track-list-converter.js");var _textTrackListConverter2=_interopRequireDefault(_textTrackListConverter);var _modalDialog=require("./modal-dialog");var _modalDialog2=_interopRequireDefault(_modalDialog);var _tech=require("./tech/tech.js");var _tech2=_interopRequireDefault(_tech);var _audioTrackList=require("./tracks/audio-track-list.js");var _audioTrackList2=_interopRequireDefault(_audioTrackList);var _videoTrackList=require("./tracks/video-track-list.js");var _videoTrackList2=_interopRequireDefault(_videoTrackList);require("./tech/loader.js");require("./tech/flash.js");require("./poster-image.js");require("./tracks/text-track-display.js");require("./loading-spinner.js");require("./big-play-button.js");require("./close-button.js");require("./control-bar/control-bar.js");require("./error-display.js");require("./tracks/text-track-settings.js");require("./tech/html5.js");function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&((typeof call==="undefined"?"undefined":_typeof2(call))==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var TECH_EVENTS_RETRIGGER=["progress","abort","suspend","emptied","stalled","loadedmetadata","loadeddata","timeupdate","ratechange","volumechange","texttrackchange"];var Player=function(_Component){_inherits(Player,_Component);function Player(tag,options,ready){_classCallCheck(this,Player);tag.id=tag.id||"vjs_video_"+Guid.newGUID();options=(0,_obj.assign)(Player.getTagSettings(tag),options);options.initChildren=false;options.createEl=false;options.reportTouchActivity=false;if(!options.language){if(typeof tag.closest==="function"){var closest=tag.closest("[lang]");if(closest){options.language=closest.getAttribute("lang");}}else{var element=tag;while(element&&element.nodeType===1){if(Dom.getElAttributes(element).hasOwnProperty("lang")){options.language=element.getAttribute("lang");break;}element=element.parentNode;}}}var _this=_possibleConstructorReturn(this,_Component.call(this,null,options,ready));if(!_this.options_||!_this.options_.techOrder||!_this.options_.techOrder.length){throw new Error("No techOrder specified. Did you overwrite "+"videojs.options instead of just changing the "+"properties you want to override?");}_this.tag=tag;_this.tagAttributes=tag&&Dom.getElAttributes(tag);_this.language(_this.options_.language);if(options.languages){var languagesToLower={};Object.getOwnPropertyNames(options.languages).forEach(function(name){languagesToLower[name.toLowerCase()]=options.languages[name];});_this.languages_=languagesToLower;}else{_this.languages_=Player.prototype.options_.languages;}_this.cache_={};_this.poster_=options.poster||"";_this.controls_=!!options.controls;tag.controls=false;_this.scrubbing_=false;_this.el_=_this.createEl();var playerOptionsCopy=(0,_mergeOptions2["default"])(_this.options_);if(options.plugins){var plugins=options.plugins;Object.getOwnPropertyNames(plugins).forEach(function(name){if(typeof this[name]==="function"){this[name](plugins[name]);}else{_log2["default"].error("Unable to find plugin:",name);}},_this);}_this.options_.playerOptions=playerOptionsCopy;_this.initChildren();_this.isAudio(tag.nodeName.toLowerCase()==="audio");if(_this.controls()){_this.addClass("vjs-controls-enabled");}else{_this.addClass("vjs-controls-disabled");}_this.el_.setAttribute("role","region");if(_this.isAudio()){_this.el_.setAttribute("aria-label","audio player");}else{_this.el_.setAttribute("aria-label","video player");}if(_this.isAudio()){_this.addClass("vjs-audio");}if(_this.flexNotSupported_()){_this.addClass("vjs-no-flex");}if(!browser.IS_IOS){_this.addClass("vjs-workinghover");}Player.players[_this.id_]=_this;_this.userActive(true);_this.reportUserActivity();_this.listenForUserActivity_();_this.on("fullscreenchange",_this.handleFullscreenChange_);_this.on("stageclick",_this.handleStageClick_);return _this;}Player.prototype.dispose=function dispose(){this.trigger("dispose");this.off("dispose");if(this.styleEl_&&this.styleEl_.parentNode){this.styleEl_.parentNode.removeChild(this.styleEl_);}Player.players[this.id_]=null;if(this.tag&&this.tag.player){this.tag.player=null;}if(this.el_&&this.el_.player){this.el_.player=null;}if(this.tech_){this.tech_.dispose();}_Component.prototype.dispose.call(this);};Player.prototype.createEl=function createEl(){var tag=this.tag;var el=void 0;var playerElIngest=this.playerElIngest_=tag.parentNode&&tag.parentNode.hasAttribute&&tag.parentNode.hasAttribute("data-vjs-player");if(playerElIngest){el=this.el_=tag.parentNode;}else{el=this.el_=_Component.prototype.createEl.call(this,"div");}tag.setAttribute("tabindex","-1");tag.removeAttribute("width");tag.removeAttribute("height");var attrs=Dom.getElAttributes(tag);Object.getOwnPropertyNames(attrs).forEach(function(attr){if(attr==="class"){el.className+=" "+attrs[attr];}else{el.setAttribute(attr,attrs[attr]);}});tag.playerId=tag.id;tag.id+="_html5_api";tag.className="vjs-tech";tag.player=el.player=this;this.addClass("vjs-paused");if(_window2["default"].VIDEOJS_NO_DYNAMIC_STYLE!==true){this.styleEl_=stylesheet.createStyleElement("vjs-styles-dimensions");var defaultsStyleEl=Dom.$(".vjs-styles-defaults");var head=Dom.$("head");head.insertBefore(this.styleEl_,defaultsStyleEl?defaultsStyleEl.nextSibling:head.firstChild);}this.width(this.options_.width);this.height(this.options_.height);this.fluid(this.options_.fluid);this.aspectRatio(this.options_.aspectRatio);var links=tag.getElementsByTagName("a");for(var i=0;i<links.length;i++){var linkEl=links.item(i);Dom.addElClass(linkEl,"vjs-hidden");linkEl.setAttribute("hidden","hidden");}tag.initNetworkState_=tag.networkState;if(tag.parentNode&&!playerElIngest){tag.parentNode.insertBefore(el,tag);}Dom.insertElFirst(tag,el);this.children_.unshift(tag);this.el_=el;return el;};Player.prototype.width=function width(value){return this.dimension("width",value);};Player.prototype.height=function height(value){return this.dimension("height",value);};Player.prototype.dimension=function dimension(_dimension,value){var privDimension=_dimension+"_";if(value===undefined){return this[privDimension]||0;}if(value===""){this[privDimension]=undefined;}else{var parsedVal=parseFloat(value);if(isNaN(parsedVal)){_log2["default"].error('Improper value "'+value+'" supplied for for '+_dimension);return this;}this[privDimension]=parsedVal;}this.updateStyleEl_();return this;};Player.prototype.fluid=function fluid(bool){if(bool===undefined){return!!this.fluid_;}this.fluid_=!!bool;if(bool){this.addClass("vjs-fluid");}else{this.removeClass("vjs-fluid");}this.updateStyleEl_();};Player.prototype.aspectRatio=function aspectRatio(ratio){if(ratio===undefined){return this.aspectRatio_;}if(!/^\d+\:\d+$/.test(ratio)){throw new Error("Improper value supplied for aspect ratio. The format should be width:height, for example 16:9.");}this.aspectRatio_=ratio;this.fluid(true);this.updateStyleEl_();};Player.prototype.updateStyleEl_=function updateStyleEl_(){if(_window2["default"].VIDEOJS_NO_DYNAMIC_STYLE===true){var _width=typeof this.width_==="number"?this.width_:this.options_.width;var _height=typeof this.height_==="number"?this.height_:this.options_.height;var techEl=this.tech_&&this.tech_.el();if(techEl){if(_width>=0){techEl.width=_width;}if(_height>=0){techEl.height=_height;}}return;}var width=void 0;var height=void 0;var aspectRatio=void 0;var idClass=void 0;if(this.aspectRatio_!==undefined&&this.aspectRatio_!=="auto"){aspectRatio=this.aspectRatio_;}else if(this.videoWidth()>0){aspectRatio=this.videoWidth()+":"+this.videoHeight();}else{aspectRatio="16:9";}var ratioParts=aspectRatio.split(":");var ratioMultiplier=ratioParts[1]/ratioParts[0];if(this.width_!==undefined){width=this.width_;}else if(this.height_!==undefined){width=this.height_/ratioMultiplier;}else{width=this.videoWidth()||300;}if(this.height_!==undefined){height=this.height_;}else{height=width*ratioMultiplier;}if(/^[^a-zA-Z]/.test(this.id())){idClass="dimensions-"+this.id();}else{idClass=this.id()+"-dimensions";}this.addClass(idClass);stylesheet.setTextContent(this.styleEl_,"\n      ."+idClass+" {\n        width: "+width+"px;\n        height: "+height+"px;\n      }\n\n      ."+idClass+".vjs-fluid {\n        padding-top: "+ratioMultiplier*100+"%;\n      }\n    ");};Player.prototype.loadTech_=function loadTech_(techName,source){var _this2=this;if(this.tech_){this.unloadTech_();}if(techName!=="Html5"&&this.tag){_tech2["default"].getTech("Html5").disposeMediaElement(this.tag);this.tag.player=null;this.tag=null;}this.techName_=techName;this.isReady_=false;var techOptions=(0,_obj.assign)({source:source,nativeControlsForTouch:this.options_.nativeControlsForTouch,playerId:this.id(),techId:this.id()+"_"+techName+"_api",videoTracks:this.videoTracks_,textTracks:this.textTracks_,audioTracks:this.audioTracks_,autoplay:this.options_.autoplay,preload:this.options_.preload,loop:this.options_.loop,muted:this.options_.muted,poster:this.poster(),language:this.language(),playerElIngest:this.playerElIngest_||false,"vtt.js":this.options_["vtt.js"]},this.options_[techName.toLowerCase()]);if(this.tag){techOptions.tag=this.tag;}if(source){this.currentType_=source.type;if(source.src===this.cache_.src&&this.cache_.currentTime>0){techOptions.startTime=this.cache_.currentTime;}this.cache_.sources=null;this.cache_.source=source;this.cache_.src=source.src;}var TechComponent=_tech2["default"].getTech(techName);if(!TechComponent){TechComponent=_component2["default"].getComponent(techName);}this.tech_=new TechComponent(techOptions);this.tech_.ready(Fn.bind(this,this.handleTechReady_),true);_textTrackListConverter2["default"].jsonToTextTracks(this.textTracksJson_||[],this.tech_);TECH_EVENTS_RETRIGGER.forEach(function(event){_this2.on(_this2.tech_,event,_this2["handleTech"+(0,_toTitleCase2["default"])(event)+"_"]);});this.on(this.tech_,"loadstart",this.handleTechLoadStart_);this.on(this.tech_,"waiting",this.handleTechWaiting_);this.on(this.tech_,"canplay",this.handleTechCanPlay_);this.on(this.tech_,"canplaythrough",this.handleTechCanPlayThrough_);this.on(this.tech_,"playing",this.handleTechPlaying_);this.on(this.tech_,"ended",this.handleTechEnded_);this.on(this.tech_,"seeking",this.handleTechSeeking_);this.on(this.tech_,"seeked",this.handleTechSeeked_);this.on(this.tech_,"play",this.handleTechPlay_);this.on(this.tech_,"firstplay",this.handleTechFirstPlay_);this.on(this.tech_,"pause",this.handleTechPause_);this.on(this.tech_,"durationchange",this.handleTechDurationChange_);this.on(this.tech_,"fullscreenchange",this.handleTechFullscreenChange_);this.on(this.tech_,"error",this.handleTechError_);this.on(this.tech_,"loadedmetadata",this.updateStyleEl_);this.on(this.tech_,"posterchange",this.handleTechPosterChange_);this.on(this.tech_,"textdata",this.handleTechTextData_);this.usingNativeControls(this.techGet_("controls"));if(this.controls()&&!this.usingNativeControls()){this.addTechControlsListeners_();}if(this.tech_.el().parentNode!==this.el()&&(techName!=="Html5"||!this.tag)){Dom.insertElFirst(this.tech_.el(),this.el());}if(this.tag){this.tag.player=null;this.tag=null;}};Player.prototype.unloadTech_=function unloadTech_(){this.videoTracks_=this.videoTracks();this.textTracks_=this.textTracks();this.audioTracks_=this.audioTracks();this.textTracksJson_=_textTrackListConverter2["default"].textTracksToJson(this.tech_);this.isReady_=false;this.tech_.dispose();this.tech_=false;};Player.prototype.tech=function tech(safety){if(safety&&safety.IWillNotUseThisInPlugins){return this.tech_;}var errorText="\n      Please make sure that you are not using this inside of a plugin.\n      To disable this alert and error, please pass in an object with\n      `IWillNotUseThisInPlugins` to the `tech` method. See\n      https://github.com/videojs/video.js/issues/2617 for more info.\n    ";_window2["default"].alert(errorText);throw new Error(errorText);};Player.prototype.addTechControlsListeners_=function addTechControlsListeners_(){this.removeTechControlsListeners_();this.on(this.tech_,"mousedown",this.handleTechClick_);this.on(this.tech_,"touchstart",this.handleTechTouchStart_);this.on(this.tech_,"touchmove",this.handleTechTouchMove_);this.on(this.tech_,"touchend",this.handleTechTouchEnd_);this.on(this.tech_,"tap",this.handleTechTap_);};Player.prototype.removeTechControlsListeners_=function removeTechControlsListeners_(){this.off(this.tech_,"tap",this.handleTechTap_);this.off(this.tech_,"touchstart",this.handleTechTouchStart_);this.off(this.tech_,"touchmove",this.handleTechTouchMove_);this.off(this.tech_,"touchend",this.handleTechTouchEnd_);this.off(this.tech_,"mousedown",this.handleTechClick_);};Player.prototype.handleTechReady_=function handleTechReady_(){this.triggerReady();if(this.cache_.volume){this.techCall_("setVolume",this.cache_.volume);}this.handleTechPosterChange_();this.handleTechDurationChange_();if((this.src()||this.currentSrc())&&this.tag&&this.options_.autoplay&&this.paused()){try{delete this.tag.poster;}catch(e){(0,_log2["default"])("deleting tag.poster throws in some browsers",e);}this.play();}};Player.prototype.handleTechLoadStart_=function handleTechLoadStart_(){this.removeClass("vjs-ended");this.removeClass("vjs-seeking");this.error(null);if(!this.paused()){this.trigger("loadstart");this.trigger("firstplay");}else{this.hasStarted(false);this.trigger("loadstart");}};Player.prototype.hasStarted=function hasStarted(_hasStarted){if(_hasStarted!==undefined){if(this.hasStarted_!==_hasStarted){this.hasStarted_=_hasStarted;if(_hasStarted){this.addClass("vjs-has-started");this.trigger("firstplay");}else{this.removeClass("vjs-has-started");}}return this;}return!!this.hasStarted_;};Player.prototype.handleTechPlay_=function handleTechPlay_(){this.removeClass("vjs-ended");this.removeClass("vjs-paused");this.addClass("vjs-playing");this.hasStarted(true);this.trigger("play");};Player.prototype.handleTechWaiting_=function handleTechWaiting_(){var _this3=this;this.addClass("vjs-waiting");this.trigger("waiting");this.one("timeupdate",function(){return _this3.removeClass("vjs-waiting");});};Player.prototype.handleTechCanPlay_=function handleTechCanPlay_(){this.removeClass("vjs-waiting");this.trigger("canplay");};Player.prototype.handleTechCanPlayThrough_=function handleTechCanPlayThrough_(){this.removeClass("vjs-waiting");this.trigger("canplaythrough");};Player.prototype.handleTechPlaying_=function handleTechPlaying_(){this.removeClass("vjs-waiting");this.trigger("playing");};Player.prototype.handleTechSeeking_=function handleTechSeeking_(){this.addClass("vjs-seeking");this.trigger("seeking");};Player.prototype.handleTechSeeked_=function handleTechSeeked_(){this.removeClass("vjs-seeking");this.trigger("seeked");};Player.prototype.handleTechFirstPlay_=function handleTechFirstPlay_(){if(this.options_.starttime){_log2["default"].warn("Passing the `starttime` option to the player will be deprecated in 6.0");this.currentTime(this.options_.starttime);}this.addClass("vjs-has-started");this.trigger("firstplay");};Player.prototype.handleTechPause_=function handleTechPause_(){this.removeClass("vjs-playing");this.addClass("vjs-paused");this.trigger("pause");};Player.prototype.handleTechEnded_=function handleTechEnded_(){this.addClass("vjs-ended");if(this.options_.loop){this.currentTime(0);this.play();}else if(!this.paused()){this.pause();}this.trigger("ended");};Player.prototype.handleTechDurationChange_=function handleTechDurationChange_(){this.duration(this.techGet_("duration"));};Player.prototype.handleTechClick_=function handleTechClick_(event){if(event.button!==0){return;}if(this.controls()){if(this.paused()){this.play();}else{this.pause();}}};Player.prototype.handleTechTap_=function handleTechTap_(){this.userActive(!this.userActive());};Player.prototype.handleTechTouchStart_=function handleTechTouchStart_(){this.userWasActive=this.userActive();};Player.prototype.handleTechTouchMove_=function handleTechTouchMove_(){if(this.userWasActive){this.reportUserActivity();}};Player.prototype.handleTechTouchEnd_=function handleTechTouchEnd_(event){event.preventDefault();};Player.prototype.handleFullscreenChange_=function handleFullscreenChange_(){if(this.isFullscreen()){this.addClass("vjs-fullscreen");}else{this.removeClass("vjs-fullscreen");}};Player.prototype.handleStageClick_=function handleStageClick_(){this.reportUserActivity();};Player.prototype.handleTechFullscreenChange_=function handleTechFullscreenChange_(event,data){if(data){this.isFullscreen(data.isFullscreen);}this.trigger("fullscreenchange");};Player.prototype.handleTechError_=function handleTechError_(){var error=this.tech_.error();this.error(error);};Player.prototype.handleTechTextData_=function handleTechTextData_(){var data=null;if(arguments.length>1){data=arguments[1];}this.trigger("textdata",data);};Player.prototype.getCache=function getCache(){return this.cache_;};Player.prototype.techCall_=function techCall_(method,arg){if(this.tech_&&!this.tech_.isReady_){this.tech_.ready(function(){this[method](arg);},true);}else{try{if(this.tech_){this.tech_[method](arg);}}catch(e){(0,_log2["default"])(e);throw e;}}};Player.prototype.techGet_=function techGet_(method){if(this.tech_&&this.tech_.isReady_){try{return this.tech_[method]();}catch(e){if(this.tech_[method]===undefined){(0,_log2["default"])("Video.js: "+method+" method not defined for "+this.techName_+" playback technology.",e);}else if(e.name==="TypeError"){(0,_log2["default"])("Video.js: "+method+" unavailable on "+this.techName_+" playback technology element.",e);this.tech_.isReady_=false;}else{(0,_log2["default"])(e);}throw e;}}return;};Player.prototype.play=function play(){if(this.src()||this.currentSrc()){this.techCall_("play");}else{this.tech_.one("loadstart",function(){this.play();});}return this;};Player.prototype.pause=function pause(){this.techCall_("pause");return this;};Player.prototype.paused=function paused(){return this.techGet_("paused")===false?false:true;};Player.prototype.scrubbing=function scrubbing(isScrubbing){if(isScrubbing!==undefined){this.scrubbing_=!!isScrubbing;if(isScrubbing){this.addClass("vjs-scrubbing");}else{this.removeClass("vjs-scrubbing");}return this;}return this.scrubbing_;};Player.prototype.currentTime=function currentTime(seconds){if(seconds!==undefined){this.techCall_("setCurrentTime",seconds);return this;}this.cache_.currentTime=this.techGet_("currentTime")||0;return this.cache_.currentTime;};Player.prototype.duration=function duration(seconds){if(seconds===undefined){return this.cache_.duration||0;}seconds=parseFloat(seconds)||0;if(seconds<0){seconds=Infinity;}if(seconds!==this.cache_.duration){this.cache_.duration=seconds;if(seconds===Infinity){this.addClass("vjs-live");}else{this.removeClass("vjs-live");}this.trigger("durationchange");}return this;};Player.prototype.remainingTime=function remainingTime(){return this.duration()-this.currentTime();};Player.prototype.buffered=function buffered(){var buffered=this.techGet_("buffered");if(!buffered||!buffered.length){buffered=(0,_timeRanges.createTimeRange)(0,0);}return buffered;};Player.prototype.bufferedPercent=function bufferedPercent(){return(0,_buffer.bufferedPercent)(this.buffered(),this.duration());};Player.prototype.bufferedEnd=function bufferedEnd(){var buffered=this.buffered();var duration=this.duration();var end=buffered.end(buffered.length-1);if(end>duration){end=duration;}return end;};Player.prototype.volume=function volume(percentAsDecimal){var vol=void 0;if(percentAsDecimal!==undefined){vol=Math.max(0,Math.min(1,parseFloat(percentAsDecimal)));this.cache_.volume=vol;this.techCall_("setVolume",vol);return this;}vol=parseFloat(this.techGet_("volume"));return isNaN(vol)?1:vol;};Player.prototype.muted=function muted(_muted){if(_muted!==undefined){this.techCall_("setMuted",_muted);return this;}return this.techGet_("muted")||false;};Player.prototype.supportsFullScreen=function supportsFullScreen(){return this.techGet_("supportsFullScreen")||false;};Player.prototype.isFullscreen=function isFullscreen(isFS){if(isFS!==undefined){this.isFullscreen_=!!isFS;return this;}return!!this.isFullscreen_;};Player.prototype.requestFullscreen=function requestFullscreen(){var fsApi=_fullscreenApi2["default"];this.isFullscreen(true);if(fsApi.requestFullscreen){Events.on(_document2["default"],fsApi.fullscreenchange,Fn.bind(this,function documentFullscreenChange(e){this.isFullscreen(_document2["default"][fsApi.fullscreenElement]);if(this.isFullscreen()===false){Events.off(_document2["default"],fsApi.fullscreenchange,documentFullscreenChange);}this.trigger("fullscreenchange");}));this.el_[fsApi.requestFullscreen]();}else if(this.tech_.supportsFullScreen()){this.techCall_("enterFullScreen");}else{this.enterFullWindow();this.trigger("fullscreenchange");}return this;};Player.prototype.exitFullscreen=function exitFullscreen(){var fsApi=_fullscreenApi2["default"];this.isFullscreen(false);if(fsApi.requestFullscreen){_document2["default"][fsApi.exitFullscreen]();}else if(this.tech_.supportsFullScreen()){this.techCall_("exitFullScreen");}else{this.exitFullWindow();this.trigger("fullscreenchange");}return this;};Player.prototype.enterFullWindow=function enterFullWindow(){this.isFullWindow=true;this.docOrigOverflow=_document2["default"].documentElement.style.overflow;Events.on(_document2["default"],"keydown",Fn.bind(this,this.fullWindowOnEscKey));_document2["default"].documentElement.style.overflow="hidden";Dom.addElClass(_document2["default"].body,"vjs-full-window");this.trigger("enterFullWindow");};Player.prototype.fullWindowOnEscKey=function fullWindowOnEscKey(event){if(event.keyCode===27){if(this.isFullscreen()===true){this.exitFullscreen();}else{this.exitFullWindow();}}};Player.prototype.exitFullWindow=function exitFullWindow(){this.isFullWindow=false;Events.off(_document2["default"],"keydown",this.fullWindowOnEscKey);_document2["default"].documentElement.style.overflow=this.docOrigOverflow;Dom.removeElClass(_document2["default"].body,"vjs-full-window");this.trigger("exitFullWindow");};Player.prototype.canPlayType=function canPlayType(type){var can=void 0;for(var i=0,j=this.options_.techOrder;i<j.length;i++){var techName=(0,_toTitleCase2["default"])(j[i]);var tech=_tech2["default"].getTech(techName);if(!tech){tech=_component2["default"].getComponent(techName);}if(!tech){_log2["default"].error('The "'+techName+'" tech is undefined. Skipped browser support check for that tech.');continue;}if(tech.isSupported()){can=tech.canPlayType(type);if(can){return can;}}}return"";};Player.prototype.selectSource=function selectSource(sources){var _this4=this;var techs=this.options_.techOrder.map(_toTitleCase2["default"]).map(function(techName){return[techName,_tech2["default"].getTech(techName)||_component2["default"].getComponent(techName)];}).filter(function(_ref){var techName=_ref[0],tech=_ref[1];if(tech){return tech.isSupported();}_log2["default"].error('The "'+techName+'" tech is undefined. Skipped browser support check for that tech.');return false;});var findFirstPassingTechSourcePair=function findFirstPassingTechSourcePair(outerArray,innerArray,tester){var found=void 0;outerArray.some(function(outerChoice){return innerArray.some(function(innerChoice){found=tester(outerChoice,innerChoice);if(found){return true;}});});return found;};var foundSourceAndTech=void 0;var flip=function flip(fn){return function(a,b){return fn(b,a);};};var finder=function finder(_ref2,source){var techName=_ref2[0],tech=_ref2[1];if(tech.canPlaySource(source,_this4.options_[techName.toLowerCase()])){return{source:source,tech:techName};}};if(this.options_.sourceOrder){foundSourceAndTech=findFirstPassingTechSourcePair(sources,techs,flip(finder));}else{foundSourceAndTech=findFirstPassingTechSourcePair(techs,sources,finder);}return foundSourceAndTech||false;};Player.prototype.src=function src(source){if(source===undefined){return this.techGet_("src");}var currentTech=_tech2["default"].getTech(this.techName_);if(!currentTech){currentTech=_component2["default"].getComponent(this.techName_);}if(Array.isArray(source)){this.sourceList_(source);}else if(typeof source==="string"){this.src({src:source});}else if(source instanceof Object){if(source.type&&!currentTech.canPlaySource(source,this.options_[this.techName_.toLowerCase()])){this.sourceList_([source]);}else{this.cache_.sources=null;this.cache_.source=source;this.cache_.src=source.src;this.currentType_=source.type||"";this.ready(function(){if(currentTech.prototype.hasOwnProperty("setSource")){this.techCall_("setSource",source);}else{this.techCall_("src",source.src);}if(this.options_.preload==="auto"){this.load();}if(this.options_.autoplay){this.play();}},true);}}return this;};Player.prototype.sourceList_=function sourceList_(sources){var sourceTech=this.selectSource(sources);if(sourceTech){if(sourceTech.tech===this.techName_){this.src(sourceTech.source);}else{this.loadTech_(sourceTech.tech,sourceTech.source);}this.cache_.sources=sources;}else{this.setTimeout(function(){this.error({code:4,message:this.localize(this.options_.notSupportedMessage)});},0);this.triggerReady();}};Player.prototype.load=function load(){this.techCall_("load");return this;};Player.prototype.reset=function reset(){this.loadTech_((0,_toTitleCase2["default"])(this.options_.techOrder[0]),null);this.techCall_("reset");return this;};Player.prototype.currentSources=function currentSources(){var source=this.currentSource();var sources=[];if(Object.keys(source).length!==0){sources.push(source);}return this.cache_.sources||sources;};Player.prototype.currentSource=function currentSource(){var source={};var src=this.currentSrc();if(src){source.src=src;}return this.cache_.source||source;};Player.prototype.currentSrc=function currentSrc(){return this.techGet_("currentSrc")||this.cache_.src||"";};Player.prototype.currentType=function currentType(){return this.currentType_||"";};Player.prototype.preload=function preload(value){if(value!==undefined){this.techCall_("setPreload",value);this.options_.preload=value;return this;}return this.techGet_("preload");};Player.prototype.autoplay=function autoplay(value){if(value!==undefined){this.techCall_("setAutoplay",value);this.options_.autoplay=value;return this;}return this.techGet_("autoplay",value);};Player.prototype.loop=function loop(value){if(value!==undefined){this.techCall_("setLoop",value);this.options_.loop=value;return this;}return this.techGet_("loop");};Player.prototype.poster=function poster(src){if(src===undefined){return this.poster_;}if(!src){src="";}this.poster_=src;this.techCall_("setPoster",src);this.trigger("posterchange");return this;};Player.prototype.handleTechPosterChange_=function handleTechPosterChange_(){if(!this.poster_&&this.tech_&&this.tech_.poster){this.poster_=this.tech_.poster()||"";this.trigger("posterchange");}};Player.prototype.controls=function controls(bool){if(bool!==undefined){bool=!!bool;if(this.controls_!==bool){this.controls_=bool;if(this.usingNativeControls()){this.techCall_("setControls",bool);}if(bool){this.removeClass("vjs-controls-disabled");this.addClass("vjs-controls-enabled");this.trigger("controlsenabled");if(!this.usingNativeControls()){this.addTechControlsListeners_();}}else{this.removeClass("vjs-controls-enabled");this.addClass("vjs-controls-disabled");this.trigger("controlsdisabled");if(!this.usingNativeControls()){this.removeTechControlsListeners_();}}}return this;}return!!this.controls_;};Player.prototype.usingNativeControls=function usingNativeControls(bool){if(bool!==undefined){bool=!!bool;if(this.usingNativeControls_!==bool){this.usingNativeControls_=bool;if(bool){this.addClass("vjs-using-native-controls");this.trigger("usingnativecontrols");}else{this.removeClass("vjs-using-native-controls");this.trigger("usingcustomcontrols");}}return this;}return!!this.usingNativeControls_;};Player.prototype.error=function error(err){if(err===undefined){return this.error_||null;}if(err===null){this.error_=err;this.removeClass("vjs-error");if(this.errorDisplay){this.errorDisplay.close();}return this;}this.error_=new _mediaError2["default"](err);this.addClass("vjs-error");_log2["default"].error("(CODE:"+this.error_.code+" "+_mediaError2["default"].errorTypes[this.error_.code]+")",this.error_.message,this.error_);this.trigger("error");return this;};Player.prototype.reportUserActivity=function reportUserActivity(event){this.userActivity_=true;};Player.prototype.userActive=function userActive(bool){if(bool!==undefined){bool=!!bool;if(bool!==this.userActive_){this.userActive_=bool;if(bool){this.userActivity_=true;this.removeClass("vjs-user-inactive");this.addClass("vjs-user-active");this.trigger("useractive");}else{this.userActivity_=false;if(this.tech_){this.tech_.one("mousemove",function(e){e.stopPropagation();e.preventDefault();});}this.removeClass("vjs-user-active");this.addClass("vjs-user-inactive");this.trigger("userinactive");}}return this;}return this.userActive_;};Player.prototype.listenForUserActivity_=function listenForUserActivity_(){var mouseInProgress=void 0;var lastMoveX=void 0;var lastMoveY=void 0;var handleActivity=Fn.bind(this,this.reportUserActivity);var handleMouseMove=function handleMouseMove(e){if(e.screenX!==lastMoveX||e.screenY!==lastMoveY){lastMoveX=e.screenX;lastMoveY=e.screenY;handleActivity();}};var handleMouseDown=function handleMouseDown(){handleActivity();this.clearInterval(mouseInProgress);mouseInProgress=this.setInterval(handleActivity,250);};var handleMouseUp=function handleMouseUp(event){handleActivity();this.clearInterval(mouseInProgress);};this.on("mousedown",handleMouseDown);this.on("mousemove",handleMouseMove);this.on("mouseup",handleMouseUp);this.on("keydown",handleActivity);this.on("keyup",handleActivity);var inactivityTimeout=void 0;this.setInterval(function(){if(this.userActivity_){this.userActivity_=false;this.userActive(true);this.clearTimeout(inactivityTimeout);var timeout=this.options_.inactivityTimeout;if(timeout>0){inactivityTimeout=this.setTimeout(function(){if(!this.userActivity_){this.userActive(false);}},timeout);}}},250);};Player.prototype.playbackRate=function playbackRate(rate){if(rate!==undefined){this.techCall_("setPlaybackRate",rate);return this;}if(this.tech_&&this.tech_.featuresPlaybackRate){return this.techGet_("playbackRate");}return 1;};Player.prototype.isAudio=function isAudio(bool){if(bool!==undefined){this.isAudio_=!!bool;return this;}return!!this.isAudio_;};Player.prototype.videoTracks=function videoTracks(){if(!this.tech_){this.videoTracks_=this.videoTracks_||new _videoTrackList2["default"]();return this.videoTracks_;}return this.tech_.videoTracks();};Player.prototype.audioTracks=function audioTracks(){if(!this.tech_){this.audioTracks_=this.audioTracks_||new _audioTrackList2["default"]();return this.audioTracks_;}return this.tech_.audioTracks();};Player.prototype.textTracks=function textTracks(){if(this.tech_){return this.tech_.textTracks();}};Player.prototype.remoteTextTracks=function remoteTextTracks(){if(this.tech_){return this.tech_.remoteTextTracks();}};Player.prototype.remoteTextTrackEls=function remoteTextTrackEls(){if(this.tech_){return this.tech_.remoteTextTrackEls();}};Player.prototype.addTextTrack=function addTextTrack(kind,label,language){if(this.tech_){return this.tech_.addTextTrack(kind,label,language);}};Player.prototype.addRemoteTextTrack=function addRemoteTextTrack(options,manualCleanup){if(this.tech_){return this.tech_.addRemoteTextTrack(options,manualCleanup);}};Player.prototype.removeRemoteTextTrack=function removeRemoteTextTrack(){var _ref3=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},_ref3$track=_ref3.track,track=_ref3$track===undefined?arguments[0]:_ref3$track;if(this.tech_){return this.tech_.removeRemoteTextTrack(track);}};Player.prototype.videoWidth=function videoWidth(){return this.tech_&&this.tech_.videoWidth&&this.tech_.videoWidth()||0;};Player.prototype.videoHeight=function videoHeight(){return this.tech_&&this.tech_.videoHeight&&this.tech_.videoHeight()||0;};Player.prototype.language=function language(code){if(code===undefined){return this.language_;}this.language_=String(code).toLowerCase();return this;};Player.prototype.languages=function languages(){return(0,_mergeOptions2["default"])(Player.prototype.options_.languages,this.languages_);};Player.prototype.toJSON=function toJSON(){var options=(0,_mergeOptions2["default"])(this.options_);var tracks=options.tracks;options.tracks=[];for(var i=0;i<tracks.length;i++){var track=tracks[i];track=(0,_mergeOptions2["default"])(track);track.player=undefined;options.tracks[i]=track;}return options;};Player.prototype.createModal=function createModal(content,options){var _this5=this;options=options||{};options.content=content||"";var modal=new _modalDialog2["default"](this,options);this.addChild(modal);modal.on("dispose",function(){_this5.removeChild(modal);});return modal.open();};Player.getTagSettings=function getTagSettings(tag){var baseOptions={sources:[],tracks:[]};var tagOptions=Dom.getElAttributes(tag);var dataSetup=tagOptions["data-setup"];if(Dom.hasElClass(tag,"vjs-fluid")){tagOptions.fluid=true;}if(dataSetup!==null){var _safeParseTuple=(0,_tuple2["default"])(dataSetup||"{}"),err=_safeParseTuple[0],data=_safeParseTuple[1];if(err){_log2["default"].error(err);}(0,_obj.assign)(tagOptions,data);}(0,_obj.assign)(baseOptions,tagOptions);if(tag.hasChildNodes()){var children=tag.childNodes;for(var i=0,j=children.length;i<j;i++){var child=children[i];var childName=child.nodeName.toLowerCase();if(childName==="source"){baseOptions.sources.push(Dom.getElAttributes(child));}else if(childName==="track"){baseOptions.tracks.push(Dom.getElAttributes(child));}}}return baseOptions;};Player.prototype.flexNotSupported_=function flexNotSupported_(){var elem=_document2["default"].createElement("i");return!("flexBasis"in elem.style||"webkitFlexBasis"in elem.style||"mozFlexBasis"in elem.style||"msFlexBasis"in elem.style||"msFlexOrder"in elem.style);};return Player;}(_component2["default"]);Player.players={};var navigator=_window2["default"].navigator;Player.prototype.options_={techOrder:["html5","flash"],html5:{},flash:{},defaultVolume:0,inactivityTimeout:2e3,playbackRates:[],children:["mediaLoader","posterImage","textTrackDisplay","loadingSpinner","bigPlayButton","controlBar","errorDisplay","textTrackSettings"],language:navigator&&(navigator.languages&&navigator.languages[0]||navigator.userLanguage||navigator.language)||"en",languages:{},notSupportedMessage:"No compatible source was found for this media."};["ended","seeking","seekable","networkState","readyState"].forEach(function(fn){Player.prototype[fn]=function(){return this.techGet_(fn);};});TECH_EVENTS_RETRIGGER.forEach(function(event){Player.prototype["handleTech"+(0,_toTitleCase2["default"])(event)+"_"]=function(){return this.trigger(event);};});_component2["default"].registerComponent("Player",Player);exports["default"]=Player;},{"./big-play-button.js":240,"./close-button.js":243,"./component.js":244,"./control-bar/control-bar.js":247,"./error-display.js":280,"./fullscreen-api.js":283,"./loading-spinner.js":284,"./media-error.js":285,"./modal-dialog":289,"./poster-image.js":294,"./tech/flash.js":298,"./tech/html5.js":299,"./tech/loader.js":300,"./tech/tech.js":301,"./tracks/audio-track-list.js":302,"./tracks/text-track-display.js":307,"./tracks/text-track-list-converter.js":308,"./tracks/text-track-settings.js":310,"./tracks/video-track-list.js":315,"./utils/browser.js":317,"./utils/buffer.js":318,"./utils/dom.js":320,"./utils/events.js":321,"./utils/fn.js":322,"./utils/guid.js":324,"./utils/log.js":325,"./utils/merge-options.js":326,"./utils/obj":327,"./utils/stylesheet.js":328,"./utils/time-ranges.js":329,"./utils/to-title-case.js":330,"global/document":89,"global/window":90,"safe-json-parse/tuple":178}],291:[function(require,module,exports){"use strict";exports.__esModule=true;var _player=require("./player.js");var _player2=_interopRequireDefault(_player);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}var plugin=function plugin(name,init){_player2["default"].prototype[name]=init;};exports["default"]=plugin;},{"./player.js":290}],292:[function(require,module,exports){"use strict";exports.__esModule=true;var _clickableComponent=require("../clickable-component.js");var _clickableComponent2=_interopRequireDefault(_clickableComponent);var _component=require("../component.js");var _component2=_interopRequireDefault(_component);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&((typeof call==="undefined"?"undefined":_typeof2(call))==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var PopupButton=function(_ClickableComponent){_inherits(PopupButton,_ClickableComponent);function PopupButton(player){var options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};_classCallCheck(this,PopupButton);var _this=_possibleConstructorReturn(this,_ClickableComponent.call(this,player,options));_this.update();return _this;}PopupButton.prototype.update=function update(){var popup=this.createPopup();if(this.popup){this.removeChild(this.popup);}this.popup=popup;this.addChild(popup);if(this.items&&this.items.length===0){this.hide();}else if(this.items&&this.items.length>1){this.show();}};PopupButton.prototype.createPopup=function createPopup(){};PopupButton.prototype.createEl=function createEl(){return _ClickableComponent.prototype.createEl.call(this,"div",{className:this.buildCSSClass()});};PopupButton.prototype.buildCSSClass=function buildCSSClass(){var menuButtonClass="vjs-menu-button";if(this.options_.inline===true){menuButtonClass+="-inline";}else{menuButtonClass+="-popup";}return"vjs-menu-button "+menuButtonClass+" "+_ClickableComponent.prototype.buildCSSClass.call(this);};return PopupButton;}(_clickableComponent2["default"]);_component2["default"].registerComponent("PopupButton",PopupButton);exports["default"]=PopupButton;},{"../clickable-component.js":242,"../component.js":244}],293:[function(require,module,exports){"use strict";exports.__esModule=true;var _component=require("../component.js");var _component2=_interopRequireDefault(_component);var _dom=require("../utils/dom.js");var Dom=_interopRequireWildcard(_dom);var _fn=require("../utils/fn.js");var Fn=_interopRequireWildcard(_fn);var _events=require("../utils/events.js");var Events=_interopRequireWildcard(_events);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&((typeof call==="undefined"?"undefined":_typeof2(call))==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var Popup=function(_Component){_inherits(Popup,_Component);function Popup(){_classCallCheck(this,Popup);return _possibleConstructorReturn(this,_Component.apply(this,arguments));}Popup.prototype.addItem=function addItem(component){this.addChild(component);component.on("click",Fn.bind(this,function(){this.unlockShowing();}));};Popup.prototype.createEl=function createEl(){var contentElType=this.options_.contentElType||"ul";this.contentEl_=Dom.createEl(contentElType,{className:"vjs-menu-content"});var el=_Component.prototype.createEl.call(this,"div",{append:this.contentEl_,className:"vjs-menu"});el.appendChild(this.contentEl_);Events.on(el,"click",function(event){event.preventDefault();event.stopImmediatePropagation();});return el;};return Popup;}(_component2["default"]);_component2["default"].registerComponent("Popup",Popup);exports["default"]=Popup;},{"../component.js":244,"../utils/dom.js":320,"../utils/events.js":321,"../utils/fn.js":322}],294:[function(require,module,exports){"use strict";exports.__esModule=true;var _clickableComponent=require("./clickable-component.js");var _clickableComponent2=_interopRequireDefault(_clickableComponent);var _component=require("./component.js");var _component2=_interopRequireDefault(_component);var _fn=require("./utils/fn.js");var Fn=_interopRequireWildcard(_fn);var _dom=require("./utils/dom.js");var Dom=_interopRequireWildcard(_dom);var _browser=require("./utils/browser.js");var browser=_interopRequireWildcard(_browser);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&((typeof call==="undefined"?"undefined":_typeof2(call))==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var PosterImage=function(_ClickableComponent){_inherits(PosterImage,_ClickableComponent);function PosterImage(player,options){_classCallCheck(this,PosterImage);var _this=_possibleConstructorReturn(this,_ClickableComponent.call(this,player,options));_this.update();player.on("posterchange",Fn.bind(_this,_this.update));return _this;}PosterImage.prototype.dispose=function dispose(){this.player().off("posterchange",this.update);_ClickableComponent.prototype.dispose.call(this);};PosterImage.prototype.createEl=function createEl(){var el=Dom.createEl("div",{className:"vjs-poster",tabIndex:-1});if(!browser.BACKGROUND_SIZE_SUPPORTED){this.fallbackImg_=Dom.createEl("img");el.appendChild(this.fallbackImg_);}return el;};PosterImage.prototype.update=function update(event){var url=this.player().poster();this.setSrc(url);if(url){this.show();}else{this.hide();}};PosterImage.prototype.setSrc=function setSrc(url){if(this.fallbackImg_){this.fallbackImg_.src=url;}else{var backgroundImage="";if(url){backgroundImage='url("'+url+'")';}this.el_.style.backgroundImage=backgroundImage;}};PosterImage.prototype.handleClick=function handleClick(event){if(!this.player_.controls()){return;}if(this.player_.paused()){this.player_.play();}else{this.player_.pause();}};return PosterImage;}(_clickableComponent2["default"]);_component2["default"].registerComponent("PosterImage",PosterImage);exports["default"]=PosterImage;},{"./clickable-component.js":242,"./component.js":244,"./utils/browser.js":317,"./utils/dom.js":320,"./utils/fn.js":322}],295:[function(require,module,exports){"use strict";exports.__esModule=true;exports.hasLoaded=exports.autoSetupTimeout=exports.autoSetup=undefined;var _dom=require("./utils/dom");var Dom=_interopRequireWildcard(_dom);var _events=require("./utils/events.js");var Events=_interopRequireWildcard(_events);var _document=require("global/document");var _document2=_interopRequireDefault(_document);var _window=require("global/window");var _window2=_interopRequireDefault(_window);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}var _windowLoaded=false;var videojs=void 0;var autoSetup=function autoSetup(){if(!Dom.isReal()){return;}var vids=_document2["default"].getElementsByTagName("video");var audios=_document2["default"].getElementsByTagName("audio");var mediaEls=[];if(vids&&vids.length>0){for(var i=0,e=vids.length;i<e;i++){mediaEls.push(vids[i]);}}if(audios&&audios.length>0){for(var _i=0,_e=audios.length;_i<_e;_i++){mediaEls.push(audios[_i]);}}if(mediaEls&&mediaEls.length>0){for(var _i2=0,_e2=mediaEls.length;_i2<_e2;_i2++){var mediaEl=mediaEls[_i2];if(mediaEl&&mediaEl.getAttribute){if(mediaEl.player===undefined){var options=mediaEl.getAttribute("data-setup");if(options!==null){videojs(mediaEl);}}}else{autoSetupTimeout(1);break;}}}else if(!_windowLoaded){autoSetupTimeout(1);}};function autoSetupTimeout(wait,vjs){if(vjs){videojs=vjs;}_window2["default"].setTimeout(autoSetup,wait);}if(Dom.isReal()&&_document2["default"].readyState==="complete"){_windowLoaded=true;}else{Events.one(_window2["default"],"load",function(){_windowLoaded=true;});}var hasLoaded=function hasLoaded(){return _windowLoaded;};exports.autoSetup=autoSetup;exports.autoSetupTimeout=autoSetupTimeout;exports.hasLoaded=hasLoaded;},{"./utils/dom":320,"./utils/events.js":321,"global/document":89,"global/window":90}],296:[function(require,module,exports){"use strict";exports.__esModule=true;var _component=require("../component.js");var _component2=_interopRequireDefault(_component);var _dom=require("../utils/dom.js");var Dom=_interopRequireWildcard(_dom);var _obj=require("../utils/obj");function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&((typeof call==="undefined"?"undefined":_typeof2(call))==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var Slider=function(_Component){_inherits(Slider,_Component);function Slider(player,options){_classCallCheck(this,Slider);var _this=_possibleConstructorReturn(this,_Component.call(this,player,options));_this.bar=_this.getChild(_this.options_.barName);_this.vertical(!!_this.options_.vertical);_this.on("mousedown",_this.handleMouseDown);_this.on("touchstart",_this.handleMouseDown);_this.on("focus",_this.handleFocus);_this.on("blur",_this.handleBlur);_this.on("click",_this.handleClick);_this.on(player,"controlsvisible",_this.update);_this.on(player,_this.playerEvent,_this.update);return _this;}Slider.prototype.createEl=function createEl(type){var props=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var attributes=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};props.className=props.className+" vjs-slider";props=(0,_obj.assign)({tabIndex:0},props);attributes=(0,_obj.assign)({role:"slider","aria-valuenow":0,"aria-valuemin":0,"aria-valuemax":100,tabIndex:0},attributes);return _Component.prototype.createEl.call(this,type,props,attributes);};Slider.prototype.handleMouseDown=function handleMouseDown(event){var doc=this.bar.el_.ownerDocument;event.preventDefault();Dom.blockTextSelection();this.addClass("vjs-sliding");this.trigger("slideractive");this.on(doc,"mousemove",this.handleMouseMove);this.on(doc,"mouseup",this.handleMouseUp);this.on(doc,"touchmove",this.handleMouseMove);this.on(doc,"touchend",this.handleMouseUp);this.handleMouseMove(event);};Slider.prototype.handleMouseMove=function handleMouseMove(event){};Slider.prototype.handleMouseUp=function handleMouseUp(){var doc=this.bar.el_.ownerDocument;Dom.unblockTextSelection();this.removeClass("vjs-sliding");this.trigger("sliderinactive");this.off(doc,"mousemove",this.handleMouseMove);this.off(doc,"mouseup",this.handleMouseUp);this.off(doc,"touchmove",this.handleMouseMove);this.off(doc,"touchend",this.handleMouseUp);this.update();};Slider.prototype.update=function update(){if(!this.el_){return;}var progress=this.getPercent();var bar=this.bar;if(!bar){return;}if(typeof progress!=="number"||progress!==progress||progress<0||progress===Infinity){progress=0;}var percentage=(progress*100).toFixed(2)+"%";if(this.vertical()){bar.el().style.height=percentage;}else{bar.el().style.width=percentage;}};Slider.prototype.calculateDistance=function calculateDistance(event){var position=Dom.getPointerPosition(this.el_,event);if(this.vertical()){return position.y;}return position.x;};Slider.prototype.handleFocus=function handleFocus(){this.on(this.bar.el_.ownerDocument,"keydown",this.handleKeyPress);};Slider.prototype.handleKeyPress=function handleKeyPress(event){if(event.which===37||event.which===40){event.preventDefault();this.stepBack();}else if(event.which===38||event.which===39){event.preventDefault();this.stepForward();}};Slider.prototype.handleBlur=function handleBlur(){this.off(this.bar.el_.ownerDocument,"keydown",this.handleKeyPress);};Slider.prototype.handleClick=function handleClick(event){event.stopImmediatePropagation();event.preventDefault();};Slider.prototype.vertical=function vertical(bool){if(bool===undefined){return this.vertical_||false;}this.vertical_=!!bool;if(this.vertical_){this.addClass("vjs-slider-vertical");}else{this.addClass("vjs-slider-horizontal");}return this;};return Slider;}(_component2["default"]);_component2["default"].registerComponent("Slider",Slider);exports["default"]=Slider;},{"../component.js":244,"../utils/dom.js":320,"../utils/obj":327}],297:[function(require,module,exports){"use strict";exports.__esModule=true;function FlashRtmpDecorator(Flash){Flash.streamingFormats={"rtmp/mp4":"MP4","rtmp/flv":"FLV"};Flash.streamFromParts=function(connection,stream){return connection+"&"+stream;};Flash.streamToParts=function(src){var parts={connection:"",stream:""};if(!src){return parts;}var connEnd=src.search(/&(?!\w+=)/);var streamBegin=void 0;if(connEnd!==-1){streamBegin=connEnd+1;}else{connEnd=streamBegin=src.lastIndexOf("/")+1;if(connEnd===0){connEnd=streamBegin=src.length;}}parts.connection=src.substring(0,connEnd);parts.stream=src.substring(streamBegin,src.length);return parts;};Flash.isStreamingType=function(srcType){return srcType in Flash.streamingFormats;};Flash.RTMP_RE=/^rtmp[set]?:\/\//i;Flash.isStreamingSrc=function(src){return Flash.RTMP_RE.test(src);};Flash.rtmpSourceHandler={};Flash.rtmpSourceHandler.canPlayType=function(type){if(Flash.isStreamingType(type)){return"maybe";}return"";};Flash.rtmpSourceHandler.canHandleSource=function(source,options){var can=Flash.rtmpSourceHandler.canPlayType(source.type);if(can){return can;}if(Flash.isStreamingSrc(source.src)){return"maybe";}return"";};Flash.rtmpSourceHandler.handleSource=function(source,tech,options){var srcParts=Flash.streamToParts(source.src);tech.setRtmpConnection(srcParts.connection);tech.setRtmpStream(srcParts.stream);};Flash.registerSourceHandler(Flash.rtmpSourceHandler);return Flash;}exports["default"]=FlashRtmpDecorator;},{}],298:[function(require,module,exports){"use strict";exports.__esModule=true;var _tech=require("./tech");var _tech2=_interopRequireDefault(_tech);var _dom=require("../utils/dom.js");var Dom=_interopRequireWildcard(_dom);var _url=require("../utils/url.js");var Url=_interopRequireWildcard(_url);var _timeRanges=require("../utils/time-ranges.js");var _flashRtmp=require("./flash-rtmp");var _flashRtmp2=_interopRequireDefault(_flashRtmp);var _component=require("../component");var _component2=_interopRequireDefault(_component);var _window=require("global/window");var _window2=_interopRequireDefault(_window);var _obj=require("../utils/obj");function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&((typeof call==="undefined"?"undefined":_typeof2(call))==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var navigator=_window2["default"].navigator;var Flash=function(_Tech){_inherits(Flash,_Tech);function Flash(options,ready){_classCallCheck(this,Flash);var _this=_possibleConstructorReturn(this,_Tech.call(this,options,ready));if(options.source){_this.ready(function(){this.setSource(options.source);},true);}if(options.startTime){_this.ready(function(){this.load();this.play();this.currentTime(options.startTime);},true);}_window2["default"].videojs=_window2["default"].videojs||{};_window2["default"].videojs.Flash=_window2["default"].videojs.Flash||{};_window2["default"].videojs.Flash.onReady=Flash.onReady;_window2["default"].videojs.Flash.onEvent=Flash.onEvent;_window2["default"].videojs.Flash.onError=Flash.onError;_this.on("seeked",function(){this.lastSeekTarget_=undefined;});return _this;}Flash.prototype.createEl=function createEl(){var options=this.options_;if(!options.swf){var ver="5.3.0";options.swf="//vjs.zencdn.net/swf/"+ver+"/video-js.swf";}var objId=options.techId;var flashVars=(0,_obj.assign)({readyFunction:"videojs.Flash.onReady",eventProxyFunction:"videojs.Flash.onEvent",errorEventProxyFunction:"videojs.Flash.onError",autoplay:options.autoplay,preload:options.preload,loop:options.loop,muted:options.muted},options.flashVars);var params=(0,_obj.assign)({wmode:"opaque",bgcolor:"#000000"},options.params);var attributes=(0,_obj.assign)({id:objId,name:objId,class:"vjs-tech"},options.attributes);this.el_=Flash.embed(options.swf,flashVars,params,attributes);this.el_.tech=this;return this.el_;};Flash.prototype.play=function play(){if(this.ended()){this.setCurrentTime(0);}this.el_.vjs_play();};Flash.prototype.pause=function pause(){this.el_.vjs_pause();};Flash.prototype.src=function src(_src){if(_src===undefined){return this.currentSrc();}return this.setSrc(_src);};Flash.prototype.setSrc=function setSrc(src){var _this2=this;src=Url.getAbsoluteURL(src);this.el_.vjs_src(src);if(this.autoplay()){this.setTimeout(function(){return _this2.play();},0);}};Flash.prototype.seeking=function seeking(){return this.lastSeekTarget_!==undefined;};Flash.prototype.setCurrentTime=function setCurrentTime(time){var seekable=this.seekable();if(seekable.length){time=time>seekable.start(0)?time:seekable.start(0);time=time<seekable.end(seekable.length-1)?time:seekable.end(seekable.length-1);this.lastSeekTarget_=time;this.trigger("seeking");this.el_.vjs_setProperty("currentTime",time);_Tech.prototype.setCurrentTime.call(this);}};Flash.prototype.currentTime=function currentTime(){if(this.seeking()){return this.lastSeekTarget_||0;}return this.el_.vjs_getProperty("currentTime");};Flash.prototype.currentSrc=function currentSrc(){if(this.currentSource_){return this.currentSource_.src;}return this.el_.vjs_getProperty("currentSrc");};Flash.prototype.duration=function duration(){if(this.readyState()===0){return NaN;}var duration=this.el_.vjs_getProperty("duration");return duration>=0?duration:Infinity;};Flash.prototype.load=function load(){this.el_.vjs_load();};Flash.prototype.poster=function poster(){this.el_.vjs_getProperty("poster");};Flash.prototype.setPoster=function setPoster(){};Flash.prototype.seekable=function seekable(){var duration=this.duration();if(duration===0){return(0,_timeRanges.createTimeRange)();}return(0,_timeRanges.createTimeRange)(0,duration);};Flash.prototype.buffered=function buffered(){var ranges=this.el_.vjs_getProperty("buffered");if(ranges.length===0){return(0,_timeRanges.createTimeRange)();}return(0,_timeRanges.createTimeRange)(ranges[0][0],ranges[0][1]);};Flash.prototype.supportsFullScreen=function supportsFullScreen(){return false;};Flash.prototype.enterFullScreen=function enterFullScreen(){return false;};return Flash;}(_tech2["default"]);var _api=Flash.prototype;var _readWrite="rtmpConnection,rtmpStream,preload,defaultPlaybackRate,playbackRate,autoplay,loop,mediaGroup,controller,controls,volume,muted,defaultMuted".split(",");var _readOnly="networkState,readyState,initialTime,startOffsetTime,paused,ended,videoWidth,videoHeight".split(",");function _createSetter(attr){var attrUpper=attr.charAt(0).toUpperCase()+attr.slice(1);_api["set"+attrUpper]=function(val){return this.el_.vjs_setProperty(attr,val);};}function _createGetter(attr){_api[attr]=function(){return this.el_.vjs_getProperty(attr);};}for(var i=0;i<_readWrite.length;i++){_createGetter(_readWrite[i]);_createSetter(_readWrite[i]);}for(var _i=0;_i<_readOnly.length;_i++){_createGetter(_readOnly[_i]);}Flash.isSupported=function(){return Flash.version()[0]>=10;};_tech2["default"].withSourceHandlers(Flash);Flash.nativeSourceHandler={};Flash.nativeSourceHandler.canPlayType=function(type){if(type in Flash.formats){return"maybe";}return"";};Flash.nativeSourceHandler.canHandleSource=function(source,options){var type=void 0;function guessMimeType(src){var ext=Url.getFileExtension(src);if(ext){return"video/"+ext;}return"";}if(!source.type){type=guessMimeType(source.src);}else{type=source.type.replace(/;.*/,"").toLowerCase();}return Flash.nativeSourceHandler.canPlayType(type);};Flash.nativeSourceHandler.handleSource=function(source,tech,options){tech.setSrc(source.src);};Flash.nativeSourceHandler.dispose=function(){};Flash.registerSourceHandler(Flash.nativeSourceHandler);Flash.formats={"video/flv":"FLV","video/x-flv":"FLV","video/mp4":"MP4","video/m4v":"MP4"};Flash.onReady=function(currSwf){var el=Dom.getEl(currSwf);var tech=el&&el.tech;if(tech&&tech.el()){Flash.checkReady(tech);}};Flash.checkReady=function(tech){if(!tech.el()){return;}if(tech.el().vjs_getProperty){tech.triggerReady();}else{this.setTimeout(function(){Flash.checkReady(tech);},50);}};Flash.onEvent=function(swfID,eventName){var tech=Dom.getEl(swfID).tech;var args=Array.prototype.slice.call(arguments,2);tech.setTimeout(function(){tech.trigger(eventName,args);},1);};Flash.onError=function(swfID,err){var tech=Dom.getEl(swfID).tech;if(err==="srcnotfound"){return tech.error(4);}tech.error("FLASH: "+err);};Flash.version=function(){var version="0,0,0";try{version=new _window2["default"].ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version").replace(/\D+/g,",").match(/^,?(.+),?$/)[1];}catch(e){try{if(navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin){version=(navigator.plugins["Shockwave Flash 2.0"]||navigator.plugins["Shockwave Flash"]).description.replace(/\D+/g,",").match(/^,?(.+),?$/)[1];}}catch(err){}}return version.split(",");};Flash.embed=function(swf,flashVars,params,attributes){var code=Flash.getEmbedCode(swf,flashVars,params,attributes);var obj=Dom.createEl("div",{innerHTML:code}).childNodes[0];return obj;};Flash.getEmbedCode=function(swf,flashVars,params,attributes){var objTag='<object type="application/x-shockwave-flash" ';var flashVarsString="";var paramsString="";var attrsString="";if(flashVars){Object.getOwnPropertyNames(flashVars).forEach(function(key){flashVarsString+=key+"="+flashVars[key]+"&amp;";});}params=(0,_obj.assign)({movie:swf,flashvars:flashVarsString,allowScriptAccess:"always",allowNetworking:"all"},params);Object.getOwnPropertyNames(params).forEach(function(key){paramsString+='<param name="'+key+'" value="'+params[key]+'" />';});attributes=(0,_obj.assign)({data:swf,width:"100%",height:"100%"},attributes);Object.getOwnPropertyNames(attributes).forEach(function(key){attrsString+=key+'="'+attributes[key]+'" ';});return""+objTag+attrsString+">"+paramsString+"</object>";};(0,_flashRtmp2["default"])(Flash);_component2["default"].registerComponent("Flash",Flash);_tech2["default"].registerTech("Flash",Flash);exports["default"]=Flash;},{"../component":244,"../utils/dom.js":320,"../utils/obj":327,"../utils/time-ranges.js":329,"../utils/url.js":331,"./flash-rtmp":297,"./tech":301,"global/window":90}],299:[function(require,module,exports){"use strict";exports.__esModule=true;var _templateObject=_taggedTemplateLiteralLoose(["Text Tracks are being loaded from another origin but the crossorigin attribute isn't used.\n            This may prevent text tracks from loading."],["Text Tracks are being loaded from another origin but the crossorigin attribute isn't used.\n            This may prevent text tracks from loading."]);var _tech=require("./tech.js");var _tech2=_interopRequireDefault(_tech);var _component=require("../component");var _component2=_interopRequireDefault(_component);var _dom=require("../utils/dom.js");var Dom=_interopRequireWildcard(_dom);var _url=require("../utils/url.js");var Url=_interopRequireWildcard(_url);var _fn=require("../utils/fn.js");var Fn=_interopRequireWildcard(_fn);var _log=require("../utils/log.js");var _log2=_interopRequireDefault(_log);var _tsml=require("tsml");var _tsml2=_interopRequireDefault(_tsml);var _browser=require("../utils/browser.js");var browser=_interopRequireWildcard(_browser);var _document=require("global/document");var _document2=_interopRequireDefault(_document);var _window=require("global/window");var _window2=_interopRequireDefault(_window);var _obj=require("../utils/obj");var _mergeOptions=require("../utils/merge-options.js");var _mergeOptions2=_interopRequireDefault(_mergeOptions);var _toTitleCase=require("../utils/to-title-case.js");var _toTitleCase2=_interopRequireDefault(_toTitleCase);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _taggedTemplateLiteralLoose(strings,raw){strings.raw=raw;return strings;}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&((typeof call==="undefined"?"undefined":_typeof2(call))==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var Html5=function(_Tech){_inherits(Html5,_Tech);function Html5(options,ready){_classCallCheck(this,Html5);var _this=_possibleConstructorReturn(this,_Tech.call(this,options,ready));var source=options.source;var crossoriginTracks=false;if(source&&(_this.el_.currentSrc!==source.src||options.tag&&options.tag.initNetworkState_===3)){_this.setSource(source);}else{_this.handleLateInit_(_this.el_);}if(_this.el_.hasChildNodes()){var nodes=_this.el_.childNodes;var nodesLength=nodes.length;var removeNodes=[];while(nodesLength--){var node=nodes[nodesLength];var nodeName=node.nodeName.toLowerCase();if(nodeName==="track"){if(!_this.featuresNativeTextTracks){removeNodes.push(node);}else{_this.remoteTextTrackEls().addTrackElement_(node);_this.remoteTextTracks().addTrack_(node.track);if(!crossoriginTracks&&!_this.el_.hasAttribute("crossorigin")&&Url.isCrossOrigin(node.src)){crossoriginTracks=true;}}}}for(var i=0;i<removeNodes.length;i++){_this.el_.removeChild(removeNodes[i]);}}var trackTypes=["audio","video"];trackTypes.forEach(function(type){var elTracks=_this.el()[type+"Tracks"];var techTracks=_this[type+"Tracks"]();var capitalType=(0,_toTitleCase2["default"])(type);if(!_this["featuresNative"+capitalType+"Tracks"]||!elTracks||!elTracks.addEventListener){return;}_this["handle"+capitalType+"TrackChange_"]=function(e){techTracks.trigger({type:"change",target:techTracks,currentTarget:techTracks,srcElement:techTracks});};_this["handle"+capitalType+"TrackAdd_"]=function(e){return techTracks.addTrack(e.track);};_this["handle"+capitalType+"TrackRemove_"]=function(e){return techTracks.removeTrack(e.track);};elTracks.addEventListener("change",_this["handle"+capitalType+"TrackChange_"]);elTracks.addEventListener("addtrack",_this["handle"+capitalType+"TrackAdd_"]);elTracks.addEventListener("removetrack",_this["handle"+capitalType+"TrackRemove_"]);_this["removeOld"+capitalType+"Tracks_"]=function(e){return _this.removeOldTracks_(techTracks,elTracks);};_this.on("loadstart",_this["removeOld"+capitalType+"Tracks_"]);});if(_this.featuresNativeTextTracks){if(crossoriginTracks){_log2["default"].warn((0,_tsml2["default"])(_templateObject));}_this.handleTextTrackChange_=Fn.bind(_this,_this.handleTextTrackChange);_this.handleTextTrackAdd_=Fn.bind(_this,_this.handleTextTrackAdd);_this.handleTextTrackRemove_=Fn.bind(_this,_this.handleTextTrackRemove);_this.proxyNativeTextTracks_();}if((browser.TOUCH_ENABLED||browser.IS_IPHONE||browser.IS_NATIVE_ANDROID)&&options.nativeControlsForTouch===true){_this.setControls(true);}_this.proxyWebkitFullscreen_();_this.triggerReady();return _this;}Html5.prototype.dispose=function dispose(){var _this2=this;["audio","video","text"].forEach(function(type){var capitalType=(0,_toTitleCase2["default"])(type);var tl=_this2.el_[type+"Tracks"];if(tl&&tl.removeEventListener){tl.removeEventListener("change",_this2["handle"+capitalType+"TrackChange_"]);tl.removeEventListener("addtrack",_this2["handle"+capitalType+"TrackAdd_"]);tl.removeEventListener("removetrack",_this2["handle"+capitalType+"TrackRemove_"]);}if(tl){_this2.off("loadstart",_this2["removeOld"+capitalType+"Tracks_"]);}});Html5.disposeMediaElement(this.el_);_Tech.prototype.dispose.call(this);};Html5.prototype.createEl=function createEl(){var el=this.options_.tag;if(!el||!(this.options_.playerElIngest||this.movingMediaElementInDOM)){if(el){var clone=el.cloneNode(true);if(el.parentNode){el.parentNode.insertBefore(clone,el);}Html5.disposeMediaElement(el);el=clone;}else{el=_document2["default"].createElement("video");var tagAttributes=this.options_.tag&&Dom.getElAttributes(this.options_.tag);var attributes=(0,_mergeOptions2["default"])({},tagAttributes);if(!browser.TOUCH_ENABLED||this.options_.nativeControlsForTouch!==true){delete attributes.controls;}Dom.setElAttributes(el,(0,_obj.assign)(attributes,{id:this.options_.techId,class:"vjs-tech"}));}el.playerId=this.options_.playerId;}var settingsAttrs=["autoplay","preload","loop","muted"];for(var i=settingsAttrs.length-1;i>=0;i--){var attr=settingsAttrs[i];var overwriteAttrs={};if(typeof this.options_[attr]!=="undefined"){overwriteAttrs[attr]=this.options_[attr];}Dom.setElAttributes(el,overwriteAttrs);}return el;};Html5.prototype.handleLateInit_=function handleLateInit_(el){if(el.networkState===0||el.networkState===3){return;}if(el.readyState===0){var loadstartFired=false;var setLoadstartFired=function setLoadstartFired(){loadstartFired=true;};this.on("loadstart",setLoadstartFired);var triggerLoadstart=function triggerLoadstart(){if(!loadstartFired){this.trigger("loadstart");}};this.on("loadedmetadata",triggerLoadstart);this.ready(function(){this.off("loadstart",setLoadstartFired);this.off("loadedmetadata",triggerLoadstart);if(!loadstartFired){this.trigger("loadstart");}});return;}var eventsToTrigger=["loadstart"];eventsToTrigger.push("loadedmetadata");if(el.readyState>=2){eventsToTrigger.push("loadeddata");}if(el.readyState>=3){eventsToTrigger.push("canplay");}if(el.readyState>=4){eventsToTrigger.push("canplaythrough");}this.ready(function(){eventsToTrigger.forEach(function(type){this.trigger(type);},this);});};Html5.prototype.proxyNativeTextTracks_=function proxyNativeTextTracks_(){var tt=this.el().textTracks;if(tt){for(var i=0;i<tt.length;i++){this.textTracks().addTrack_(tt[i]);}if(tt.addEventListener){tt.addEventListener("change",this.handleTextTrackChange_);tt.addEventListener("addtrack",this.handleTextTrackAdd_);tt.addEventListener("removetrack",this.handleTextTrackRemove_);}this.on("loadstart",this.removeOldTextTracks_);}};Html5.prototype.handleTextTrackChange=function handleTextTrackChange(e){var tt=this.textTracks();this.textTracks().trigger({type:"change",target:tt,currentTarget:tt,srcElement:tt});};Html5.prototype.handleTextTrackAdd=function handleTextTrackAdd(e){this.textTracks().addTrack_(e.track);};Html5.prototype.handleTextTrackRemove=function handleTextTrackRemove(e){this.textTracks().removeTrack_(e.track);};Html5.prototype.removeOldTracks_=function removeOldTracks_(techTracks,elTracks){var removeTracks=[];if(!elTracks){return;}for(var i=0;i<techTracks.length;i++){var techTrack=techTracks[i];var found=false;for(var j=0;j<elTracks.length;j++){if(elTracks[j]===techTrack){found=true;break;}}if(!found){removeTracks.push(techTrack);}}for(var _i=0;_i<removeTracks.length;_i++){var track=removeTracks[_i];techTracks.removeTrack_(track);}};Html5.prototype.removeOldTextTracks_=function removeOldTextTracks_(e){var techTracks=this.textTracks();var elTracks=this.el().textTracks;this.removeOldTracks_(techTracks,elTracks);};Html5.prototype.play=function play(){var playPromise=this.el_.play();if(playPromise!==undefined&&typeof playPromise.then==="function"){playPromise.then(null,function(e){});}};Html5.prototype.setCurrentTime=function setCurrentTime(seconds){try{this.el_.currentTime=seconds;}catch(e){(0,_log2["default"])(e,"Video is not ready. (Video.js)");}};Html5.prototype.duration=function duration(){var _this3=this;if(this.el_.duration===Infinity&&browser.IS_ANDROID&&browser.IS_CHROME){if(this.el_.currentTime===0){var checkProgress=function checkProgress(){if(_this3.el_.currentTime>0){if(_this3.el_.duration===Infinity){_this3.trigger("durationchange");}_this3.off("timeupdate",checkProgress);}};this.on("timeupdate",checkProgress);return NaN;}}return this.el_.duration||NaN;};Html5.prototype.width=function width(){return this.el_.offsetWidth;};Html5.prototype.height=function height(){return this.el_.offsetHeight;};Html5.prototype.proxyWebkitFullscreen_=function proxyWebkitFullscreen_(){var _this4=this;if(!("webkitDisplayingFullscreen"in this.el_)){return;}var endFn=function endFn(){this.trigger("fullscreenchange",{isFullscreen:false});};var beginFn=function beginFn(){this.one("webkitendfullscreen",endFn);this.trigger("fullscreenchange",{isFullscreen:true});};this.on("webkitbeginfullscreen",beginFn);this.on("dispose",function(){_this4.off("webkitbeginfullscreen",beginFn);_this4.off("webkitendfullscreen",endFn);});};Html5.prototype.supportsFullScreen=function supportsFullScreen(){if(typeof this.el_.webkitEnterFullScreen==="function"){var userAgent=_window2["default"].navigator&&_window2["default"].navigator.userAgent||"";if(/Android/.test(userAgent)||!/Chrome|Mac OS X 10.5/.test(userAgent)){return true;}}return false;};Html5.prototype.enterFullScreen=function enterFullScreen(){var video=this.el_;if(video.paused&&video.networkState<=video.HAVE_METADATA){this.el_.play();this.setTimeout(function(){video.pause();video.webkitEnterFullScreen();},0);}else{video.webkitEnterFullScreen();}};Html5.prototype.exitFullScreen=function exitFullScreen(){this.el_.webkitExitFullScreen();};Html5.prototype.src=function src(_src){if(_src===undefined){return this.el_.src;}this.setSrc(_src);};Html5.prototype.reset=function reset(){Html5.resetMediaElement(this.el_);};Html5.prototype.currentSrc=function currentSrc(){if(this.currentSource_){return this.currentSource_.src;}return this.el_.currentSrc;};Html5.prototype.setControls=function setControls(val){this.el_.controls=!!val;};Html5.prototype.addTextTrack=function addTextTrack(kind,label,language){if(!this.featuresNativeTextTracks){return _Tech.prototype.addTextTrack.call(this,kind,label,language);}return this.el_.addTextTrack(kind,label,language);};Html5.prototype.createRemoteTextTrack=function createRemoteTextTrack(options){if(!this.featuresNativeTextTracks){return _Tech.prototype.createRemoteTextTrack.call(this,options);}var htmlTrackElement=_document2["default"].createElement("track");if(options.kind){htmlTrackElement.kind=options.kind;}if(options.label){htmlTrackElement.label=options.label;}if(options.language||options.srclang){htmlTrackElement.srclang=options.language||options.srclang;}if(options["default"]){htmlTrackElement["default"]=options["default"];}if(options.id){htmlTrackElement.id=options.id;}if(options.src){htmlTrackElement.src=options.src;}return htmlTrackElement;};Html5.prototype.addRemoteTextTrack=function addRemoteTextTrack(options,manualCleanup){var htmlTrackElement=_Tech.prototype.addRemoteTextTrack.call(this,options,manualCleanup);if(this.featuresNativeTextTracks){this.el().appendChild(htmlTrackElement);}return htmlTrackElement;};Html5.prototype.removeRemoteTextTrack=function removeRemoteTextTrack(track){_Tech.prototype.removeRemoteTextTrack.call(this,track);if(this.featuresNativeTextTracks){var tracks=this.$$("track");var i=tracks.length;while(i--){if(track===tracks[i]||track===tracks[i].track){this.el().removeChild(tracks[i]);}}}};return Html5;}(_tech2["default"]);if(Dom.isReal()){Html5.TEST_VID=_document2["default"].createElement("video");var track=_document2["default"].createElement("track");track.kind="captions";track.srclang="en";track.label="English";Html5.TEST_VID.appendChild(track);}Html5.isSupported=function(){try{Html5.TEST_VID.volume=.5;}catch(e){return false;}return!!(Html5.TEST_VID&&Html5.TEST_VID.canPlayType);};Html5.canControlVolume=function(){try{var volume=Html5.TEST_VID.volume;Html5.TEST_VID.volume=volume/2+.1;return volume!==Html5.TEST_VID.volume;}catch(e){return false;}};Html5.canControlPlaybackRate=function(){if(browser.IS_ANDROID&&browser.IS_CHROME){return false;}try{var playbackRate=Html5.TEST_VID.playbackRate;Html5.TEST_VID.playbackRate=playbackRate/2+.1;return playbackRate!==Html5.TEST_VID.playbackRate;}catch(e){return false;}};Html5.supportsNativeTextTracks=function(){return browser.IS_ANY_SAFARI;};Html5.supportsNativeVideoTracks=function(){return!!(Html5.TEST_VID&&Html5.TEST_VID.videoTracks);};Html5.supportsNativeAudioTracks=function(){return!!(Html5.TEST_VID&&Html5.TEST_VID.audioTracks);};Html5.Events=["loadstart","suspend","abort","error","emptied","stalled","loadedmetadata","loadeddata","canplay","canplaythrough","playing","waiting","seeking","seeked","ended","durationchange","timeupdate","progress","play","pause","ratechange","volumechange"];Html5.prototype.featuresVolumeControl=Html5.canControlVolume();Html5.prototype.featuresPlaybackRate=Html5.canControlPlaybackRate();Html5.prototype.movingMediaElementInDOM=!browser.IS_IOS;Html5.prototype.featuresFullscreenResize=true;Html5.prototype.featuresProgressEvents=true;Html5.prototype.featuresTimeupdateEvents=true;Html5.prototype.featuresNativeTextTracks=Html5.supportsNativeTextTracks();Html5.prototype.featuresNativeVideoTracks=Html5.supportsNativeVideoTracks();Html5.prototype.featuresNativeAudioTracks=Html5.supportsNativeAudioTracks();var canPlayType=Html5.TEST_VID&&Html5.TEST_VID.constructor.prototype.canPlayType;var mpegurlRE=/^application\/(?:x-|vnd\.apple\.)mpegurl/i;var mp4RE=/^video\/mp4/i;Html5.patchCanPlayType=function(){if(browser.ANDROID_VERSION>=4&&!browser.IS_FIREFOX){Html5.TEST_VID.constructor.prototype.canPlayType=function(type){if(type&&mpegurlRE.test(type)){return"maybe";}return canPlayType.call(this,type);};}else if(browser.IS_OLD_ANDROID){Html5.TEST_VID.constructor.prototype.canPlayType=function(type){if(type&&mp4RE.test(type)){return"maybe";}return canPlayType.call(this,type);};}};Html5.unpatchCanPlayType=function(){var r=Html5.TEST_VID.constructor.prototype.canPlayType;Html5.TEST_VID.constructor.prototype.canPlayType=canPlayType;return r;};Html5.patchCanPlayType();Html5.disposeMediaElement=function(el){if(!el){return;}if(el.parentNode){el.parentNode.removeChild(el);}while(el.hasChildNodes()){el.removeChild(el.firstChild);}el.removeAttribute("src");if(typeof el.load==="function"){(function(){try{el.load();}catch(e){}})();}};Html5.resetMediaElement=function(el){if(!el){return;}var sources=el.querySelectorAll("source");var i=sources.length;while(i--){el.removeChild(sources[i]);}el.removeAttribute("src");if(typeof el.load==="function"){(function(){try{el.load();}catch(e){}})();}};["paused","currentTime","buffered","volume","muted","poster","preload","autoplay","controls","loop","error","seeking","seekable","ended","defaultMuted","playbackRate","played","networkState","readyState","videoWidth","videoHeight"].forEach(function(prop){Html5.prototype[prop]=function(){return this.el_[prop];};});["volume","muted","src","poster","preload","autoplay","loop","playbackRate"].forEach(function(prop){Html5.prototype["set"+(0,_toTitleCase2["default"])(prop)]=function(v){this.el_[prop]=v;};});["pause","load"].forEach(function(prop){Html5.prototype[prop]=function(){return this.el_[prop]();};});_tech2["default"].withSourceHandlers(Html5);Html5.nativeSourceHandler={};Html5.nativeSourceHandler.canPlayType=function(type){try{return Html5.TEST_VID.canPlayType(type);}catch(e){return"";}};Html5.nativeSourceHandler.canHandleSource=function(source,options){if(source.type){return Html5.nativeSourceHandler.canPlayType(source.type);}else if(source.src){var ext=Url.getFileExtension(source.src);return Html5.nativeSourceHandler.canPlayType("video/"+ext);}return"";};Html5.nativeSourceHandler.handleSource=function(source,tech,options){tech.setSrc(source.src);};Html5.nativeSourceHandler.dispose=function(){};Html5.registerSourceHandler(Html5.nativeSourceHandler);_component2["default"].registerComponent("Html5",Html5);_tech2["default"].registerTech("Html5",Html5);exports["default"]=Html5;},{"../component":244,"../utils/browser.js":317,"../utils/dom.js":320,"../utils/fn.js":322,"../utils/log.js":325,"../utils/merge-options.js":326,"../utils/obj":327,"../utils/to-title-case.js":330,"../utils/url.js":331,"./tech.js":301,"global/document":89,"global/window":90,tsml:231}],300:[function(require,module,exports){"use strict";exports.__esModule=true;var _component=require("../component.js");var _component2=_interopRequireDefault(_component);var _tech=require("./tech.js");var _tech2=_interopRequireDefault(_tech);var _toTitleCase=require("../utils/to-title-case.js");var _toTitleCase2=_interopRequireDefault(_toTitleCase);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&((typeof call==="undefined"?"undefined":_typeof2(call))==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var MediaLoader=function(_Component){_inherits(MediaLoader,_Component);function MediaLoader(player,options,ready){_classCallCheck(this,MediaLoader);var _this=_possibleConstructorReturn(this,_Component.call(this,player,options,ready));if(!options.playerOptions.sources||options.playerOptions.sources.length===0){for(var i=0,j=options.playerOptions.techOrder;i<j.length;i++){var techName=(0,_toTitleCase2["default"])(j[i]);var tech=_tech2["default"].getTech(techName);if(!techName){tech=_component2["default"].getComponent(techName);}if(tech&&tech.isSupported()){player.loadTech_(techName);break;}}}else{player.src(options.playerOptions.sources);}return _this;}return MediaLoader;}(_component2["default"]);_component2["default"].registerComponent("MediaLoader",MediaLoader);exports["default"]=MediaLoader;},{"../component.js":244,"../utils/to-title-case.js":330,"./tech.js":301}],301:[function(require,module,exports){"use strict";exports.__esModule=true;var _component=require("../component");var _component2=_interopRequireDefault(_component);var _htmlTrackElement=require("../tracks/html-track-element");var _htmlTrackElement2=_interopRequireDefault(_htmlTrackElement);var _htmlTrackElementList=require("../tracks/html-track-element-list");var _htmlTrackElementList2=_interopRequireDefault(_htmlTrackElementList);var _mergeOptions=require("../utils/merge-options.js");var _mergeOptions2=_interopRequireDefault(_mergeOptions);var _textTrack=require("../tracks/text-track");var _textTrack2=_interopRequireDefault(_textTrack);var _textTrackList=require("../tracks/text-track-list");var _textTrackList2=_interopRequireDefault(_textTrackList);var _videoTrackList=require("../tracks/video-track-list");var _videoTrackList2=_interopRequireDefault(_videoTrackList);var _audioTrackList=require("../tracks/audio-track-list");var _audioTrackList2=_interopRequireDefault(_audioTrackList);var _fn=require("../utils/fn.js");var Fn=_interopRequireWildcard(_fn);var _log=require("../utils/log.js");var _log2=_interopRequireDefault(_log);var _timeRanges=require("../utils/time-ranges.js");var _buffer=require("../utils/buffer.js");var _mediaError=require("../media-error.js");var _mediaError2=_interopRequireDefault(_mediaError);var _window=require("global/window");var _window2=_interopRequireDefault(_window);var _document=require("global/document");var _document2=_interopRequireDefault(_document);var _obj=require("../utils/obj");function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&((typeof call==="undefined"?"undefined":_typeof2(call))==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}function createTrackHelper(self,kind,label,language){var options=arguments.length>4&&arguments[4]!==undefined?arguments[4]:{};var tracks=self.textTracks();options.kind=kind;if(label){options.label=label;}if(language){options.language=language;}options.tech=self;var track=new _textTrack2["default"](options);tracks.addTrack_(track);return track;}var Tech=function(_Component){_inherits(Tech,_Component);function Tech(){var options=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var ready=arguments.length>1&&arguments[1]!==undefined?arguments[1]:function(){};_classCallCheck(this,Tech);options.reportTouchActivity=false;var _this=_possibleConstructorReturn(this,_Component.call(this,null,options,ready));_this.hasStarted_=false;_this.on("playing",function(){this.hasStarted_=true;});_this.on("loadstart",function(){this.hasStarted_=false;});_this.textTracks_=options.textTracks;_this.videoTracks_=options.videoTracks;_this.audioTracks_=options.audioTracks;if(!_this.featuresProgressEvents){_this.manualProgressOn();}if(!_this.featuresTimeupdateEvents){_this.manualTimeUpdatesOn();}["Text","Audio","Video"].forEach(function(track){if(options["native"+track+"Tracks"]===false){_this["featuresNative"+track+"Tracks"]=false;}});if(options.nativeCaptions===false){_this.featuresNativeTextTracks=false;}if(!_this.featuresNativeTextTracks){_this.emulateTextTracks();}_this.autoRemoteTextTracks_=new _textTrackList2["default"]();_this.initTextTrackListeners();_this.initTrackListeners();if(!options.nativeControlsForTouch){_this.emitTapEvents();}if(_this.constructor){_this.name_=_this.constructor.name||"Unknown Tech";}return _this;}Tech.prototype.manualProgressOn=function manualProgressOn(){this.on("durationchange",this.onDurationChange);this.manualProgress=true;this.one("ready",this.trackProgress);};Tech.prototype.manualProgressOff=function manualProgressOff(){this.manualProgress=false;this.stopTrackingProgress();this.off("durationchange",this.onDurationChange);};Tech.prototype.trackProgress=function trackProgress(event){this.stopTrackingProgress();this.progressInterval=this.setInterval(Fn.bind(this,function(){var numBufferedPercent=this.bufferedPercent();if(this.bufferedPercent_!==numBufferedPercent){this.trigger("progress");}this.bufferedPercent_=numBufferedPercent;if(numBufferedPercent===1){this.stopTrackingProgress();}}),500);};Tech.prototype.onDurationChange=function onDurationChange(event){this.duration_=this.duration();};Tech.prototype.buffered=function buffered(){return(0,_timeRanges.createTimeRange)(0,0);};Tech.prototype.bufferedPercent=function bufferedPercent(){return(0,_buffer.bufferedPercent)(this.buffered(),this.duration_);};Tech.prototype.stopTrackingProgress=function stopTrackingProgress(){this.clearInterval(this.progressInterval);};Tech.prototype.manualTimeUpdatesOn=function manualTimeUpdatesOn(){this.manualTimeUpdates=true;this.on("play",this.trackCurrentTime);this.on("pause",this.stopTrackingCurrentTime);};Tech.prototype.manualTimeUpdatesOff=function manualTimeUpdatesOff(){this.manualTimeUpdates=false;this.stopTrackingCurrentTime();this.off("play",this.trackCurrentTime);this.off("pause",this.stopTrackingCurrentTime);};Tech.prototype.trackCurrentTime=function trackCurrentTime(){if(this.currentTimeInterval){this.stopTrackingCurrentTime();}this.currentTimeInterval=this.setInterval(function(){this.trigger({type:"timeupdate",target:this,manuallyTriggered:true});},250);};Tech.prototype.stopTrackingCurrentTime=function stopTrackingCurrentTime(){this.clearInterval(this.currentTimeInterval);this.trigger({type:"timeupdate",target:this,manuallyTriggered:true});};Tech.prototype.dispose=function dispose(){this.clearTracks(["audio","video","text"]);if(this.manualProgress){this.manualProgressOff();}if(this.manualTimeUpdates){this.manualTimeUpdatesOff();}_Component.prototype.dispose.call(this);};Tech.prototype.clearTracks=function clearTracks(types){var _this2=this;types=[].concat(types);types.forEach(function(type){var list=_this2[type+"Tracks"]()||[];var i=list.length;while(i--){var track=list[i];if(type==="text"){_this2.removeRemoteTextTrack(track);}list.removeTrack_(track);}});};Tech.prototype.cleanupAutoTextTracks=function cleanupAutoTextTracks(){var list=this.autoRemoteTextTracks_||[];var i=list.length;while(i--){var track=list[i];this.removeRemoteTextTrack(track);}};Tech.prototype.reset=function reset(){};Tech.prototype.error=function error(err){if(err!==undefined){this.error_=new _mediaError2["default"](err);this.trigger("error");}return this.error_;};Tech.prototype.played=function played(){if(this.hasStarted_){return(0,_timeRanges.createTimeRange)(0,0);}return(0,_timeRanges.createTimeRange)();};Tech.prototype.setCurrentTime=function setCurrentTime(){if(this.manualTimeUpdates){this.trigger({type:"timeupdate",target:this,manuallyTriggered:true});}};Tech.prototype.initTextTrackListeners=function initTextTrackListeners(){var textTrackListChanges=Fn.bind(this,function(){this.trigger("texttrackchange");});var tracks=this.textTracks();if(!tracks){return;}tracks.addEventListener("removetrack",textTrackListChanges);tracks.addEventListener("addtrack",textTrackListChanges);this.on("dispose",Fn.bind(this,function(){tracks.removeEventListener("removetrack",textTrackListChanges);tracks.removeEventListener("addtrack",textTrackListChanges);}));};Tech.prototype.initTrackListeners=function initTrackListeners(){var _this3=this;var trackTypes=["video","audio"];trackTypes.forEach(function(type){var trackListChanges=function trackListChanges(){_this3.trigger(type+"trackchange");};var tracks=_this3[type+"Tracks"]();tracks.addEventListener("removetrack",trackListChanges);tracks.addEventListener("addtrack",trackListChanges);_this3.on("dispose",function(){tracks.removeEventListener("removetrack",trackListChanges);tracks.removeEventListener("addtrack",trackListChanges);});});};Tech.prototype.addWebVttScript_=function addWebVttScript_(){var _this4=this;if(_window2["default"].WebVTT){return;}if(_document2["default"].body.contains(this.el())){var vtt=require("videojs-vtt.js");if(!this.options_["vtt.js"]&&(0,_obj.isPlain)(vtt)&&Object.keys(vtt).length>0){this.trigger("vttjsloaded");return;}var script=_document2["default"].createElement("script");script.src=this.options_["vtt.js"]||"https://vjs.zencdn.net/vttjs/0.12.3/vtt.min.js";script.onload=function(){_this4.trigger("vttjsloaded");};script.onerror=function(){_this4.trigger("vttjserror");};this.on("dispose",function(){script.onload=null;script.onerror=null;});_window2["default"].WebVTT=true;this.el().parentNode.appendChild(script);}else{this.ready(this.addWebVttScript_);}};Tech.prototype.emulateTextTracks=function emulateTextTracks(){var _this5=this;var tracks=this.textTracks();if(!tracks){return;}var remoteTracks=this.remoteTextTracks();var handleAddTrack=function handleAddTrack(e){return tracks.addTrack_(e.track);};var handleRemoveTrack=function handleRemoveTrack(e){return tracks.removeTrack_(e.track);};remoteTracks.on("addtrack",handleAddTrack);remoteTracks.on("removetrack",handleRemoveTrack);this.addWebVttScript_();var updateDisplay=function updateDisplay(){return _this5.trigger("texttrackchange");};var textTracksChanges=function textTracksChanges(){updateDisplay();for(var i=0;i<tracks.length;i++){var track=tracks[i];track.removeEventListener("cuechange",updateDisplay);if(track.mode==="showing"){track.addEventListener("cuechange",updateDisplay);}}};textTracksChanges();tracks.addEventListener("change",textTracksChanges);tracks.addEventListener("addtrack",textTracksChanges);tracks.addEventListener("removetrack",textTracksChanges);this.on("dispose",function(){remoteTracks.off("addtrack",handleAddTrack);remoteTracks.off("removetrack",handleRemoveTrack);tracks.removeEventListener("change",textTracksChanges);tracks.removeEventListener("addtrack",textTracksChanges);tracks.removeEventListener("removetrack",textTracksChanges);for(var i=0;i<tracks.length;i++){var track=tracks[i];track.removeEventListener("cuechange",updateDisplay);}});};Tech.prototype.videoTracks=function videoTracks(){this.videoTracks_=this.videoTracks_||new _videoTrackList2["default"]();return this.videoTracks_;};Tech.prototype.audioTracks=function audioTracks(){this.audioTracks_=this.audioTracks_||new _audioTrackList2["default"]();return this.audioTracks_;};Tech.prototype.textTracks=function textTracks(){this.textTracks_=this.textTracks_||new _textTrackList2["default"]();return this.textTracks_;};Tech.prototype.remoteTextTracks=function remoteTextTracks(){this.remoteTextTracks_=this.remoteTextTracks_||new _textTrackList2["default"]();return this.remoteTextTracks_;};Tech.prototype.remoteTextTrackEls=function remoteTextTrackEls(){this.remoteTextTrackEls_=this.remoteTextTrackEls_||new _htmlTrackElementList2["default"]();return this.remoteTextTrackEls_;};Tech.prototype.addTextTrack=function addTextTrack(kind,label,language){if(!kind){throw new Error("TextTrack kind is required but was not provided");}return createTrackHelper(this,kind,label,language);};Tech.prototype.createRemoteTextTrack=function createRemoteTextTrack(options){var track=(0,_mergeOptions2["default"])(options,{tech:this});return new _htmlTrackElement2["default"](track);};Tech.prototype.addRemoteTextTrack=function addRemoteTextTrack(){var options=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var manualCleanup=arguments[1];var htmlTrackElement=this.createRemoteTextTrack(options);if(manualCleanup!==true&&manualCleanup!==false){_log2["default"].warn('Calling addRemoteTextTrack without explicitly setting the "manualCleanup" parameter to `true` is deprecated and default to `false` in future version of video.js');manualCleanup=true;}this.remoteTextTrackEls().addTrackElement_(htmlTrackElement);this.remoteTextTracks().addTrack_(htmlTrackElement.track);if(manualCleanup!==true){this.autoRemoteTextTracks_.addTrack_(htmlTrackElement.track);}return htmlTrackElement;};Tech.prototype.removeRemoteTextTrack=function removeRemoteTextTrack(track){var trackElement=this.remoteTextTrackEls().getTrackElementByTrack_(track);this.remoteTextTrackEls().removeTrackElement_(trackElement);this.remoteTextTracks().removeTrack_(track);this.autoRemoteTextTracks_.removeTrack_(track);};Tech.prototype.setPoster=function setPoster(){};Tech.prototype.canPlayType=function canPlayType(){return"";};Tech.isTech=function isTech(component){return component.prototype instanceof Tech||component instanceof Tech||component===Tech;};Tech.registerTech=function registerTech(name,tech){if(!Tech.techs_){Tech.techs_={};}if(!Tech.isTech(tech)){throw new Error("Tech "+name+" must be a Tech");}Tech.techs_[name]=tech;return tech;};Tech.getTech=function getTech(name){if(Tech.techs_&&Tech.techs_[name]){return Tech.techs_[name];}if(_window2["default"]&&_window2["default"].videojs&&_window2["default"].videojs[name]){_log2["default"].warn("The "+name+" tech was added to the videojs object when it should be registered using videojs.registerTech(name, tech)");return _window2["default"].videojs[name];}};return Tech;}(_component2["default"]);Tech.prototype.textTracks_;Tech.prototype.audioTracks_;Tech.prototype.videoTracks_;Tech.prototype.featuresVolumeControl=true;Tech.prototype.featuresFullscreenResize=false;Tech.prototype.featuresPlaybackRate=false;Tech.prototype.featuresProgressEvents=false;Tech.prototype.featuresTimeupdateEvents=false;Tech.prototype.featuresNativeTextTracks=false;Tech.withSourceHandlers=function(_Tech){_Tech.registerSourceHandler=function(handler,index){var handlers=_Tech.sourceHandlers;if(!handlers){handlers=_Tech.sourceHandlers=[];}if(index===undefined){index=handlers.length;}handlers.splice(index,0,handler);};_Tech.canPlayType=function(type){var handlers=_Tech.sourceHandlers||[];var can=void 0;for(var i=0;i<handlers.length;i++){can=handlers[i].canPlayType(type);if(can){return can;}}return"";};_Tech.selectSourceHandler=function(source,options){var handlers=_Tech.sourceHandlers||[];var can=void 0;for(var i=0;i<handlers.length;i++){can=handlers[i].canHandleSource(source,options);if(can){return handlers[i];}}return null;};_Tech.canPlaySource=function(srcObj,options){var sh=_Tech.selectSourceHandler(srcObj,options);if(sh){return sh.canHandleSource(srcObj,options);}return"";};var deferrable=["seekable","duration"];deferrable.forEach(function(fnName){var originalFn=this[fnName];if(typeof originalFn!=="function"){return;}this[fnName]=function(){if(this.sourceHandler_&&this.sourceHandler_[fnName]){return this.sourceHandler_[fnName].apply(this.sourceHandler_,arguments);}return originalFn.apply(this,arguments);};},_Tech.prototype);_Tech.prototype.setSource=function(source){var sh=_Tech.selectSourceHandler(source,this.options_);if(!sh){if(_Tech.nativeSourceHandler){sh=_Tech.nativeSourceHandler;}else{_log2["default"].error("No source hander found for the current source.");}}this.disposeSourceHandler();this.off("dispose",this.disposeSourceHandler);if(sh!==_Tech.nativeSourceHandler){this.currentSource_=source;this.off(this.el_,"loadstart",_Tech.prototype.firstLoadStartListener_);this.off(this.el_,"loadstart",_Tech.prototype.successiveLoadStartListener_);this.one(this.el_,"loadstart",_Tech.prototype.firstLoadStartListener_);}this.sourceHandler_=sh.handleSource(source,this,this.options_);this.on("dispose",this.disposeSourceHandler);return this;};_Tech.prototype.firstLoadStartListener_=function(){this.one(this.el_,"loadstart",_Tech.prototype.successiveLoadStartListener_);};_Tech.prototype.successiveLoadStartListener_=function(){this.disposeSourceHandler();this.one(this.el_,"loadstart",_Tech.prototype.successiveLoadStartListener_);};_Tech.prototype.disposeSourceHandler=function(){if(this.currentSource_){this.clearTracks(["audio","video"]);this.currentSource_=null;}this.cleanupAutoTextTracks();if(this.sourceHandler_){this.off(this.el_,"loadstart",_Tech.prototype.firstLoadStartListener_);this.off(this.el_,"loadstart",_Tech.prototype.successiveLoadStartListener_);if(this.sourceHandler_.dispose){this.sourceHandler_.dispose();}this.sourceHandler_=null;}};};_component2["default"].registerComponent("Tech",Tech);_component2["default"].registerComponent("MediaTechController",Tech);Tech.registerTech("Tech",Tech);exports["default"]=Tech;},{"../component":244,"../media-error.js":285,"../tracks/audio-track-list":302,"../tracks/html-track-element":305,"../tracks/html-track-element-list":304,"../tracks/text-track":311,"../tracks/text-track-list":309,"../tracks/video-track-list":315,"../utils/buffer.js":318,"../utils/fn.js":322,"../utils/log.js":325,"../utils/merge-options.js":326,"../utils/obj":327,"../utils/time-ranges.js":329,"global/document":89,"global/window":90,"videojs-vtt.js":343}],302:[function(require,module,exports){"use strict";exports.__esModule=true;var _trackList=require("./track-list");var _trackList2=_interopRequireDefault(_trackList);var _browser=require("../utils/browser.js");var browser=_interopRequireWildcard(_browser);var _document=require("global/document");var _document2=_interopRequireDefault(_document);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&((typeof call==="undefined"?"undefined":_typeof2(call))==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var disableOthers=function disableOthers(list,track){for(var i=0;i<list.length;i++){if(track.id===list[i].id){continue;}list[i].enabled=false;}};var AudioTrackList=function(_TrackList){_inherits(AudioTrackList,_TrackList);function AudioTrackList(){var _this,_ret;var tracks=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];_classCallCheck(this,AudioTrackList);var list=void 0;for(var i=tracks.length-1;i>=0;i--){if(tracks[i].enabled){disableOthers(tracks,tracks[i]);break;}}if(browser.IS_IE8){list=_document2["default"].createElement("custom");for(var prop in _trackList2["default"].prototype){if(prop!=="constructor"){list[prop]=_trackList2["default"].prototype[prop];}}for(var _prop in AudioTrackList.prototype){if(_prop!=="constructor"){list[_prop]=AudioTrackList.prototype[_prop];}}}list=(_this=_possibleConstructorReturn(this,_TrackList.call(this,tracks,list)),_this);list.changing_=false;return _ret=list,_possibleConstructorReturn(_this,_ret);}AudioTrackList.prototype.addTrack_=function addTrack_(track){var _this2=this;if(track.enabled){disableOthers(this,track);}_TrackList.prototype.addTrack_.call(this,track);if(!track.addEventListener){return;}track.addEventListener("enabledchange",function(){if(_this2.changing_){return;}_this2.changing_=true;disableOthers(_this2,track);_this2.changing_=false;_this2.trigger("change");});};AudioTrackList.prototype.addTrack=function addTrack(track){this.addTrack_(track);};AudioTrackList.prototype.removeTrack=function removeTrack(track){_TrackList.prototype.removeTrack_.call(this,track);};return AudioTrackList;}(_trackList2["default"]);exports["default"]=AudioTrackList;},{"../utils/browser.js":317,"./track-list":313,"global/document":89}],303:[function(require,module,exports){"use strict";exports.__esModule=true;var _trackEnums=require("./track-enums");var _track=require("./track");var _track2=_interopRequireDefault(_track);var _mergeOptions=require("../utils/merge-options");var _mergeOptions2=_interopRequireDefault(_mergeOptions);var _browser=require("../utils/browser.js");var browser=_interopRequireWildcard(_browser);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&((typeof call==="undefined"?"undefined":_typeof2(call))==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var AudioTrack=function(_Track){_inherits(AudioTrack,_Track);function AudioTrack(){var _this,_ret;var options=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,AudioTrack);var settings=(0,_mergeOptions2["default"])(options,{kind:_trackEnums.AudioTrackKind[options.kind]||""});var track=(_this=_possibleConstructorReturn(this,_Track.call(this,settings)),_this);var enabled=false;if(browser.IS_IE8){for(var prop in AudioTrack.prototype){if(prop!=="constructor"){track[prop]=AudioTrack.prototype[prop];}}}Object.defineProperty(track,"enabled",{get:function get(){return enabled;},set:function set(newEnabled){if(typeof newEnabled!=="boolean"||newEnabled===enabled){return;}enabled=newEnabled;this.trigger("enabledchange");}});if(settings.enabled){track.enabled=settings.enabled;}track.loaded_=true;return _ret=track,_possibleConstructorReturn(_this,_ret);}return AudioTrack;}(_track2["default"]);exports["default"]=AudioTrack;},{"../utils/browser.js":317,"../utils/merge-options":326,"./track":314,"./track-enums":312}],304:[function(require,module,exports){"use strict";exports.__esModule=true;var _browser=require("../utils/browser.js");var browser=_interopRequireWildcard(_browser);var _document=require("global/document");var _document2=_interopRequireDefault(_document);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}var HtmlTrackElementList=function(){function HtmlTrackElementList(){var trackElements=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];_classCallCheck(this,HtmlTrackElementList);var list=this;if(browser.IS_IE8){list=_document2["default"].createElement("custom");for(var prop in HtmlTrackElementList.prototype){if(prop!=="constructor"){list[prop]=HtmlTrackElementList.prototype[prop];}}}list.trackElements_=[];Object.defineProperty(list,"length",{get:function get(){return this.trackElements_.length;}});for(var i=0,length=trackElements.length;i<length;i++){list.addTrackElement_(trackElements[i]);}if(browser.IS_IE8){return list;}}HtmlTrackElementList.prototype.addTrackElement_=function addTrackElement_(trackElement){var index=this.trackElements_.length;if(!(""+index in this)){Object.defineProperty(this,index,{get:function get(){return this.trackElements_[index];}});}if(this.trackElements_.indexOf(trackElement)===-1){this.trackElements_.push(trackElement);}};HtmlTrackElementList.prototype.getTrackElementByTrack_=function getTrackElementByTrack_(track){var trackElement_=void 0;for(var i=0,length=this.trackElements_.length;i<length;i++){if(track===this.trackElements_[i].track){trackElement_=this.trackElements_[i];break;}}return trackElement_;};HtmlTrackElementList.prototype.removeTrackElement_=function removeTrackElement_(trackElement){for(var i=0,length=this.trackElements_.length;i<length;i++){if(trackElement===this.trackElements_[i]){this.trackElements_.splice(i,1);break;}}};return HtmlTrackElementList;}();exports["default"]=HtmlTrackElementList;},{"../utils/browser.js":317,"global/document":89}],305:[function(require,module,exports){"use strict";exports.__esModule=true;var _browser=require("../utils/browser.js");var browser=_interopRequireWildcard(_browser);var _document=require("global/document");var _document2=_interopRequireDefault(_document);var _eventTarget=require("../event-target");var _eventTarget2=_interopRequireDefault(_eventTarget);var _textTrack=require("../tracks/text-track");var _textTrack2=_interopRequireDefault(_textTrack);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&((typeof call==="undefined"?"undefined":_typeof2(call))==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var NONE=0;var LOADING=1;var LOADED=2;var ERROR=3;var HTMLTrackElement=function(_EventTarget){_inherits(HTMLTrackElement,_EventTarget);function HTMLTrackElement(){var options=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,HTMLTrackElement);var _this=_possibleConstructorReturn(this,_EventTarget.call(this));var readyState=void 0;var trackElement=_this;if(browser.IS_IE8){trackElement=_document2["default"].createElement("custom");for(var prop in HTMLTrackElement.prototype){if(prop!=="constructor"){trackElement[prop]=HTMLTrackElement.prototype[prop];}}}var track=new _textTrack2["default"](options);trackElement.kind=track.kind;trackElement.src=track.src;trackElement.srclang=track.language;trackElement.label=track.label;trackElement["default"]=track["default"];Object.defineProperty(trackElement,"readyState",{get:function get(){return readyState;}});Object.defineProperty(trackElement,"track",{get:function get(){return track;}});readyState=NONE;track.addEventListener("loadeddata",function(){readyState=LOADED;trackElement.trigger({type:"load",target:trackElement});});if(browser.IS_IE8){var _ret;return _ret=trackElement,_possibleConstructorReturn(_this,_ret);}return _this;}return HTMLTrackElement;}(_eventTarget2["default"]);HTMLTrackElement.prototype.allowedEvents_={load:"load"};HTMLTrackElement.NONE=NONE;HTMLTrackElement.LOADING=LOADING;HTMLTrackElement.LOADED=LOADED;HTMLTrackElement.ERROR=ERROR;exports["default"]=HTMLTrackElement;},{"../event-target":281,"../tracks/text-track":311,"../utils/browser.js":317,"global/document":89}],306:[function(require,module,exports){"use strict";exports.__esModule=true;var _browser=require("../utils/browser.js");var browser=_interopRequireWildcard(_browser);var _document=require("global/document");var _document2=_interopRequireDefault(_document);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}var TextTrackCueList=function(){function TextTrackCueList(cues){_classCallCheck(this,TextTrackCueList);var list=this;if(browser.IS_IE8){list=_document2["default"].createElement("custom");for(var prop in TextTrackCueList.prototype){if(prop!=="constructor"){list[prop]=TextTrackCueList.prototype[prop];}}}TextTrackCueList.prototype.setCues_.call(list,cues);Object.defineProperty(list,"length",{get:function get(){return this.length_;}});if(browser.IS_IE8){return list;}}TextTrackCueList.prototype.setCues_=function setCues_(cues){var oldLength=this.length||0;var i=0;var l=cues.length;this.cues_=cues;this.length_=cues.length;var defineProp=function defineProp(index){if(!(""+index in this)){Object.defineProperty(this,""+index,{get:function get(){return this.cues_[index];}});}};if(oldLength<l){i=oldLength;for(;i<l;i++){defineProp.call(this,i);}}};TextTrackCueList.prototype.getCueById=function getCueById(id){var result=null;for(var i=0,l=this.length;i<l;i++){var cue=this[i];if(cue.id===id){result=cue;break;}}return result;};return TextTrackCueList;}();exports["default"]=TextTrackCueList;},{"../utils/browser.js":317,"global/document":89}],307:[function(require,module,exports){"use strict";exports.__esModule=true;var _component=require("../component");var _component2=_interopRequireDefault(_component);var _fn=require("../utils/fn.js");var Fn=_interopRequireWildcard(_fn);var _window=require("global/window");var _window2=_interopRequireDefault(_window);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&((typeof call==="undefined"?"undefined":_typeof2(call))==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var darkGray="#222";var lightGray="#ccc";var fontMap={monospace:"monospace",sansSerif:"sans-serif",serif:"serif",monospaceSansSerif:'"Andale Mono", "Lucida Console", monospace',monospaceSerif:'"Courier New", monospace',proportionalSansSerif:"sans-serif",proportionalSerif:"serif",casual:'"Comic Sans MS", Impact, fantasy',script:'"Monotype Corsiva", cursive',smallcaps:'"Andale Mono", "Lucida Console", monospace, sans-serif'};function constructColor(color,opacity){return"rgba("+parseInt(color[1]+color[1],16)+","+parseInt(color[2]+color[2],16)+","+parseInt(color[3]+color[3],16)+","+opacity+")";}function tryUpdateStyle(el,style,rule){try{el.style[style]=rule;}catch(e){return;}}var TextTrackDisplay=function(_Component){_inherits(TextTrackDisplay,_Component);function TextTrackDisplay(player,options,ready){_classCallCheck(this,TextTrackDisplay);var _this=_possibleConstructorReturn(this,_Component.call(this,player,options,ready));player.on("loadstart",Fn.bind(_this,_this.toggleDisplay));player.on("texttrackchange",Fn.bind(_this,_this.updateDisplay));player.ready(Fn.bind(_this,function(){if(player.tech_&&player.tech_.featuresNativeTextTracks){this.hide();return;}player.on("fullscreenchange",Fn.bind(this,this.updateDisplay));var tracks=this.options_.playerOptions.tracks||[];for(var i=0;i<tracks.length;i++){this.player_.addRemoteTextTrack(tracks[i],true);}var modes={captions:1,subtitles:1};var trackList=this.player_.textTracks();var firstDesc=void 0;var firstCaptions=void 0;if(trackList){for(var _i=0;_i<trackList.length;_i++){var track=trackList[_i];if(track["default"]){if(track.kind==="descriptions"&&!firstDesc){firstDesc=track;}else if(track.kind in modes&&!firstCaptions){firstCaptions=track;}}}if(firstCaptions){firstCaptions.mode="showing";}else if(firstDesc){firstDesc.mode="showing";}}}));return _this;}TextTrackDisplay.prototype.toggleDisplay=function toggleDisplay(){if(this.player_.tech_&&this.player_.tech_.featuresNativeTextTracks){this.hide();}else{this.show();}};TextTrackDisplay.prototype.createEl=function createEl(){return _Component.prototype.createEl.call(this,"div",{className:"vjs-text-track-display"},{"aria-live":"off","aria-atomic":"true"});};TextTrackDisplay.prototype.clearDisplay=function clearDisplay(){if(typeof _window2["default"].WebVTT==="function"){_window2["default"].WebVTT.processCues(_window2["default"],[],this.el_);}};TextTrackDisplay.prototype.updateDisplay=function updateDisplay(){var tracks=this.player_.textTracks();this.clearDisplay();if(!tracks){return;}var descriptionsTrack=null;var captionsSubtitlesTrack=null;var i=tracks.length;while(i--){var track=tracks[i];if(track.mode==="showing"){if(track.kind==="descriptions"){descriptionsTrack=track;}else{captionsSubtitlesTrack=track;}}}if(captionsSubtitlesTrack){if(this.getAttribute("aria-live")!=="off"){this.setAttribute("aria-live","off");}this.updateForTrack(captionsSubtitlesTrack);}else if(descriptionsTrack){if(this.getAttribute("aria-live")!=="assertive"){this.setAttribute("aria-live","assertive");}this.updateForTrack(descriptionsTrack);}};TextTrackDisplay.prototype.updateForTrack=function updateForTrack(track){if(typeof _window2["default"].WebVTT!=="function"||!track.activeCues){return;}var overrides=this.player_.textTrackSettings.getValues();var cues=[];for(var _i2=0;_i2<track.activeCues.length;_i2++){cues.push(track.activeCues[_i2]);}_window2["default"].WebVTT.processCues(_window2["default"],cues,this.el_);var i=cues.length;while(i--){var cue=cues[i];if(!cue){continue;}var cueDiv=cue.displayState;if(overrides.color){cueDiv.firstChild.style.color=overrides.color;}if(overrides.textOpacity){tryUpdateStyle(cueDiv.firstChild,"color",constructColor(overrides.color||"#fff",overrides.textOpacity));}if(overrides.backgroundColor){cueDiv.firstChild.style.backgroundColor=overrides.backgroundColor;}if(overrides.backgroundOpacity){tryUpdateStyle(cueDiv.firstChild,"backgroundColor",constructColor(overrides.backgroundColor||"#000",overrides.backgroundOpacity));}if(overrides.windowColor){if(overrides.windowOpacity){tryUpdateStyle(cueDiv,"backgroundColor",constructColor(overrides.windowColor,overrides.windowOpacity));}else{cueDiv.style.backgroundColor=overrides.windowColor;}}if(overrides.edgeStyle){if(overrides.edgeStyle==="dropshadow"){cueDiv.firstChild.style.textShadow="2px 2px 3px "+darkGray+", 2px 2px 4px "+darkGray+", 2px 2px 5px "+darkGray;}else if(overrides.edgeStyle==="raised"){cueDiv.firstChild.style.textShadow="1px 1px "+darkGray+", 2px 2px "+darkGray+", 3px 3px "+darkGray;}else if(overrides.edgeStyle==="depressed"){cueDiv.firstChild.style.textShadow="1px 1px "+lightGray+", 0 1px "+lightGray+", -1px -1px "+darkGray+", 0 -1px "+darkGray;}else if(overrides.edgeStyle==="uniform"){cueDiv.firstChild.style.textShadow="0 0 4px "+darkGray+", 0 0 4px "+darkGray+", 0 0 4px "+darkGray+", 0 0 4px "+darkGray;}}if(overrides.fontPercent&&overrides.fontPercent!==1){var fontSize=_window2["default"].parseFloat(cueDiv.style.fontSize);cueDiv.style.fontSize=fontSize*overrides.fontPercent+"px";cueDiv.style.height="auto";cueDiv.style.top="auto";cueDiv.style.bottom="2px";}if(overrides.fontFamily&&overrides.fontFamily!=="default"){if(overrides.fontFamily==="small-caps"){cueDiv.firstChild.style.fontVariant="small-caps";}else{cueDiv.firstChild.style.fontFamily=fontMap[overrides.fontFamily];}}}};return TextTrackDisplay;}(_component2["default"]);_component2["default"].registerComponent("TextTrackDisplay",TextTrackDisplay);exports["default"]=TextTrackDisplay;},{"../component":244,"../utils/fn.js":322,"global/window":90}],308:[function(require,module,exports){"use strict";exports.__esModule=true;var trackToJson_=function trackToJson_(track){var ret=["kind","label","language","id","inBandMetadataTrackDispatchType","mode","src"].reduce(function(acc,prop,i){if(track[prop]){acc[prop]=track[prop];}return acc;},{cues:track.cues&&Array.prototype.map.call(track.cues,function(cue){return{startTime:cue.startTime,endTime:cue.endTime,text:cue.text,id:cue.id};})});return ret;};var textTracksToJson=function textTracksToJson(tech){var trackEls=tech.$$("track");var trackObjs=Array.prototype.map.call(trackEls,function(t){return t.track;});var tracks=Array.prototype.map.call(trackEls,function(trackEl){var json=trackToJson_(trackEl.track);if(trackEl.src){json.src=trackEl.src;}return json;});return tracks.concat(Array.prototype.filter.call(tech.textTracks(),function(track){return trackObjs.indexOf(track)===-1;}).map(trackToJson_));};var jsonToTextTracks=function jsonToTextTracks(json,tech){json.forEach(function(track){var addedTrack=tech.addRemoteTextTrack(track).track;if(!track.src&&track.cues){track.cues.forEach(function(cue){return addedTrack.addCue(cue);});}});return tech.textTracks();};exports["default"]={textTracksToJson:textTracksToJson,jsonToTextTracks:jsonToTextTracks,trackToJson_:trackToJson_};},{}],309:[function(require,module,exports){"use strict";exports.__esModule=true;var _trackList=require("./track-list");var _trackList2=_interopRequireDefault(_trackList);var _fn=require("../utils/fn.js");var Fn=_interopRequireWildcard(_fn);var _browser=require("../utils/browser.js");var browser=_interopRequireWildcard(_browser);var _document=require("global/document");var _document2=_interopRequireDefault(_document);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&((typeof call==="undefined"?"undefined":_typeof2(call))==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var TextTrackList=function(_TrackList){_inherits(TextTrackList,_TrackList);function TextTrackList(){var _this,_ret;var tracks=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];_classCallCheck(this,TextTrackList);var list=void 0;if(browser.IS_IE8){list=_document2["default"].createElement("custom");for(var prop in _trackList2["default"].prototype){if(prop!=="constructor"){list[prop]=_trackList2["default"].prototype[prop];}}for(var _prop in TextTrackList.prototype){if(_prop!=="constructor"){list[_prop]=TextTrackList.prototype[_prop];}}}list=(_this=_possibleConstructorReturn(this,_TrackList.call(this,tracks,list)),_this);return _ret=list,_possibleConstructorReturn(_this,_ret);}TextTrackList.prototype.addTrack_=function addTrack_(track){_TrackList.prototype.addTrack_.call(this,track);track.addEventListener("modechange",Fn.bind(this,function(){this.trigger("change");}));};return TextTrackList;}(_trackList2["default"]);exports["default"]=TextTrackList;},{"../utils/browser.js":317,"../utils/fn.js":322,"./track-list":313,"global/document":89}],310:[function(require,module,exports){"use strict";exports.__esModule=true;var _window=require("global/window");var _window2=_interopRequireDefault(_window);var _component=require("../component");var _component2=_interopRequireDefault(_component);var _dom=require("../utils/dom");var _fn=require("../utils/fn");var Fn=_interopRequireWildcard(_fn);var _obj=require("../utils/obj");var Obj=_interopRequireWildcard(_obj);var _log=require("../utils/log");var _log2=_interopRequireDefault(_log);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&((typeof call==="undefined"?"undefined":_typeof2(call))==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var LOCAL_STORAGE_KEY="vjs-text-track-settings";var COLOR_BLACK=["#000","Black"];var COLOR_BLUE=["#00F","Blue"];var COLOR_CYAN=["#0FF","Cyan"];var COLOR_GREEN=["#0F0","Green"];var COLOR_MAGENTA=["#F0F","Magenta"];var COLOR_RED=["#F00","Red"];var COLOR_WHITE=["#FFF","White"];var COLOR_YELLOW=["#FF0","Yellow"];var OPACITY_OPAQUE=["1","Opaque"];var OPACITY_SEMI=["0.5","Semi-Transparent"];var OPACITY_TRANS=["0","Transparent"];var selectConfigs={backgroundColor:{selector:".vjs-bg-color > select",id:"captions-background-color-%s",label:"Color",options:[COLOR_BLACK,COLOR_WHITE,COLOR_RED,COLOR_GREEN,COLOR_BLUE,COLOR_YELLOW,COLOR_MAGENTA,COLOR_CYAN]},backgroundOpacity:{selector:".vjs-bg-opacity > select",id:"captions-background-opacity-%s",label:"Transparency",options:[OPACITY_OPAQUE,OPACITY_SEMI,OPACITY_TRANS]},color:{selector:".vjs-fg-color > select",id:"captions-foreground-color-%s",label:"Color",options:[COLOR_WHITE,COLOR_BLACK,COLOR_RED,COLOR_GREEN,COLOR_BLUE,COLOR_YELLOW,COLOR_MAGENTA,COLOR_CYAN]},edgeStyle:{selector:".vjs-edge-style > select",id:"%s",label:"Text Edge Style",options:[["none","None"],["raised","Raised"],["depressed","Depressed"],["uniform","Uniform"],["dropshadow","Dropshadow"]]},fontFamily:{selector:".vjs-font-family > select",id:"captions-font-family-%s",label:"Font Family",options:[["proportionalSansSerif","Proportional Sans-Serif"],["monospaceSansSerif","Monospace Sans-Serif"],["proportionalSerif","Proportional Serif"],["monospaceSerif","Monospace Serif"],["casual","Casual"],["script","Script"],["small-caps","Small Caps"]]},fontPercent:{selector:".vjs-font-percent > select",id:"captions-font-size-%s",label:"Font Size",options:[["0.50","50%"],["0.75","75%"],["1.00","100%"],["1.25","125%"],["1.50","150%"],["1.75","175%"],["2.00","200%"],["3.00","300%"],["4.00","400%"]],default:2,parser:function parser(v){return v==="1.00"?null:Number(v);}},textOpacity:{selector:".vjs-text-opacity > select",id:"captions-foreground-opacity-%s",label:"Transparency",options:[OPACITY_OPAQUE,OPACITY_SEMI]},windowColor:{selector:".vjs-window-color > select",id:"captions-window-color-%s",label:"Color"},windowOpacity:{selector:".vjs-window-opacity > select",id:"captions-window-opacity-%s",label:"Transparency",options:[OPACITY_TRANS,OPACITY_SEMI,OPACITY_OPAQUE]}};selectConfigs.windowColor.options=selectConfigs.backgroundColor.options;function parseOptionValue(value,parser){if(parser){value=parser(value);}if(value&&value!=="none"){return value;}}function getSelectedOptionValue(el,parser){var value=el.options[el.options.selectedIndex].value;return parseOptionValue(value,parser);}function setSelectedOption(el,value,parser){if(!value){return;}for(var i=0;i<el.options.length;i++){if(parseOptionValue(el.options[i].value,parser)===value){el.selectedIndex=i;break;}}}var TextTrackSettings=function(_Component){_inherits(TextTrackSettings,_Component);function TextTrackSettings(player,options){_classCallCheck(this,TextTrackSettings);var _this=_possibleConstructorReturn(this,_Component.call(this,player,options));_this.setDefaults();_this.hide();_this.updateDisplay=Fn.bind(_this,_this.updateDisplay);if(options.persistTextTrackSettings===undefined){_this.options_.persistTextTrackSettings=_this.options_.playerOptions.persistTextTrackSettings;}_this.on(_this.$(".vjs-done-button"),"click",function(){_this.saveSettings();_this.hide();});_this.on(_this.$(".vjs-default-button"),"click",function(){_this.setDefaults();_this.updateDisplay();});Obj.each(selectConfigs,function(config){_this.on(_this.$(config.selector),"change",_this.updateDisplay);});if(_this.options_.persistTextTrackSettings){_this.restoreSettings();}return _this;}TextTrackSettings.prototype.createElSelect_=function createElSelect_(key){var _this2=this;var config=selectConfigs[key];var id=config.id.replace("%s",this.id_);return[(0,_dom.createEl)("label",{className:"vjs-label",textContent:config.label},{for:id}),(0,_dom.createEl)("select",{id:id},undefined,config.options.map(function(o){return(0,_dom.createEl)("option",{textContent:_this2.localize(o[1]),value:o[0]});}))];};TextTrackSettings.prototype.createElFgColor_=function createElFgColor_(){var legend=(0,_dom.createEl)("legend",{textContent:this.localize("Text")});var select=this.createElSelect_("color");var opacity=(0,_dom.createEl)("span",{className:"vjs-text-opacity vjs-opacity"},undefined,this.createElSelect_("textOpacity"));return(0,_dom.createEl)("fieldset",{className:"vjs-fg-color vjs-tracksetting"},undefined,[legend].concat(select,opacity));};TextTrackSettings.prototype.createElBgColor_=function createElBgColor_(){var legend=(0,_dom.createEl)("legend",{textContent:this.localize("Background")});var select=this.createElSelect_("backgroundColor");var opacity=(0,_dom.createEl)("span",{className:"vjs-bg-opacity vjs-opacity"},undefined,this.createElSelect_("backgroundOpacity"));return(0,_dom.createEl)("fieldset",{className:"vjs-bg-color vjs-tracksetting"},undefined,[legend].concat(select,opacity));};TextTrackSettings.prototype.createElWinColor_=function createElWinColor_(){var legend=(0,_dom.createEl)("legend",{textContent:this.localize("Window")});var select=this.createElSelect_("windowColor");var opacity=(0,_dom.createEl)("span",{className:"vjs-window-opacity vjs-opacity"},undefined,this.createElSelect_("windowOpacity"));return(0,_dom.createEl)("fieldset",{className:"vjs-window-color vjs-tracksetting"},undefined,[legend].concat(select,opacity));};TextTrackSettings.prototype.createElColors_=function createElColors_(){return(0,_dom.createEl)("div",{className:"vjs-tracksettings-colors"},undefined,[this.createElFgColor_(),this.createElBgColor_(),this.createElWinColor_()]);};TextTrackSettings.prototype.createElFont_=function createElFont_(){var fontPercent=(0,_dom.createEl)("div",{className:"vjs-font-percent vjs-tracksetting"},undefined,this.createElSelect_("fontPercent"));var edgeStyle=(0,_dom.createEl)("div",{className:"vjs-edge-style vjs-tracksetting"},undefined,this.createElSelect_("edgeStyle"));var fontFamily=(0,_dom.createEl)("div",{className:"vjs-font-family vjs-tracksetting"},undefined,this.createElSelect_("fontFamily"));return(0,_dom.createEl)("div",{className:"vjs-tracksettings-font"},undefined,[fontPercent,edgeStyle,fontFamily]);};TextTrackSettings.prototype.createElControls_=function createElControls_(){var defaultsButton=(0,_dom.createEl)("button",{className:"vjs-default-button",textContent:this.localize("Defaults")});var doneButton=(0,_dom.createEl)("button",{className:"vjs-done-button",textContent:"Done"});return(0,_dom.createEl)("div",{className:"vjs-tracksettings-controls"},undefined,[defaultsButton,doneButton]);};TextTrackSettings.prototype.createEl=function createEl(){var settings=(0,_dom.createEl)("div",{className:"vjs-tracksettings"},undefined,[this.createElColors_(),this.createElFont_(),this.createElControls_()]);var heading=(0,_dom.createEl)("div",{className:"vjs-control-text",id:"TTsettingsDialogLabel-"+this.id_,textContent:"Caption Settings Dialog"},{"aria-level":"1",role:"heading"});var description=(0,_dom.createEl)("div",{className:"vjs-control-text",id:"TTsettingsDialogDescription-"+this.id_,textContent:"Beginning of dialog window. Escape will cancel and close the window."});var doc=(0,_dom.createEl)("div",undefined,{role:"document"},[heading,description,settings]);return(0,_dom.createEl)("div",{className:"vjs-caption-settings vjs-modal-overlay",tabIndex:-1},{role:"dialog","aria-labelledby":heading.id,"aria-describedby":description.id},doc);};TextTrackSettings.prototype.getValues=function getValues(){var _this3=this;return Obj.reduce(selectConfigs,function(accum,config,key){var value=getSelectedOptionValue(_this3.$(config.selector),config.parser);if(value!==undefined){accum[key]=value;}return accum;},{});};TextTrackSettings.prototype.setValues=function setValues(values){var _this4=this;Obj.each(selectConfigs,function(config,key){setSelectedOption(_this4.$(config.selector),values[key],config.parser);});};TextTrackSettings.prototype.setDefaults=function setDefaults(){var _this5=this;Obj.each(selectConfigs,function(config){var index=config.hasOwnProperty("default")?config["default"]:0;_this5.$(config.selector).selectedIndex=index;});};TextTrackSettings.prototype.restoreSettings=function restoreSettings(){var values=void 0;try{values=JSON.parse(_window2["default"].localStorage.getItem(LOCAL_STORAGE_KEY));}catch(err){_log2["default"].warn(err);}if(values){this.setValues(values);}};TextTrackSettings.prototype.saveSettings=function saveSettings(){if(!this.options_.persistTextTrackSettings){return;}var values=this.getValues();try{if(Object.keys(values).length){_window2["default"].localStorage.setItem(LOCAL_STORAGE_KEY,JSON.stringify(values));}else{_window2["default"].localStorage.removeItem(LOCAL_STORAGE_KEY);}}catch(err){_log2["default"].warn(err);}};TextTrackSettings.prototype.updateDisplay=function updateDisplay(){var ttDisplay=this.player_.getChild("textTrackDisplay");if(ttDisplay){ttDisplay.updateDisplay();}};return TextTrackSettings;}(_component2["default"]);_component2["default"].registerComponent("TextTrackSettings",TextTrackSettings);exports["default"]=TextTrackSettings;},{"../component":244,"../utils/dom":320,"../utils/fn":322,"../utils/log":325,"../utils/obj":327,"global/window":90}],311:[function(require,module,exports){"use strict";exports.__esModule=true;var _textTrackCueList=require("./text-track-cue-list");var _textTrackCueList2=_interopRequireDefault(_textTrackCueList);var _fn=require("../utils/fn.js");var Fn=_interopRequireWildcard(_fn);var _trackEnums=require("./track-enums");var _log=require("../utils/log.js");var _log2=_interopRequireDefault(_log);var _window=require("global/window");var _window2=_interopRequireDefault(_window);var _track=require("./track.js");var _track2=_interopRequireDefault(_track);var _url=require("../utils/url.js");var _xhr=require("xhr");var _xhr2=_interopRequireDefault(_xhr);var _mergeOptions=require("../utils/merge-options");var _mergeOptions2=_interopRequireDefault(_mergeOptions);var _browser=require("../utils/browser.js");var browser=_interopRequireWildcard(_browser);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&((typeof call==="undefined"?"undefined":_typeof2(call))==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var parseCues=function parseCues(srcContent,track){var parser=new _window2["default"].WebVTT.Parser(_window2["default"],_window2["default"].vttjs,_window2["default"].WebVTT.StringDecoder());var errors=[];parser.oncue=function(cue){track.addCue(cue);};parser.onparsingerror=function(error){errors.push(error);};parser.onflush=function(){track.trigger({type:"loadeddata",target:track});};parser.parse(srcContent);if(errors.length>0){if(_window2["default"].console&&_window2["default"].console.groupCollapsed){_window2["default"].console.groupCollapsed("Text Track parsing errors for "+track.src);}errors.forEach(function(error){return _log2["default"].error(error);});if(_window2["default"].console&&_window2["default"].console.groupEnd){_window2["default"].console.groupEnd();}}parser.flush();};var loadTrack=function loadTrack(src,track){var opts={uri:src};var crossOrigin=(0,_url.isCrossOrigin)(src);if(crossOrigin){opts.cors=crossOrigin;}(0,_xhr2["default"])(opts,Fn.bind(this,function(err,response,responseBody){if(err){return _log2["default"].error(err,response);}track.loaded_=true;if(typeof _window2["default"].WebVTT!=="function"){if(track.tech_){var loadHandler=function loadHandler(){return parseCues(responseBody,track);};track.tech_.on("vttjsloaded",loadHandler);track.tech_.on("vttjserror",function(){_log2["default"].error("vttjs failed to load, stopping trying to process "+track.src);track.tech_.off("vttjsloaded",loadHandler);});}}else{parseCues(responseBody,track);}}));};var TextTrack=function(_Track){_inherits(TextTrack,_Track);function TextTrack(){var _this,_ret;var options=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,TextTrack);if(!options.tech){throw new Error("A tech was not provided.");}var settings=(0,_mergeOptions2["default"])(options,{kind:_trackEnums.TextTrackKind[options.kind]||"subtitles",language:options.language||options.srclang||""});var mode=_trackEnums.TextTrackMode[settings.mode]||"disabled";var default_=settings["default"];if(settings.kind==="metadata"||settings.kind==="chapters"){mode="hidden";}var tt=(_this=_possibleConstructorReturn(this,_Track.call(this,settings)),_this);tt.tech_=settings.tech;if(browser.IS_IE8){for(var prop in TextTrack.prototype){if(prop!=="constructor"){tt[prop]=TextTrack.prototype[prop];}}}tt.cues_=[];tt.activeCues_=[];var cues=new _textTrackCueList2["default"](tt.cues_);var activeCues=new _textTrackCueList2["default"](tt.activeCues_);var changed=false;var timeupdateHandler=Fn.bind(tt,function(){this.activeCues;if(changed){this.trigger("cuechange");changed=false;}});if(mode!=="disabled"){tt.tech_.ready(function(){tt.tech_.on("timeupdate",timeupdateHandler);},true);}Object.defineProperty(tt,"default",{get:function get(){return default_;},set:function set(){}});Object.defineProperty(tt,"mode",{get:function get(){return mode;},set:function set(newMode){var _this2=this;if(!_trackEnums.TextTrackMode[newMode]){return;}mode=newMode;if(mode==="showing"){this.tech_.ready(function(){_this2.tech_.on("timeupdate",timeupdateHandler);},true);}this.trigger("modechange");}});Object.defineProperty(tt,"cues",{get:function get(){if(!this.loaded_){return null;}return cues;},set:function set(){}});Object.defineProperty(tt,"activeCues",{get:function get(){if(!this.loaded_){return null;}if(this.cues.length===0){return activeCues;}var ct=this.tech_.currentTime();var active=[];for(var i=0,l=this.cues.length;i<l;i++){var cue=this.cues[i];if(cue.startTime<=ct&&cue.endTime>=ct){active.push(cue);}else if(cue.startTime===cue.endTime&&cue.startTime<=ct&&cue.startTime+.5>=ct){active.push(cue);}}changed=false;if(active.length!==this.activeCues_.length){changed=true;}else{for(var _i=0;_i<active.length;_i++){if(this.activeCues_.indexOf(active[_i])===-1){changed=true;}}}this.activeCues_=active;activeCues.setCues_(this.activeCues_);return activeCues;},set:function set(){}});if(settings.src){tt.src=settings.src;loadTrack(settings.src,tt);}else{tt.loaded_=true;}return _ret=tt,_possibleConstructorReturn(_this,_ret);}TextTrack.prototype.addCue=function addCue(originalCue){var cue=originalCue;if(_window2["default"].vttjs&&!(originalCue instanceof _window2["default"].vttjs.VTTCue)){cue=new _window2["default"].vttjs.VTTCue(originalCue.startTime,originalCue.endTime,originalCue.text);for(var prop in originalCue){if(!(prop in cue)){cue[prop]=originalCue[prop];}}cue.id=originalCue.id;cue.originalCue_=originalCue;}var tracks=this.tech_.textTracks();if(tracks){for(var i=0;i<tracks.length;i++){if(tracks[i]!==this){tracks[i].removeCue(cue);}}}this.cues_.push(cue);this.cues.setCues_(this.cues_);};TextTrack.prototype.removeCue=function removeCue(_removeCue){var i=this.cues_.length;while(i--){var cue=this.cues_[i];if(cue===_removeCue||cue.originalCue_&&cue.originalCue_===_removeCue){this.cues_.splice(i,1);this.cues.setCues_(this.cues_);break;}}};return TextTrack;}(_track2["default"]);TextTrack.prototype.allowedEvents_={cuechange:"cuechange"};exports["default"]=TextTrack;},{"../utils/browser.js":317,"../utils/fn.js":322,"../utils/log.js":325,"../utils/merge-options":326,"../utils/url.js":331,"./text-track-cue-list":306,"./track-enums":312,"./track.js":314,"global/window":90,xhr:371}],312:[function(require,module,exports){"use strict";exports.__esModule=true;var VideoTrackKind=exports.VideoTrackKind={alternative:"alternative",captions:"captions",main:"main",sign:"sign",subtitles:"subtitles",commentary:"commentary"};var AudioTrackKind=exports.AudioTrackKind={alternative:"alternative",descriptions:"descriptions",main:"main","main-desc":"main-desc",translation:"translation",commentary:"commentary"};var TextTrackKind=exports.TextTrackKind={subtitles:"subtitles",captions:"captions",descriptions:"descriptions",chapters:"chapters",metadata:"metadata"};var TextTrackMode=exports.TextTrackMode={disabled:"disabled",hidden:"hidden",showing:"showing"};},{}],313:[function(require,module,exports){"use strict";exports.__esModule=true;var _eventTarget=require("../event-target");var _eventTarget2=_interopRequireDefault(_eventTarget);var _browser=require("../utils/browser.js");var browser=_interopRequireWildcard(_browser);var _document=require("global/document");var _document2=_interopRequireDefault(_document);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&((typeof call==="undefined"?"undefined":_typeof2(call))==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var TrackList=function(_EventTarget){_inherits(TrackList,_EventTarget);function TrackList(){var tracks=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];var _ret;var list=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;_classCallCheck(this,TrackList);var _this=_possibleConstructorReturn(this,_EventTarget.call(this));if(!list){list=_this;if(browser.IS_IE8){list=_document2["default"].createElement("custom");for(var prop in TrackList.prototype){if(prop!=="constructor"){list[prop]=TrackList.prototype[prop];}}}}list.tracks_=[];Object.defineProperty(list,"length",{get:function get(){return this.tracks_.length;}});for(var i=0;i<tracks.length;i++){list.addTrack_(tracks[i]);}return _ret=list,_possibleConstructorReturn(_this,_ret);}TrackList.prototype.addTrack_=function addTrack_(track){var index=this.tracks_.length;if(!(""+index in this)){Object.defineProperty(this,index,{get:function get(){return this.tracks_[index];}});}if(this.tracks_.indexOf(track)===-1){this.tracks_.push(track);this.trigger({track:track,type:"addtrack"});}};TrackList.prototype.removeTrack_=function removeTrack_(rtrack){var track=void 0;for(var i=0,l=this.length;i<l;i++){if(this[i]===rtrack){track=this[i];if(track.off){track.off();}this.tracks_.splice(i,1);break;}}if(!track){return;}this.trigger({track:track,type:"removetrack"});};TrackList.prototype.getTrackById=function getTrackById(id){var result=null;for(var i=0,l=this.length;i<l;i++){var track=this[i];if(track.id===id){result=track;break;}}return result;};return TrackList;}(_eventTarget2["default"]);TrackList.prototype.allowedEvents_={change:"change",addtrack:"addtrack",removetrack:"removetrack"};for(var event in TrackList.prototype.allowedEvents_){TrackList.prototype["on"+event]=null;}exports["default"]=TrackList;},{"../event-target":281,"../utils/browser.js":317,"global/document":89}],314:[function(require,module,exports){"use strict";exports.__esModule=true;var _browser=require("../utils/browser.js");var browser=_interopRequireWildcard(_browser);var _document=require("global/document");var _document2=_interopRequireDefault(_document);var _guid=require("../utils/guid.js");var Guid=_interopRequireWildcard(_guid);var _eventTarget=require("../event-target");var _eventTarget2=_interopRequireDefault(_eventTarget);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&((typeof call==="undefined"?"undefined":_typeof2(call))==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var Track=function(_EventTarget){_inherits(Track,_EventTarget);function Track(){var _ret;var options=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,Track);var _this=_possibleConstructorReturn(this,_EventTarget.call(this));var track=_this;if(browser.IS_IE8){track=_document2["default"].createElement("custom");for(var prop in Track.prototype){if(prop!=="constructor"){track[prop]=Track.prototype[prop];}}}var trackProps={id:options.id||"vjs_track_"+Guid.newGUID(),kind:options.kind||"",label:options.label||"",language:options.language||""};var _loop=function _loop(key){Object.defineProperty(track,key,{get:function get(){return trackProps[key];},set:function set(){}});};for(var key in trackProps){_loop(key);}return _ret=track,_possibleConstructorReturn(_this,_ret);}return Track;}(_eventTarget2["default"]);exports["default"]=Track;},{"../event-target":281,"../utils/browser.js":317,"../utils/guid.js":324,"global/document":89}],315:[function(require,module,exports){"use strict";exports.__esModule=true;var _trackList=require("./track-list");var _trackList2=_interopRequireDefault(_trackList);var _browser=require("../utils/browser.js");var browser=_interopRequireWildcard(_browser);var _document=require("global/document");var _document2=_interopRequireDefault(_document);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&((typeof call==="undefined"?"undefined":_typeof2(call))==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var disableOthers=function disableOthers(list,track){for(var i=0;i<list.length;i++){if(track.id===list[i].id){continue;}list[i].selected=false;}};var VideoTrackList=function(_TrackList){_inherits(VideoTrackList,_TrackList);function VideoTrackList(){var _this,_ret;var tracks=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];_classCallCheck(this,VideoTrackList);var list=void 0;for(var i=tracks.length-1;i>=0;i--){if(tracks[i].selected){disableOthers(tracks,tracks[i]);break;}}if(browser.IS_IE8){list=_document2["default"].createElement("custom");for(var prop in _trackList2["default"].prototype){if(prop!=="constructor"){list[prop]=_trackList2["default"].prototype[prop];}}for(var _prop in VideoTrackList.prototype){if(_prop!=="constructor"){list[_prop]=VideoTrackList.prototype[_prop];}}}list=(_this=_possibleConstructorReturn(this,_TrackList.call(this,tracks,list)),_this);list.changing_=false;Object.defineProperty(list,"selectedIndex",{get:function get(){for(var _i=0;_i<this.length;_i++){if(this[_i].selected){return _i;}}return-1;},set:function set(){}});return _ret=list,_possibleConstructorReturn(_this,_ret);}VideoTrackList.prototype.addTrack_=function addTrack_(track){var _this2=this;if(track.selected){disableOthers(this,track);}_TrackList.prototype.addTrack_.call(this,track);if(!track.addEventListener){return;}track.addEventListener("selectedchange",function(){if(_this2.changing_){return;}_this2.changing_=true;disableOthers(_this2,track);_this2.changing_=false;_this2.trigger("change");});};VideoTrackList.prototype.addTrack=function addTrack(track){this.addTrack_(track);};VideoTrackList.prototype.removeTrack=function removeTrack(track){_TrackList.prototype.removeTrack_.call(this,track);};return VideoTrackList;}(_trackList2["default"]);exports["default"]=VideoTrackList;},{"../utils/browser.js":317,"./track-list":313,"global/document":89}],316:[function(require,module,exports){"use strict";exports.__esModule=true;var _trackEnums=require("./track-enums");var _track=require("./track");var _track2=_interopRequireDefault(_track);var _mergeOptions=require("../utils/merge-options");var _mergeOptions2=_interopRequireDefault(_mergeOptions);var _browser=require("../utils/browser.js");var browser=_interopRequireWildcard(_browser);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&((typeof call==="undefined"?"undefined":_typeof2(call))==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var VideoTrack=function(_Track){_inherits(VideoTrack,_Track);function VideoTrack(){var _this,_ret;var options=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,VideoTrack);var settings=(0,_mergeOptions2["default"])(options,{kind:_trackEnums.VideoTrackKind[options.kind]||""});var track=(_this=_possibleConstructorReturn(this,_Track.call(this,settings)),_this);var selected=false;if(browser.IS_IE8){for(var prop in VideoTrack.prototype){if(prop!=="constructor"){track[prop]=VideoTrack.prototype[prop];}}}Object.defineProperty(track,"selected",{get:function get(){return selected;},set:function set(newSelected){if(typeof newSelected!=="boolean"||newSelected===selected){return;}selected=newSelected;this.trigger("selectedchange");}});if(settings.selected){track.selected=settings.selected;}return _ret=track,_possibleConstructorReturn(_this,_ret);}return VideoTrack;}(_track2["default"]);exports["default"]=VideoTrack;},{"../utils/browser.js":317,"../utils/merge-options":326,"./track":314,"./track-enums":312}],317:[function(require,module,exports){"use strict";exports.__esModule=true;exports.BACKGROUND_SIZE_SUPPORTED=exports.TOUCH_ENABLED=exports.IS_ANY_SAFARI=exports.IS_SAFARI=exports.IE_VERSION=exports.IS_IE8=exports.IS_CHROME=exports.IS_EDGE=exports.IS_FIREFOX=exports.IS_NATIVE_ANDROID=exports.IS_OLD_ANDROID=exports.ANDROID_VERSION=exports.IS_ANDROID=exports.IOS_VERSION=exports.IS_IOS=exports.IS_IPOD=exports.IS_IPHONE=exports.IS_IPAD=undefined;var _dom=require("./dom");var Dom=_interopRequireWildcard(_dom);var _window=require("global/window");var _window2=_interopRequireDefault(_window);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}var USER_AGENT=_window2["default"].navigator&&_window2["default"].navigator.userAgent||"";var webkitVersionMap=/AppleWebKit\/([\d.]+)/i.exec(USER_AGENT);var appleWebkitVersion=webkitVersionMap?parseFloat(webkitVersionMap.pop()):null;var IS_IPAD=exports.IS_IPAD=/iPad/i.test(USER_AGENT);var IS_IPHONE=exports.IS_IPHONE=/iPhone/i.test(USER_AGENT)&&!IS_IPAD;var IS_IPOD=exports.IS_IPOD=/iPod/i.test(USER_AGENT);var IS_IOS=exports.IS_IOS=IS_IPHONE||IS_IPAD||IS_IPOD;var IOS_VERSION=exports.IOS_VERSION=function(){var match=USER_AGENT.match(/OS (\d+)_/i);if(match&&match[1]){return match[1];}return null;}();var IS_ANDROID=exports.IS_ANDROID=/Android/i.test(USER_AGENT);var ANDROID_VERSION=exports.ANDROID_VERSION=function(){var match=USER_AGENT.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i);if(!match){return null;}var major=match[1]&&parseFloat(match[1]);var minor=match[2]&&parseFloat(match[2]);if(major&&minor){return parseFloat(match[1]+"."+match[2]);}else if(major){return major;}return null;}();var IS_OLD_ANDROID=exports.IS_OLD_ANDROID=IS_ANDROID&&/webkit/i.test(USER_AGENT)&&ANDROID_VERSION<2.3;var IS_NATIVE_ANDROID=exports.IS_NATIVE_ANDROID=IS_ANDROID&&ANDROID_VERSION<5&&appleWebkitVersion<537;var IS_FIREFOX=exports.IS_FIREFOX=/Firefox/i.test(USER_AGENT);var IS_EDGE=exports.IS_EDGE=/Edge/i.test(USER_AGENT);var IS_CHROME=exports.IS_CHROME=!IS_EDGE&&/Chrome/i.test(USER_AGENT);var IS_IE8=exports.IS_IE8=/MSIE\s8\.0/.test(USER_AGENT);var IE_VERSION=exports.IE_VERSION=function(){var result=/MSIE\s(\d+)\.\d/.exec(USER_AGENT);var version=result&&parseFloat(result[1]);if(!version&&/Trident\/7.0/i.test(USER_AGENT)&&/rv:11.0/.test(USER_AGENT)){version=11;}return version;}();var IS_SAFARI=exports.IS_SAFARI=/Safari/i.test(USER_AGENT)&&!IS_CHROME&&!IS_ANDROID&&!IS_EDGE;var IS_ANY_SAFARI=exports.IS_ANY_SAFARI=IS_SAFARI||IS_IOS;var TOUCH_ENABLED=exports.TOUCH_ENABLED=Dom.isReal()&&("ontouchstart"in _window2["default"]||_window2["default"].DocumentTouch&&_window2["default"].document instanceof _window2["default"].DocumentTouch);var BACKGROUND_SIZE_SUPPORTED=exports.BACKGROUND_SIZE_SUPPORTED=Dom.isReal()&&"backgroundSize"in _window2["default"].document.createElement("video").style;},{"./dom":320,"global/window":90}],318:[function(require,module,exports){"use strict";exports.__esModule=true;exports.bufferedPercent=bufferedPercent;var _timeRanges=require("./time-ranges.js");function bufferedPercent(buffered,duration){var bufferedDuration=0;var start=void 0;var end=void 0;if(!duration){return 0;}if(!buffered||!buffered.length){buffered=(0,_timeRanges.createTimeRange)(0,0);}for(var i=0;i<buffered.length;i++){start=buffered.start(i);end=buffered.end(i);if(end>duration){end=duration;}bufferedDuration+=end-start;}return bufferedDuration/duration;}},{"./time-ranges.js":329}],319:[function(require,module,exports){"use strict";exports.__esModule=true;exports["default"]=computedStyle;var _window=require("global/window");var _window2=_interopRequireDefault(_window);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function computedStyle(el,prop){if(!el||!prop){return"";}if(typeof _window2["default"].getComputedStyle==="function"){var cs=_window2["default"].getComputedStyle(el);return cs?cs[prop]:"";}return el.currentStyle[prop]||"";}},{"global/window":90}],320:[function(require,module,exports){"use strict";exports.__esModule=true;exports.$$=exports.$=undefined;var _templateObject=_taggedTemplateLiteralLoose(["Setting attributes in the second argument of createEl()\n                has been deprecated. Use the third argument instead.\n                createEl(type, properties, attributes). Attempting to set "," to ","."],["Setting attributes in the second argument of createEl()\n                has been deprecated. Use the third argument instead.\n                createEl(type, properties, attributes). Attempting to set "," to ","."]);exports.isReal=isReal;exports.isEl=isEl;exports.getEl=getEl;exports.createEl=createEl;exports.textContent=textContent;exports.insertElFirst=insertElFirst;exports.getElData=getElData;exports.hasElData=hasElData;exports.removeElData=removeElData;exports.hasElClass=hasElClass;exports.addElClass=addElClass;exports.removeElClass=removeElClass;exports.toggleElClass=toggleElClass;exports.setElAttributes=setElAttributes;exports.getElAttributes=getElAttributes;exports.getAttribute=getAttribute;exports.setAttribute=setAttribute;exports.removeAttribute=removeAttribute;exports.blockTextSelection=blockTextSelection;exports.unblockTextSelection=unblockTextSelection;exports.findElPosition=findElPosition;exports.getPointerPosition=getPointerPosition;exports.isTextNode=isTextNode;exports.emptyEl=emptyEl;exports.normalizeContent=normalizeContent;exports.appendContent=appendContent;exports.insertContent=insertContent;var _document=require("global/document");var _document2=_interopRequireDefault(_document);var _window=require("global/window");var _window2=_interopRequireDefault(_window);var _guid=require("./guid.js");var Guid=_interopRequireWildcard(_guid);var _log=require("./log.js");var _log2=_interopRequireDefault(_log);var _tsml=require("tsml");var _tsml2=_interopRequireDefault(_tsml);var _obj=require("./obj");function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _taggedTemplateLiteralLoose(strings,raw){strings.raw=raw;return strings;}function isNonBlankString(str){return typeof str==="string"&&/\S/.test(str);}function throwIfWhitespace(str){if(/\s/.test(str)){throw new Error("class has illegal whitespace characters");}}function classRegExp(className){return new RegExp("(^|\\s)"+className+"($|\\s)");}function isReal(){return _document2["default"]===_window2["default"].document&&typeof _document2["default"].createElement!=="undefined";}function isEl(value){return(0,_obj.isObject)(value)&&value.nodeType===1;}function createQuerier(method){return function(selector,context){if(!isNonBlankString(selector)){return _document2["default"][method](null);}if(isNonBlankString(context)){context=_document2["default"].querySelector(context);}var ctx=isEl(context)?context:_document2["default"];return ctx[method]&&ctx[method](selector);};}function getEl(id){if(id.indexOf("#")===0){id=id.slice(1);}return _document2["default"].getElementById(id);}function createEl(){var tagName=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"div";var properties=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var attributes=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var content=arguments[3];var el=_document2["default"].createElement(tagName);Object.getOwnPropertyNames(properties).forEach(function(propName){var val=properties[propName];if(propName.indexOf("aria-")!==-1||propName==="role"||propName==="type"){_log2["default"].warn((0,_tsml2["default"])(_templateObject,propName,val));el.setAttribute(propName,val);}else if(propName==="textContent"){textContent(el,val);}else{el[propName]=val;}});Object.getOwnPropertyNames(attributes).forEach(function(attrName){el.setAttribute(attrName,attributes[attrName]);});if(content){appendContent(el,content);}return el;}function textContent(el,text){if(typeof el.textContent==="undefined"){el.innerText=text;}else{el.textContent=text;}return el;}function insertElFirst(child,parent){if(parent.firstChild){parent.insertBefore(child,parent.firstChild);}else{parent.appendChild(child);}}var elData={};var elIdAttr="vdata"+new Date().getTime();function getElData(el){var id=el[elIdAttr];if(!id){id=el[elIdAttr]=Guid.newGUID();}if(!elData[id]){elData[id]={};}return elData[id];}function hasElData(el){var id=el[elIdAttr];if(!id){return false;}return!!Object.getOwnPropertyNames(elData[id]).length;}function removeElData(el){var id=el[elIdAttr];if(!id){return;}delete elData[id];try{delete el[elIdAttr];}catch(e){if(el.removeAttribute){el.removeAttribute(elIdAttr);}else{el[elIdAttr]=null;}}}function hasElClass(element,classToCheck){throwIfWhitespace(classToCheck);if(element.classList){return element.classList.contains(classToCheck);}return classRegExp(classToCheck).test(element.className);}function addElClass(element,classToAdd){if(element.classList){element.classList.add(classToAdd);}else if(!hasElClass(element,classToAdd)){element.className=(element.className+" "+classToAdd).trim();}return element;}function removeElClass(element,classToRemove){if(element.classList){element.classList.remove(classToRemove);}else{throwIfWhitespace(classToRemove);element.className=element.className.split(/\s+/).filter(function(c){return c!==classToRemove;}).join(" ");}return element;}function toggleElClass(element,classToToggle,predicate){var has=hasElClass(element,classToToggle);if(typeof predicate==="function"){predicate=predicate(element,classToToggle);}if(typeof predicate!=="boolean"){predicate=!has;}if(predicate===has){return;}if(predicate){addElClass(element,classToToggle);}else{removeElClass(element,classToToggle);}return element;}function setElAttributes(el,attributes){Object.getOwnPropertyNames(attributes).forEach(function(attrName){var attrValue=attributes[attrName];if(attrValue===null||typeof attrValue==="undefined"||attrValue===false){el.removeAttribute(attrName);}else{el.setAttribute(attrName,attrValue===true?"":attrValue);}});}function getElAttributes(tag){var obj={};var knownBooleans=","+"autoplay,controls,loop,muted,default"+",";if(tag&&tag.attributes&&tag.attributes.length>0){var attrs=tag.attributes;for(var i=attrs.length-1;i>=0;i--){var attrName=attrs[i].name;var attrVal=attrs[i].value;if(typeof tag[attrName]==="boolean"||knownBooleans.indexOf(","+attrName+",")!==-1){attrVal=attrVal!==null?true:false;}obj[attrName]=attrVal;}}return obj;}function getAttribute(el,attribute){return el.getAttribute(attribute);}function setAttribute(el,attribute,value){el.setAttribute(attribute,value);}function removeAttribute(el,attribute){el.removeAttribute(attribute);}function blockTextSelection(){_document2["default"].body.focus();_document2["default"].onselectstart=function(){return false;};}function unblockTextSelection(){_document2["default"].onselectstart=function(){return true;};}function findElPosition(el){var box=void 0;if(el.getBoundingClientRect&&el.parentNode){box=el.getBoundingClientRect();}if(!box){return{left:0,top:0};}var docEl=_document2["default"].documentElement;var body=_document2["default"].body;var clientLeft=docEl.clientLeft||body.clientLeft||0;var scrollLeft=_window2["default"].pageXOffset||body.scrollLeft;var left=box.left+scrollLeft-clientLeft;var clientTop=docEl.clientTop||body.clientTop||0;var scrollTop=_window2["default"].pageYOffset||body.scrollTop;var top=box.top+scrollTop-clientTop;return{left:Math.round(left),top:Math.round(top)};}function getPointerPosition(el,event){var position={};var box=findElPosition(el);var boxW=el.offsetWidth;var boxH=el.offsetHeight;var boxY=box.top;var boxX=box.left;var pageY=event.pageY;var pageX=event.pageX;if(event.changedTouches){pageX=event.changedTouches[0].pageX;pageY=event.changedTouches[0].pageY;}position.y=Math.max(0,Math.min(1,(boxY-pageY+boxH)/boxH));position.x=Math.max(0,Math.min(1,(pageX-boxX)/boxW));return position;}function isTextNode(value){return(0,_obj.isObject)(value)&&value.nodeType===3;}function emptyEl(el){while(el.firstChild){el.removeChild(el.firstChild);}return el;}function normalizeContent(content){if(typeof content==="function"){content=content();}return(Array.isArray(content)?content:[content]).map(function(value){if(typeof value==="function"){value=value();}if(isEl(value)||isTextNode(value)){return value;}if(typeof value==="string"&&/\S/.test(value)){return _document2["default"].createTextNode(value);}}).filter(function(value){return value;});}function appendContent(el,content){normalizeContent(content).forEach(function(node){return el.appendChild(node);});return el;}function insertContent(el,content){return appendContent(emptyEl(el),content);}var $=exports.$=createQuerier("querySelector");var $$=exports.$$=createQuerier("querySelectorAll");},{"./guid.js":324,"./log.js":325,"./obj":327,"global/document":89,"global/window":90,tsml:231}],321:[function(require,module,exports){"use strict";exports.__esModule=true;exports.fixEvent=fixEvent;exports.on=on;exports.off=off;exports.trigger=trigger;exports.one=one;var _dom=require("./dom.js");var Dom=_interopRequireWildcard(_dom);var _guid=require("./guid.js");var Guid=_interopRequireWildcard(_guid);var _log=require("./log.js");var _log2=_interopRequireDefault(_log);var _window=require("global/window");var _window2=_interopRequireDefault(_window);var _document=require("global/document");var _document2=_interopRequireDefault(_document);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}function _cleanUpEvents(elem,type){var data=Dom.getElData(elem);if(data.handlers[type].length===0){delete data.handlers[type];if(elem.removeEventListener){elem.removeEventListener(type,data.dispatcher,false);}else if(elem.detachEvent){elem.detachEvent("on"+type,data.dispatcher);}}if(Object.getOwnPropertyNames(data.handlers).length<=0){delete data.handlers;delete data.dispatcher;delete data.disabled;}if(Object.getOwnPropertyNames(data).length===0){Dom.removeElData(elem);}}function _handleMultipleEvents(fn,elem,types,callback){types.forEach(function(type){fn(elem,type,callback);});}function fixEvent(event){function returnTrue(){return true;}function returnFalse(){return false;}if(!event||!event.isPropagationStopped){var old=event||_window2["default"].event;event={};for(var key in old){if(key!=="layerX"&&key!=="layerY"&&key!=="keyLocation"&&key!=="webkitMovementX"&&key!=="webkitMovementY"){if(!(key==="returnValue"&&old.preventDefault)){event[key]=old[key];}}}if(!event.target){event.target=event.srcElement||_document2["default"];}if(!event.relatedTarget){event.relatedTarget=event.fromElement===event.target?event.toElement:event.fromElement;}event.preventDefault=function(){if(old.preventDefault){old.preventDefault();}event.returnValue=false;old.returnValue=false;event.defaultPrevented=true;};event.defaultPrevented=false;event.stopPropagation=function(){if(old.stopPropagation){old.stopPropagation();}event.cancelBubble=true;old.cancelBubble=true;event.isPropagationStopped=returnTrue;};event.isPropagationStopped=returnFalse;event.stopImmediatePropagation=function(){if(old.stopImmediatePropagation){old.stopImmediatePropagation();}event.isImmediatePropagationStopped=returnTrue;event.stopPropagation();};event.isImmediatePropagationStopped=returnFalse;if(event.clientX!==null&&event.clientX!==undefined){var doc=_document2["default"].documentElement;var body=_document2["default"].body;event.pageX=event.clientX+(doc&&doc.scrollLeft||body&&body.scrollLeft||0)-(doc&&doc.clientLeft||body&&body.clientLeft||0);event.pageY=event.clientY+(doc&&doc.scrollTop||body&&body.scrollTop||0)-(doc&&doc.clientTop||body&&body.clientTop||0);}event.which=event.charCode||event.keyCode;if(event.button!==null&&event.button!==undefined){event.button=event.button&1?0:event.button&4?1:event.button&2?2:0;}}return event;}function on(elem,type,fn){if(Array.isArray(type)){return _handleMultipleEvents(on,elem,type,fn);}var data=Dom.getElData(elem);if(!data.handlers){data.handlers={};}if(!data.handlers[type]){data.handlers[type]=[];}if(!fn.guid){fn.guid=Guid.newGUID();}data.handlers[type].push(fn);if(!data.dispatcher){data.disabled=false;data.dispatcher=function(event,hash){if(data.disabled){return;}event=fixEvent(event);var handlers=data.handlers[event.type];if(handlers){var handlersCopy=handlers.slice(0);for(var m=0,n=handlersCopy.length;m<n;m++){if(event.isImmediatePropagationStopped()){break;}else{try{handlersCopy[m].call(elem,event,hash);}catch(e){_log2["default"].error(e);}}}}};}if(data.handlers[type].length===1){if(elem.addEventListener){elem.addEventListener(type,data.dispatcher,false);}else if(elem.attachEvent){elem.attachEvent("on"+type,data.dispatcher);}}}function off(elem,type,fn){if(!Dom.hasElData(elem)){return;}var data=Dom.getElData(elem);if(!data.handlers){return;}if(Array.isArray(type)){return _handleMultipleEvents(off,elem,type,fn);}var removeType=function removeType(t){data.handlers[t]=[];_cleanUpEvents(elem,t);};if(!type){for(var t in data.handlers){removeType(t);}return;}var handlers=data.handlers[type];if(!handlers){return;}if(!fn){removeType(type);return;}if(fn.guid){for(var n=0;n<handlers.length;n++){if(handlers[n].guid===fn.guid){handlers.splice(n--,1);}}}_cleanUpEvents(elem,type);}function trigger(elem,event,hash){var elemData=Dom.hasElData(elem)?Dom.getElData(elem):{};var parent=elem.parentNode||elem.ownerDocument;if(typeof event==="string"){event={type:event,target:elem};}event=fixEvent(event);if(elemData.dispatcher){elemData.dispatcher.call(elem,event,hash);}if(parent&&!event.isPropagationStopped()&&event.bubbles===true){trigger.call(null,parent,event,hash);}else if(!parent&&!event.defaultPrevented){var targetData=Dom.getElData(event.target);if(event.target[event.type]){targetData.disabled=true;if(typeof event.target[event.type]==="function"){event.target[event.type]();}targetData.disabled=false;}}return!event.defaultPrevented;}function one(elem,type,fn){if(Array.isArray(type)){return _handleMultipleEvents(one,elem,type,fn);}var func=function func(){off(elem,type,func);fn.apply(this,arguments);};func.guid=fn.guid=fn.guid||Guid.newGUID();on(elem,type,func);}},{"./dom.js":320,"./guid.js":324,"./log.js":325,"global/document":89,"global/window":90}],322:[function(require,module,exports){"use strict";exports.__esModule=true;exports.throttle=exports.bind=undefined;var _guid=require("./guid.js");var bind=exports.bind=function bind(context,fn,uid){if(!fn.guid){fn.guid=(0,_guid.newGUID)();}var bound=function bound(){return fn.apply(context,arguments);};bound.guid=uid?uid+"_"+fn.guid:fn.guid;return bound;};var throttle=exports.throttle=function throttle(fn,wait){var last=Date.now();var throttled=function throttled(){var now=Date.now();if(now-last>=wait){fn.apply(undefined,arguments);last=now;}};return throttled;};},{"./guid.js":324}],323:[function(require,module,exports){"use strict";exports.__esModule=true;function formatTime(seconds){var guide=arguments.length>1&&arguments[1]!==undefined?arguments[1]:seconds;seconds=seconds<0?0:seconds;var s=Math.floor(seconds%60);var m=Math.floor(seconds/60%60);var h=Math.floor(seconds/3600);var gm=Math.floor(guide/60%60);var gh=Math.floor(guide/3600);if(isNaN(seconds)||seconds===Infinity){h=m=s="-";}h=h>0||gh>0?h+":":"";m=((h||gm>=10)&&m<10?"0"+m:m)+":";s=s<10?"0"+s:s;return h+m+s;}exports["default"]=formatTime;},{}],324:[function(require,module,exports){"use strict";exports.__esModule=true;exports.newGUID=newGUID;var _guid=1;function newGUID(){return _guid++;}},{}],325:[function(require,module,exports){"use strict";exports.__esModule=true;exports.logByType=undefined;var _window=require("global/window");var _window2=_interopRequireDefault(_window);var _browser=require("./browser");var _obj=require("./obj");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}var log=void 0;var logByType=exports.logByType=function logByType(type,args){var stringify=arguments.length>2&&arguments[2]!==undefined?arguments[2]:!!_browser.IE_VERSION&&_browser.IE_VERSION<11;if(type!=="log"){args.unshift(type.toUpperCase()+":");}log.history.push(args);args.unshift("VIDEOJS:");var fn=_window2["default"].console&&_window2["default"].console[type];if(!fn){return;}if(stringify){args=args.map(function(a){if((0,_obj.isObject)(a)||Array.isArray(a)){try{return JSON.stringify(a);}catch(x){return String(a);}}return String(a);}).join(" ");}if(!fn.apply){fn(args);}else{fn[Array.isArray(args)?"apply":"call"](_window2["default"].console,args);}};log=function log(){for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}logByType("log",args);};log.history=[];log.error=function(){for(var _len2=arguments.length,args=Array(_len2),_key2=0;_key2<_len2;_key2++){args[_key2]=arguments[_key2];}return logByType("error",args);};log.warn=function(){for(var _len3=arguments.length,args=Array(_len3),_key3=0;_key3<_len3;_key3++){args[_key3]=arguments[_key3];}return logByType("warn",args);};exports["default"]=log;},{"./browser":317,"./obj":327,"global/window":90}],326:[function(require,module,exports){"use strict";exports.__esModule=true;exports["default"]=mergeOptions;var _obj=require("./obj");function mergeOptions(){var result={};for(var _len=arguments.length,sources=Array(_len),_key=0;_key<_len;_key++){sources[_key]=arguments[_key];}sources.forEach(function(source){if(!source){return;}(0,_obj.each)(source,function(value,key){if(!(0,_obj.isPlain)(value)){result[key]=value;return;}if(!(0,_obj.isPlain)(result[key])){result[key]={};}result[key]=mergeOptions(result[key],value);});});return result;}},{"./obj":327}],327:[function(require,module,exports){"use strict";exports.__esModule=true;var _typeof=typeof Symbol==="function"&&_typeof2(Symbol.iterator)==="symbol"?function(obj){return typeof obj==="undefined"?"undefined":_typeof2(obj);}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj==="undefined"?"undefined":_typeof2(obj);};exports.each=each;exports.reduce=reduce;exports.assign=assign;exports.isObject=isObject;exports.isPlain=isPlain;var toString=Object.prototype.toString;var keys=function keys(object){return isObject(object)?Object.keys(object):[];};function each(object,fn){keys(object).forEach(function(key){return fn(object[key],key);});}function reduce(object,fn){var initial=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;return keys(object).reduce(function(accum,key){return fn(accum,object[key],key);},initial);}function assign(target){for(var _len=arguments.length,sources=Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){sources[_key-1]=arguments[_key];}if(Object.assign){return Object.assign.apply(Object,[target].concat(sources));}sources.forEach(function(source){if(!source){return;}each(source,function(value,key){target[key]=value;});});return target;}function isObject(value){return!!value&&(typeof value==="undefined"?"undefined":_typeof(value))==="object";}function isPlain(value){return isObject(value)&&toString.call(value)==="[object Object]"&&value.constructor===Object;}},{}],328:[function(require,module,exports){"use strict";exports.__esModule=true;exports.setTextContent=exports.createStyleElement=undefined;var _document=require("global/document");var _document2=_interopRequireDefault(_document);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}var createStyleElement=exports.createStyleElement=function createStyleElement(className){var style=_document2["default"].createElement("style");style.className=className;return style;};var setTextContent=exports.setTextContent=function setTextContent(el,content){if(el.styleSheet){el.styleSheet.cssText=content;}else{el.textContent=content;}};},{"global/document":89}],329:[function(require,module,exports){"use strict";exports.__esModule=true;exports.createTimeRange=undefined;exports.createTimeRanges=createTimeRanges;var _log=require("./log.js");var _log2=_interopRequireDefault(_log);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function rangeCheck(fnName,index,maxIndex){if(index<0||index>maxIndex){throw new Error("Failed to execute '"+fnName+"' on 'TimeRanges': The index provided ("+index+") is greater than or equal to the maximum bound ("+maxIndex+").");}}function getRange(fnName,valueIndex,ranges,rangeIndex){if(rangeIndex===undefined){_log2["default"].warn("DEPRECATED: Function '"+fnName+"' on 'TimeRanges' called without an index argument.");rangeIndex=0;}rangeCheck(fnName,rangeIndex,ranges.length-1);return ranges[rangeIndex][valueIndex];}function createTimeRangesObj(ranges){if(ranges===undefined||ranges.length===0){return{length:0,start:function start(){throw new Error("This TimeRanges object is empty");},end:function end(){throw new Error("This TimeRanges object is empty");}};}return{length:ranges.length,start:getRange.bind(null,"start",0,ranges),end:getRange.bind(null,"end",1,ranges)};}function createTimeRanges(start,end){if(Array.isArray(start)){return createTimeRangesObj(start);}else if(start===undefined||end===undefined){return createTimeRangesObj();}return createTimeRangesObj([[start,end]]);}exports.createTimeRange=createTimeRanges;},{"./log.js":325}],330:[function(require,module,exports){"use strict";exports.__esModule=true;function toTitleCase(string){if(typeof string!=="string"){return string;}return string.charAt(0).toUpperCase()+string.slice(1);}exports["default"]=toTitleCase;},{}],331:[function(require,module,exports){"use strict";exports.__esModule=true;exports.isCrossOrigin=exports.getFileExtension=exports.getAbsoluteURL=exports.parseUrl=undefined;var _document=require("global/document");var _document2=_interopRequireDefault(_document);var _window=require("global/window");var _window2=_interopRequireDefault(_window);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}var parseUrl=exports.parseUrl=function parseUrl(url){var props=["protocol","hostname","port","pathname","search","hash","host"];var a=_document2["default"].createElement("a");a.href=url;var addToBody=a.host===""&&a.protocol!=="file:";var div=void 0;if(addToBody){div=_document2["default"].createElement("div");div.innerHTML='<a href="'+url+'"></a>';a=div.firstChild;div.setAttribute("style","display:none; position:absolute;");_document2["default"].body.appendChild(div);}var details={};for(var i=0;i<props.length;i++){details[props[i]]=a[props[i]];}if(details.protocol==="http:"){details.host=details.host.replace(/:80$/,"");}if(details.protocol==="https:"){details.host=details.host.replace(/:443$/,"");}if(addToBody){_document2["default"].body.removeChild(div);}return details;};var getAbsoluteURL=exports.getAbsoluteURL=function getAbsoluteURL(url){if(!url.match(/^https?:\/\//)){var div=_document2["default"].createElement("div");div.innerHTML='<a href="'+url+'">x</a>';url=div.firstChild.href;}return url;};var getFileExtension=exports.getFileExtension=function getFileExtension(path){if(typeof path==="string"){var splitPathRe=/^(\/?)([\s\S]*?)((?:\.{1,2}|[^\/]+?)(\.([^\.\/\?]+)))(?:[\/]*|[\?].*)$/i;var pathParts=splitPathRe.exec(path);if(pathParts){return pathParts.pop().toLowerCase();}}return"";};var isCrossOrigin=exports.isCrossOrigin=function isCrossOrigin(url){var winLoc=_window2["default"].location;var urlInfo=parseUrl(url);var srcProtocol=urlInfo.protocol===":"?winLoc.protocol:urlInfo.protocol;var crossOrigin=srcProtocol+urlInfo.host!==winLoc.protocol+winLoc.host;return crossOrigin;};},{"global/document":89,"global/window":90}],332:[function(require,module,exports){"use strict";exports.__esModule=true;var _typeof=typeof Symbol==="function"&&_typeof2(Symbol.iterator)==="symbol"?function(obj){return typeof obj==="undefined"?"undefined":_typeof2(obj);}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj==="undefined"?"undefined":_typeof2(obj);};var _window=require("global/window");var _window2=_interopRequireDefault(_window);var _document=require("global/document");var _document2=_interopRequireDefault(_document);var _setup=require("./setup");var setup=_interopRequireWildcard(_setup);var _stylesheet=require("./utils/stylesheet.js");var stylesheet=_interopRequireWildcard(_stylesheet);var _component=require("./component");var _component2=_interopRequireDefault(_component);var _eventTarget=require("./event-target");var _eventTarget2=_interopRequireDefault(_eventTarget);var _events=require("./utils/events.js");var Events=_interopRequireWildcard(_events);var _player=require("./player");var _player2=_interopRequireDefault(_player);var _plugins=require("./plugins.js");var _plugins2=_interopRequireDefault(_plugins);var _mergeOptions2=require("./utils/merge-options.js");var _mergeOptions3=_interopRequireDefault(_mergeOptions2);var _fn=require("./utils/fn.js");var Fn=_interopRequireWildcard(_fn);var _textTrack=require("./tracks/text-track.js");var _textTrack2=_interopRequireDefault(_textTrack);var _audioTrack=require("./tracks/audio-track.js");var _audioTrack2=_interopRequireDefault(_audioTrack);var _videoTrack=require("./tracks/video-track.js");var _videoTrack2=_interopRequireDefault(_videoTrack);var _timeRanges=require("./utils/time-ranges.js");var _formatTime=require("./utils/format-time.js");var _formatTime2=_interopRequireDefault(_formatTime);var _log=require("./utils/log.js");var _log2=_interopRequireDefault(_log);var _dom=require("./utils/dom.js");var Dom=_interopRequireWildcard(_dom);var _browser=require("./utils/browser.js");var browser=_interopRequireWildcard(_browser);var _url=require("./utils/url.js");var Url=_interopRequireWildcard(_url);var _obj=require("./utils/obj");var _computedStyle=require("./utils/computed-style.js");var _computedStyle2=_interopRequireDefault(_computedStyle);var _extend=require("./extend.js");var _extend2=_interopRequireDefault(_extend);var _xhr=require("xhr");var _xhr2=_interopRequireDefault(_xhr);var _tech=require("./tech/tech.js");var _tech2=_interopRequireDefault(_tech);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}if(typeof HTMLVideoElement==="undefined"&&Dom.isReal()){_document2["default"].createElement("video");_document2["default"].createElement("audio");_document2["default"].createElement("track");}function videojs(id,options,ready){var tag=void 0;if(typeof id==="string"){if(id.indexOf("#")===0){id=id.slice(1);}if(videojs.getPlayers()[id]){if(options){_log2["default"].warn('Player "'+id+'" is already initialised. Options will not be applied.');}if(ready){videojs.getPlayers()[id].ready(ready);}return videojs.getPlayers()[id];}tag=Dom.getEl(id);}else{tag=id;}if(!tag||!tag.nodeName){throw new TypeError("The element or ID supplied is not valid. (videojs)");}if(tag.player||_player2["default"].players[tag.playerId]){return tag.player||_player2["default"].players[tag.playerId];}options=options||{};videojs.hooks("beforesetup").forEach(function(hookFunction){var opts=hookFunction(tag,(0,_mergeOptions3["default"])(options));if(!(0,_obj.isObject)(opts)||Array.isArray(opts)){_log2["default"].error("please return an object in beforesetup hooks");return;}options=(0,_mergeOptions3["default"])(options,opts);});var PlayerComponent=_component2["default"].getComponent("Player");var player=new PlayerComponent(tag,options,ready);videojs.hooks("setup").forEach(function(hookFunction){return hookFunction(player);});return player;}videojs.hooks_={};videojs.hooks=function(type,fn){videojs.hooks_[type]=videojs.hooks_[type]||[];if(fn){videojs.hooks_[type]=videojs.hooks_[type].concat(fn);}return videojs.hooks_[type];};videojs.hook=function(type,fn){videojs.hooks(type,fn);};videojs.removeHook=function(type,fn){var index=videojs.hooks(type).indexOf(fn);if(index<=-1){return false;}videojs.hooks_[type]=videojs.hooks_[type].slice();videojs.hooks_[type].splice(index,1);return true;};if(_window2["default"].VIDEOJS_NO_DYNAMIC_STYLE!==true&&Dom.isReal()){var style=Dom.$(".vjs-styles-defaults");if(!style){style=stylesheet.createStyleElement("vjs-styles-defaults");var head=Dom.$("head");if(head){head.insertBefore(style,head.firstChild);}stylesheet.setTextContent(style,"\n      .video-js {\n        width: 300px;\n        height: 150px;\n      }\n\n      .vjs-fluid {\n        padding-top: 56.25%\n      }\n    ");}}setup.autoSetupTimeout(1,videojs);videojs.VERSION="5.19.2";videojs.options=_player2["default"].prototype.options_;videojs.getPlayers=function(){return _player2["default"].players;};videojs.players=_player2["default"].players;videojs.getComponent=_component2["default"].getComponent;videojs.registerComponent=function(name,comp){if(_tech2["default"].isTech(comp)){_log2["default"].warn("The "+name+" tech was registered as a component. It should instead be registered using videojs.registerTech(name, tech)");}_component2["default"].registerComponent.call(_component2["default"],name,comp);};videojs.getTech=_tech2["default"].getTech;videojs.registerTech=_tech2["default"].registerTech;videojs.browser=browser;videojs.TOUCH_ENABLED=browser.TOUCH_ENABLED;videojs.extend=_extend2["default"];videojs.mergeOptions=_mergeOptions3["default"];videojs.bind=Fn.bind;videojs.plugin=_plugins2["default"];videojs.addLanguage=function(code,data){var _mergeOptions;code=(""+code).toLowerCase();videojs.options.languages=(0,_mergeOptions3["default"])(videojs.options.languages,(_mergeOptions={},_mergeOptions[code]=data,_mergeOptions));return videojs.options.languages[code];};videojs.log=_log2["default"];videojs.createTimeRange=videojs.createTimeRanges=_timeRanges.createTimeRanges;videojs.formatTime=_formatTime2["default"];videojs.parseUrl=Url.parseUrl;videojs.isCrossOrigin=Url.isCrossOrigin;videojs.EventTarget=_eventTarget2["default"];videojs.on=Events.on;videojs.one=Events.one;videojs.off=Events.off;videojs.trigger=Events.trigger;videojs.xhr=_xhr2["default"];videojs.TextTrack=_textTrack2["default"];videojs.AudioTrack=_audioTrack2["default"];videojs.VideoTrack=_videoTrack2["default"];videojs.isEl=Dom.isEl;videojs.isTextNode=Dom.isTextNode;videojs.createEl=Dom.createEl;videojs.hasClass=Dom.hasElClass;videojs.addClass=Dom.addElClass;videojs.removeClass=Dom.removeElClass;videojs.toggleClass=Dom.toggleElClass;videojs.setAttributes=Dom.setElAttributes;videojs.getAttributes=Dom.getElAttributes;videojs.emptyEl=Dom.emptyEl;videojs.appendContent=Dom.appendContent;videojs.insertContent=Dom.insertContent;videojs.computedStyle=_computedStyle2["default"];if(typeof define==="function"&&define.amd){define("videojs",[],function(){return videojs;});}else if((typeof exports==="undefined"?"undefined":_typeof(exports))==="object"&&(typeof module==="undefined"?"undefined":_typeof(module))==="object"){module.exports=videojs;}exports["default"]=videojs;},{"./component":244,"./event-target":281,"./extend.js":282,"./player":290,"./plugins.js":291,"./setup":295,"./tech/tech.js":301,"./tracks/audio-track.js":303,"./tracks/text-track.js":311,"./tracks/video-track.js":316,"./utils/browser.js":317,"./utils/computed-style.js":319,"./utils/dom.js":320,"./utils/events.js":321,"./utils/fn.js":322,"./utils/format-time.js":323,"./utils/log.js":325,"./utils/merge-options.js":326,"./utils/obj":327,"./utils/stylesheet.js":328,"./utils/time-ranges.js":329,"./utils/url.js":331,"global/document":89,"global/window":90,xhr:371}],333:[function(require,module,exports){"use strict";exports.__esModule=true;exports["default"]=cancelContentPlay;var _window=require("global/window");var _window2=_interopRequireDefault(_window);var _document=require("global/document");var _document2=_interopRequireDefault(_document);var _video=require("video.js");var _video2=_interopRequireDefault(_video);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function cancelContentPlay(player){if(player.ads.cancelPlayTimeout){return;}if(_video2["default"].browser.IS_IOS&&_video2["default"].browser.IS_IPHONE&&!player.el_.hasAttribute("playsinline")){var width=player.currentWidth?player.currentWidth():player.width();var height=player.currentHeight?player.currentHeight():player.height();var position=_window2["default"].getComputedStyle(player.el_).position;var top=_window2["default"].getComputedStyle(player.el_).top;var placeholder=_document2["default"].createElement("div");placeholder.style.width=width+"px";placeholder.style.height=height+"px";placeholder.style.background="black";placeholder.style.position=position;placeholder.style.top=top;player.el_.parentNode.insertBefore(placeholder,player.el_);player.el_.style.display="none";player.one(["adstart","adtimeout","adserror","adscanceled","adskip","playing"],function(){player.el_.style.display="block";placeholder.remove();});player.on("fullscreenchange",function(){if(placeholder&&!player.isFullscreen()){player.el_.style.display="block";placeholder.remove();}});}player.ads.cancelPlayTimeout=_window2["default"].setTimeout(function(){player.ads.cancelPlayTimeout=null;if(!player.paused()){player.pause();}player.ads._cancelledPlay=true;},1);}},{"global/document":89,"global/window":90,"video.js":332}],334:[function(require,module,exports){"use strict";exports.__esModule=true;exports["default"]=initializeContentupdate;var _window=require("global/window");var _window2=_interopRequireDefault(_window);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function initializeContentupdate(player){player.ads.contentSrc=player.currentSrc();var checkSrc=function checkSrc(){if(player.ads.state!=="ad-playback"){var src=player.currentSrc();if(src!==player.ads.contentSrc){player.trigger({type:"contentupdate",oldValue:player.ads.contentSrc,newValue:src});player.ads.contentSrc=src;}}};player.on("loadstart",checkSrc);_window2["default"].setTimeout(checkSrc,1);}},{"global/window":90}],335:[function(require,module,exports){"use strict";exports.__esModule=true;exports.processMetadataTracks=processMetadataTracks;exports.setMetadataTrackMode=setMetadataTrackMode;exports.getSupportedAdCue=getSupportedAdCue;exports.isSupportedAdCue=isSupportedAdCue;exports.getCueId=getCueId;exports.processAdTrack=processAdTrack;var _video=require("video.js");var _video2=_interopRequireDefault(_video);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function processMetadataTracks(player,processMetadataTrack){var tracks=player.textTracks();var setModeAndProcess=function setModeAndProcess(track){if(track.kind==="metadata"){player.ads.cueTextTracks.setMetadataTrackMode(track);processMetadataTrack(player,track);}};for(var i=0;i<tracks.length;i++){setModeAndProcess(tracks[i]);}tracks.addEventListener("addtrack",function(event){setModeAndProcess(event.track);});}function setMetadataTrackMode(track){return;}function getSupportedAdCue(player,cue){return cue;}function isSupportedAdCue(player,cue){return true;}function getCueId(player,cue){return cue.id;}var cueAlreadySeen=function cueAlreadySeen(player,cueId){return cueId!==undefined&&player.ads.includedCues[cueId];};var setCueAlreadySeen=function setCueAlreadySeen(player,cueId){if(cueId!==undefined&&cueId!==""){player.ads.includedCues[cueId]=true;}};function processAdTrack(player,cues,processCue,cancelAdsHandler){player.ads.includedCues={};for(var i=0;i<cues.length;i++){var cue=cues[i];var cueData=this.getSupportedAdCue(player,cue);if(!this.isSupportedAdCue(player,cue)){_video2["default"].log.warn("Skipping as this is not a supported ad cue.",cue);return;}var cueId=this.getCueId(player,cue);var startTime=cue.startTime;if(cueAlreadySeen(player,cueId)){_video2["default"].log("Skipping ad already seen with ID "+cueId);return;}if(cancelAdsHandler){cancelAdsHandler(player,cueData,cueId,startTime);}processCue(player,cueData,cueId,startTime);setCueAlreadySeen(player,cueId);}}},{"video.js":332}],336:[function(require,module,exports){"use strict";exports.__esModule=true;var _typeof=typeof Symbol==="function"&&_typeof2(Symbol.iterator)==="symbol"?function(obj){return typeof obj==="undefined"?"undefined":_typeof2(obj);}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj==="undefined"?"undefined":_typeof2(obj);};exports["default"]=adMacroReplacement;var _window=require("global/window");var _window2=_interopRequireDefault(_window);var _document=require("global/document");var _document2=_interopRequireDefault(_document);var _video=require("video.js");var _video2=_interopRequireDefault(_video);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}var uriEncodeIfNeeded=function uriEncodeIfNeeded(value,uriEncode){if(uriEncode){return encodeURIComponent(value);}return value;};var customFields=function customFields(mediainfo,macros,customFieldsName){if(mediainfo&&mediainfo[customFieldsName]){var fields=mediainfo[customFieldsName];var fieldNames=Object.keys(fields);for(var i=0;i<fieldNames.length;i++){var tag="{mediainfo."+customFieldsName+"."+fieldNames[i]+"}";macros[tag]=fields[fieldNames[i]];}}};function adMacroReplacement(string,uriEncode,customMacros){if(uriEncode===undefined){uriEncode=false;}var macros={};if(customMacros!==undefined){macros=customMacros;}macros["{player.id}"]=this.options_["data-player"];macros["{mediainfo.id}"]=this.mediainfo?this.mediainfo.id:"";macros["{mediainfo.name}"]=this.mediainfo?this.mediainfo.name:"";macros["{mediainfo.description}"]=this.mediainfo?this.mediainfo.description:"";macros["{mediainfo.tags}"]=this.mediainfo?this.mediainfo.tags:"";macros["{mediainfo.reference_id}"]=this.mediainfo?this.mediainfo.reference_id:"";macros["{mediainfo.duration}"]=this.mediainfo?this.mediainfo.duration:"";macros["{mediainfo.ad_keys}"]=this.mediainfo?this.mediainfo.ad_keys:"";macros["{player.duration}"]=this.duration();macros["{timestamp}"]=new Date().getTime();macros["{document.referrer}"]=_document2["default"].referrer;macros["{window.location.href}"]=_window2["default"].location.href;macros["{random}"]=Math.floor(Math.random()*1e12);customFields(this.mediainfo,macros,"custom_fields");customFields(this.mediainfo,macros,"customFields");for(var i in macros){string=string.split(i).join(uriEncodeIfNeeded(macros[i],uriEncode));}string=string.replace(/{pageVariable\.([^}]+)}/g,function(match,name){var value=void 0;var context=_window2["default"];var names=name.split(".");for(var _i=0;_i<names.length;_i++){if(_i===names.length-1){value=context[names[_i]];}else{context=context[names[_i]];}}var type=typeof value==="undefined"?"undefined":_typeof(value);if(value===null){return"null";}else if(value===undefined){_video2["default"].log.warn('Page variable "'+name+'" not found');return"";}else if(type!=="string"&&type!=="number"&&type!=="boolean"){_video2["default"].log.warn('Page variable "'+name+'" is not a supported type');return"";}return uriEncodeIfNeeded(String(value),uriEncode);});return string;}},{"global/document":89,"global/window":90,"video.js":332}],337:[function(require,module,exports){"use strict";var _window=require("global/window");var _window2=_interopRequireDefault(_window);var _video=require("video.js");var _video2=_interopRequireDefault(_video);var _redispatch=require("./redispatch.js");var _redispatch2=_interopRequireDefault(_redispatch);var _snapshot=require("./snapshot.js");var snapshot=_interopRequireWildcard(_snapshot);var _contentupdate=require("./contentupdate.js");var _contentupdate2=_interopRequireDefault(_contentupdate);var _cancelContentPlay=require("./cancelContentPlay.js");var _cancelContentPlay2=_interopRequireDefault(_cancelContentPlay);var _macros=require("./macros.js");var _macros2=_interopRequireDefault(_macros);var _cueTextTracks=require("./cueTextTracks.js");var cueTextTracks=_interopRequireWildcard(_cueTextTracks);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}var VIDEO_EVENTS=_video2["default"].getTech("Html5").Events;var removeNativePoster=function removeNativePoster(player){var tech=player.$(".vjs-tech");if(tech){tech.removeAttribute("poster");}};var defaults={timeout:5e3,prerollTimeout:100,postrollTimeout:100,debug:false,stitchedAds:false};var contribAdsPlugin=function contribAdsPlugin(options){var player=this;var settings=_video2["default"].mergeOptions(defaults,options);var videoEvents=VIDEO_EVENTS.concat(["firstplay","loadedalldata","playing"]);player.on(videoEvents,_redispatch2["default"]);_window2["default"].setTimeout(function(){if(!player.ads._hasThereBeenALoadStartDuringPlayerLife&&player.src()!==""){_video2["default"].log.error("videojs-contrib-ads has not seen a loadstart event 5 seconds "+"after being initialized, but a source is present. This indicates that "+"videojs-contrib-ads was initialized too late. It must be initialized "+"immediately after video.js in the same tick. As a result, some ads will not "+"play and some media events will be incorrect. For more information, see "+"https://github.com/videojs/videojs-contrib-ads#important-note-about-initialization");}},5e3);player.on("ended",function(){if(!player.hasClass("vjs-has-started")){player.addClass("vjs-has-started");}});player.on(["addurationchange","adcanplay"],function(){if(player.ads.snapshot&&player.currentSrc()===player.ads.snapshot.currentSrc){return;}if(!player.ads.isAdPlaying()){return;}player.play();});player.on("nopreroll",function(){player.ads.nopreroll_=true;});player.on("nopostroll",function(){player.ads.nopostroll_=true;});player.on(["ads-ad-started","playing"],function(){player.removeClass("vjs-ad-loading");});player.on("playing",function(){player.ads._cancelledPlay=false;});player.one("loadstart",function(){player.ads._hasThereBeenALoadStartDuringPlayerLife=true;});player.on("loadeddata",function(){player.ads._hasThereBeenALoadedData=true;});player.on("loadedmetadata",function(){player.ads._hasThereBeenALoadedMetaData=true;});player.ads={state:"content-set",disableNextSnapshotRestore:false,_contentEnding:false,_contentHasEnded:false,_hasThereBeenALoadStartDuringPlayerLife:false,_hasThereBeenALoadedData:false,_hasThereBeenALoadedMetaData:false,_inLinearAdMode:false,adType:null,VERSION:"5.0.3",reset:function reset(){player.ads.disableNextSnapshotRestore=false;player.ads._contentEnding=false;player.ads._contentHasEnded=false;player.ads.snapshot=null;player.ads.adType=null;player.ads._hasThereBeenALoadedData=false;player.ads._hasThereBeenALoadedMetaData=false;},startLinearAdMode:function startLinearAdMode(){if(player.ads.state==="preroll?"||player.ads.state==="content-playback"||player.ads.state==="postroll?"){player.ads._inLinearAdMode=true;player.trigger("adstart");}},endLinearAdMode:function endLinearAdMode(){if(player.ads.state==="ad-playback"){player.ads._inLinearAdMode=false;player.trigger("adend");player.removeClass("vjs-ad-loading");}},skipLinearAdMode:function skipLinearAdMode(){if(player.ads.state!=="ad-playback"){player.trigger("adskip");}},stitchedAds:function stitchedAds(arg){if(arg!==undefined){this._stitchedAds=!!arg;}return this._stitchedAds;},videoElementRecycled:function videoElementRecycled(){if(player.ads.shouldPlayContentBehindAd(player)){return false;}if(!this.snapshot){throw new Error("You cannot use videoElementRecycled while there is no snapshot.");}var srcChanged=player.tech_.src()!==this.snapshot.src;var currentSrcChanged=player.currentSrc()!==this.snapshot.currentSrc;return srcChanged||currentSrcChanged;},isLive:function isLive(somePlayer){if(somePlayer.duration()===Infinity){return true;}else if(_video2["default"].browser.IOS_VERSION==="8"&&somePlayer.duration()===0){return true;}return false;},shouldPlayContentBehindAd:function shouldPlayContentBehindAd(somePlayer){return!_video2["default"].browser.IS_IOS&&!_video2["default"].browser.IS_ANDROID&&somePlayer.duration()===Infinity;},isInAdMode:function isInAdMode(){return player.ads.state==="ads-ready?"||player.ads.state==="preroll?"||player.ads.state==="ad-playback"||player.ads.state==="content-resuming";},isContentResuming:function isContentResuming(){return player.ads.state==="content-resuming";},isAdPlaying:function isAdPlaying(){return this._inLinearAdMode;}};player.ads.stitchedAds(settings.stitchedAds);player.ads.cueTextTracks=cueTextTracks;player.ads.adMacroReplacement=_macros2["default"].bind(player);(0,_contentupdate2["default"])(player);player.on("contentupdate",player.ads.reset);var states={"content-set":{events:{adscanceled:function adscanceled(){this.state="content-playback";},adsready:function adsready(){this.state="ads-ready";},play:function play(){this.state="ads-ready?";(0,_cancelContentPlay2["default"])(player);removeNativePoster(player);},adserror:function adserror(){this.state="content-playback";},adskip:function adskip(){this.state="content-playback";}}},"ads-ready":{events:{play:function play(){this.state="preroll?";(0,_cancelContentPlay2["default"])(player);},adskip:function adskip(){this.state="content-playback";},adserror:function adserror(){this.state="content-playback";}}},"preroll?":{enter:function enter(){if(player.ads.nopreroll_){player.trigger("readyforpreroll");_window2["default"].setTimeout(function(){player.trigger("nopreroll");},1);}else{player.addClass("vjs-ad-loading");player.ads.adTimeoutTimeout=_window2["default"].setTimeout(function(){player.trigger("adtimeout");},settings.prerollTimeout);if(player.ads._hasThereBeenALoadStartDuringPlayerLife){player.trigger("readyforpreroll");}else{player.one("loadstart",function(){player.trigger("readyforpreroll");});}}},leave:function leave(){_window2["default"].clearTimeout(player.ads.adTimeoutTimeout);},events:{play:function play(){(0,_cancelContentPlay2["default"])(player);},adstart:function adstart(){this.state="ad-playback";player.ads.adType="preroll";},adskip:function adskip(){this.state="content-playback";},adtimeout:function adtimeout(){this.state="content-playback";},adserror:function adserror(){this.state="content-playback";},nopreroll:function nopreroll(){this.state="content-playback";}}},"ads-ready?":{enter:function enter(){player.addClass("vjs-ad-loading");player.ads.adTimeoutTimeout=_window2["default"].setTimeout(function(){player.trigger("adtimeout");},settings.timeout);},leave:function leave(){_window2["default"].clearTimeout(player.ads.adTimeoutTimeout);player.removeClass("vjs-ad-loading");},events:{play:function play(){(0,_cancelContentPlay2["default"])(player);},adscanceled:function adscanceled(){this.state="content-playback";},adsready:function adsready(){this.state="preroll?";},adskip:function adskip(){this.state="content-playback";},adtimeout:function adtimeout(){this.state="content-playback";},adserror:function adserror(){this.state="content-playback";}}},"ad-playback":{enter:function enter(){if(!player.ads.shouldPlayContentBehindAd(player)){this.snapshot=snapshot.getPlayerSnapshot(player);}if(player.ads.shouldPlayContentBehindAd(player)){this.preAdVolume_=player.volume();player.volume(0);}player.addClass("vjs-ad-playing");if(player.hasClass("vjs-live")){player.removeClass("vjs-live");}removeNativePoster(player);if(player.ads.cancelPlayTimeout){_window2["default"].setTimeout(function(){_window2["default"].clearTimeout(player.ads.cancelPlayTimeout);player.ads.cancelPlayTimeout=null;},1);}},leave:function leave(){player.removeClass("vjs-ad-playing");if(player.ads.isLive(player)){player.addClass("vjs-live");}if(!player.ads.shouldPlayContentBehindAd(player)){snapshot.restorePlayerSnapshot(player,this.snapshot);}if(player.ads.shouldPlayContentBehindAd(player)){player.volume(this.preAdVolume_);}},events:{adend:function adend(){this.state="content-resuming";player.ads.adType=null;},adserror:function adserror(){player.ads.endLinearAdMode();}}},"content-resuming":{enter:function enter(){if(this._contentHasEnded){_window2["default"].clearTimeout(player.ads._fireEndedTimeout);player.ads._fireEndedTimeout=_window2["default"].setTimeout(function(){player.trigger("ended");},1e3);}},leave:function leave(){_window2["default"].clearTimeout(player.ads._fireEndedTimeout);},events:{contentupdate:function contentupdate(){this.state="content-set";},contentresumed:function contentresumed(){this.state="content-playback";},playing:function playing(){this.state="content-playback";},ended:function ended(){this.state="content-playback";}}},"postroll?":{enter:function enter(){player.ads._contentEnding=true;this.snapshot=snapshot.getPlayerSnapshot(player);if(player.ads.nopostroll_){_window2["default"].setTimeout(function(){player.ads.state="content-resuming";player.trigger("ended");},1);}else{player.addClass("vjs-ad-loading");player.ads.adTimeoutTimeout=_window2["default"].setTimeout(function(){player.trigger("adtimeout");},settings.postrollTimeout);}},leave:function leave(){_window2["default"].clearTimeout(player.ads.adTimeoutTimeout);player.removeClass("vjs-ad-loading");},events:{adstart:function adstart(){this.state="ad-playback";player.ads.adType="postroll";},adskip:function adskip(){this.state="content-resuming";_window2["default"].setTimeout(function(){player.trigger("ended");},1);},adtimeout:function adtimeout(){this.state="content-resuming";_window2["default"].setTimeout(function(){player.trigger("ended");},1);},adserror:function adserror(){this.state="content-resuming";_window2["default"].setTimeout(function(){player.trigger("ended");},1);},contentupdate:function contentupdate(){this.state="ads-ready?";}}},"content-playback":{enter:function enter(){if(player.ads.cancelPlayTimeout){_window2["default"].clearTimeout(player.ads.cancelPlayTimeout);player.ads.cancelPlayTimeout=null;}player.trigger({type:"contentplayback",triggerevent:player.ads.triggerevent});if(player.ads._cancelledPlay){if(player.paused()){player.play();}}},events:{adsready:function adsready(){player.trigger("readyforpreroll");},adstart:function adstart(){this.state="ad-playback";if(player.ads.adType!=="preroll"){player.ads.adType="midroll";}},contentupdate:function contentupdate(){if(!player.ads.shouldPlayContentBehindAd(player)){(0,_cancelContentPlay2["default"])(player);}if(player.paused()){this.state="content-set";}else{this.state="ads-ready?";}},contentended:function contentended(){if(this._contentHasEnded){this.state="content-resuming";return;}this._contentEnding=false;this._contentHasEnded=true;this.state="postroll?";}}}};var processEvent=function processEvent(event){var state=player.ads.state;var eventHandlers=states[state].events;if(eventHandlers){var handler=eventHandlers[event.type];if(handler){handler.apply(player.ads);}}if(state!==player.ads.state){var previousState=state;var newState=player.ads.state;player.ads.triggerevent=event.type;if(states[previousState].leave){states[previousState].leave.apply(player.ads);}if(states[newState].enter){states[newState].enter.apply(player.ads);}if(settings.debug){_video2["default"].log("ads",player.ads.triggerevent+" triggered: "+previousState+" -> "+newState);}}};player.on(VIDEO_EVENTS.concat(["adtimeout","contentupdate","contentplaying","contentended","contentresumed","adstart","adend","adskip","adsready","adserror","adscanceled","nopreroll"]),processEvent);player.on("dispose",function(){if(player.ads.adTimeoutTimeout){_window2["default"].clearTimeout(player.ads.adTimeoutTimeout);}if(player.ads._fireEndedTimeout){_window2["default"].clearTimeout(player.ads._fireEndedTimeout);}if(player.ads.cancelPlayTimeout){_window2["default"].clearTimeout(player.ads.cancelPlayTimeout);}if(player.ads.tryToResumeTimeout_){player.clearTimeout(player.ads.tryToResumeTimeout_);}});if(!player.paused()){processEvent({type:"play"});}};var registerPlugin=_video2["default"].registerPlugin||_video2["default"].plugin;registerPlugin("ads",contribAdsPlugin);},{"./cancelContentPlay.js":333,"./contentupdate.js":334,"./cueTextTracks.js":335,"./macros.js":336,"./redispatch.js":338,"./snapshot.js":339,"global/window":90,"video.js":332}],338:[function(require,module,exports){"use strict";exports.__esModule=true;exports["default"]=redispatch;var cancelEvent=function cancelEvent(player,event){event.isImmediatePropagationStopped=function(){return true;};event.cancelBubble=true;event.isPropagationStopped=function(){return true;};};var prefixEvent=function prefixEvent(player,prefix,event){cancelEvent(player,event);player.trigger({type:prefix+event.type,state:player.ads.state,originalEvent:event});};var handlePlaying=function handlePlaying(player,event){if(player.ads.isInAdMode()){if(player.ads.isContentResuming()){if(player.ads._contentEnding){prefixEvent(player,"content",event);}}else if(player.ads._cancelledPlay){cancelEvent(player,event);}else{prefixEvent(player,"ad",event);}}};var handleEnded=function handleEnded(player,event){if(player.ads.isInAdMode()){if(player.ads.isContentResuming()){return;}prefixEvent(player,"ad",event);}else{prefixEvent(player,"content",event);}};var handleLoadEvent=function handleLoadEvent(player,event){if(event.type==="loadstart"&&!player.ads._hasThereBeenALoadStartDuringPlayerLife||event.type==="loadeddata"&&!player.ads._hasThereBeenALoadedData||event.type==="loadedmetadata"&&!player.ads._hasThereBeenALoadedMetaData){return;}else if(player.ads.isAdPlaying()){prefixEvent(player,"ad",event);}else if(player.currentSrc()!==player.ads.contentSrc){return;}else{prefixEvent(player,"content",event);}};var handlePlay=function handlePlay(player,event){var resumingAfterNoPreroll=player.ads._cancelledPlay&&!player.ads.isInAdMode();if(player.ads.isAdPlaying()){prefixEvent(player,"ad",event);}else if(player.ads.isContentResuming()||resumingAfterNoPreroll){prefixEvent(player,"content",event);}};function redispatch(event){if(event.type==="playing"){handlePlaying(this,event);}else if(event.type==="ended"){handleEnded(this,event);}else if(event.type==="loadstart"||event.type==="loadeddata"||event.type==="loadedmetadata"){handleLoadEvent(this,event);}else if(event.type==="play"){handlePlay(this,event);}else if(this.ads.isInAdMode()){if(this.ads.isContentResuming()){prefixEvent(this,"content",event);}else{prefixEvent(this,"ad",event);}}}},{}],339:[function(require,module,exports){"use strict";exports.__esModule=true;exports.getPlayerSnapshot=getPlayerSnapshot;exports.restorePlayerSnapshot=restorePlayerSnapshot;var _window=require("global/window");var _window2=_interopRequireDefault(_window);var _video=require("video.js");var _video2=_interopRequireDefault(_video);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function getPlayerSnapshot(player){var currentTime=void 0;if(_video2["default"].browser.IS_IOS&&player.ads.isLive(player)){if(player.seekable().length>0){currentTime=player.currentTime()-player.seekable().end(0);}else{currentTime=player.currentTime();}}else{currentTime=player.currentTime();}var tech=player.$(".vjs-tech");var remoteTracks=player.remoteTextTracks?player.remoteTextTracks():[];var tracks=player.textTracks?player.textTracks():[];var suppressedRemoteTracks=[];var suppressedTracks=[];var snapshotObject={ended:player.ended(),currentSrc:player.currentSrc(),src:player.tech_.src(),currentTime:currentTime,type:player.currentType()};if(tech){snapshotObject.nativePoster=tech.poster;snapshotObject.style=tech.getAttribute("style");}for(var i=0;i<remoteTracks.length;i++){var track=remoteTracks[i];suppressedRemoteTracks.push({track:track,mode:track.mode});track.mode="disabled";}snapshotObject.suppressedRemoteTracks=suppressedRemoteTracks;for(var _i=0;_i<tracks.length;_i++){var _track=tracks[_i];suppressedTracks.push({track:_track,mode:_track.mode});_track.mode="disabled";}snapshotObject.suppressedTracks=suppressedTracks;return snapshotObject;}function restorePlayerSnapshot(player,snapshotObject){if(player.ads.disableNextSnapshotRestore===true){player.ads.disableNextSnapshotRestore=false;return;}var tech=player.$(".vjs-tech");var attempts=20;var suppressedRemoteTracks=snapshotObject.suppressedRemoteTracks;var suppressedTracks=snapshotObject.suppressedTracks;var trackSnapshot=void 0;var restoreTracks=function restoreTracks(){for(var i=0;i<suppressedRemoteTracks.length;i++){trackSnapshot=suppressedRemoteTracks[i];trackSnapshot.track.mode=trackSnapshot.mode;}for(var _i2=0;_i2<suppressedTracks.length;_i2++){trackSnapshot=suppressedTracks[_i2];trackSnapshot.track.mode=trackSnapshot.mode;}};var resume=function resume(){var currentTime=void 0;if(_video2["default"].browser.IS_IOS&&player.ads.isLive(player)){if(snapshotObject.currentTime<0){if(player.seekable().length>0){currentTime=player.seekable().end(0)+snapshotObject.currentTime;}else{currentTime=player.currentTime();}player.currentTime(currentTime);}}else if(snapshotObject.ended){player.currentTime(player.duration());}else{player.currentTime(snapshotObject.currentTime);}if(!snapshotObject.ended){player.play();}};var tryToResume=function tryToResume(){player.off("contentcanplay",tryToResume);if(player.ads.tryToResumeTimeout_){player.clearTimeout(player.ads.tryToResumeTimeout_);player.ads.tryToResumeTimeout_=null;}tech=player.el().querySelector(".vjs-tech");if(tech.readyState>1){return resume();}if(tech.seekable===undefined){return resume();}if(tech.seekable.length>0){return resume();}if(attempts--){_window2["default"].setTimeout(tryToResume,50);}else{try{resume();}catch(e){_video2["default"].log.warn("Failed to resume the content after an advertisement",e);}}};if(snapshotObject.nativePoster){tech.poster=snapshotObject.nativePoster;}if("style"in snapshotObject){tech.setAttribute("style",snapshotObject.style||"");}if(player.ads.videoElementRecycled()){player.one("contentloadedmetadata",restoreTracks);player.src({src:snapshotObject.currentSrc,type:snapshotObject.type});player.one("contentcanplay",tryToResume);player.ads.tryToResumeTimeout_=player.setTimeout(tryToResume,2e3);}else if(!player.ended()||!snapshotObject.ended){restoreTracks();player.play();}}},{"global/window":90,"video.js":332}],340:[function(require,module,exports){(function(global){(function(f){if((typeof exports==="undefined"?"undefined":_typeof2(exports))==="object"&&typeof module!=="undefined"){module.exports=f();}else if(typeof define==="function"&&define.amd){define([],f);}else{var g;if(typeof window!=="undefined"){g=window;}else if(typeof global!=="undefined"){g=global;}else if(typeof self!=="undefined"){g=self;}else{g=this;}g.videojs=f();}})(function(){var define,module,exports;return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f;}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e);},l,l.exports,e,t,n,r);}return n[o].exports;}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++){s(r[o]);}return s;}({1:[function(_dereq_,module,exports){(function(global){var topLevel=typeof global!=="undefined"?global:typeof window!=="undefined"?window:{};var minDoc=_dereq_("min-document");if(typeof document!=="undefined"){module.exports=document;}else{var doccy=topLevel["__GLOBAL_DOCUMENT_CACHE@4"];if(!doccy){doccy=topLevel["__GLOBAL_DOCUMENT_CACHE@4"]=minDoc;}module.exports=doccy;}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{});},{"min-document":3}],2:[function(_dereq_,module,exports){(function(global){if(typeof window!=="undefined"){module.exports=window;}else if(typeof global!=="undefined"){module.exports=global;}else if(typeof self!=="undefined"){module.exports=self;}else{module.exports={};}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{});},{}],3:[function(_dereq_,module,exports){},{}],4:[function(_dereq_,module,exports){var getNative=_dereq_("../internal/getNative");var nativeNow=getNative(Date,"now");var now=nativeNow||function(){return new Date().getTime();};module.exports=now;},{"../internal/getNative":20}],5:[function(_dereq_,module,exports){var isObject=_dereq_("../lang/isObject"),now=_dereq_("../date/now");var FUNC_ERROR_TEXT="Expected a function";var nativeMax=Math.max;function debounce(func,wait,options){var args,maxTimeoutId,result,stamp,thisArg,timeoutId,trailingCall,lastCalled=0,maxWait=false,trailing=true;if(typeof func!="function"){throw new TypeError(FUNC_ERROR_TEXT);}wait=wait<0?0:+wait||0;if(options===true){var leading=true;trailing=false;}else if(isObject(options)){leading=!!options.leading;maxWait="maxWait"in options&&nativeMax(+options.maxWait||0,wait);trailing="trailing"in options?!!options.trailing:trailing;}function cancel(){if(timeoutId){clearTimeout(timeoutId);}if(maxTimeoutId){clearTimeout(maxTimeoutId);}lastCalled=0;maxTimeoutId=timeoutId=trailingCall=undefined;}function complete(isCalled,id){if(id){clearTimeout(id);}maxTimeoutId=timeoutId=trailingCall=undefined;if(isCalled){lastCalled=now();result=func.apply(thisArg,args);if(!timeoutId&&!maxTimeoutId){args=thisArg=undefined;}}}function delayed(){var remaining=wait-(now()-stamp);if(remaining<=0||remaining>wait){complete(trailingCall,maxTimeoutId);}else{timeoutId=setTimeout(delayed,remaining);}}function maxDelayed(){complete(trailing,timeoutId);}function debounced(){args=arguments;stamp=now();thisArg=this;trailingCall=trailing&&(timeoutId||!leading);if(maxWait===false){var leadingCall=leading&&!timeoutId;}else{if(!maxTimeoutId&&!leading){lastCalled=stamp;}var remaining=maxWait-(stamp-lastCalled),isCalled=remaining<=0||remaining>maxWait;if(isCalled){if(maxTimeoutId){maxTimeoutId=clearTimeout(maxTimeoutId);}lastCalled=stamp;result=func.apply(thisArg,args);}else if(!maxTimeoutId){maxTimeoutId=setTimeout(maxDelayed,remaining);}}if(isCalled&&timeoutId){timeoutId=clearTimeout(timeoutId);}else if(!timeoutId&&wait!==maxWait){timeoutId=setTimeout(delayed,wait);}if(leadingCall){isCalled=true;result=func.apply(thisArg,args);}if(isCalled&&!timeoutId&&!maxTimeoutId){args=thisArg=undefined;}return result;}debounced.cancel=cancel;return debounced;}module.exports=debounce;},{"../date/now":4,"../lang/isObject":33}],6:[function(_dereq_,module,exports){var FUNC_ERROR_TEXT="Expected a function";var nativeMax=Math.max;function restParam(func,start){if(typeof func!="function"){throw new TypeError(FUNC_ERROR_TEXT);}start=nativeMax(start===undefined?func.length-1:+start||0,0);return function(){var args=arguments,index=-1,length=nativeMax(args.length-start,0),rest=Array(length);while(++index<length){rest[index]=args[start+index];}switch(start){case 0:return func.call(this,rest);case 1:return func.call(this,args[0],rest);case 2:return func.call(this,args[0],args[1],rest);}var otherArgs=Array(start+1);index=-1;while(++index<start){otherArgs[index]=args[index];}otherArgs[start]=rest;return func.apply(this,otherArgs);};}module.exports=restParam;},{}],7:[function(_dereq_,module,exports){var debounce=_dereq_("./debounce"),isObject=_dereq_("../lang/isObject");var FUNC_ERROR_TEXT="Expected a function";function throttle(func,wait,options){var leading=true,trailing=true;if(typeof func!="function"){throw new TypeError(FUNC_ERROR_TEXT);}if(options===false){leading=false;}else if(isObject(options)){leading="leading"in options?!!options.leading:leading;trailing="trailing"in options?!!options.trailing:trailing;}return debounce(func,wait,{leading:leading,maxWait:+wait,trailing:trailing});}module.exports=throttle;},{"../lang/isObject":33,"./debounce":5}],8:[function(_dereq_,module,exports){function arrayCopy(source,array){var index=-1,length=source.length;array||(array=Array(length));while(++index<length){array[index]=source[index];}return array;}module.exports=arrayCopy;},{}],9:[function(_dereq_,module,exports){function arrayEach(array,iteratee){var index=-1,length=array.length;while(++index<length){if(iteratee(array[index],index,array)===false){break;}}return array;}module.exports=arrayEach;},{}],10:[function(_dereq_,module,exports){function baseCopy(source,props,object){object||(object={});var index=-1,length=props.length;while(++index<length){var key=props[index];object[key]=source[key];}return object;}module.exports=baseCopy;},{}],11:[function(_dereq_,module,exports){var createBaseFor=_dereq_("./createBaseFor");var baseFor=createBaseFor();module.exports=baseFor;},{"./createBaseFor":18}],12:[function(_dereq_,module,exports){var baseFor=_dereq_("./baseFor"),keysIn=_dereq_("../object/keysIn");function baseForIn(object,iteratee){return baseFor(object,iteratee,keysIn);}module.exports=baseForIn;},{"../object/keysIn":39,"./baseFor":11}],13:[function(_dereq_,module,exports){var arrayEach=_dereq_("./arrayEach"),baseMergeDeep=_dereq_("./baseMergeDeep"),isArray=_dereq_("../lang/isArray"),isArrayLike=_dereq_("./isArrayLike"),isObject=_dereq_("../lang/isObject"),isObjectLike=_dereq_("./isObjectLike"),isTypedArray=_dereq_("../lang/isTypedArray"),keys=_dereq_("../object/keys");function baseMerge(object,source,customizer,stackA,stackB){if(!isObject(object)){return object;}var isSrcArr=isArrayLike(source)&&(isArray(source)||isTypedArray(source)),props=isSrcArr?undefined:keys(source);arrayEach(props||source,function(srcValue,key){if(props){key=srcValue;srcValue=source[key];}if(isObjectLike(srcValue)){stackA||(stackA=[]);stackB||(stackB=[]);baseMergeDeep(object,source,key,baseMerge,customizer,stackA,stackB);}else{var value=object[key],result=customizer?customizer(value,srcValue,key,object,source):undefined,isCommon=result===undefined;if(isCommon){result=srcValue;}if((result!==undefined||isSrcArr&&!(key in object))&&(isCommon||(result===result?result!==value:value===value))){object[key]=result;}}});return object;}module.exports=baseMerge;},{"../lang/isArray":30,"../lang/isObject":33,"../lang/isTypedArray":36,"../object/keys":38,"./arrayEach":9,"./baseMergeDeep":14,"./isArrayLike":21,"./isObjectLike":26}],14:[function(_dereq_,module,exports){var arrayCopy=_dereq_("./arrayCopy"),isArguments=_dereq_("../lang/isArguments"),isArray=_dereq_("../lang/isArray"),isArrayLike=_dereq_("./isArrayLike"),isPlainObject=_dereq_("../lang/isPlainObject"),isTypedArray=_dereq_("../lang/isTypedArray"),toPlainObject=_dereq_("../lang/toPlainObject");function baseMergeDeep(object,source,key,mergeFunc,customizer,stackA,stackB){var length=stackA.length,srcValue=source[key];while(length--){if(stackA[length]==srcValue){object[key]=stackB[length];return;}}var value=object[key],result=customizer?customizer(value,srcValue,key,object,source):undefined,isCommon=result===undefined;if(isCommon){result=srcValue;if(isArrayLike(srcValue)&&(isArray(srcValue)||isTypedArray(srcValue))){result=isArray(value)?value:isArrayLike(value)?arrayCopy(value):[];}else if(isPlainObject(srcValue)||isArguments(srcValue)){result=isArguments(value)?toPlainObject(value):isPlainObject(value)?value:{};}else{isCommon=false;}}stackA.push(srcValue);stackB.push(result);if(isCommon){object[key]=mergeFunc(result,srcValue,customizer,stackA,stackB);}else if(result===result?result!==value:value===value){object[key]=result;}}module.exports=baseMergeDeep;},{"../lang/isArguments":29,"../lang/isArray":30,"../lang/isPlainObject":34,"../lang/isTypedArray":36,"../lang/toPlainObject":37,"./arrayCopy":8,"./isArrayLike":21}],15:[function(_dereq_,module,exports){var toObject=_dereq_("./toObject");function baseProperty(key){return function(object){return object==null?undefined:toObject(object)[key];};}module.exports=baseProperty;},{"./toObject":28}],16:[function(_dereq_,module,exports){var identity=_dereq_("../utility/identity");function bindCallback(func,thisArg,argCount){if(typeof func!="function"){return identity;}if(thisArg===undefined){return func;}switch(argCount){case 1:return function(value){return func.call(thisArg,value);};case 3:return function(value,index,collection){return func.call(thisArg,value,index,collection);};case 4:return function(accumulator,value,index,collection){return func.call(thisArg,accumulator,value,index,collection);};case 5:return function(value,other,key,object,source){return func.call(thisArg,value,other,key,object,source);};}return function(){return func.apply(thisArg,arguments);};}module.exports=bindCallback;},{"../utility/identity":42}],17:[function(_dereq_,module,exports){var bindCallback=_dereq_("./bindCallback"),isIterateeCall=_dereq_("./isIterateeCall"),restParam=_dereq_("../function/restParam");function createAssigner(assigner){return restParam(function(object,sources){var index=-1,length=object==null?0:sources.length,customizer=length>2?sources[length-2]:undefined,guard=length>2?sources[2]:undefined,thisArg=length>1?sources[length-1]:undefined;if(typeof customizer=="function"){customizer=bindCallback(customizer,thisArg,5);length-=2;}else{customizer=typeof thisArg=="function"?thisArg:undefined;length-=customizer?1:0;}if(guard&&isIterateeCall(sources[0],sources[1],guard)){customizer=length<3?undefined:customizer;length=1;}while(++index<length){var source=sources[index];if(source){assigner(object,source,customizer);}}return object;});}module.exports=createAssigner;},{"../function/restParam":6,"./bindCallback":16,"./isIterateeCall":24}],18:[function(_dereq_,module,exports){var toObject=_dereq_("./toObject");function createBaseFor(fromRight){return function(object,iteratee,keysFunc){var iterable=toObject(object),props=keysFunc(object),length=props.length,index=fromRight?length:-1;while(fromRight?index--:++index<length){var key=props[index];if(iteratee(iterable[key],key,iterable)===false){break;}}return object;};}module.exports=createBaseFor;},{"./toObject":28}],19:[function(_dereq_,module,exports){var baseProperty=_dereq_("./baseProperty");var getLength=baseProperty("length");module.exports=getLength;},{"./baseProperty":15}],20:[function(_dereq_,module,exports){var isNative=_dereq_("../lang/isNative");function getNative(object,key){var value=object==null?undefined:object[key];return isNative(value)?value:undefined;}module.exports=getNative;},{"../lang/isNative":32}],21:[function(_dereq_,module,exports){var getLength=_dereq_("./getLength"),isLength=_dereq_("./isLength");function isArrayLike(value){return value!=null&&isLength(getLength(value));}module.exports=isArrayLike;},{"./getLength":19,"./isLength":25}],22:[function(_dereq_,module,exports){var isHostObject=function(){try{Object({toString:0}+"");}catch(e){return function(){return false;};}return function(value){return typeof value.toString!="function"&&typeof(value+"")=="string";};}();module.exports=isHostObject;},{}],23:[function(_dereq_,module,exports){var reIsUint=/^\d+$/;var MAX_SAFE_INTEGER=9007199254740991;function isIndex(value,length){value=typeof value=="number"||reIsUint.test(value)?+value:-1;length=length==null?MAX_SAFE_INTEGER:length;return value>-1&&value%1==0&&value<length;}module.exports=isIndex;},{}],24:[function(_dereq_,module,exports){var isArrayLike=_dereq_("./isArrayLike"),isIndex=_dereq_("./isIndex"),isObject=_dereq_("../lang/isObject");function isIterateeCall(value,index,object){if(!isObject(object)){return false;}var type=typeof index==="undefined"?"undefined":_typeof2(index);if(type=="number"?isArrayLike(object)&&isIndex(index,object.length):type=="string"&&index in object){var other=object[index];return value===value?value===other:other!==other;}return false;}module.exports=isIterateeCall;},{"../lang/isObject":33,"./isArrayLike":21,"./isIndex":23}],25:[function(_dereq_,module,exports){var MAX_SAFE_INTEGER=9007199254740991;function isLength(value){return typeof value=="number"&&value>-1&&value%1==0&&value<=MAX_SAFE_INTEGER;}module.exports=isLength;},{}],26:[function(_dereq_,module,exports){function isObjectLike(value){return!!value&&(typeof value==="undefined"?"undefined":_typeof2(value))=="object";}module.exports=isObjectLike;},{}],27:[function(_dereq_,module,exports){var isArguments=_dereq_("../lang/isArguments"),isArray=_dereq_("../lang/isArray"),isIndex=_dereq_("./isIndex"),isLength=_dereq_("./isLength"),isString=_dereq_("../lang/isString"),keysIn=_dereq_("../object/keysIn");var objectProto=Object.prototype;var hasOwnProperty=objectProto.hasOwnProperty;function shimKeys(object){var props=keysIn(object),propsLength=props.length,length=propsLength&&object.length;var allowIndexes=!!length&&isLength(length)&&(isArray(object)||isArguments(object)||isString(object));var index=-1,result=[];while(++index<propsLength){var key=props[index];if(allowIndexes&&isIndex(key,length)||hasOwnProperty.call(object,key)){result.push(key);}}return result;}module.exports=shimKeys;},{"../lang/isArguments":29,"../lang/isArray":30,"../lang/isString":35,"../object/keysIn":39,"./isIndex":23,"./isLength":25}],28:[function(_dereq_,module,exports){var isObject=_dereq_("../lang/isObject"),isString=_dereq_("../lang/isString"),support=_dereq_("../support");function toObject(value){if(support.unindexedChars&&isString(value)){var index=-1,length=value.length,result=Object(value);while(++index<length){result[index]=value.charAt(index);}return result;}return isObject(value)?value:Object(value);}module.exports=toObject;},{"../lang/isObject":33,"../lang/isString":35,"../support":41}],29:[function(_dereq_,module,exports){var isArrayLike=_dereq_("../internal/isArrayLike"),isObjectLike=_dereq_("../internal/isObjectLike");var objectProto=Object.prototype;var hasOwnProperty=objectProto.hasOwnProperty;var propertyIsEnumerable=objectProto.propertyIsEnumerable;function isArguments(value){return isObjectLike(value)&&isArrayLike(value)&&hasOwnProperty.call(value,"callee")&&!propertyIsEnumerable.call(value,"callee");}module.exports=isArguments;},{"../internal/isArrayLike":21,"../internal/isObjectLike":26}],30:[function(_dereq_,module,exports){var getNative=_dereq_("../internal/getNative"),isLength=_dereq_("../internal/isLength"),isObjectLike=_dereq_("../internal/isObjectLike");var arrayTag="[object Array]";var objectProto=Object.prototype;var objToString=objectProto.toString;var nativeIsArray=getNative(Array,"isArray");var isArray=nativeIsArray||function(value){return isObjectLike(value)&&isLength(value.length)&&objToString.call(value)==arrayTag;};module.exports=isArray;},{"../internal/getNative":20,"../internal/isLength":25,"../internal/isObjectLike":26}],31:[function(_dereq_,module,exports){var isObject=_dereq_("./isObject");var funcTag="[object Function]";var objectProto=Object.prototype;var objToString=objectProto.toString;function isFunction(value){return isObject(value)&&objToString.call(value)==funcTag;}module.exports=isFunction;},{"./isObject":33}],32:[function(_dereq_,module,exports){var isFunction=_dereq_("./isFunction"),isHostObject=_dereq_("../internal/isHostObject"),isObjectLike=_dereq_("../internal/isObjectLike");var reIsHostCtor=/^\[object .+?Constructor\]$/;var objectProto=Object.prototype;var fnToString=Function.prototype.toString;var hasOwnProperty=objectProto.hasOwnProperty;var reIsNative=RegExp("^"+fnToString.call(hasOwnProperty).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function isNative(value){if(value==null){return false;}if(isFunction(value)){return reIsNative.test(fnToString.call(value));}return isObjectLike(value)&&(isHostObject(value)?reIsNative:reIsHostCtor).test(value);}module.exports=isNative;},{"../internal/isHostObject":22,"../internal/isObjectLike":26,"./isFunction":31}],33:[function(_dereq_,module,exports){function isObject(value){var type=typeof value==="undefined"?"undefined":_typeof2(value);return!!value&&(type=="object"||type=="function");}module.exports=isObject;},{}],34:[function(_dereq_,module,exports){var baseForIn=_dereq_("../internal/baseForIn"),isArguments=_dereq_("./isArguments"),isHostObject=_dereq_("../internal/isHostObject"),isObjectLike=_dereq_("../internal/isObjectLike"),support=_dereq_("../support");var objectTag="[object Object]";var objectProto=Object.prototype;var hasOwnProperty=objectProto.hasOwnProperty;var objToString=objectProto.toString;function isPlainObject(value){var Ctor;if(!(isObjectLike(value)&&objToString.call(value)==objectTag&&!isHostObject(value)&&!isArguments(value))||!hasOwnProperty.call(value,"constructor")&&(Ctor=value.constructor,typeof Ctor=="function"&&!(Ctor instanceof Ctor))){return false;}var result;if(support.ownLast){baseForIn(value,function(subValue,key,object){result=hasOwnProperty.call(object,key);return false;});return result!==false;}baseForIn(value,function(subValue,key){result=key;});return result===undefined||hasOwnProperty.call(value,result);}module.exports=isPlainObject;},{"../internal/baseForIn":12,"../internal/isHostObject":22,"../internal/isObjectLike":26,"../support":41,"./isArguments":29}],35:[function(_dereq_,module,exports){var isObjectLike=_dereq_("../internal/isObjectLike");var stringTag="[object String]";var objectProto=Object.prototype;var objToString=objectProto.toString;function isString(value){return typeof value=="string"||isObjectLike(value)&&objToString.call(value)==stringTag;}module.exports=isString;},{"../internal/isObjectLike":26}],36:[function(_dereq_,module,exports){var isLength=_dereq_("../internal/isLength"),isObjectLike=_dereq_("../internal/isObjectLike");var argsTag="[object Arguments]",arrayTag="[object Array]",boolTag="[object Boolean]",dateTag="[object Date]",errorTag="[object Error]",funcTag="[object Function]",mapTag="[object Map]",numberTag="[object Number]",objectTag="[object Object]",regexpTag="[object RegExp]",setTag="[object Set]",stringTag="[object String]",weakMapTag="[object WeakMap]";var arrayBufferTag="[object ArrayBuffer]",float32Tag="[object Float32Array]",float64Tag="[object Float64Array]",int8Tag="[object Int8Array]",int16Tag="[object Int16Array]",int32Tag="[object Int32Array]",uint8Tag="[object Uint8Array]",uint8ClampedTag="[object Uint8ClampedArray]",uint16Tag="[object Uint16Array]",uint32Tag="[object Uint32Array]";var typedArrayTags={};typedArrayTags[float32Tag]=typedArrayTags[float64Tag]=typedArrayTags[int8Tag]=typedArrayTags[int16Tag]=typedArrayTags[int32Tag]=typedArrayTags[uint8Tag]=typedArrayTags[uint8ClampedTag]=typedArrayTags[uint16Tag]=typedArrayTags[uint32Tag]=true;typedArrayTags[argsTag]=typedArrayTags[arrayTag]=typedArrayTags[arrayBufferTag]=typedArrayTags[boolTag]=typedArrayTags[dateTag]=typedArrayTags[errorTag]=typedArrayTags[funcTag]=typedArrayTags[mapTag]=typedArrayTags[numberTag]=typedArrayTags[objectTag]=typedArrayTags[regexpTag]=typedArrayTags[setTag]=typedArrayTags[stringTag]=typedArrayTags[weakMapTag]=false;var objectProto=Object.prototype;var objToString=objectProto.toString;function isTypedArray(value){return isObjectLike(value)&&isLength(value.length)&&!!typedArrayTags[objToString.call(value)];}module.exports=isTypedArray;},{"../internal/isLength":25,"../internal/isObjectLike":26}],37:[function(_dereq_,module,exports){var baseCopy=_dereq_("../internal/baseCopy"),keysIn=_dereq_("../object/keysIn");function toPlainObject(value){return baseCopy(value,keysIn(value));}module.exports=toPlainObject;},{"../internal/baseCopy":10,"../object/keysIn":39}],38:[function(_dereq_,module,exports){var getNative=_dereq_("../internal/getNative"),isArrayLike=_dereq_("../internal/isArrayLike"),isObject=_dereq_("../lang/isObject"),shimKeys=_dereq_("../internal/shimKeys"),support=_dereq_("../support");var nativeKeys=getNative(Object,"keys");var keys=!nativeKeys?shimKeys:function(object){var Ctor=object==null?undefined:object.constructor;if(typeof Ctor=="function"&&Ctor.prototype===object||(typeof object=="function"?support.enumPrototypes:isArrayLike(object))){return shimKeys(object);}return isObject(object)?nativeKeys(object):[];};module.exports=keys;},{"../internal/getNative":20,"../internal/isArrayLike":21,"../internal/shimKeys":27,"../lang/isObject":33,"../support":41}],39:[function(_dereq_,module,exports){var arrayEach=_dereq_("../internal/arrayEach"),isArguments=_dereq_("../lang/isArguments"),isArray=_dereq_("../lang/isArray"),isFunction=_dereq_("../lang/isFunction"),isIndex=_dereq_("../internal/isIndex"),isLength=_dereq_("../internal/isLength"),isObject=_dereq_("../lang/isObject"),isString=_dereq_("../lang/isString"),support=_dereq_("../support");var arrayTag="[object Array]",boolTag="[object Boolean]",dateTag="[object Date]",errorTag="[object Error]",funcTag="[object Function]",numberTag="[object Number]",objectTag="[object Object]",regexpTag="[object RegExp]",stringTag="[object String]";var shadowProps=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"];var errorProto=Error.prototype,objectProto=Object.prototype,stringProto=String.prototype;var hasOwnProperty=objectProto.hasOwnProperty;var objToString=objectProto.toString;var nonEnumProps={};nonEnumProps[arrayTag]=nonEnumProps[dateTag]=nonEnumProps[numberTag]={constructor:true,toLocaleString:true,toString:true,valueOf:true};nonEnumProps[boolTag]=nonEnumProps[stringTag]={constructor:true,toString:true,valueOf:true};nonEnumProps[errorTag]=nonEnumProps[funcTag]=nonEnumProps[regexpTag]={constructor:true,toString:true};nonEnumProps[objectTag]={constructor:true};arrayEach(shadowProps,function(key){for(var tag in nonEnumProps){if(hasOwnProperty.call(nonEnumProps,tag)){var props=nonEnumProps[tag];props[key]=hasOwnProperty.call(props,key);}}});function keysIn(object){if(object==null){return[];}if(!isObject(object)){object=Object(object);}var length=object.length;length=length&&isLength(length)&&(isArray(object)||isArguments(object)||isString(object))&&length||0;var Ctor=object.constructor,index=-1,proto=isFunction(Ctor)&&Ctor.prototype||objectProto,isProto=proto===object,result=Array(length),skipIndexes=length>0,skipErrorProps=support.enumErrorProps&&(object===errorProto||object instanceof Error),skipProto=support.enumPrototypes&&isFunction(object);while(++index<length){result[index]=index+"";}for(var key in object){if(!(skipProto&&key=="prototype")&&!(skipErrorProps&&(key=="message"||key=="name"))&&!(skipIndexes&&isIndex(key,length))&&!(key=="constructor"&&(isProto||!hasOwnProperty.call(object,key)))){result.push(key);}}if(support.nonEnumShadows&&object!==objectProto){var tag=object===stringProto?stringTag:object===errorProto?errorTag:objToString.call(object),nonEnums=nonEnumProps[tag]||nonEnumProps[objectTag];if(tag==objectTag){proto=objectProto;}length=shadowProps.length;while(length--){key=shadowProps[length];var nonEnum=nonEnums[key];if(!(isProto&&nonEnum)&&(nonEnum?hasOwnProperty.call(object,key):object[key]!==proto[key])){result.push(key);}}}return result;}module.exports=keysIn;},{"../internal/arrayEach":9,"../internal/isIndex":23,"../internal/isLength":25,"../lang/isArguments":29,"../lang/isArray":30,"../lang/isFunction":31,"../lang/isObject":33,"../lang/isString":35,"../support":41}],40:[function(_dereq_,module,exports){var baseMerge=_dereq_("../internal/baseMerge"),createAssigner=_dereq_("../internal/createAssigner");var merge=createAssigner(baseMerge);module.exports=merge;},{"../internal/baseMerge":13,"../internal/createAssigner":17}],41:[function(_dereq_,module,exports){var arrayProto=Array.prototype,errorProto=Error.prototype,objectProto=Object.prototype;var propertyIsEnumerable=objectProto.propertyIsEnumerable,splice=arrayProto.splice;var support={};(function(x){var Ctor=function Ctor(){this.x=x;},object={0:x,length:x},props=[];Ctor.prototype={valueOf:x,y:x};for(var key in new Ctor()){props.push(key);}support.enumErrorProps=propertyIsEnumerable.call(errorProto,"message")||propertyIsEnumerable.call(errorProto,"name");support.enumPrototypes=propertyIsEnumerable.call(Ctor,"prototype");support.nonEnumShadows=!/valueOf/.test(props);support.ownLast=props[0]!="x";support.spliceObjects=(splice.call(object,0,1),!object[0]);support.unindexedChars="x"[0]+Object("x")[0]!="xx";})(1,0);module.exports=support;},{}],42:[function(_dereq_,module,exports){function identity(value){return value;}module.exports=identity;},{}],43:[function(_dereq_,module,exports){"use strict";var keys=_dereq_("object-keys");module.exports=function hasSymbols(){if(typeof Symbol!=="function"||typeof Object.getOwnPropertySymbols!=="function"){return false;}if(_typeof2(Symbol.iterator)==="symbol"){return true;}var obj={};var sym=Symbol("test");if(typeof sym==="string"){return false;}var symVal=42;obj[sym]=symVal;for(sym in obj){return false;}if(keys(obj).length!==0){return false;}if(typeof Object.keys==="function"&&Object.keys(obj).length!==0){return false;}if(typeof Object.getOwnPropertyNames==="function"&&Object.getOwnPropertyNames(obj).length!==0){return false;}var syms=Object.getOwnPropertySymbols(obj);if(syms.length!==1||syms[0]!==sym){return false;}if(!Object.prototype.propertyIsEnumerable.call(obj,sym)){return false;}if(typeof Object.getOwnPropertyDescriptor==="function"){var descriptor=Object.getOwnPropertyDescriptor(obj,sym);if(descriptor.value!==symVal||descriptor.enumerable!==true){return false;}}return true;};},{"object-keys":49}],44:[function(_dereq_,module,exports){"use strict";var keys=_dereq_("object-keys");var bind=_dereq_("function-bind");var canBeObject=function canBeObject(obj){return typeof obj!=="undefined"&&obj!==null;};var hasSymbols=_dereq_("./hasSymbols")();var toObject=Object;var push=bind.call(Function.call,Array.prototype.push);var propIsEnumerable=bind.call(Function.call,Object.prototype.propertyIsEnumerable);module.exports=function assign(target,source1){if(!canBeObject(target)){throw new TypeError("target must be an object");}var objTarget=toObject(target);var s,source,i,props,syms,value,key;for(s=1;s<arguments.length;++s){source=toObject(arguments[s]);props=keys(source);if(hasSymbols&&Object.getOwnPropertySymbols){syms=Object.getOwnPropertySymbols(source);for(i=0;i<syms.length;++i){key=syms[i];if(propIsEnumerable(source,key)){push(props,key);}}}for(i=0;i<props.length;++i){key=props[i];value=source[key];if(propIsEnumerable(source,key)){objTarget[key]=value;}}}return objTarget;};},{"./hasSymbols":43,"function-bind":48,"object-keys":49}],45:[function(_dereq_,module,exports){"use strict";var defineProperties=_dereq_("define-properties");var implementation=_dereq_("./implementation");var getPolyfill=_dereq_("./polyfill");var shim=_dereq_("./shim");defineProperties(implementation,{implementation:implementation,getPolyfill:getPolyfill,shim:shim});module.exports=implementation;},{"./implementation":44,"./polyfill":51,"./shim":52,"define-properties":46}],46:[function(_dereq_,module,exports){"use strict";var keys=_dereq_("object-keys");var foreach=_dereq_("foreach");var hasSymbols=typeof Symbol==="function"&&_typeof2(Symbol())==="symbol";var toStr=Object.prototype.toString;var isFunction=function isFunction(fn){return typeof fn==="function"&&toStr.call(fn)==="[object Function]";};var arePropertyDescriptorsSupported=function arePropertyDescriptorsSupported(){var obj={};try{Object.defineProperty(obj,"x",{enumerable:false,value:obj});for(var _ in obj){return false;}return obj.x===obj;}catch(e){return false;}};var supportsDescriptors=Object.defineProperty&&arePropertyDescriptorsSupported();var defineProperty=function defineProperty(object,name,value,predicate){if(name in object&&(!isFunction(predicate)||!predicate())){return;}if(supportsDescriptors){Object.defineProperty(object,name,{configurable:true,enumerable:false,value:value,writable:true});}else{object[name]=value;}};var defineProperties=function defineProperties(object,map){var predicates=arguments.length>2?arguments[2]:{};var props=keys(map);if(hasSymbols){props=props.concat(Object.getOwnPropertySymbols(map));}foreach(props,function(name){defineProperty(object,name,map[name],predicates[name]);});};defineProperties.supportsDescriptors=!!supportsDescriptors;module.exports=defineProperties;},{foreach:47,"object-keys":49}],47:[function(_dereq_,module,exports){var hasOwn=Object.prototype.hasOwnProperty;var toString=Object.prototype.toString;module.exports=function forEach(obj,fn,ctx){if(toString.call(fn)!=="[object Function]"){throw new TypeError("iterator must be a function");}var l=obj.length;if(l===+l){for(var i=0;i<l;i++){fn.call(ctx,obj[i],i,obj);}}else{for(var k in obj){if(hasOwn.call(obj,k)){fn.call(ctx,obj[k],k,obj);}}}};},{}],48:[function(_dereq_,module,exports){var ERROR_MESSAGE="Function.prototype.bind called on incompatible ";var slice=Array.prototype.slice;var toStr=Object.prototype.toString;var funcType="[object Function]";module.exports=function bind(that){var target=this;if(typeof target!=="function"||toStr.call(target)!==funcType){throw new TypeError(ERROR_MESSAGE+target);}var args=slice.call(arguments,1);var binder=function binder(){if(this instanceof bound){var result=target.apply(this,args.concat(slice.call(arguments)));if(Object(result)===result){return result;}return this;}else{return target.apply(that,args.concat(slice.call(arguments)));}};var boundLength=Math.max(0,target.length-args.length);var boundArgs=[];for(var i=0;i<boundLength;i++){boundArgs.push("$"+i);}var bound=Function("binder","return function ("+boundArgs.join(",")+"){ return binder.apply(this,arguments); }")(binder);if(target.prototype){var Empty=function Empty(){};Empty.prototype=target.prototype;bound.prototype=new Empty();Empty.prototype=null;}return bound;};},{}],49:[function(_dereq_,module,exports){"use strict";var has=Object.prototype.hasOwnProperty;var toStr=Object.prototype.toString;var slice=Array.prototype.slice;var isArgs=_dereq_("./isArguments");var hasDontEnumBug=!{toString:null}.propertyIsEnumerable("toString");var hasProtoEnumBug=function(){}.propertyIsEnumerable("prototype");var dontEnums=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];var equalsConstructorPrototype=function equalsConstructorPrototype(o){var ctor=o.constructor;return ctor&&ctor.prototype===o;};var blacklistedKeys={$console:true,$frame:true,$frameElement:true,$frames:true,$parent:true,$self:true,$webkitIndexedDB:true,$webkitStorageInfo:true,$window:true};var hasAutomationEqualityBug=function(){if(typeof window==="undefined"){return false;}for(var k in window){try{if(!blacklistedKeys["$"+k]&&has.call(window,k)&&window[k]!==null&&_typeof2(window[k])==="object"){try{equalsConstructorPrototype(window[k]);}catch(e){return true;}}}catch(e){return true;}}return false;}();var equalsConstructorPrototypeIfNotBuggy=function equalsConstructorPrototypeIfNotBuggy(o){if(typeof window==="undefined"||!hasAutomationEqualityBug){return equalsConstructorPrototype(o);}try{return equalsConstructorPrototype(o);}catch(e){return false;}};var keysShim=function keys(object){var isObject=object!==null&&(typeof object==="undefined"?"undefined":_typeof2(object))==="object";var isFunction=toStr.call(object)==="[object Function]";var isArguments=isArgs(object);var isString=isObject&&toStr.call(object)==="[object String]";var theKeys=[];if(!isObject&&!isFunction&&!isArguments){throw new TypeError("Object.keys called on a non-object");}var skipProto=hasProtoEnumBug&&isFunction;if(isString&&object.length>0&&!has.call(object,0)){for(var i=0;i<object.length;++i){theKeys.push(String(i));}}if(isArguments&&object.length>0){for(var j=0;j<object.length;++j){theKeys.push(String(j));}}else{for(var name in object){if(!(skipProto&&name==="prototype")&&has.call(object,name)){theKeys.push(String(name));}}}if(hasDontEnumBug){var skipConstructor=equalsConstructorPrototypeIfNotBuggy(object);for(var k=0;k<dontEnums.length;++k){if(!(skipConstructor&&dontEnums[k]==="constructor")&&has.call(object,dontEnums[k])){theKeys.push(dontEnums[k]);}}}return theKeys;};keysShim.shim=function shimObjectKeys(){if(Object.keys){var keysWorksWithArguments=function(){return(Object.keys(arguments)||"").length===2;}(1,2);if(!keysWorksWithArguments){var originalKeys=Object.keys;Object.keys=function keys(object){if(isArgs(object)){return originalKeys(slice.call(object));}else{return originalKeys(object);}};}}else{Object.keys=keysShim;}return Object.keys||keysShim;};module.exports=keysShim;},{"./isArguments":50}],50:[function(_dereq_,module,exports){"use strict";var toStr=Object.prototype.toString;module.exports=function isArguments(value){var str=toStr.call(value);var isArgs=str==="[object Arguments]";if(!isArgs){isArgs=str!=="[object Array]"&&value!==null&&(typeof value==="undefined"?"undefined":_typeof2(value))==="object"&&typeof value.length==="number"&&value.length>=0&&toStr.call(value.callee)==="[object Function]";}return isArgs;};},{}],51:[function(_dereq_,module,exports){"use strict";var implementation=_dereq_("./implementation");var lacksProperEnumerationOrder=function lacksProperEnumerationOrder(){if(!Object.assign){return false;}var str="abcdefghijklmnopqrst";var letters=str.split("");var map={};for(var i=0;i<letters.length;++i){map[letters[i]]=letters[i];}var obj=Object.assign({},map);var actual="";for(var k in obj){actual+=k;}return str!==actual;};var assignHasPendingExceptions=function assignHasPendingExceptions(){if(!Object.assign||!Object.preventExtensions){return false;}var thrower=Object.preventExtensions({1:2});try{Object.assign(thrower,"xy");}catch(e){return thrower[1]==="y";}};module.exports=function getPolyfill(){if(!Object.assign){return implementation;}if(lacksProperEnumerationOrder()){return implementation;}if(assignHasPendingExceptions()){return implementation;}return Object.assign;};},{"./implementation":44}],52:[function(_dereq_,module,exports){"use strict";var define=_dereq_("define-properties");var getPolyfill=_dereq_("./polyfill");module.exports=function shimAssign(){var polyfill=getPolyfill();define(Object,{assign:polyfill},{assign:function assign(){return Object.assign!==polyfill;}});return polyfill;};},{"./polyfill":51,"define-properties":46}],53:[function(_dereq_,module,exports){module.exports=SafeParseTuple;function SafeParseTuple(obj,reviver){var json;var error=null;try{json=JSON.parse(obj,reviver);}catch(err){error=err;}return[error,json];}},{}],54:[function(_dereq_,module,exports){function clean(s){return s.replace(/\n\r?\s*/g,"");}module.exports=function tsml(sa){var s="",i=0;for(;i<arguments.length;i++){s+=clean(sa[i])+(arguments[i+1]||"");}return s;};},{}],55:[function(_dereq_,module,exports){"use strict";var window=_dereq_("global/window");var once=_dereq_("once");var isFunction=_dereq_("is-function");var parseHeaders=_dereq_("parse-headers");var xtend=_dereq_("xtend");module.exports=createXHR;createXHR.XMLHttpRequest=window.XMLHttpRequest||noop;createXHR.XDomainRequest="withCredentials"in new createXHR.XMLHttpRequest()?createXHR.XMLHttpRequest:window.XDomainRequest;forEachArray(["get","put","post","patch","head","delete"],function(method){createXHR[method==="delete"?"del":method]=function(uri,options,callback){options=initParams(uri,options,callback);options.method=method.toUpperCase();return _createXHR(options);};});function forEachArray(array,iterator){for(var i=0;i<array.length;i++){iterator(array[i]);}}function isEmpty(obj){for(var i in obj){if(obj.hasOwnProperty(i))return false;}return true;}function initParams(uri,options,callback){var params=uri;if(isFunction(options)){callback=options;if(typeof uri==="string"){params={uri:uri};}}else{params=xtend(options,{uri:uri});}params.callback=callback;return params;}function createXHR(uri,options,callback){options=initParams(uri,options,callback);return _createXHR(options);}function _createXHR(options){var callback=options.callback;if(typeof callback==="undefined"){throw new Error("callback argument missing");}callback=once(callback);function readystatechange(){if(xhr.readyState===4){loadFunc();}}function getBody(){var body=undefined;if(xhr.response){body=xhr.response;}else if(xhr.responseType==="text"||!xhr.responseType){body=xhr.responseText||xhr.responseXML;}if(isJson){try{body=JSON.parse(body);}catch(e){}}return body;}var failureResponse={body:undefined,headers:{},statusCode:0,method:method,url:uri,rawRequest:xhr};function errorFunc(evt){clearTimeout(timeoutTimer);if(!(evt instanceof Error)){evt=new Error(""+(evt||"Unknown XMLHttpRequest Error"));}evt.statusCode=0;callback(evt,failureResponse);}function loadFunc(){if(aborted)return;var status;clearTimeout(timeoutTimer);if(options.useXDR&&xhr.status===undefined){status=200;}else{status=xhr.status===1223?204:xhr.status;}var response=failureResponse;var err=null;if(status!==0){response={body:getBody(),statusCode:status,method:method,headers:{},url:uri,rawRequest:xhr};if(xhr.getAllResponseHeaders){response.headers=parseHeaders(xhr.getAllResponseHeaders());}}else{err=new Error("Internal XMLHttpRequest Error");}callback(err,response,response.body);}var xhr=options.xhr||null;if(!xhr){if(options.cors||options.useXDR){xhr=new createXHR.XDomainRequest();}else{xhr=new createXHR.XMLHttpRequest();}}var key;var aborted;var uri=xhr.url=options.uri||options.url;var method=xhr.method=options.method||"GET";var body=options.body||options.data||null;var headers=xhr.headers=options.headers||{};var sync=!!options.sync;var isJson=false;var timeoutTimer;if("json"in options){isJson=true;headers["accept"]||headers["Accept"]||(headers["Accept"]="application/json");if(method!=="GET"&&method!=="HEAD"){headers["content-type"]||headers["Content-Type"]||(headers["Content-Type"]="application/json");body=JSON.stringify(options.json);}}xhr.onreadystatechange=readystatechange;xhr.onload=loadFunc;xhr.onerror=errorFunc;xhr.onprogress=function(){};xhr.ontimeout=errorFunc;xhr.open(method,uri,!sync,options.username,options.password);if(!sync){xhr.withCredentials=!!options.withCredentials;}if(!sync&&options.timeout>0){timeoutTimer=setTimeout(function(){aborted=true;xhr.abort("timeout");var e=new Error("XMLHttpRequest timeout");e.code="ETIMEDOUT";errorFunc(e);},options.timeout);}if(xhr.setRequestHeader){for(key in headers){if(headers.hasOwnProperty(key)){xhr.setRequestHeader(key,headers[key]);}}}else if(options.headers&&!isEmpty(options.headers)){throw new Error("Headers cannot be set on an XDomainRequest object");}if("responseType"in options){xhr.responseType=options.responseType;}if("beforeSend"in options&&typeof options.beforeSend==="function"){options.beforeSend(xhr);}xhr.send(body);return xhr;}function noop(){}},{"global/window":2,"is-function":56,once:57,"parse-headers":60,xtend:61}],56:[function(_dereq_,module,exports){module.exports=isFunction;var toString=Object.prototype.toString;function isFunction(fn){var string=toString.call(fn);return string==="[object Function]"||typeof fn==="function"&&string!=="[object RegExp]"||typeof window!=="undefined"&&(fn===window.setTimeout||fn===window.alert||fn===window.confirm||fn===window.prompt);}},{}],57:[function(_dereq_,module,exports){module.exports=once;once.proto=once(function(){Object.defineProperty(Function.prototype,"once",{value:function value(){return once(this);},configurable:true});});function once(fn){var called=false;return function(){if(called)return;called=true;return fn.apply(this,arguments);};}},{}],58:[function(_dereq_,module,exports){var isFunction=_dereq_("is-function");module.exports=forEach;var toString=Object.prototype.toString;var hasOwnProperty=Object.prototype.hasOwnProperty;function forEach(list,iterator,context){if(!isFunction(iterator)){throw new TypeError("iterator must be a function");}if(arguments.length<3){context=this;}if(toString.call(list)==="[object Array]")forEachArray(list,iterator,context);else if(typeof list==="string")forEachString(list,iterator,context);else forEachObject(list,iterator,context);}function forEachArray(array,iterator,context){for(var i=0,len=array.length;i<len;i++){if(hasOwnProperty.call(array,i)){iterator.call(context,array[i],i,array);}}}function forEachString(string,iterator,context){for(var i=0,len=string.length;i<len;i++){iterator.call(context,string.charAt(i),i,string);}}function forEachObject(object,iterator,context){for(var k in object){if(hasOwnProperty.call(object,k)){iterator.call(context,object[k],k,object);}}}},{"is-function":56}],59:[function(_dereq_,module,exports){exports=module.exports=trim;function trim(str){return str.replace(/^\s*|\s*$/g,"");}exports.left=function(str){return str.replace(/^\s*/,"");};exports.right=function(str){return str.replace(/\s*$/,"");};},{}],60:[function(_dereq_,module,exports){var trim=_dereq_("trim"),forEach=_dereq_("for-each"),isArray=function isArray(arg){return Object.prototype.toString.call(arg)==="[object Array]";};module.exports=function(headers){if(!headers)return{};var result={};forEach(trim(headers).split("\n"),function(row){var index=row.indexOf(":"),key=trim(row.slice(0,index)).toLowerCase(),value=trim(row.slice(index+1));if(typeof result[key]==="undefined"){result[key]=value;}else if(isArray(result[key])){result[key].push(value);}else{result[key]=[result[key],value];}});return result;};},{"for-each":58,trim:59}],61:[function(_dereq_,module,exports){module.exports=extend;var hasOwnProperty=Object.prototype.hasOwnProperty;function extend(){var target={};for(var i=0;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(hasOwnProperty.call(source,key)){target[key]=source[key];}}}return target;}},{}],62:[function(_dereq_,module,exports){"use strict";exports.__esModule=true;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var _buttonJs=_dereq_("./button.js");var _buttonJs2=_interopRequireDefault(_buttonJs);var _componentJs=_dereq_("./component.js");var _componentJs2=_interopRequireDefault(_componentJs);var BigPlayButton=function(_Button){_inherits(BigPlayButton,_Button);function BigPlayButton(player,options){_classCallCheck(this,BigPlayButton);_Button.call(this,player,options);}BigPlayButton.prototype.buildCSSClass=function buildCSSClass(){return"vjs-big-play-button";};BigPlayButton.prototype.handleClick=function handleClick(){this.player_.play();};return BigPlayButton;}(_buttonJs2["default"]);BigPlayButton.prototype.controlText_="Play Video";_componentJs2["default"].registerComponent("BigPlayButton",BigPlayButton);exports["default"]=BigPlayButton;module.exports=exports["default"];},{"./button.js":63,"./component.js":65}],63:[function(_dereq_,module,exports){"use strict";exports.__esModule=true;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var _component=_dereq_("./component");var _component2=_interopRequireDefault(_component);var _utilsDomJs=_dereq_("./utils/dom.js");var Dom=_interopRequireWildcard(_utilsDomJs);var _utilsEventsJs=_dereq_("./utils/events.js");var Events=_interopRequireWildcard(_utilsEventsJs);var _utilsFnJs=_dereq_("./utils/fn.js");var Fn=_interopRequireWildcard(_utilsFnJs);var _globalDocument=_dereq_("global/document");var _globalDocument2=_interopRequireDefault(_globalDocument);var _objectAssign=_dereq_("object.assign");var _objectAssign2=_interopRequireDefault(_objectAssign);var Button=function(_Component){_inherits(Button,_Component);function Button(player,options){_classCallCheck(this,Button);_Component.call(this,player,options);this.emitTapEvents();this.on("tap",this.handleClick);this.on("click",this.handleClick);this.on("focus",this.handleFocus);this.on("blur",this.handleBlur);}Button.prototype.createEl=function createEl(){var tag=arguments.length<=0||arguments[0]===undefined?"button":arguments[0];var props=arguments.length<=1||arguments[1]===undefined?{}:arguments[1];var attributes=arguments.length<=2||arguments[2]===undefined?{}:arguments[2];props=_objectAssign2["default"]({className:this.buildCSSClass(),tabIndex:0},props);attributes=_objectAssign2["default"]({role:"button",type:"button","aria-live":"polite"},attributes);var el=_Component.prototype.createEl.call(this,tag,props,attributes);this.controlTextEl_=Dom.createEl("span",{className:"vjs-control-text"});el.appendChild(this.controlTextEl_);this.controlText(this.controlText_);return el;};Button.prototype.controlText=function controlText(text){if(!text)return this.controlText_||"Need Text";this.controlText_=text;this.controlTextEl_.innerHTML=this.localize(this.controlText_);return this;};Button.prototype.buildCSSClass=function buildCSSClass(){return"vjs-control vjs-button "+_Component.prototype.buildCSSClass.call(this);};Button.prototype.handleClick=function handleClick(){};Button.prototype.handleFocus=function handleFocus(){Events.on(_globalDocument2["default"],"keydown",Fn.bind(this,this.handleKeyPress));};Button.prototype.handleKeyPress=function handleKeyPress(event){if(event.which===32||event.which===13){event.preventDefault();this.handleClick(event);}};Button.prototype.handleBlur=function handleBlur(){Events.off(_globalDocument2["default"],"keydown",Fn.bind(this,this.handleKeyPress));};return Button;}(_component2["default"]);_component2["default"].registerComponent("Button",Button);exports["default"]=Button;module.exports=exports["default"];},{"./component":65,"./utils/dom.js":126,"./utils/events.js":127,"./utils/fn.js":128,"global/document":1,"object.assign":45}],64:[function(_dereq_,module,exports){"use strict";exports.__esModule=true;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var _button=_dereq_("./button");var _button2=_interopRequireDefault(_button);var _component=_dereq_("./component");var _component2=_interopRequireDefault(_component);var CloseButton=function(_Button){_inherits(CloseButton,_Button);function CloseButton(player,options){_classCallCheck(this,CloseButton);_Button.call(this,player,options);this.controlText(options&&options.controlText||this.localize("Close"));}CloseButton.prototype.buildCSSClass=function buildCSSClass(){return"vjs-close-button "+_Button.prototype.buildCSSClass.call(this);};CloseButton.prototype.handleClick=function handleClick(){this.trigger({type:"close",bubbles:false});};return CloseButton;}(_button2["default"]);_component2["default"].registerComponent("CloseButton",CloseButton);exports["default"]=CloseButton;module.exports=exports["default"];},{"./button":63,"./component":65}],65:[function(_dereq_,module,exports){"use strict";exports.__esModule=true;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}var _globalWindow=_dereq_("global/window");var _globalWindow2=_interopRequireDefault(_globalWindow);var _utilsDomJs=_dereq_("./utils/dom.js");var Dom=_interopRequireWildcard(_utilsDomJs);var _utilsFnJs=_dereq_("./utils/fn.js");var Fn=_interopRequireWildcard(_utilsFnJs);var _utilsGuidJs=_dereq_("./utils/guid.js");var Guid=_interopRequireWildcard(_utilsGuidJs);var _utilsEventsJs=_dereq_("./utils/events.js");var Events=_interopRequireWildcard(_utilsEventsJs);var _utilsLogJs=_dereq_("./utils/log.js");var _utilsLogJs2=_interopRequireDefault(_utilsLogJs);var _utilsToTitleCaseJs=_dereq_("./utils/to-title-case.js");var _utilsToTitleCaseJs2=_interopRequireDefault(_utilsToTitleCaseJs);var _objectAssign=_dereq_("object.assign");var _objectAssign2=_interopRequireDefault(_objectAssign);var _utilsMergeOptionsJs=_dereq_("./utils/merge-options.js");var _utilsMergeOptionsJs2=_interopRequireDefault(_utilsMergeOptionsJs);var Component=function(){function Component(player,options,ready){_classCallCheck(this,Component);if(!player&&this.play){this.player_=player=this;}else{this.player_=player;}this.options_=_utilsMergeOptionsJs2["default"]({},this.options_);options=this.options_=_utilsMergeOptionsJs2["default"](this.options_,options);this.id_=options.id||options.el&&options.el.id;if(!this.id_){var id=player&&player.id&&player.id()||"no_player";this.id_=id+"_component_"+Guid.newGUID();}this.name_=options.name||null;if(options.el){this.el_=options.el;}else if(options.createEl!==false){this.el_=this.createEl();}this.children_=[];this.childIndex_={};this.childNameIndex_={};if(options.initChildren!==false){this.initChildren();}this.ready(ready);if(options.reportTouchActivity!==false){this.enableTouchActivity();}}Component.prototype.dispose=function dispose(){this.trigger({type:"dispose",bubbles:false});if(this.children_){for(var i=this.children_.length-1;i>=0;i--){if(this.children_[i].dispose){this.children_[i].dispose();}}}this.children_=null;this.childIndex_=null;this.childNameIndex_=null;this.off();if(this.el_.parentNode){this.el_.parentNode.removeChild(this.el_);}Dom.removeElData(this.el_);this.el_=null;};Component.prototype.player=function player(){return this.player_;};Component.prototype.options=function options(obj){_utilsLogJs2["default"].warn("this.options() has been deprecated and will be moved to the constructor in 6.0");if(!obj){return this.options_;}this.options_=_utilsMergeOptionsJs2["default"](this.options_,obj);return this.options_;};Component.prototype.el=function el(){return this.el_;};Component.prototype.createEl=function createEl(tagName,properties,attributes){return Dom.createEl(tagName,properties,attributes);};Component.prototype.localize=function localize(string){var code=this.player_.language&&this.player_.language();var languages=this.player_.languages&&this.player_.languages();if(!code||!languages){return string;}var language=languages[code];if(language&&language[string]){return language[string];}var primaryCode=code.split("-")[0];var primaryLang=languages[primaryCode];if(primaryLang&&primaryLang[string]){return primaryLang[string];}return string;};Component.prototype.contentEl=function contentEl(){return this.contentEl_||this.el_;};Component.prototype.id=function id(){return this.id_;};Component.prototype.name=function name(){return this.name_;};Component.prototype.children=function children(){return this.children_;};Component.prototype.getChildById=function getChildById(id){return this.childIndex_[id];};Component.prototype.getChild=function getChild(name){return this.childNameIndex_[name];};Component.prototype.addChild=function addChild(child){var options=arguments.length<=1||arguments[1]===undefined?{}:arguments[1];var component=undefined;var componentName=undefined;if(typeof child==="string"){componentName=child;if(!options){options={};}if(options===true){_utilsLogJs2["default"].warn("Initializing a child component with `true` is deprecated. Children should be defined in an array when possible, but if necessary use an object instead of `true`.");options={};}var componentClassName=options.componentClass||_utilsToTitleCaseJs2["default"](componentName);options.name=componentName;var ComponentClass=Component.getComponent(componentClassName);if(!ComponentClass){throw new Error("Component "+componentClassName+" does not exist");}if(typeof ComponentClass!=="function"){return null;}component=new ComponentClass(this.player_||this,options);}else{component=child;}this.children_.push(component);if(typeof component.id==="function"){this.childIndex_[component.id()]=component;}componentName=componentName||component.name&&component.name();if(componentName){this.childNameIndex_[componentName]=component;}if(typeof component.el==="function"&&component.el()){this.contentEl().appendChild(component.el());}return component;};Component.prototype.removeChild=function removeChild(component){if(typeof component==="string"){component=this.getChild(component);}if(!component||!this.children_){return;}var childFound=false;for(var i=this.children_.length-1;i>=0;i--){if(this.children_[i]===component){childFound=true;this.children_.splice(i,1);break;}}if(!childFound){return;}this.childIndex_[component.id()]=null;this.childNameIndex_[component.name()]=null;var compEl=component.el();if(compEl&&compEl.parentNode===this.contentEl()){this.contentEl().removeChild(component.el());}};Component.prototype.initChildren=function initChildren(){var _this=this;var children=this.options_.children;if(children){(function(){var parentOptions=_this.options_;var handleAdd=function handleAdd(child){var name=child.name;var opts=child.opts;if(parentOptions[name]!==undefined){opts=parentOptions[name];}if(opts===false){return;}if(opts===true){opts={};}opts.playerOptions=_this.options_.playerOptions;var newChild=_this.addChild(name,opts);if(newChild){_this[name]=newChild;}};var workingChildren=undefined;var Tech=Component.getComponent("Tech");if(Array.isArray(children)){workingChildren=children;}else{workingChildren=Object.keys(children);}workingChildren.concat(Object.keys(_this.options_).filter(function(child){return!workingChildren.some(function(wchild){if(typeof wchild==="string"){return child===wchild;}else{return child===wchild.name;}});})).map(function(child){var name=undefined,opts=undefined;if(typeof child==="string"){name=child;opts=children[name]||_this.options_[name]||{};}else{name=child.name;opts=child;}return{name:name,opts:opts};}).filter(function(child){var c=Component.getComponent(child.opts.componentClass||_utilsToTitleCaseJs2["default"](child.name));return c&&!Tech.isTech(c);}).forEach(handleAdd);})();}};Component.prototype.buildCSSClass=function buildCSSClass(){return"";};Component.prototype.on=function on(first,second,third){var _this2=this;if(typeof first==="string"||Array.isArray(first)){Events.on(this.el_,first,Fn.bind(this,second));}else{(function(){var target=first;var type=second;var fn=Fn.bind(_this2,third);var removeOnDispose=function removeOnDispose(){return _this2.off(target,type,fn);};removeOnDispose.guid=fn.guid;_this2.on("dispose",removeOnDispose);var cleanRemover=function cleanRemover(){return _this2.off("dispose",removeOnDispose);};cleanRemover.guid=fn.guid;if(first.nodeName){Events.on(target,type,fn);Events.on(target,"dispose",cleanRemover);}else if(typeof first.on==="function"){target.on(type,fn);target.on("dispose",cleanRemover);}})();}return this;};Component.prototype.off=function off(first,second,third){if(!first||typeof first==="string"||Array.isArray(first)){Events.off(this.el_,first,second);}else{var target=first;var type=second;var fn=Fn.bind(this,third);this.off("dispose",fn);if(first.nodeName){Events.off(target,type,fn);Events.off(target,"dispose",fn);}else{target.off(type,fn);target.off("dispose",fn);}}return this;};Component.prototype.one=function one(first,second,third){var _this3=this,_arguments=arguments;if(typeof first==="string"||Array.isArray(first)){Events.one(this.el_,first,Fn.bind(this,second));}else{(function(){var target=first;var type=second;var fn=Fn.bind(_this3,third);var newFunc=function newFunc(){_this3.off(target,type,newFunc);fn.apply(null,_arguments);};newFunc.guid=fn.guid;_this3.on(target,type,newFunc);})();}return this;};Component.prototype.trigger=function trigger(event,hash){Events.trigger(this.el_,event,hash);return this;};Component.prototype.ready=function ready(fn){var sync=arguments.length<=1||arguments[1]===undefined?false:arguments[1];if(fn){if(this.isReady_){if(sync){fn.call(this);}else{this.setTimeout(fn,1);}}else{this.readyQueue_=this.readyQueue_||[];this.readyQueue_.push(fn);}}return this;};Component.prototype.triggerReady=function triggerReady(){this.isReady_=true;this.setTimeout(function(){var readyQueue=this.readyQueue_;this.readyQueue_=[];if(readyQueue&&readyQueue.length>0){readyQueue.forEach(function(fn){fn.call(this);},this);}this.trigger("ready");},1);};Component.prototype.$=function $(selector,context){return Dom.$(selector,context||this.contentEl());};Component.prototype.$$=function $$(selector,context){return Dom.$$(selector,context||this.contentEl());};Component.prototype.hasClass=function hasClass(classToCheck){return Dom.hasElClass(this.el_,classToCheck);};Component.prototype.addClass=function addClass(classToAdd){Dom.addElClass(this.el_,classToAdd);return this;};Component.prototype.removeClass=function removeClass(classToRemove){Dom.removeElClass(this.el_,classToRemove);return this;};Component.prototype.toggleClass=function toggleClass(classToToggle,predicate){Dom.toggleElClass(this.el_,classToToggle,predicate);return this;};Component.prototype.show=function show(){this.removeClass("vjs-hidden");return this;};Component.prototype.hide=function hide(){this.addClass("vjs-hidden");return this;};Component.prototype.lockShowing=function lockShowing(){this.addClass("vjs-lock-showing");return this;};Component.prototype.unlockShowing=function unlockShowing(){this.removeClass("vjs-lock-showing");return this;};Component.prototype.width=function width(num,skipListeners){return this.dimension("width",num,skipListeners);};Component.prototype.height=function height(num,skipListeners){return this.dimension("height",num,skipListeners);};Component.prototype.dimensions=function dimensions(width,height){return this.width(width,true).height(height);};Component.prototype.dimension=function dimension(widthOrHeight,num,skipListeners){if(num!==undefined){if(num===null||num!==num){num=0;}if((""+num).indexOf("%")!==-1||(""+num).indexOf("px")!==-1){this.el_.style[widthOrHeight]=num;}else if(num==="auto"){this.el_.style[widthOrHeight]="";}else{this.el_.style[widthOrHeight]=num+"px";}if(!skipListeners){this.trigger("resize");}return this;}if(!this.el_){return 0;}var val=this.el_.style[widthOrHeight];var pxIndex=val.indexOf("px");if(pxIndex!==-1){return parseInt(val.slice(0,pxIndex),10);}return parseInt(this.el_["offset"+_utilsToTitleCaseJs2["default"](widthOrHeight)],10);};Component.prototype.emitTapEvents=function emitTapEvents(){var touchStart=0;var firstTouch=null;var tapMovementThreshold=10;var touchTimeThreshold=200;var couldBeTap=undefined;this.on("touchstart",function(event){if(event.touches.length===1){firstTouch=_objectAssign2["default"]({},event.touches[0]);touchStart=new Date().getTime();couldBeTap=true;}});this.on("touchmove",function(event){if(event.touches.length>1){couldBeTap=false;}else if(firstTouch){var xdiff=event.touches[0].pageX-firstTouch.pageX;var ydiff=event.touches[0].pageY-firstTouch.pageY;var touchDistance=Math.sqrt(xdiff*xdiff+ydiff*ydiff);if(touchDistance>tapMovementThreshold){couldBeTap=false;}}});var noTap=function noTap(){couldBeTap=false;};this.on("touchleave",noTap);this.on("touchcancel",noTap);this.on("touchend",function(event){firstTouch=null;if(couldBeTap===true){var touchTime=new Date().getTime()-touchStart;if(touchTime<touchTimeThreshold){event.preventDefault();this.trigger("tap");}}});};Component.prototype.enableTouchActivity=function enableTouchActivity(){if(!this.player()||!this.player().reportUserActivity){return;}var report=Fn.bind(this.player(),this.player().reportUserActivity);var touchHolding=undefined;this.on("touchstart",function(){report();this.clearInterval(touchHolding);touchHolding=this.setInterval(report,250);});var touchEnd=function touchEnd(event){report();this.clearInterval(touchHolding);};this.on("touchmove",report);this.on("touchend",touchEnd);this.on("touchcancel",touchEnd);};Component.prototype.setTimeout=function setTimeout(fn,timeout){fn=Fn.bind(this,fn);var timeoutId=_globalWindow2["default"].setTimeout(fn,timeout);var disposeFn=function disposeFn(){this.clearTimeout(timeoutId);};disposeFn.guid="vjs-timeout-"+timeoutId;this.on("dispose",disposeFn);return timeoutId;};Component.prototype.clearTimeout=function clearTimeout(timeoutId){_globalWindow2["default"].clearTimeout(timeoutId);var disposeFn=function disposeFn(){};disposeFn.guid="vjs-timeout-"+timeoutId;this.off("dispose",disposeFn);return timeoutId;};Component.prototype.setInterval=function setInterval(fn,interval){fn=Fn.bind(this,fn);var intervalId=_globalWindow2["default"].setInterval(fn,interval);var disposeFn=function disposeFn(){this.clearInterval(intervalId);};disposeFn.guid="vjs-interval-"+intervalId;this.on("dispose",disposeFn);return intervalId;};Component.prototype.clearInterval=function clearInterval(intervalId){_globalWindow2["default"].clearInterval(intervalId);var disposeFn=function disposeFn(){};disposeFn.guid="vjs-interval-"+intervalId;this.off("dispose",disposeFn);return intervalId;};Component.registerComponent=function registerComponent(name,comp){if(!Component.components_){Component.components_={};}Component.components_[name]=comp;return comp;};Component.getComponent=function getComponent(name){if(Component.components_&&Component.components_[name]){return Component.components_[name];}if(_globalWindow2["default"]&&_globalWindow2["default"].videojs&&_globalWindow2["default"].videojs[name]){_utilsLogJs2["default"].warn("The "+name+" component was added to the videojs object when it should be registered using videojs.registerComponent(name, component)");return _globalWindow2["default"].videojs[name];}};Component.extend=function extend(props){props=props||{};_utilsLogJs2["default"].warn("Component.extend({}) has been deprecated, use videojs.extend(Component, {}) instead");var init=props.init||props.init||this.prototype.init||this.prototype.init||function(){};var subObj=function subObj(){init.apply(this,arguments);};subObj.prototype=Object.create(this.prototype);subObj.prototype.constructor=subObj;subObj.extend=Component.extend;for(var _name in props){if(props.hasOwnProperty(_name)){subObj.prototype[_name]=props[_name];}}return subObj;};return Component;}();Component.registerComponent("Component",Component);exports["default"]=Component;module.exports=exports["default"];},{"./utils/dom.js":126,"./utils/events.js":127,"./utils/fn.js":128,"./utils/guid.js":130,"./utils/log.js":131,"./utils/merge-options.js":132,"./utils/to-title-case.js":135,"global/window":2,"object.assign":45}],66:[function(_dereq_,module,exports){"use strict";exports.__esModule=true;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var _componentJs=_dereq_("../component.js");var _componentJs2=_interopRequireDefault(_componentJs);var _playToggleJs=_dereq_("./play-toggle.js");var _playToggleJs2=_interopRequireDefault(_playToggleJs);var _timeControlsCurrentTimeDisplayJs=_dereq_("./time-controls/current-time-display.js");var _timeControlsCurrentTimeDisplayJs2=_interopRequireDefault(_timeControlsCurrentTimeDisplayJs);var _timeControlsDurationDisplayJs=_dereq_("./time-controls/duration-display.js");var _timeControlsDurationDisplayJs2=_interopRequireDefault(_timeControlsDurationDisplayJs);var _timeControlsTimeDividerJs=_dereq_("./time-controls/time-divider.js");var _timeControlsTimeDividerJs2=_interopRequireDefault(_timeControlsTimeDividerJs);var _timeControlsRemainingTimeDisplayJs=_dereq_("./time-controls/remaining-time-display.js");var _timeControlsRemainingTimeDisplayJs2=_interopRequireDefault(_timeControlsRemainingTimeDisplayJs);var _liveDisplayJs=_dereq_("./live-display.js");var _liveDisplayJs2=_interopRequireDefault(_liveDisplayJs);var _progressControlProgressControlJs=_dereq_("./progress-control/progress-control.js");var _progressControlProgressControlJs2=_interopRequireDefault(_progressControlProgressControlJs);var _fullscreenToggleJs=_dereq_("./fullscreen-toggle.js");var _fullscreenToggleJs2=_interopRequireDefault(_fullscreenToggleJs);var _volumeControlVolumeControlJs=_dereq_("./volume-control/volume-control.js");var _volumeControlVolumeControlJs2=_interopRequireDefault(_volumeControlVolumeControlJs);var _volumeMenuButtonJs=_dereq_("./volume-menu-button.js");var _volumeMenuButtonJs2=_interopRequireDefault(_volumeMenuButtonJs);var _muteToggleJs=_dereq_("./mute-toggle.js");var _muteToggleJs2=_interopRequireDefault(_muteToggleJs);var _textTrackControlsChaptersButtonJs=_dereq_("./text-track-controls/chapters-button.js");var _textTrackControlsChaptersButtonJs2=_interopRequireDefault(_textTrackControlsChaptersButtonJs);var _textTrackControlsSubtitlesButtonJs=_dereq_("./text-track-controls/subtitles-button.js");var _textTrackControlsSubtitlesButtonJs2=_interopRequireDefault(_textTrackControlsSubtitlesButtonJs);var _textTrackControlsCaptionsButtonJs=_dereq_("./text-track-controls/captions-button.js");var _textTrackControlsCaptionsButtonJs2=_interopRequireDefault(_textTrackControlsCaptionsButtonJs);var _playbackRateMenuPlaybackRateMenuButtonJs=_dereq_("./playback-rate-menu/playback-rate-menu-button.js");var _playbackRateMenuPlaybackRateMenuButtonJs2=_interopRequireDefault(_playbackRateMenuPlaybackRateMenuButtonJs);var _spacerControlsCustomControlSpacerJs=_dereq_("./spacer-controls/custom-control-spacer.js");var _spacerControlsCustomControlSpacerJs2=_interopRequireDefault(_spacerControlsCustomControlSpacerJs);var ControlBar=function(_Component){_inherits(ControlBar,_Component);function ControlBar(){_classCallCheck(this,ControlBar);_Component.apply(this,arguments);}ControlBar.prototype.createEl=function createEl(){return _Component.prototype.createEl.call(this,"div",{className:"vjs-control-bar"});};return ControlBar;}(_componentJs2["default"]);ControlBar.prototype.options_={loadEvent:"play",children:["playToggle","volumeMenuButton","currentTimeDisplay","timeDivider","durationDisplay","progressControl","liveDisplay","remainingTimeDisplay","customControlSpacer","playbackRateMenuButton","chaptersButton","subtitlesButton","captionsButton","fullscreenToggle"]};_componentJs2["default"].registerComponent("ControlBar",ControlBar);exports["default"]=ControlBar;module.exports=exports["default"];},{"../component.js":65,"./fullscreen-toggle.js":67,"./live-display.js":68,"./mute-toggle.js":69,"./play-toggle.js":70,"./playback-rate-menu/playback-rate-menu-button.js":71,"./progress-control/progress-control.js":76,"./spacer-controls/custom-control-spacer.js":78,"./text-track-controls/captions-button.js":81,"./text-track-controls/chapters-button.js":82,"./text-track-controls/subtitles-button.js":85,"./time-controls/current-time-display.js":88,"./time-controls/duration-display.js":89,"./time-controls/remaining-time-display.js":90,"./time-controls/time-divider.js":91,"./volume-control/volume-control.js":93,"./volume-menu-button.js":95}],67:[function(_dereq_,module,exports){"use strict";exports.__esModule=true;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var _buttonJs=_dereq_("../button.js");var _buttonJs2=_interopRequireDefault(_buttonJs);var _componentJs=_dereq_("../component.js");var _componentJs2=_interopRequireDefault(_componentJs);var FullscreenToggle=function(_Button){_inherits(FullscreenToggle,_Button);function FullscreenToggle(){_classCallCheck(this,FullscreenToggle);_Button.apply(this,arguments);}FullscreenToggle.prototype.buildCSSClass=function buildCSSClass(){return"vjs-fullscreen-control "+_Button.prototype.buildCSSClass.call(this);};FullscreenToggle.prototype.handleClick=function handleClick(){if(!this.player_.isFullscreen()){this.player_.requestFullscreen();this.controlText("Non-Fullscreen");}else{this.player_.exitFullscreen();this.controlText("Fullscreen");}};return FullscreenToggle;}(_buttonJs2["default"]);FullscreenToggle.prototype.controlText_="Fullscreen";_componentJs2["default"].registerComponent("FullscreenToggle",FullscreenToggle);exports["default"]=FullscreenToggle;module.exports=exports["default"];},{"../button.js":63,"../component.js":65}],68:[function(_dereq_,module,exports){"use strict";exports.__esModule=true;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var _component=_dereq_("../component");var _component2=_interopRequireDefault(_component);var _utilsDomJs=_dereq_("../utils/dom.js");var Dom=_interopRequireWildcard(_utilsDomJs);var LiveDisplay=function(_Component){_inherits(LiveDisplay,_Component);function LiveDisplay(player,options){_classCallCheck(this,LiveDisplay);_Component.call(this,player,options);this.updateShowing();this.on(this.player(),"durationchange",this.updateShowing);}LiveDisplay.prototype.createEl=function createEl(){var el=_Component.prototype.createEl.call(this,"div",{className:"vjs-live-control vjs-control"});this.contentEl_=Dom.createEl("div",{className:"vjs-live-display",innerHTML:'<span class="vjs-control-text">'+this.localize("Stream Type")+"</span>"+this.localize("LIVE")},{"aria-live":"off"});el.appendChild(this.contentEl_);return el;};LiveDisplay.prototype.updateShowing=function updateShowing(){if(this.player().duration()===Infinity){this.show();}else{this.hide();}};return LiveDisplay;}(_component2["default"]);_component2["default"].registerComponent("LiveDisplay",LiveDisplay);exports["default"]=LiveDisplay;module.exports=exports["default"];},{"../component":65,"../utils/dom.js":126}],69:[function(_dereq_,module,exports){"use strict";exports.__esModule=true;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var _button=_dereq_("../button");var _button2=_interopRequireDefault(_button);var _component=_dereq_("../component");var _component2=_interopRequireDefault(_component);var _utilsDomJs=_dereq_("../utils/dom.js");var Dom=_interopRequireWildcard(_utilsDomJs);var MuteToggle=function(_Button){_inherits(MuteToggle,_Button);function MuteToggle(player,options){_classCallCheck(this,MuteToggle);_Button.call(this,player,options);this.on(player,"volumechange",this.update);if(player.tech_&&player.tech_["featuresVolumeControl"]===false){this.addClass("vjs-hidden");}this.on(player,"loadstart",function(){this.update();if(player.tech_["featuresVolumeControl"]===false){this.addClass("vjs-hidden");}else{this.removeClass("vjs-hidden");}});}MuteToggle.prototype.buildCSSClass=function buildCSSClass(){return"vjs-mute-control "+_Button.prototype.buildCSSClass.call(this);};MuteToggle.prototype.handleClick=function handleClick(){this.player_.muted(this.player_.muted()?false:true);};MuteToggle.prototype.update=function update(){var vol=this.player_.volume(),level=3;if(vol===0||this.player_.muted()){level=0;}else if(vol<.33){level=1;}else if(vol<.67){level=2;}var toMute=this.player_.muted()?"Unmute":"Mute";var localizedMute=this.localize(toMute);if(this.controlText()!==localizedMute){this.controlText(localizedMute);}for(var i=0;i<4;i++){Dom.removeElClass(this.el_,"vjs-vol-"+i);}Dom.addElClass(this.el_,"vjs-vol-"+level);};return MuteToggle;}(_button2["default"]);MuteToggle.prototype.controlText_="Mute";_component2["default"].registerComponent("MuteToggle",MuteToggle);exports["default"]=MuteToggle;module.exports=exports["default"];},{"../button":63,"../component":65,"../utils/dom.js":126}],70:[function(_dereq_,module,exports){"use strict";exports.__esModule=true;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var _buttonJs=_dereq_("../button.js");var _buttonJs2=_interopRequireDefault(_buttonJs);var _componentJs=_dereq_("../component.js");var _componentJs2=_interopRequireDefault(_componentJs);var PlayToggle=function(_Button){_inherits(PlayToggle,_Button);function PlayToggle(player,options){_classCallCheck(this,PlayToggle);_Button.call(this,player,options);this.on(player,"play",this.handlePlay);this.on(player,"pause",this.handlePause);}PlayToggle.prototype.buildCSSClass=function buildCSSClass(){return"vjs-play-control "+_Button.prototype.buildCSSClass.call(this);};PlayToggle.prototype.handleClick=function handleClick(){if(this.player_.paused()){this.player_.play();}else{this.player_.pause();}};PlayToggle.prototype.handlePlay=function handlePlay(){this.removeClass("vjs-paused");this.addClass("vjs-playing");this.controlText("Pause");};PlayToggle.prototype.handlePause=function handlePause(){this.removeClass("vjs-playing");this.addClass("vjs-paused");this.controlText("Play");};return PlayToggle;}(_buttonJs2["default"]);PlayToggle.prototype.controlText_="Play";_componentJs2["default"].registerComponent("PlayToggle",PlayToggle);exports["default"]=PlayToggle;module.exports=exports["default"];},{"../button.js":63,"../component.js":65}],71:[function(_dereq_,module,exports){"use strict";exports.__esModule=true;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var _menuMenuButtonJs=_dereq_("../../menu/menu-button.js");var _menuMenuButtonJs2=_interopRequireDefault(_menuMenuButtonJs);var _menuMenuJs=_dereq_("../../menu/menu.js");var _menuMenuJs2=_interopRequireDefault(_menuMenuJs);var _playbackRateMenuItemJs=_dereq_("./playback-rate-menu-item.js");var _playbackRateMenuItemJs2=_interopRequireDefault(_playbackRateMenuItemJs);var _componentJs=_dereq_("../../component.js");var _componentJs2=_interopRequireDefault(_componentJs);var _utilsDomJs=_dereq_("../../utils/dom.js");var Dom=_interopRequireWildcard(_utilsDomJs);var PlaybackRateMenuButton=function(_MenuButton){_inherits(PlaybackRateMenuButton,_MenuButton);function PlaybackRateMenuButton(player,options){_classCallCheck(this,PlaybackRateMenuButton);_MenuButton.call(this,player,options);this.updateVisibility();this.updateLabel();this.on(player,"loadstart",this.updateVisibility);this.on(player,"ratechange",this.updateLabel);}PlaybackRateMenuButton.prototype.createEl=function createEl(){var el=_MenuButton.prototype.createEl.call(this);this.labelEl_=Dom.createEl("div",{className:"vjs-playback-rate-value",innerHTML:1});el.appendChild(this.labelEl_);return el;};PlaybackRateMenuButton.prototype.buildCSSClass=function buildCSSClass(){return"vjs-playback-rate "+_MenuButton.prototype.buildCSSClass.call(this);};PlaybackRateMenuButton.prototype.createMenu=function createMenu(){var menu=new _menuMenuJs2["default"](this.player());var rates=this.playbackRates();if(rates){for(var i=rates.length-1;i>=0;i--){menu.addChild(new _playbackRateMenuItemJs2["default"](this.player(),{rate:rates[i]+"x"}));}}return menu;};PlaybackRateMenuButton.prototype.updateARIAAttributes=function updateARIAAttributes(){this.el().setAttribute("aria-valuenow",this.player().playbackRate());};PlaybackRateMenuButton.prototype.handleClick=function handleClick(){var currentRate=this.player().playbackRate();var rates=this.playbackRates();var newRate=rates[0];for(var i=0;i<rates.length;i++){if(rates[i]>currentRate){newRate=rates[i];break;}}this.player().playbackRate(newRate);};PlaybackRateMenuButton.prototype.playbackRates=function playbackRates(){return this.options_["playbackRates"]||this.options_.playerOptions&&this.options_.playerOptions["playbackRates"];};PlaybackRateMenuButton.prototype.playbackRateSupported=function playbackRateSupported(){return this.player().tech_&&this.player().tech_["featuresPlaybackRate"]&&this.playbackRates()&&this.playbackRates().length>0;};PlaybackRateMenuButton.prototype.updateVisibility=function updateVisibility(){if(this.playbackRateSupported()){this.removeClass("vjs-hidden");}else{this.addClass("vjs-hidden");}};PlaybackRateMenuButton.prototype.updateLabel=function updateLabel(){if(this.playbackRateSupported()){this.labelEl_.innerHTML=this.player().playbackRate()+"x";}};return PlaybackRateMenuButton;}(_menuMenuButtonJs2["default"]);PlaybackRateMenuButton.prototype.controlText_="Playback Rate";_componentJs2["default"].registerComponent("PlaybackRateMenuButton",PlaybackRateMenuButton);exports["default"]=PlaybackRateMenuButton;module.exports=exports["default"];},{"../../component.js":65,"../../menu/menu-button.js":102,"../../menu/menu.js":104,"../../utils/dom.js":126,"./playback-rate-menu-item.js":72}],72:[function(_dereq_,module,exports){"use strict";exports.__esModule=true;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var _menuMenuItemJs=_dereq_("../../menu/menu-item.js");var _menuMenuItemJs2=_interopRequireDefault(_menuMenuItemJs);var _componentJs=_dereq_("../../component.js");var _componentJs2=_interopRequireDefault(_componentJs);var PlaybackRateMenuItem=function(_MenuItem){_inherits(PlaybackRateMenuItem,_MenuItem);function PlaybackRateMenuItem(player,options){_classCallCheck(this,PlaybackRateMenuItem);var label=options["rate"];var rate=parseFloat(label,10);options["label"]=label;options["selected"]=rate===1;_MenuItem.call(this,player,options);this.label=label;this.rate=rate;this.on(player,"ratechange",this.update);}PlaybackRateMenuItem.prototype.handleClick=function handleClick(){_MenuItem.prototype.handleClick.call(this);this.player().playbackRate(this.rate);};PlaybackRateMenuItem.prototype.update=function update(){this.selected(this.player().playbackRate()===this.rate);};return PlaybackRateMenuItem;}(_menuMenuItemJs2["default"]);PlaybackRateMenuItem.prototype.contentElType="button";_componentJs2["default"].registerComponent("PlaybackRateMenuItem",PlaybackRateMenuItem);exports["default"]=PlaybackRateMenuItem;module.exports=exports["default"];},{"../../component.js":65,"../../menu/menu-item.js":103}],73:[function(_dereq_,module,exports){"use strict";exports.__esModule=true;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var _componentJs=_dereq_("../../component.js");var _componentJs2=_interopRequireDefault(_componentJs);var _utilsDomJs=_dereq_("../../utils/dom.js");var Dom=_interopRequireWildcard(_utilsDomJs);var LoadProgressBar=function(_Component){_inherits(LoadProgressBar,_Component);function LoadProgressBar(player,options){_classCallCheck(this,LoadProgressBar);_Component.call(this,player,options);this.on(player,"progress",this.update);}LoadProgressBar.prototype.createEl=function createEl(){return _Component.prototype.createEl.call(this,"div",{className:"vjs-load-progress",innerHTML:'<span class="vjs-control-text"><span>'+this.localize("Loaded")+"</span>: 0%</span>"});};LoadProgressBar.prototype.update=function update(){var buffered=this.player_.buffered();var duration=this.player_.duration();var bufferedEnd=this.player_.bufferedEnd();var children=this.el_.children;var percentify=function percentify(time,end){var percent=time/end||0;return(percent>=1?1:percent)*100+"%";};this.el_.style.width=percentify(bufferedEnd,duration);for(var i=0;i<buffered.length;i++){var start=buffered.start(i);var end=buffered.end(i);var part=children[i];if(!part){part=this.el_.appendChild(Dom.createEl());}part.style.left=percentify(start,bufferedEnd);part.style.width=percentify(end-start,bufferedEnd);}for(var i=children.length;i>buffered.length;i--){this.el_.removeChild(children[i-1]);}};return LoadProgressBar;}(_componentJs2["default"]);_componentJs2["default"].registerComponent("LoadProgressBar",LoadProgressBar);exports["default"]=LoadProgressBar;module.exports=exports["default"];},{"../../component.js":65,"../../utils/dom.js":126}],74:[function(_dereq_,module,exports){"use strict";exports.__esModule=true;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var _componentJs=_dereq_("../../component.js");var _componentJs2=_interopRequireDefault(_componentJs);var _utilsDomJs=_dereq_("../../utils/dom.js");var Dom=_interopRequireWildcard(_utilsDomJs);var _utilsFnJs=_dereq_("../../utils/fn.js");var Fn=_interopRequireWildcard(_utilsFnJs);var _utilsFormatTimeJs=_dereq_("../../utils/format-time.js");var _utilsFormatTimeJs2=_interopRequireDefault(_utilsFormatTimeJs);var _lodashCompatFunctionThrottle=_dereq_("lodash-compat/function/throttle");var _lodashCompatFunctionThrottle2=_interopRequireDefault(_lodashCompatFunctionThrottle);var MouseTimeDisplay=function(_Component){_inherits(MouseTimeDisplay,_Component);function MouseTimeDisplay(player,options){var _this=this;_classCallCheck(this,MouseTimeDisplay);_Component.call(this,player,options);this.update(0,0);player.on("ready",function(){_this.on(player.controlBar.progressControl.el(),"mousemove",_lodashCompatFunctionThrottle2["default"](Fn.bind(_this,_this.handleMouseMove),25));});}MouseTimeDisplay.prototype.createEl=function createEl(){return _Component.prototype.createEl.call(this,"div",{className:"vjs-mouse-display"});};MouseTimeDisplay.prototype.handleMouseMove=function handleMouseMove(event){var duration=this.player_.duration();var newTime=this.calculateDistance(event)*duration;var position=event.pageX-Dom.findElPosition(this.el().parentNode).left;this.update(newTime,position);};MouseTimeDisplay.prototype.update=function update(newTime,position){var time=_utilsFormatTimeJs2["default"](newTime,this.player_.duration());this.el().style.left=position+"px";this.el().setAttribute("data-current-time",time);};MouseTimeDisplay.prototype.calculateDistance=function calculateDistance(event){return Dom.getPointerPosition(this.el().parentNode,event).x;};return MouseTimeDisplay;}(_componentJs2["default"]);_componentJs2["default"].registerComponent("MouseTimeDisplay",MouseTimeDisplay);exports["default"]=MouseTimeDisplay;module.exports=exports["default"];},{"../../component.js":65,"../../utils/dom.js":126,"../../utils/fn.js":128,"../../utils/format-time.js":129,"lodash-compat/function/throttle":7}],75:[function(_dereq_,module,exports){"use strict";exports.__esModule=true;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var _componentJs=_dereq_("../../component.js");var _componentJs2=_interopRequireDefault(_componentJs);var _utilsFnJs=_dereq_("../../utils/fn.js");var Fn=_interopRequireWildcard(_utilsFnJs);var _utilsFormatTimeJs=_dereq_("../../utils/format-time.js");var _utilsFormatTimeJs2=_interopRequireDefault(_utilsFormatTimeJs);var PlayProgressBar=function(_Component){_inherits(PlayProgressBar,_Component);function PlayProgressBar(player,options){_classCallCheck(this,PlayProgressBar);_Component.call(this,player,options);this.updateDataAttr();this.on(player,"timeupdate",this.updateDataAttr);player.ready(Fn.bind(this,this.updateDataAttr));}PlayProgressBar.prototype.createEl=function createEl(){return _Component.prototype.createEl.call(this,"div",{className:"vjs-play-progress vjs-slider-bar",innerHTML:'<span class="vjs-control-text"><span>'+this.localize("Progress")+"</span>: 0%</span>"});};PlayProgressBar.prototype.updateDataAttr=function updateDataAttr(){var time=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime();this.el_.setAttribute("data-current-time",_utilsFormatTimeJs2["default"](time,this.player_.duration()));};return PlayProgressBar;}(_componentJs2["default"]);_componentJs2["default"].registerComponent("PlayProgressBar",PlayProgressBar);exports["default"]=PlayProgressBar;module.exports=exports["default"];},{"../../component.js":65,"../../utils/fn.js":128,"../../utils/format-time.js":129}],76:[function(_dereq_,module,exports){"use strict";exports.__esModule=true;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var _componentJs=_dereq_("../../component.js");var _componentJs2=_interopRequireDefault(_componentJs);var _seekBarJs=_dereq_("./seek-bar.js");var _seekBarJs2=_interopRequireDefault(_seekBarJs);var _mouseTimeDisplayJs=_dereq_("./mouse-time-display.js");var _mouseTimeDisplayJs2=_interopRequireDefault(_mouseTimeDisplayJs);var ProgressControl=function(_Component){_inherits(ProgressControl,_Component);function ProgressControl(){_classCallCheck(this,ProgressControl);_Component.apply(this,arguments);}ProgressControl.prototype.createEl=function createEl(){return _Component.prototype.createEl.call(this,"div",{className:"vjs-progress-control vjs-control"});};return ProgressControl;}(_componentJs2["default"]);ProgressControl.prototype.options_={children:["seekBar"]};_componentJs2["default"].registerComponent("ProgressControl",ProgressControl);exports["default"]=ProgressControl;module.exports=exports["default"];},{"../../component.js":65,"./mouse-time-display.js":74,"./seek-bar.js":77}],77:[function(_dereq_,module,exports){"use strict";exports.__esModule=true;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var _sliderSliderJs=_dereq_("../../slider/slider.js");var _sliderSliderJs2=_interopRequireDefault(_sliderSliderJs);var _componentJs=_dereq_("../../component.js");var _componentJs2=_interopRequireDefault(_componentJs);var _loadProgressBarJs=_dereq_("./load-progress-bar.js");var _loadProgressBarJs2=_interopRequireDefault(_loadProgressBarJs);var _playProgressBarJs=_dereq_("./play-progress-bar.js");var _playProgressBarJs2=_interopRequireDefault(_playProgressBarJs);var _utilsFnJs=_dereq_("../../utils/fn.js");var Fn=_interopRequireWildcard(_utilsFnJs);var _utilsFormatTimeJs=_dereq_("../../utils/format-time.js");var _utilsFormatTimeJs2=_interopRequireDefault(_utilsFormatTimeJs);var _objectAssign=_dereq_("object.assign");var _objectAssign2=_interopRequireDefault(_objectAssign);var SeekBar=function(_Slider){_inherits(SeekBar,_Slider);function SeekBar(player,options){_classCallCheck(this,SeekBar);_Slider.call(this,player,options);this.on(player,"timeupdate",this.updateARIAAttributes);player.ready(Fn.bind(this,this.updateARIAAttributes));}SeekBar.prototype.createEl=function createEl(){return _Slider.prototype.createEl.call(this,"div",{className:"vjs-progress-holder"},{"aria-label":"video progress bar"});};SeekBar.prototype.updateARIAAttributes=function updateARIAAttributes(){var time=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime();this.el_.setAttribute("aria-valuenow",(this.getPercent()*100).toFixed(2));this.el_.setAttribute("aria-valuetext",_utilsFormatTimeJs2["default"](time,this.player_.duration()));};SeekBar.prototype.getPercent=function getPercent(){var percent=this.player_.currentTime()/this.player_.duration();return percent>=1?1:percent;};SeekBar.prototype.handleMouseDown=function handleMouseDown(event){_Slider.prototype.handleMouseDown.call(this,event);this.player_.scrubbing(true);this.videoWasPlaying=!this.player_.paused();this.player_.pause();};SeekBar.prototype.handleMouseMove=function handleMouseMove(event){var newTime=this.calculateDistance(event)*this.player_.duration();if(newTime===this.player_.duration()){newTime=newTime-.1;}this.player_.currentTime(newTime);};SeekBar.prototype.handleMouseUp=function handleMouseUp(event){_Slider.prototype.handleMouseUp.call(this,event);this.player_.scrubbing(false);if(this.videoWasPlaying){this.player_.play();}};SeekBar.prototype.stepForward=function stepForward(){this.player_.currentTime(this.player_.currentTime()+5);};SeekBar.prototype.stepBack=function stepBack(){this.player_.currentTime(this.player_.currentTime()-5);};return SeekBar;}(_sliderSliderJs2["default"]);SeekBar.prototype.options_={children:["loadProgressBar","mouseTimeDisplay","playProgressBar"],barName:"playProgressBar"};SeekBar.prototype.playerEvent="timeupdate";_componentJs2["default"].registerComponent("SeekBar",SeekBar);exports["default"]=SeekBar;module.exports=exports["default"];},{"../../component.js":65,"../../slider/slider.js":110,"../../utils/fn.js":128,"../../utils/format-time.js":129,"./load-progress-bar.js":73,"./play-progress-bar.js":75,"object.assign":45}],78:[function(_dereq_,module,exports){"use strict";exports.__esModule=true;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var _spacerJs=_dereq_("./spacer.js");var _spacerJs2=_interopRequireDefault(_spacerJs);var _componentJs=_dereq_("../../component.js");var _componentJs2=_interopRequireDefault(_componentJs);var CustomControlSpacer=function(_Spacer){_inherits(CustomControlSpacer,_Spacer);function CustomControlSpacer(){_classCallCheck(this,CustomControlSpacer);_Spacer.apply(this,arguments);}CustomControlSpacer.prototype.buildCSSClass=function buildCSSClass(){return"vjs-custom-control-spacer "+_Spacer.prototype.buildCSSClass.call(this);};CustomControlSpacer.prototype.createEl=function createEl(){var el=_Spacer.prototype.createEl.call(this,{className:this.buildCSSClass()});el.innerHTML="&nbsp;";return el;};return CustomControlSpacer;}(_spacerJs2["default"]);_componentJs2["default"].registerComponent("CustomControlSpacer",CustomControlSpacer);exports["default"]=CustomControlSpacer;module.exports=exports["default"];},{"../../component.js":65,"./spacer.js":79}],79:[function(_dereq_,module,exports){"use strict";exports.__esModule=true;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var _componentJs=_dereq_("../../component.js");var _componentJs2=_interopRequireDefault(_componentJs);var Spacer=function(_Component){_inherits(Spacer,_Component);function Spacer(){_classCallCheck(this,Spacer);_Component.apply(this,arguments);}Spacer.prototype.buildCSSClass=function buildCSSClass(){return"vjs-spacer "+_Component.prototype.buildCSSClass.call(this);};Spacer.prototype.createEl=function createEl(){return _Component.prototype.createEl.call(this,"div",{className:this.buildCSSClass()});};return Spacer;}(_componentJs2["default"]);_componentJs2["default"].registerComponent("Spacer",Spacer);exports["default"]=Spacer;module.exports=exports["default"];},{"../../component.js":65}],80:[function(_dereq_,module,exports){"use strict";exports.__esModule=true;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var _textTrackMenuItemJs=_dereq_("./text-track-menu-item.js");var _textTrackMenuItemJs2=_interopRequireDefault(_textTrackMenuItemJs);var _componentJs=_dereq_("../../component.js");var _componentJs2=_interopRequireDefault(_componentJs);var CaptionSettingsMenuItem=function(_TextTrackMenuItem){_inherits(CaptionSettingsMenuItem,_TextTrackMenuItem);function CaptionSettingsMenuItem(player,options){_classCallCheck(this,CaptionSettingsMenuItem);options["track"]={kind:options["kind"],player:player,label:options["kind"]+" settings",default:false,mode:"disabled"};_TextTrackMenuItem.call(this,player,options);this.addClass("vjs-texttrack-settings");}CaptionSettingsMenuItem.prototype.handleClick=function handleClick(){this.player().getChild("textTrackSettings").show();};return CaptionSettingsMenuItem;}(_textTrackMenuItemJs2["default"]);_componentJs2["default"].registerComponent("CaptionSettingsMenuItem",CaptionSettingsMenuItem);exports["default"]=CaptionSettingsMenuItem;module.exports=exports["default"];},{"../../component.js":65,"./text-track-menu-item.js":87}],81:[function(_dereq_,module,exports){"use strict";exports.__esModule=true;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var _textTrackButtonJs=_dereq_("./text-track-button.js");var _textTrackButtonJs2=_interopRequireDefault(_textTrackButtonJs);var _componentJs=_dereq_("../../component.js");var _componentJs2=_interopRequireDefault(_componentJs);var _captionSettingsMenuItemJs=_dereq_("./caption-settings-menu-item.js");var _captionSettingsMenuItemJs2=_interopRequireDefault(_captionSettingsMenuItemJs);var CaptionsButton=function(_TextTrackButton){_inherits(CaptionsButton,_TextTrackButton);function CaptionsButton(player,options,ready){_classCallCheck(this,CaptionsButton);_TextTrackButton.call(this,player,options,ready);this.el_.setAttribute("aria-label","Captions Menu");}CaptionsButton.prototype.buildCSSClass=function buildCSSClass(){return"vjs-captions-button "+_TextTrackButton.prototype.buildCSSClass.call(this);};CaptionsButton.prototype.update=function update(){var threshold=2;_TextTrackButton.prototype.update.call(this);if(this.player().tech_&&this.player().tech_["featuresNativeTextTracks"]){threshold=1;}if(this.items&&this.items.length>threshold){this.show();}else{this.hide();}};CaptionsButton.prototype.createItems=function createItems(){var items=[];if(!(this.player().tech_&&this.player().tech_["featuresNativeTextTracks"])){items.push(new _captionSettingsMenuItemJs2["default"](this.player_,{kind:this.kind_}));}return _TextTrackButton.prototype.createItems.call(this,items);};return CaptionsButton;}(_textTrackButtonJs2["default"]);CaptionsButton.prototype.kind_="captions";CaptionsButton.prototype.controlText_="Captions";_componentJs2["default"].registerComponent("CaptionsButton",CaptionsButton);exports["default"]=CaptionsButton;module.exports=exports["default"];},{"../../component.js":65,"./caption-settings-menu-item.js":80,"./text-track-button.js":86}],82:[function(_dereq_,module,exports){"use strict";exports.__esModule=true;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var _textTrackButtonJs=_dereq_("./text-track-button.js");var _textTrackButtonJs2=_interopRequireDefault(_textTrackButtonJs);var _componentJs=_dereq_("../../component.js");var _componentJs2=_interopRequireDefault(_componentJs);var _textTrackMenuItemJs=_dereq_("./text-track-menu-item.js");var _textTrackMenuItemJs2=_interopRequireDefault(_textTrackMenuItemJs);var _chaptersTrackMenuItemJs=_dereq_("./chapters-track-menu-item.js");var _chaptersTrackMenuItemJs2=_interopRequireDefault(_chaptersTrackMenuItemJs);var _menuMenuJs=_dereq_("../../menu/menu.js");var _menuMenuJs2=_interopRequireDefault(_menuMenuJs);var _utilsDomJs=_dereq_("../../utils/dom.js");var Dom=_interopRequireWildcard(_utilsDomJs);var _utilsFnJs=_dereq_("../../utils/fn.js");var Fn=_interopRequireWildcard(_utilsFnJs);var _utilsToTitleCaseJs=_dereq_("../../utils/to-title-case.js");var _utilsToTitleCaseJs2=_interopRequireDefault(_utilsToTitleCaseJs);var _globalWindow=_dereq_("global/window");var _globalWindow2=_interopRequireDefault(_globalWindow);var ChaptersButton=function(_TextTrackButton){_inherits(ChaptersButton,_TextTrackButton);function ChaptersButton(player,options,ready){_classCallCheck(this,ChaptersButton);_TextTrackButton.call(this,player,options,ready);this.el_.setAttribute("aria-label","Chapters Menu");}ChaptersButton.prototype.buildCSSClass=function buildCSSClass(){return"vjs-chapters-button "+_TextTrackButton.prototype.buildCSSClass.call(this);};ChaptersButton.prototype.createItems=function createItems(){var items=[];var tracks=this.player_.textTracks();if(!tracks){return items;}for(var i=0;i<tracks.length;i++){var track=tracks[i];if(track["kind"]===this.kind_){items.push(new _textTrackMenuItemJs2["default"](this.player_,{track:track}));}}return items;};ChaptersButton.prototype.createMenu=function createMenu(){var tracks=this.player_.textTracks()||[];var chaptersTrack=undefined;var items=this.items=[];for(var i=0,l=tracks.length;i<l;i++){var track=tracks[i];if(track["kind"]===this.kind_){if(!track.cues){track["mode"]="hidden";_globalWindow2["default"].setTimeout(Fn.bind(this,function(){this.createMenu();}),100);}else{chaptersTrack=track;break;}}}var menu=this.menu;if(menu===undefined){menu=new _menuMenuJs2["default"](this.player_);menu.contentEl().appendChild(Dom.createEl("li",{className:"vjs-menu-title",innerHTML:_utilsToTitleCaseJs2["default"](this.kind_),tabIndex:-1}));}if(chaptersTrack){var cues=chaptersTrack["cues"],cue=undefined;for(var i=0,l=cues.length;i<l;i++){cue=cues[i];var mi=new _chaptersTrackMenuItemJs2["default"](this.player_,{track:chaptersTrack,cue:cue});items.push(mi);menu.addChild(mi);}this.addChild(menu);}if(this.items.length>0){this.show();}return menu;};return ChaptersButton;}(_textTrackButtonJs2["default"]);ChaptersButton.prototype.kind_="chapters";ChaptersButton.prototype.controlText_="Chapters";_componentJs2["default"].registerComponent("ChaptersButton",ChaptersButton);exports["default"]=ChaptersButton;module.exports=exports["default"];},{"../../component.js":65,"../../menu/menu.js":104,"../../utils/dom.js":126,"../../utils/fn.js":128,"../../utils/to-title-case.js":135,"./chapters-track-menu-item.js":83,"./text-track-button.js":86,"./text-track-menu-item.js":87,"global/window":2}],83:[function(_dereq_,module,exports){"use strict";exports.__esModule=true;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var _menuMenuItemJs=_dereq_("../../menu/menu-item.js");var _menuMenuItemJs2=_interopRequireDefault(_menuMenuItemJs);var _componentJs=_dereq_("../../component.js");var _componentJs2=_interopRequireDefault(_componentJs);var _utilsFnJs=_dereq_("../../utils/fn.js");var Fn=_interopRequireWildcard(_utilsFnJs);var ChaptersTrackMenuItem=function(_MenuItem){_inherits(ChaptersTrackMenuItem,_MenuItem);function ChaptersTrackMenuItem(player,options){_classCallCheck(this,ChaptersTrackMenuItem);var track=options["track"];var cue=options["cue"];var currentTime=player.currentTime();options["label"]=cue.text;options["selected"]=cue["startTime"]<=currentTime&&currentTime<cue["endTime"];_MenuItem.call(this,player,options);this.track=track;this.cue=cue;track.addEventListener("cuechange",Fn.bind(this,this.update));}ChaptersTrackMenuItem.prototype.handleClick=function handleClick(){_MenuItem.prototype.handleClick.call(this);this.player_.currentTime(this.cue.startTime);this.update(this.cue.startTime);};ChaptersTrackMenuItem.prototype.update=function update(){var cue=this.cue;var currentTime=this.player_.currentTime();this.selected(cue["startTime"]<=currentTime&&currentTime<cue["endTime"]);};return ChaptersTrackMenuItem;}(_menuMenuItemJs2["default"]);_componentJs2["default"].registerComponent("ChaptersTrackMenuItem",ChaptersTrackMenuItem);exports["default"]=ChaptersTrackMenuItem;module.exports=exports["default"];},{"../../component.js":65,"../../menu/menu-item.js":103,"../../utils/fn.js":128}],84:[function(_dereq_,module,exports){"use strict";exports.__esModule=true;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var _textTrackMenuItemJs=_dereq_("./text-track-menu-item.js");var _textTrackMenuItemJs2=_interopRequireDefault(_textTrackMenuItemJs);var _componentJs=_dereq_("../../component.js");var _componentJs2=_interopRequireDefault(_componentJs);var OffTextTrackMenuItem=function(_TextTrackMenuItem){_inherits(OffTextTrackMenuItem,_TextTrackMenuItem);function OffTextTrackMenuItem(player,options){_classCallCheck(this,OffTextTrackMenuItem);options["track"]={kind:options["kind"],player:player,label:options["kind"]+" off",default:false,mode:"disabled"};_TextTrackMenuItem.call(this,player,options);this.selected(true);}OffTextTrackMenuItem.prototype.handleTracksChange=function handleTracksChange(event){var tracks=this.player().textTracks();var selected=true;for(var i=0,l=tracks.length;i<l;i++){var track=tracks[i];if(track["kind"]===this.track["kind"]&&track["mode"]==="showing"){selected=false;break;}}this.selected(selected);};return OffTextTrackMenuItem;}(_textTrackMenuItemJs2["default"]);_componentJs2["default"].registerComponent("OffTextTrackMenuItem",OffTextTrackMenuItem);exports["default"]=OffTextTrackMenuItem;module.exports=exports["default"];},{"../../component.js":65,"./text-track-menu-item.js":87}],85:[function(_dereq_,module,exports){"use strict";exports.__esModule=true;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var _textTrackButtonJs=_dereq_("./text-track-button.js");var _textTrackButtonJs2=_interopRequireDefault(_textTrackButtonJs);var _componentJs=_dereq_("../../component.js");var _componentJs2=_interopRequireDefault(_componentJs);var SubtitlesButton=function(_TextTrackButton){_inherits(SubtitlesButton,_TextTrackButton);function SubtitlesButton(player,options,ready){_classCallCheck(this,SubtitlesButton);_TextTrackButton.call(this,player,options,ready);this.el_.setAttribute("aria-label","Subtitles Menu");}SubtitlesButton.prototype.buildCSSClass=function buildCSSClass(){return"vjs-subtitles-button "+_TextTrackButton.prototype.buildCSSClass.call(this);};return SubtitlesButton;}(_textTrackButtonJs2["default"]);SubtitlesButton.prototype.kind_="subtitles";SubtitlesButton.prototype.controlText_="Subtitles";_componentJs2["default"].registerComponent("SubtitlesButton",SubtitlesButton);exports["default"]=SubtitlesButton;module.exports=exports["default"];},{"../../component.js":65,"./text-track-button.js":86}],86:[function(_dereq_,module,exports){"use strict";exports.__esModule=true;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var _menuMenuButtonJs=_dereq_("../../menu/menu-button.js");var _menuMenuButtonJs2=_interopRequireDefault(_menuMenuButtonJs);var _componentJs=_dereq_("../../component.js");var _componentJs2=_interopRequireDefault(_componentJs);var _utilsFnJs=_dereq_("../../utils/fn.js");var Fn=_interopRequireWildcard(_utilsFnJs);var _textTrackMenuItemJs=_dereq_("./text-track-menu-item.js");var _textTrackMenuItemJs2=_interopRequireDefault(_textTrackMenuItemJs);var _offTextTrackMenuItemJs=_dereq_("./off-text-track-menu-item.js");var _offTextTrackMenuItemJs2=_interopRequireDefault(_offTextTrackMenuItemJs);var TextTrackButton=function(_MenuButton){_inherits(TextTrackButton,_MenuButton);function TextTrackButton(player,options){_classCallCheck(this,TextTrackButton);_MenuButton.call(this,player,options);var tracks=this.player_.textTracks();if(this.items.length<=1){this.hide();}if(!tracks){return;}var updateHandler=Fn.bind(this,this.update);tracks.addEventListener("removetrack",updateHandler);tracks.addEventListener("addtrack",updateHandler);this.player_.on("dispose",function(){tracks.removeEventListener("removetrack",updateHandler);tracks.removeEventListener("addtrack",updateHandler);});}TextTrackButton.prototype.createItems=function createItems(){var items=arguments.length<=0||arguments[0]===undefined?[]:arguments[0];items.push(new _offTextTrackMenuItemJs2["default"](this.player_,{kind:this.kind_}));var tracks=this.player_.textTracks();if(!tracks){return items;}for(var i=0;i<tracks.length;i++){var track=tracks[i];if(track["kind"]===this.kind_){items.push(new _textTrackMenuItemJs2["default"](this.player_,{track:track}));}}return items;};return TextTrackButton;}(_menuMenuButtonJs2["default"]);_componentJs2["default"].registerComponent("TextTrackButton",TextTrackButton);exports["default"]=TextTrackButton;module.exports=exports["default"];},{"../../component.js":65,"../../menu/menu-button.js":102,"../../utils/fn.js":128,"./off-text-track-menu-item.js":84,"./text-track-menu-item.js":87}],87:[function(_dereq_,module,exports){"use strict";exports.__esModule=true;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var _menuMenuItemJs=_dereq_("../../menu/menu-item.js");var _menuMenuItemJs2=_interopRequireDefault(_menuMenuItemJs);var _componentJs=_dereq_("../../component.js");var _componentJs2=_interopRequireDefault(_componentJs);var _utilsFnJs=_dereq_("../../utils/fn.js");var Fn=_interopRequireWildcard(_utilsFnJs);var _globalWindow=_dereq_("global/window");var _globalWindow2=_interopRequireDefault(_globalWindow);var _globalDocument=_dereq_("global/document");var _globalDocument2=_interopRequireDefault(_globalDocument);var TextTrackMenuItem=function(_MenuItem){_inherits(TextTrackMenuItem,_MenuItem);function TextTrackMenuItem(player,options){var _this=this;_classCallCheck(this,TextTrackMenuItem);var track=options["track"];var tracks=player.textTracks();options["label"]=track["label"]||track["language"]||"Unknown";options["selected"]=track["default"]||track["mode"]==="showing";_MenuItem.call(this,player,options);this.track=track;if(tracks){(function(){var changeHandler=Fn.bind(_this,_this.handleTracksChange);tracks.addEventListener("change",changeHandler);_this.on("dispose",function(){tracks.removeEventListener("change",changeHandler);});})();}if(tracks&&tracks.onchange===undefined){(function(){var event=undefined;_this.on(["tap","click"],function(){if(_typeof2(_globalWindow2["default"].Event)!=="object"){try{event=new _globalWindow2["default"].Event("change");}catch(err){}}if(!event){event=_globalDocument2["default"].createEvent("Event");event.initEvent("change",true,true);}tracks.dispatchEvent(event);});})();}}TextTrackMenuItem.prototype.handleClick=function handleClick(event){var kind=this.track["kind"];var tracks=this.player_.textTracks();_MenuItem.prototype.handleClick.call(this,event);if(!tracks)return;for(var i=0;i<tracks.length;i++){var track=tracks[i];if(track["kind"]!==kind){continue;}if(track===this.track){track["mode"]="showing";}else{track["mode"]="disabled";}}};TextTrackMenuItem.prototype.handleTracksChange=function handleTracksChange(event){this.selected(this.track["mode"]==="showing");};return TextTrackMenuItem;}(_menuMenuItemJs2["default"]);_componentJs2["default"].registerComponent("TextTrackMenuItem",TextTrackMenuItem);exports["default"]=TextTrackMenuItem;module.exports=exports["default"];},{"../../component.js":65,"../../menu/menu-item.js":103,"../../utils/fn.js":128,"global/document":1,"global/window":2}],88:[function(_dereq_,module,exports){"use strict";exports.__esModule=true;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var _componentJs=_dereq_("../../component.js");var _componentJs2=_interopRequireDefault(_componentJs);var _utilsDomJs=_dereq_("../../utils/dom.js");var Dom=_interopRequireWildcard(_utilsDomJs);var _utilsFormatTimeJs=_dereq_("../../utils/format-time.js");var _utilsFormatTimeJs2=_interopRequireDefault(_utilsFormatTimeJs);var CurrentTimeDisplay=function(_Component){_inherits(CurrentTimeDisplay,_Component);function CurrentTimeDisplay(player,options){_classCallCheck(this,CurrentTimeDisplay);_Component.call(this,player,options);this.on(player,"timeupdate",this.updateContent);}CurrentTimeDisplay.prototype.createEl=function createEl(){var el=_Component.prototype.createEl.call(this,"div",{className:"vjs-current-time vjs-time-control vjs-control"});this.contentEl_=Dom.createEl("div",{className:"vjs-current-time-display",innerHTML:'<span class="vjs-control-text">Current Time </span>'+"0:00"},{"aria-live":"off"});el.appendChild(this.contentEl_);return el;};CurrentTimeDisplay.prototype.updateContent=function updateContent(){var time=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime();var localizedText=this.localize("Current Time");var formattedTime=_utilsFormatTimeJs2["default"](time,this.player_.duration());this.contentEl_.innerHTML='<span class="vjs-control-text">'+localizedText+"</span> "+formattedTime;};return CurrentTimeDisplay;}(_componentJs2["default"]);_componentJs2["default"].registerComponent("CurrentTimeDisplay",CurrentTimeDisplay);exports["default"]=CurrentTimeDisplay;module.exports=exports["default"];},{"../../component.js":65,"../../utils/dom.js":126,"../../utils/format-time.js":129}],89:[function(_dereq_,module,exports){"use strict";exports.__esModule=true;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var _componentJs=_dereq_("../../component.js");var _componentJs2=_interopRequireDefault(_componentJs);var _utilsDomJs=_dereq_("../../utils/dom.js");var Dom=_interopRequireWildcard(_utilsDomJs);var _utilsFormatTimeJs=_dereq_("../../utils/format-time.js");var _utilsFormatTimeJs2=_interopRequireDefault(_utilsFormatTimeJs);var DurationDisplay=function(_Component){_inherits(DurationDisplay,_Component);function DurationDisplay(player,options){_classCallCheck(this,DurationDisplay);_Component.call(this,player,options);this.on(player,"timeupdate",this.updateContent);this.on(player,"loadedmetadata",this.updateContent);}DurationDisplay.prototype.createEl=function createEl(){var el=_Component.prototype.createEl.call(this,"div",{className:"vjs-duration vjs-time-control vjs-control"});this.contentEl_=Dom.createEl("div",{className:"vjs-duration-display",innerHTML:'<span class="vjs-control-text">'+this.localize("Duration Time")+"</span> 0:00"},{"aria-live":"off"});el.appendChild(this.contentEl_);return el;};DurationDisplay.prototype.updateContent=function updateContent(){var duration=this.player_.duration();if(duration){var localizedText=this.localize("Duration Time");var formattedTime=_utilsFormatTimeJs2["default"](duration);this.contentEl_.innerHTML='<span class="vjs-control-text">'+localizedText+"</span> "+formattedTime;}};return DurationDisplay;}(_componentJs2["default"]);_componentJs2["default"].registerComponent("DurationDisplay",DurationDisplay);exports["default"]=DurationDisplay;module.exports=exports["default"];},{"../../component.js":65,"../../utils/dom.js":126,"../../utils/format-time.js":129}],90:[function(_dereq_,module,exports){"use strict";exports.__esModule=true;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var _componentJs=_dereq_("../../component.js");var _componentJs2=_interopRequireDefault(_componentJs);var _utilsDomJs=_dereq_("../../utils/dom.js");var Dom=_interopRequireWildcard(_utilsDomJs);var _utilsFormatTimeJs=_dereq_("../../utils/format-time.js");var _utilsFormatTimeJs2=_interopRequireDefault(_utilsFormatTimeJs);var RemainingTimeDisplay=function(_Component){_inherits(RemainingTimeDisplay,_Component);function RemainingTimeDisplay(player,options){_classCallCheck(this,RemainingTimeDisplay);_Component.call(this,player,options);this.on(player,"timeupdate",this.updateContent);}RemainingTimeDisplay.prototype.createEl=function createEl(){var el=_Component.prototype.createEl.call(this,"div",{className:"vjs-remaining-time vjs-time-control vjs-control"});this.contentEl_=Dom.createEl("div",{className:"vjs-remaining-time-display",innerHTML:'<span class="vjs-control-text">'+this.localize("Remaining Time")+"</span> -0:00"},{"aria-live":"off"});el.appendChild(this.contentEl_);return el;};RemainingTimeDisplay.prototype.updateContent=function updateContent(){if(this.player_.duration()){var localizedText=this.localize("Remaining Time");var formattedTime=_utilsFormatTimeJs2["default"](this.player_.remainingTime());this.contentEl_.innerHTML='<span class="vjs-control-text">'+localizedText+"</span> -"+formattedTime;}};return RemainingTimeDisplay;}(_componentJs2["default"]);_componentJs2["default"].registerComponent("RemainingTimeDisplay",RemainingTimeDisplay);exports["default"]=RemainingTimeDisplay;module.exports=exports["default"];},{"../../component.js":65,"../../utils/dom.js":126,"../../utils/format-time.js":129}],91:[function(_dereq_,module,exports){"use strict";exports.__esModule=true;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var _componentJs=_dereq_("../../component.js");var _componentJs2=_interopRequireDefault(_componentJs);var TimeDivider=function(_Component){_inherits(TimeDivider,_Component);function TimeDivider(){_classCallCheck(this,TimeDivider);_Component.apply(this,arguments);}TimeDivider.prototype.createEl=function createEl(){return _Component.prototype.createEl.call(this,"div",{className:"vjs-time-control vjs-time-divider",innerHTML:"<div><span>/</span></div>"});};return TimeDivider;}(_componentJs2["default"]);_componentJs2["default"].registerComponent("TimeDivider",TimeDivider);exports["default"]=TimeDivider;module.exports=exports["default"];},{"../../component.js":65}],92:[function(_dereq_,module,exports){"use strict";exports.__esModule=true;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var _sliderSliderJs=_dereq_("../../slider/slider.js");var _sliderSliderJs2=_interopRequireDefault(_sliderSliderJs);var _componentJs=_dereq_("../../component.js");var _componentJs2=_interopRequireDefault(_componentJs);var _utilsFnJs=_dereq_("../../utils/fn.js");var Fn=_interopRequireWildcard(_utilsFnJs);var _volumeLevelJs=_dereq_("./volume-level.js");var _volumeLevelJs2=_interopRequireDefault(_volumeLevelJs);var VolumeBar=function(_Slider){_inherits(VolumeBar,_Slider);function VolumeBar(player,options){_classCallCheck(this,VolumeBar);_Slider.call(this,player,options);this.on(player,"volumechange",this.updateARIAAttributes);player.ready(Fn.bind(this,this.updateARIAAttributes));}VolumeBar.prototype.createEl=function createEl(){return _Slider.prototype.createEl.call(this,"div",{className:"vjs-volume-bar vjs-slider-bar"},{"aria-label":"volume level"});};VolumeBar.prototype.handleMouseMove=function handleMouseMove(event){if(this.player_.muted()){this.player_.muted(false);}this.player_.volume(this.calculateDistance(event));};VolumeBar.prototype.getPercent=function getPercent(){if(this.player_.muted()){return 0;}else{return this.player_.volume();}};VolumeBar.prototype.stepForward=function stepForward(){this.player_.volume(this.player_.volume()+.1);};VolumeBar.prototype.stepBack=function stepBack(){this.player_.volume(this.player_.volume()-.1);};VolumeBar.prototype.updateARIAAttributes=function updateARIAAttributes(){var volume=(this.player_.volume()*100).toFixed(2);this.el_.setAttribute("aria-valuenow",volume);this.el_.setAttribute("aria-valuetext",volume+"%");};return VolumeBar;}(_sliderSliderJs2["default"]);VolumeBar.prototype.options_={children:["volumeLevel"],barName:"volumeLevel"};VolumeBar.prototype.playerEvent="volumechange";_componentJs2["default"].registerComponent("VolumeBar",VolumeBar);exports["default"]=VolumeBar;module.exports=exports["default"];},{"../../component.js":65,"../../slider/slider.js":110,"../../utils/fn.js":128,"./volume-level.js":94}],93:[function(_dereq_,module,exports){"use strict";exports.__esModule=true;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var _componentJs=_dereq_("../../component.js");var _componentJs2=_interopRequireDefault(_componentJs);var _volumeBarJs=_dereq_("./volume-bar.js");var _volumeBarJs2=_interopRequireDefault(_volumeBarJs);var VolumeControl=function(_Component){_inherits(VolumeControl,_Component);function VolumeControl(player,options){_classCallCheck(this,VolumeControl);_Component.call(this,player,options);if(player.tech_&&player.tech_["featuresVolumeControl"]===false){this.addClass("vjs-hidden");}this.on(player,"loadstart",function(){if(player.tech_["featuresVolumeControl"]===false){this.addClass("vjs-hidden");}else{this.removeClass("vjs-hidden");}});}VolumeControl.prototype.createEl=function createEl(){return _Component.prototype.createEl.call(this,"div",{className:"vjs-volume-control vjs-control"});};return VolumeControl;}(_componentJs2["default"]);VolumeControl.prototype.options_={children:["volumeBar"]};_componentJs2["default"].registerComponent("VolumeControl",VolumeControl);exports["default"]=VolumeControl;module.exports=exports["default"];},{"../../component.js":65,"./volume-bar.js":92}],94:[function(_dereq_,module,exports){"use strict";exports.__esModule=true;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var _componentJs=_dereq_("../../component.js");var _componentJs2=_interopRequireDefault(_componentJs);var VolumeLevel=function(_Component){_inherits(VolumeLevel,_Component);function VolumeLevel(){_classCallCheck(this,VolumeLevel);_Component.apply(this,arguments);}VolumeLevel.prototype.createEl=function createEl(){return _Component.prototype.createEl.call(this,"div",{className:"vjs-volume-level",innerHTML:'<span class="vjs-control-text"></span>'});};return VolumeLevel;}(_componentJs2["default"]);_componentJs2["default"].registerComponent("VolumeLevel",VolumeLevel);exports["default"]=VolumeLevel;module.exports=exports["default"];},{"../../component.js":65}],95:[function(_dereq_,module,exports){"use strict";exports.__esModule=true;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var _buttonJs=_dereq_("../button.js");var _buttonJs2=_interopRequireDefault(_buttonJs);var _componentJs=_dereq_("../component.js");var _componentJs2=_interopRequireDefault(_componentJs);var _menuMenuJs=_dereq_("../menu/menu.js");var _menuMenuJs2=_interopRequireDefault(_menuMenuJs);var _menuMenuButtonJs=_dereq_("../menu/menu-button.js");var _menuMenuButtonJs2=_interopRequireDefault(_menuMenuButtonJs);var _muteToggleJs=_dereq_("./mute-toggle.js");var _muteToggleJs2=_interopRequireDefault(_muteToggleJs);var _volumeControlVolumeBarJs=_dereq_("./volume-control/volume-bar.js");var _volumeControlVolumeBarJs2=_interopRequireDefault(_volumeControlVolumeBarJs);var VolumeMenuButton=function(_MenuButton){_inherits(VolumeMenuButton,_MenuButton);function VolumeMenuButton(player){var options=arguments.length<=1||arguments[1]===undefined?{}:arguments[1];_classCallCheck(this,VolumeMenuButton);if(options.inline===undefined){options.inline=true;}if(options.vertical===undefined){if(options.inline){options.vertical=false;}else{options.vertical=true;}}options.volumeBar=options.volumeBar||{};options.volumeBar.vertical=!!options.vertical;_MenuButton.call(this,player,options);this.on(player,"volumechange",this.volumeUpdate);this.on(player,"loadstart",this.volumeUpdate);function updateVisibility(){if(player.tech_&&player.tech_["featuresVolumeControl"]===false){this.addClass("vjs-hidden");}else{this.removeClass("vjs-hidden");}}updateVisibility.call(this);this.on(player,"loadstart",updateVisibility);this.on(this.volumeBar,["slideractive","focus"],function(){this.addClass("vjs-slider-active");});this.on(this.volumeBar,["sliderinactive","blur"],function(){this.removeClass("vjs-slider-active");});}VolumeMenuButton.prototype.buildCSSClass=function buildCSSClass(){var orientationClass="";if(!!this.options_.vertical){orientationClass="vjs-volume-menu-button-vertical";}else{orientationClass="vjs-volume-menu-button-horizontal";}return"vjs-volume-menu-button "+_MenuButton.prototype.buildCSSClass.call(this)+" "+orientationClass;};VolumeMenuButton.prototype.createMenu=function createMenu(){var menu=new _menuMenuJs2["default"](this.player_,{contentElType:"div"});var vb=new _volumeControlVolumeBarJs2["default"](this.player_,this.options_.volumeBar);menu.addChild(vb);this.volumeBar=vb;return menu;};VolumeMenuButton.prototype.handleClick=function handleClick(){_muteToggleJs2["default"].prototype.handleClick.call(this);_MenuButton.prototype.handleClick.call(this);};return VolumeMenuButton;}(_menuMenuButtonJs2["default"]);VolumeMenuButton.prototype.volumeUpdate=_muteToggleJs2["default"].prototype.update;VolumeMenuButton.prototype.controlText_="Mute";_componentJs2["default"].registerComponent("VolumeMenuButton",VolumeMenuButton);exports["default"]=VolumeMenuButton;module.exports=exports["default"];},{"../button.js":63,"../component.js":65,"../menu/menu-button.js":102,"../menu/menu.js":104,"./mute-toggle.js":69,"./volume-control/volume-bar.js":92}],96:[function(_dereq_,module,exports){"use strict";exports.__esModule=true;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var _component=_dereq_("./component");var _component2=_interopRequireDefault(_component);var _modalDialog=_dereq_("./modal-dialog");var _modalDialog2=_interopRequireDefault(_modalDialog);var _utilsDom=_dereq_("./utils/dom");var Dom=_interopRequireWildcard(_utilsDom);var _utilsMergeOptions=_dereq_("./utils/merge-options");var _utilsMergeOptions2=_interopRequireDefault(_utilsMergeOptions);var ErrorDisplay=function(_ModalDialog){_inherits(ErrorDisplay,_ModalDialog);function ErrorDisplay(player,options){_classCallCheck(this,ErrorDisplay);_ModalDialog.call(this,player,options);this.on(player,"error",this.open);}ErrorDisplay.prototype.buildCSSClass=function buildCSSClass(){return"vjs-error-display "+_ModalDialog.prototype.buildCSSClass.call(this);};ErrorDisplay.prototype.content=function content(){var error=this.player().error();return error?this.localize(error.message):"";};return ErrorDisplay;}(_modalDialog2["default"]);ErrorDisplay.prototype.options_=_utilsMergeOptions2["default"](_modalDialog2["default"].prototype.options_,{fillAlways:true,uncloseable:true});_component2["default"].registerComponent("ErrorDisplay",ErrorDisplay);exports["default"]=ErrorDisplay;module.exports=exports["default"];},{"./component":65,"./modal-dialog":105,"./utils/dom":126,"./utils/merge-options":132}],97:[function(_dereq_,module,exports){"use strict";exports.__esModule=true;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}var _utilsEventsJs=_dereq_("./utils/events.js");var Events=_interopRequireWildcard(_utilsEventsJs);var EventTarget=function EventTarget(){};EventTarget.prototype.allowedEvents_={};EventTarget.prototype.on=function(type,fn){var ael=this.addEventListener;this.addEventListener=Function.prototype;Events.on(this,type,fn);this.addEventListener=ael;};EventTarget.prototype.addEventListener=EventTarget.prototype.on;EventTarget.prototype.off=function(type,fn){Events.off(this,type,fn);};EventTarget.prototype.removeEventListener=EventTarget.prototype.off;EventTarget.prototype.one=function(type,fn){Events.one(this,type,fn);};EventTarget.prototype.trigger=function(event){var type=event.type||event;if(typeof event==="string"){event={type:type};}event=Events.fixEvent(event);if(this.allowedEvents_[type]&&this["on"+type]){this["on"+type](event);}Events.trigger(this,event);};EventTarget.prototype.dispatchEvent=EventTarget.prototype.trigger;exports["default"]=EventTarget;module.exports=exports["default"];},{"./utils/events.js":127}],98:[function(_dereq_,module,exports){"use strict";exports.__esModule=true;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}var _utilsLog=_dereq_("./utils/log");var _utilsLog2=_interopRequireDefault(_utilsLog);var _inherits=function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass){subClass.super_=superClass;}};var extendFn=function extendFn(superClass){var subClassMethods=arguments.length<=1||arguments[1]===undefined?{}:arguments[1];var subClass=function subClass(){superClass.apply(this,arguments);};var methods={};if((typeof subClassMethods==="undefined"?"undefined":_typeof2(subClassMethods))==="object"){if(typeof subClassMethods.init==="function"){_utilsLog2["default"].warn("Constructor logic via init() is deprecated; please use constructor() instead.");subClassMethods.constructor=subClassMethods.init;}if(subClassMethods.constructor!==Object.prototype.constructor){subClass=subClassMethods.constructor;}methods=subClassMethods;}else if(typeof subClassMethods==="function"){subClass=subClassMethods;}_inherits(subClass,superClass);for(var name in methods){if(methods.hasOwnProperty(name)){subClass.prototype[name]=methods[name];}}return subClass;};exports["default"]=extendFn;module.exports=exports["default"];},{"./utils/log":131}],99:[function(_dereq_,module,exports){"use strict";exports.__esModule=true;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}var _globalDocument=_dereq_("global/document");var _globalDocument2=_interopRequireDefault(_globalDocument);var FullscreenApi={};var apiMap=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]];var specApi=apiMap[0];var browserApi=undefined;for(var i=0;i<apiMap.length;i++){if(apiMap[i][1]in _globalDocument2["default"]){browserApi=apiMap[i];break;}}if(browserApi){for(var i=0;i<browserApi.length;i++){FullscreenApi[specApi[i]]=browserApi[i];}}exports["default"]=FullscreenApi;module.exports=exports["default"];},{"global/document":1}],100:[function(_dereq_,module,exports){"use strict";exports.__esModule=true;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var _component=_dereq_("./component");var _component2=_interopRequireDefault(_component);var LoadingSpinner=function(_Component){_inherits(LoadingSpinner,_Component);function LoadingSpinner(){_classCallCheck(this,LoadingSpinner);_Component.apply(this,arguments);}LoadingSpinner.prototype.createEl=function createEl(){return _Component.prototype.createEl.call(this,"div",{className:"vjs-loading-spinner"});};return LoadingSpinner;}(_component2["default"]);_component2["default"].registerComponent("LoadingSpinner",LoadingSpinner);exports["default"]=LoadingSpinner;module.exports=exports["default"];},{"./component":65}],101:[function(_dereq_,module,exports){"use strict";exports.__esModule=true;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}var _objectAssign=_dereq_("object.assign");var _objectAssign2=_interopRequireDefault(_objectAssign);var MediaError=function MediaError(code){if(typeof code==="number"){this.code=code;}else if(typeof code==="string"){this.message=code;}else if((typeof code==="undefined"?"undefined":_typeof2(code))==="object"){_objectAssign2["default"](this,code);}if(!this.message){this.message=MediaError.defaultMessages[this.code]||"";}};MediaError.prototype.code=0;MediaError.prototype.message="";MediaError.prototype.status=null;MediaError.errorTypes=["MEDIA_ERR_CUSTOM","MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED","MEDIA_ERR_ENCRYPTED"];MediaError.defaultMessages={1:"You aborted the media playback",2:"A network error caused the media download to fail part-way.",3:"The media playback was aborted due to a corruption problem or because the media used features your browser did not support.",4:"The media could not be loaded, either because the server or network failed or because the format is not supported.",5:"The media is encrypted and we do not have the keys to decrypt it."};for(var errNum=0;errNum<MediaError.errorTypes.length;errNum++){MediaError[MediaError.errorTypes[errNum]]=errNum;MediaError.prototype[MediaError.errorTypes[errNum]]=errNum;}exports["default"]=MediaError;module.exports=exports["default"];},{"object.assign":45}],102:[function(_dereq_,module,exports){"use strict";exports.__esModule=true;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var _buttonJs=_dereq_("../button.js");var _buttonJs2=_interopRequireDefault(_buttonJs);var _componentJs=_dereq_("../component.js");var _componentJs2=_interopRequireDefault(_componentJs);var _menuJs=_dereq_("./menu.js");var _menuJs2=_interopRequireDefault(_menuJs);var _utilsDomJs=_dereq_("../utils/dom.js");var Dom=_interopRequireWildcard(_utilsDomJs);var _utilsFnJs=_dereq_("../utils/fn.js");var Fn=_interopRequireWildcard(_utilsFnJs);var _utilsToTitleCaseJs=_dereq_("../utils/to-title-case.js");var _utilsToTitleCaseJs2=_interopRequireDefault(_utilsToTitleCaseJs);var MenuButton=function(_Button){_inherits(MenuButton,_Button);function MenuButton(player){var options=arguments.length<=1||arguments[1]===undefined?{}:arguments[1];_classCallCheck(this,MenuButton);_Button.call(this,player,options);this.update();this.on("keydown",this.handleKeyPress);this.el_.setAttribute("aria-haspopup",true);this.el_.setAttribute("role","button");}MenuButton.prototype.update=function update(){var menu=this.createMenu();if(this.menu){this.removeChild(this.menu);}this.menu=menu;this.addChild(menu);this.buttonPressed_=false;if(this.items&&this.items.length===0){this.hide();}else if(this.items&&this.items.length>1){this.show();}};MenuButton.prototype.createMenu=function createMenu(){var menu=new _menuJs2["default"](this.player_);if(this.options_.title){menu.contentEl().appendChild(Dom.createEl("li",{className:"vjs-menu-title",innerHTML:_utilsToTitleCaseJs2["default"](this.options_.title),tabIndex:-1}));}this.items=this["createItems"]();if(this.items){for(var i=0;i<this.items.length;i++){menu.addItem(this.items[i]);}}return menu;};MenuButton.prototype.createItems=function createItems(){};MenuButton.prototype.createEl=function createEl(){return _Button.prototype.createEl.call(this,"div",{className:this.buildCSSClass()});};MenuButton.prototype.buildCSSClass=function buildCSSClass(){var menuButtonClass="vjs-menu-button";if(this.options_.inline===true){menuButtonClass+="-inline";}else{menuButtonClass+="-popup";}return"vjs-menu-button "+menuButtonClass+" "+_Button.prototype.buildCSSClass.call(this);};MenuButton.prototype.handleFocus=function handleFocus(){};MenuButton.prototype.handleBlur=function handleBlur(){};MenuButton.prototype.handleClick=function handleClick(){this.one("mouseout",Fn.bind(this,function(){this.menu.unlockShowing();this.el_.blur();}));if(this.buttonPressed_){this.unpressButton();}else{this.pressButton();}};MenuButton.prototype.handleKeyPress=function handleKeyPress(event){if(event.which===32||event.which===13){if(this.buttonPressed_){this.unpressButton();}else{this.pressButton();}event.preventDefault();}else if(event.which===27){if(this.buttonPressed_){this.unpressButton();}event.preventDefault();}};MenuButton.prototype.pressButton=function pressButton(){this.buttonPressed_=true;this.menu.lockShowing();this.el_.setAttribute("aria-pressed",true);if(this.items&&this.items.length>0){this.items[0].el().focus();}};MenuButton.prototype.unpressButton=function unpressButton(){this.buttonPressed_=false;this.menu.unlockShowing();this.el_.setAttribute("aria-pressed",false);};return MenuButton;}(_buttonJs2["default"]);_componentJs2["default"].registerComponent("MenuButton",MenuButton);exports["default"]=MenuButton;module.exports=exports["default"];},{"../button.js":63,"../component.js":65,"../utils/dom.js":126,"../utils/fn.js":128,"../utils/to-title-case.js":135,"./menu.js":104}],103:[function(_dereq_,module,exports){"use strict";exports.__esModule=true;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var _buttonJs=_dereq_("../button.js");var _buttonJs2=_interopRequireDefault(_buttonJs);var _componentJs=_dereq_("../component.js");var _componentJs2=_interopRequireDefault(_componentJs);var _objectAssign=_dereq_("object.assign");var _objectAssign2=_interopRequireDefault(_objectAssign);var MenuItem=function(_Button){_inherits(MenuItem,_Button);function MenuItem(player,options){_classCallCheck(this,MenuItem);_Button.call(this,player,options);this.selected(options["selected"]);}MenuItem.prototype.createEl=function createEl(type,props,attrs){return _Button.prototype.createEl.call(this,"li",_objectAssign2["default"]({className:"vjs-menu-item",innerHTML:this.localize(this.options_["label"])},props),attrs);};MenuItem.prototype.handleClick=function handleClick(){this.selected(true);};MenuItem.prototype.selected=function selected(_selected){if(_selected){this.addClass("vjs-selected");this.el_.setAttribute("aria-selected",true);}else{this.removeClass("vjs-selected");this.el_.setAttribute("aria-selected",false);}};return MenuItem;}(_buttonJs2["default"]);_componentJs2["default"].registerComponent("MenuItem",MenuItem);exports["default"]=MenuItem;module.exports=exports["default"];},{"../button.js":63,"../component.js":65,"object.assign":45}],104:[function(_dereq_,module,exports){"use strict";exports.__esModule=true;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var _componentJs=_dereq_("../component.js");var _componentJs2=_interopRequireDefault(_componentJs);var _utilsDomJs=_dereq_("../utils/dom.js");var Dom=_interopRequireWildcard(_utilsDomJs);var _utilsFnJs=_dereq_("../utils/fn.js");var Fn=_interopRequireWildcard(_utilsFnJs);var _utilsEventsJs=_dereq_("../utils/events.js");var Events=_interopRequireWildcard(_utilsEventsJs);var Menu=function(_Component){_inherits(Menu,_Component);function Menu(){_classCallCheck(this,Menu);_Component.apply(this,arguments);}Menu.prototype.addItem=function addItem(component){this.addChild(component);component.on("click",Fn.bind(this,function(){this.unlockShowing();}));};Menu.prototype.createEl=function createEl(){var contentElType=this.options_.contentElType||"ul";this.contentEl_=Dom.createEl(contentElType,{className:"vjs-menu-content"});var el=_Component.prototype.createEl.call(this,"div",{append:this.contentEl_,className:"vjs-menu"});el.appendChild(this.contentEl_);Events.on(el,"click",function(event){event.preventDefault();event.stopImmediatePropagation();});return el;};return Menu;}(_componentJs2["default"]);_componentJs2["default"].registerComponent("Menu",Menu);exports["default"]=Menu;module.exports=exports["default"];},{"../component.js":65,"../utils/dom.js":126,"../utils/events.js":127,"../utils/fn.js":128}],105:[function(_dereq_,module,exports){"use strict";exports.__esModule=true;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var _globalDocument=_dereq_("global/document");var _globalDocument2=_interopRequireDefault(_globalDocument);var _utilsDom=_dereq_("./utils/dom");var Dom=_interopRequireWildcard(_utilsDom);var _utilsFn=_dereq_("./utils/fn");var Fn=_interopRequireWildcard(_utilsFn);var _utilsLog=_dereq_("./utils/log");var _utilsLog2=_interopRequireDefault(_utilsLog);var _component=_dereq_("./component");var _component2=_interopRequireDefault(_component);var _closeButton=_dereq_("./close-button");var _closeButton2=_interopRequireDefault(_closeButton);var MODAL_CLASS_NAME="vjs-modal-dialog";var ESC=27;var ModalDialog=function(_Component){_inherits(ModalDialog,_Component);function ModalDialog(player,options){_classCallCheck(this,ModalDialog);_Component.call(this,player,options);this.opened_=this.hasBeenOpened_=this.hasBeenFilled_=false;this.closeable(!this.options_.uncloseable);this.content(this.options_.content);this.contentEl_=Dom.createEl("div",{className:MODAL_CLASS_NAME+"-content"},{role:"document"});this.descEl_=Dom.createEl("p",{className:MODAL_CLASS_NAME+"-description vjs-offscreen",id:this.el().getAttribute("aria-describedby")});Dom.textContent(this.descEl_,this.description());this.el_.appendChild(this.descEl_);this.el_.appendChild(this.contentEl_);}ModalDialog.prototype.createEl=function createEl(){return _Component.prototype.createEl.call(this,"div",{className:this.buildCSSClass(),tabIndex:-1},{"aria-describedby":this.id()+"_description","aria-hidden":"true","aria-label":this.label(),role:"dialog"});};ModalDialog.prototype.buildCSSClass=function buildCSSClass(){return MODAL_CLASS_NAME+" vjs-hidden "+_Component.prototype.buildCSSClass.call(this);};ModalDialog.prototype.handleKeyPress=function handleKeyPress(e){if(e.which===ESC&&this.closeable()){this.close();}};ModalDialog.prototype.label=function label(){return this.options_.label||this.localize("Modal Window");};ModalDialog.prototype.description=function description(){var desc=this.options_.description||this.localize("This is a modal window.");if(this.closeable()){desc+=" "+this.localize("This modal can be closed by pressing the Escape key or activating the close button.");}return desc;};ModalDialog.prototype.open=function open(){if(!this.opened_){var player=this.player();this.trigger("beforemodalopen");this.opened_=true;if(this.options_.fillAlways||!this.hasBeenOpened_&&!this.hasBeenFilled_){this.fill();}this.wasPlaying_=!player.paused();if(this.wasPlaying_){player.pause();}if(this.closeable()){this.on(_globalDocument2["default"],"keydown",Fn.bind(this,this.handleKeyPress));}player.controls(false);this.show();this.el().setAttribute("aria-hidden","false");this.trigger("modalopen");this.hasBeenOpened_=true;}return this;};ModalDialog.prototype.opened=function opened(value){if(typeof value==="boolean"){this[value?"open":"close"]();}return this.opened_;};ModalDialog.prototype.close=function close(){if(this.opened_){var player=this.player();this.trigger("beforemodalclose");this.opened_=false;if(this.wasPlaying_){player.play();}if(this.closeable()){this.off(_globalDocument2["default"],"keydown",Fn.bind(this,this.handleKeyPress));}player.controls(true);this.hide();this.el().setAttribute("aria-hidden","true");this.trigger("modalclose");if(this.options_.temporary){this.dispose();}}return this;};ModalDialog.prototype.closeable=function closeable(value){if(typeof value==="boolean"){var closeable=this.closeable_=!!value;var _close=this.getChild("closeButton");if(closeable&&!_close){var temp=this.contentEl_;this.contentEl_=this.el_;_close=this.addChild("closeButton");this.contentEl_=temp;this.on(_close,"close",this.close);}if(!closeable&&_close){this.off(_close,"close",this.close);this.removeChild(_close);_close.dispose();}}return this.closeable_;};ModalDialog.prototype.fill=function fill(){return this.fillWith(this.content());};ModalDialog.prototype.fillWith=function fillWith(content){var contentEl=this.contentEl();var parentEl=contentEl.parentNode;var nextSiblingEl=contentEl.nextSibling;this.trigger("beforemodalfill");this.hasBeenFilled_=true;parentEl.removeChild(contentEl);this.empty();Dom.insertContent(contentEl,content);this.trigger("modalfill");if(nextSiblingEl){parentEl.insertBefore(contentEl,nextSiblingEl);}else{parentEl.appendChild(contentEl);}return this;};ModalDialog.prototype.empty=function empty(){this.trigger("beforemodalempty");Dom.emptyEl(this.contentEl());this.trigger("modalempty");return this;};ModalDialog.prototype.content=function content(value){if(typeof value!=="undefined"){this.content_=value;}return this.content_;};return ModalDialog;}(_component2["default"]);ModalDialog.prototype.options_={temporary:true};_component2["default"].registerComponent("ModalDialog",ModalDialog);exports["default"]=ModalDialog;module.exports=exports["default"];},{"./close-button":64,"./component":65,"./utils/dom":126,"./utils/fn":128,"./utils/log":131,"global/document":1}],106:[function(_dereq_,module,exports){"use strict";exports.__esModule=true;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var _componentJs=_dereq_("./component.js");var _componentJs2=_interopRequireDefault(_componentJs);var _globalDocument=_dereq_("global/document");var _globalDocument2=_interopRequireDefault(_globalDocument);var _globalWindow=_dereq_("global/window");var _globalWindow2=_interopRequireDefault(_globalWindow);var _utilsEventsJs=_dereq_("./utils/events.js");var Events=_interopRequireWildcard(_utilsEventsJs);var _utilsDomJs=_dereq_("./utils/dom.js");var Dom=_interopRequireWildcard(_utilsDomJs);var _utilsFnJs=_dereq_("./utils/fn.js");var Fn=_interopRequireWildcard(_utilsFnJs);var _utilsGuidJs=_dereq_("./utils/guid.js");var Guid=_interopRequireWildcard(_utilsGuidJs);var _utilsBrowserJs=_dereq_("./utils/browser.js");var browser=_interopRequireWildcard(_utilsBrowserJs);var _utilsLogJs=_dereq_("./utils/log.js");var _utilsLogJs2=_interopRequireDefault(_utilsLogJs);var _utilsToTitleCaseJs=_dereq_("./utils/to-title-case.js");var _utilsToTitleCaseJs2=_interopRequireDefault(_utilsToTitleCaseJs);var _utilsTimeRangesJs=_dereq_("./utils/time-ranges.js");var _utilsBufferJs=_dereq_("./utils/buffer.js");var _utilsStylesheetJs=_dereq_("./utils/stylesheet.js");var stylesheet=_interopRequireWildcard(_utilsStylesheetJs);var _fullscreenApiJs=_dereq_("./fullscreen-api.js");var _fullscreenApiJs2=_interopRequireDefault(_fullscreenApiJs);var _mediaErrorJs=_dereq_("./media-error.js");var _mediaErrorJs2=_interopRequireDefault(_mediaErrorJs);var _safeJsonParseTuple=_dereq_("safe-json-parse/tuple");var _safeJsonParseTuple2=_interopRequireDefault(_safeJsonParseTuple);var _objectAssign=_dereq_("object.assign");var _objectAssign2=_interopRequireDefault(_objectAssign);var _utilsMergeOptionsJs=_dereq_("./utils/merge-options.js");var _utilsMergeOptionsJs2=_interopRequireDefault(_utilsMergeOptionsJs);var _tracksTextTrackListConverterJs=_dereq_("./tracks/text-track-list-converter.js");var _tracksTextTrackListConverterJs2=_interopRequireDefault(_tracksTextTrackListConverterJs);var _techLoaderJs=_dereq_("./tech/loader.js");var _techLoaderJs2=_interopRequireDefault(_techLoaderJs);var _posterImageJs=_dereq_("./poster-image.js");var _posterImageJs2=_interopRequireDefault(_posterImageJs);var _tracksTextTrackDisplayJs=_dereq_("./tracks/text-track-display.js");var _tracksTextTrackDisplayJs2=_interopRequireDefault(_tracksTextTrackDisplayJs);var _loadingSpinnerJs=_dereq_("./loading-spinner.js");var _loadingSpinnerJs2=_interopRequireDefault(_loadingSpinnerJs);var _bigPlayButtonJs=_dereq_("./big-play-button.js");var _bigPlayButtonJs2=_interopRequireDefault(_bigPlayButtonJs);var _controlBarControlBarJs=_dereq_("./control-bar/control-bar.js");var _controlBarControlBarJs2=_interopRequireDefault(_controlBarControlBarJs);var _errorDisplayJs=_dereq_("./error-display.js");var _errorDisplayJs2=_interopRequireDefault(_errorDisplayJs);var _tracksTextTrackSettingsJs=_dereq_("./tracks/text-track-settings.js");var _tracksTextTrackSettingsJs2=_interopRequireDefault(_tracksTextTrackSettingsJs);var _modalDialog=_dereq_("./modal-dialog");var _modalDialog2=_interopRequireDefault(_modalDialog);var _techTechJs=_dereq_("./tech/tech.js");var _techTechJs2=_interopRequireDefault(_techTechJs);var _techHtml5Js=_dereq_("./tech/html5.js");var _techHtml5Js2=_interopRequireDefault(_techHtml5Js);var Player=function(_Component){_inherits(Player,_Component);function Player(tag,options,ready){var _this=this;_classCallCheck(this,Player);tag.id=tag.id||"vjs_video_"+Guid.newGUID();options=_objectAssign2["default"](Player.getTagSettings(tag),options);options.initChildren=false;options.createEl=false;options.reportTouchActivity=false;_Component.call(this,null,options,ready);if(!this.options_||!this.options_.techOrder||!this.options_.techOrder.length){throw new Error("No techOrder specified. Did you overwrite "+"videojs.options instead of just changing the "+"properties you want to override?");}this.tag=tag;this.tagAttributes=tag&&Dom.getElAttributes(tag);this.language(this.options_.language);if(options.languages){(function(){var languagesToLower={};Object.getOwnPropertyNames(options.languages).forEach(function(name){languagesToLower[name.toLowerCase()]=options.languages[name];});_this.languages_=languagesToLower;})();}else{this.languages_=Player.prototype.options_.languages;}this.cache_={};this.poster_=options.poster||"";this.controls_=!!options.controls;tag.controls=false;this.scrubbing_=false;this.el_=this.createEl();var playerOptionsCopy=_utilsMergeOptionsJs2["default"](this.options_);if(options.plugins){(function(){var plugins=options.plugins;Object.getOwnPropertyNames(plugins).forEach(function(name){if(typeof this[name]==="function"){this[name](plugins[name]);}else{_utilsLogJs2["default"].error("Unable to find plugin:",name);}},_this);})();}this.options_.playerOptions=playerOptionsCopy;this.initChildren();this.isAudio(tag.nodeName.toLowerCase()==="audio");if(this.controls()){this.addClass("vjs-controls-enabled");}else{this.addClass("vjs-controls-disabled");}if(this.isAudio()){this.addClass("vjs-audio");}if(this.flexNotSupported_()){this.addClass("vjs-no-flex");}Player.players[this.id_]=this;this.userActive(true);this.reportUserActivity();this.listenForUserActivity_();this.on("fullscreenchange",this.handleFullscreenChange_);this.on("stageclick",this.handleStageClick_);}Player.prototype.dispose=function dispose(){this.trigger("dispose");this.off("dispose");if(this.styleEl_){this.styleEl_.parentNode.removeChild(this.styleEl_);}Player.players[this.id_]=null;if(this.tag&&this.tag.player){this.tag.player=null;}if(this.el_&&this.el_.player){this.el_.player=null;}if(this.tech_){this.tech_.dispose();}_Component.prototype.dispose.call(this);};Player.prototype.createEl=function createEl(){var el=this.el_=_Component.prototype.createEl.call(this,"div");var tag=this.tag;tag.removeAttribute("width");tag.removeAttribute("height");var attrs=Dom.getElAttributes(tag);Object.getOwnPropertyNames(attrs).forEach(function(attr){if(attr==="class"){el.className=attrs[attr];}else{el.setAttribute(attr,attrs[attr]);}});tag.id+="_html5_api";tag.className="vjs-tech";tag.player=el.player=this;this.addClass("vjs-paused");this.styleEl_=stylesheet.createStyleElement("vjs-styles-dimensions");var defaultsStyleEl=Dom.$(".vjs-styles-defaults");var head=Dom.$("head");head.insertBefore(this.styleEl_,defaultsStyleEl?defaultsStyleEl.nextSibling:head.firstChild);this.width(this.options_.width);this.height(this.options_.height);this.fluid(this.options_.fluid);this.aspectRatio(this.options_.aspectRatio);tag.initNetworkState_=tag.networkState;if(tag.parentNode){tag.parentNode.insertBefore(el,tag);}Dom.insertElFirst(tag,el);this.el_=el;return el;};Player.prototype.width=function width(value){return this.dimension("width",value);};Player.prototype.height=function height(value){return this.dimension("height",value);};Player.prototype.dimension=function dimension(_dimension,value){var privDimension=_dimension+"_";if(value===undefined){return this[privDimension]||0;}if(value===""){this[privDimension]=undefined;}else{var parsedVal=parseFloat(value);if(isNaN(parsedVal)){_utilsLogJs2["default"].error('Improper value "'+value+'" supplied for for '+_dimension);return this;}this[privDimension]=parsedVal;}this.updateStyleEl_();return this;};Player.prototype.fluid=function fluid(bool){if(bool===undefined){return!!this.fluid_;}this.fluid_=!!bool;if(bool){this.addClass("vjs-fluid");}else{this.removeClass("vjs-fluid");}};Player.prototype.aspectRatio=function aspectRatio(ratio){if(ratio===undefined){return this.aspectRatio_;}if(!/^\d+\:\d+$/.test(ratio)){throw new Error("Improper value supplied for aspect ratio. The format should be width:height, for example 16:9.");}this.aspectRatio_=ratio;this.fluid(true);this.updateStyleEl_();};Player.prototype.updateStyleEl_=function updateStyleEl_(){var width=undefined;var height=undefined;var aspectRatio=undefined;var idClass=undefined;if(this.aspectRatio_!==undefined&&this.aspectRatio_!=="auto"){aspectRatio=this.aspectRatio_;}else if(this.videoWidth()){aspectRatio=this.videoWidth()+":"+this.videoHeight();}else{aspectRatio="16:9";}var ratioParts=aspectRatio.split(":");var ratioMultiplier=ratioParts[1]/ratioParts[0];if(this.width_!==undefined){width=this.width_;}else if(this.height_!==undefined){width=this.height_/ratioMultiplier;}else{width=this.videoWidth()||300;}if(this.height_!==undefined){height=this.height_;}else{height=width*ratioMultiplier;}if(/^[^a-zA-Z]/.test(this.id())){idClass="dimensions-"+this.id();}else{idClass=this.id()+"-dimensions";}this.addClass(idClass);stylesheet.setTextContent(this.styleEl_,"\n      ."+idClass+" {\n        width: "+width+"px;\n        height: "+height+"px;\n      }\n\n      ."+idClass+".vjs-fluid {\n        padding-top: "+ratioMultiplier*100+"%;\n      }\n    ");};Player.prototype.loadTech_=function loadTech_(techName,source){if(this.tech_){this.unloadTech_();}if(techName!=="Html5"&&this.tag){_techTechJs2["default"].getTech("Html5").disposeMediaElement(this.tag);this.tag.player=null;this.tag=null;}this.techName_=techName;this.isReady_=false;var techOptions=_objectAssign2["default"]({nativeControlsForTouch:this.options_.nativeControlsForTouch,source:source,playerId:this.id(),techId:this.id()+"_"+techName+"_api",textTracks:this.textTracks_,autoplay:this.options_.autoplay,preload:this.options_.preload,loop:this.options_.loop,muted:this.options_.muted,poster:this.poster(),language:this.language(),"vtt.js":this.options_["vtt.js"]},this.options_[techName.toLowerCase()]);if(this.tag){techOptions.tag=this.tag;}if(source){this.currentType_=source.type;if(source.src===this.cache_.src&&this.cache_.currentTime>0){techOptions.startTime=this.cache_.currentTime;}this.cache_.src=source.src;}var techComponent=_techTechJs2["default"].getTech(techName);if(!techComponent){techComponent=_componentJs2["default"].getComponent(techName);}this.tech_=new techComponent(techOptions);this.tech_.ready(Fn.bind(this,this.handleTechReady_),true);_tracksTextTrackListConverterJs2["default"].jsonToTextTracks(this.textTracksJson_||[],this.tech_);this.on(this.tech_,"loadstart",this.handleTechLoadStart_);this.on(this.tech_,"waiting",this.handleTechWaiting_);this.on(this.tech_,"canplay",this.handleTechCanPlay_);this.on(this.tech_,"canplaythrough",this.handleTechCanPlayThrough_);this.on(this.tech_,"playing",this.handleTechPlaying_);this.on(this.tech_,"ended",this.handleTechEnded_);this.on(this.tech_,"seeking",this.handleTechSeeking_);this.on(this.tech_,"seeked",this.handleTechSeeked_);this.on(this.tech_,"play",this.handleTechPlay_);this.on(this.tech_,"firstplay",this.handleTechFirstPlay_);this.on(this.tech_,"pause",this.handleTechPause_);this.on(this.tech_,"progress",this.handleTechProgress_);this.on(this.tech_,"durationchange",this.handleTechDurationChange_);this.on(this.tech_,"fullscreenchange",this.handleTechFullscreenChange_);this.on(this.tech_,"error",this.handleTechError_);this.on(this.tech_,"suspend",this.handleTechSuspend_);this.on(this.tech_,"abort",this.handleTechAbort_);this.on(this.tech_,"emptied",this.handleTechEmptied_);this.on(this.tech_,"stalled",this.handleTechStalled_);this.on(this.tech_,"loadedmetadata",this.handleTechLoadedMetaData_);this.on(this.tech_,"loadeddata",this.handleTechLoadedData_);this.on(this.tech_,"timeupdate",this.handleTechTimeUpdate_);this.on(this.tech_,"ratechange",this.handleTechRateChange_);this.on(this.tech_,"volumechange",this.handleTechVolumeChange_);this.on(this.tech_,"texttrackchange",this.handleTechTextTrackChange_);this.on(this.tech_,"loadedmetadata",this.updateStyleEl_);this.on(this.tech_,"posterchange",this.handleTechPosterChange_);this.usingNativeControls(this.techGet_("controls"));if(this.controls()&&!this.usingNativeControls()){this.addTechControlsListeners_();}if(this.tech_.el().parentNode!==this.el()&&(techName!=="Html5"||!this.tag)){Dom.insertElFirst(this.tech_.el(),this.el());}if(this.tag){this.tag.player=null;this.tag=null;}};Player.prototype.unloadTech_=function unloadTech_(){this.textTracks_=this.textTracks();this.textTracksJson_=_tracksTextTrackListConverterJs2["default"].textTracksToJson(this.tech_);this.isReady_=false;this.tech_.dispose();this.tech_=false;};Player.prototype.addTechControlsListeners_=function addTechControlsListeners_(){this.removeTechControlsListeners_();this.on(this.tech_,"mousedown",this.handleTechClick_);this.on(this.tech_,"touchstart",this.handleTechTouchStart_);this.on(this.tech_,"touchmove",this.handleTechTouchMove_);this.on(this.tech_,"touchend",this.handleTechTouchEnd_);this.on(this.tech_,"tap",this.handleTechTap_);};Player.prototype.removeTechControlsListeners_=function removeTechControlsListeners_(){this.off(this.tech_,"tap",this.handleTechTap_);this.off(this.tech_,"touchstart",this.handleTechTouchStart_);this.off(this.tech_,"touchmove",this.handleTechTouchMove_);this.off(this.tech_,"touchend",this.handleTechTouchEnd_);this.off(this.tech_,"mousedown",this.handleTechClick_);};Player.prototype.handleTechReady_=function handleTechReady_(){this.triggerReady();if(this.cache_.volume){this.techCall_("setVolume",this.cache_.volume);}this.handleTechPosterChange_();this.handleTechDurationChange_();if(this.tag&&this.options_.autoplay&&this.paused()){delete this.tag.poster;this.play();}};Player.prototype.handleTechLoadStart_=function handleTechLoadStart_(){this.removeClass("vjs-ended");this.error(null);if(!this.paused()){this.trigger("loadstart");this.trigger("firstplay");}else{this.hasStarted(false);this.trigger("loadstart");}};Player.prototype.hasStarted=function hasStarted(_hasStarted){if(_hasStarted!==undefined){if(this.hasStarted_!==_hasStarted){this.hasStarted_=_hasStarted;if(_hasStarted){this.addClass("vjs-has-started");this.trigger("firstplay");}else{this.removeClass("vjs-has-started");}}return this;}return!!this.hasStarted_;};Player.prototype.handleTechPlay_=function handleTechPlay_(){this.removeClass("vjs-ended");this.removeClass("vjs-paused");this.addClass("vjs-playing");this.hasStarted(true);this.trigger("play");};Player.prototype.handleTechWaiting_=function handleTechWaiting_(){this.addClass("vjs-waiting");this.trigger("waiting");};Player.prototype.handleTechCanPlay_=function handleTechCanPlay_(){this.removeClass("vjs-waiting");this.trigger("canplay");};Player.prototype.handleTechCanPlayThrough_=function handleTechCanPlayThrough_(){this.removeClass("vjs-waiting");this.trigger("canplaythrough");};Player.prototype.handleTechPlaying_=function handleTechPlaying_(){this.removeClass("vjs-waiting");this.trigger("playing");};Player.prototype.handleTechSeeking_=function handleTechSeeking_(){this.addClass("vjs-seeking");this.trigger("seeking");};Player.prototype.handleTechSeeked_=function handleTechSeeked_(){this.removeClass("vjs-seeking");this.trigger("seeked");};Player.prototype.handleTechFirstPlay_=function handleTechFirstPlay_(){if(this.options_.starttime){this.currentTime(this.options_.starttime);}this.addClass("vjs-has-started");this.trigger("firstplay");};Player.prototype.handleTechPause_=function handleTechPause_(){this.removeClass("vjs-playing");this.addClass("vjs-paused");this.trigger("pause");};Player.prototype.handleTechProgress_=function handleTechProgress_(){this.trigger("progress");};Player.prototype.handleTechEnded_=function handleTechEnded_(){this.addClass("vjs-ended");if(this.options_.loop){this.currentTime(0);this.play();}else if(!this.paused()){this.pause();}this.trigger("ended");};Player.prototype.handleTechDurationChange_=function handleTechDurationChange_(){this.duration(this.techGet_("duration"));};Player.prototype.handleTechClick_=function handleTechClick_(event){if(event.button!==0)return;if(this.controls()){if(this.paused()){this.play();}else{this.pause();}}};Player.prototype.handleTechTap_=function handleTechTap_(){this.userActive(!this.userActive());};Player.prototype.handleTechTouchStart_=function handleTechTouchStart_(){this.userWasActive=this.userActive();};Player.prototype.handleTechTouchMove_=function handleTechTouchMove_(){if(this.userWasActive){this.reportUserActivity();}};Player.prototype.handleTechTouchEnd_=function handleTechTouchEnd_(event){event.preventDefault();};Player.prototype.handleFullscreenChange_=function handleFullscreenChange_(){if(this.isFullscreen()){this.addClass("vjs-fullscreen");}else{this.removeClass("vjs-fullscreen");}};Player.prototype.handleStageClick_=function handleStageClick_(){this.reportUserActivity();};Player.prototype.handleTechFullscreenChange_=function handleTechFullscreenChange_(event,data){if(data){this.isFullscreen(data.isFullscreen);}this.trigger("fullscreenchange");};Player.prototype.handleTechError_=function handleTechError_(){var error=this.tech_.error();this.error(error&&error.code);};Player.prototype.handleTechSuspend_=function handleTechSuspend_(){this.trigger("suspend");};Player.prototype.handleTechAbort_=function handleTechAbort_(){this.trigger("abort");};Player.prototype.handleTechEmptied_=function handleTechEmptied_(){this.trigger("emptied");};Player.prototype.handleTechStalled_=function handleTechStalled_(){this.trigger("stalled");};Player.prototype.handleTechLoadedMetaData_=function handleTechLoadedMetaData_(){this.trigger("loadedmetadata");};Player.prototype.handleTechLoadedData_=function handleTechLoadedData_(){this.trigger("loadeddata");};Player.prototype.handleTechTimeUpdate_=function handleTechTimeUpdate_(){this.trigger("timeupdate");};Player.prototype.handleTechRateChange_=function handleTechRateChange_(){this.trigger("ratechange");};Player.prototype.handleTechVolumeChange_=function handleTechVolumeChange_(){this.trigger("volumechange");};Player.prototype.handleTechTextTrackChange_=function handleTechTextTrackChange_(){this.trigger("texttrackchange");};Player.prototype.getCache=function getCache(){return this.cache_;};Player.prototype.techCall_=function techCall_(method,arg){if(this.tech_&&!this.tech_.isReady_){this.tech_.ready(function(){this[method](arg);},true);}else{try{this.tech_[method](arg);}catch(e){_utilsLogJs2["default"](e);throw e;}}};Player.prototype.techGet_=function techGet_(method){if(this.tech_&&this.tech_.isReady_){try{return this.tech_[method]();}catch(e){if(this.tech_[method]===undefined){_utilsLogJs2["default"]("Video.js: "+method+" method not defined for "+this.techName_+" playback technology.",e);}else{if(e.name==="TypeError"){_utilsLogJs2["default"]("Video.js: "+method+" unavailable on "+this.techName_+" playback technology element.",e);this.tech_.isReady_=false;}else{_utilsLogJs2["default"](e);}}throw e;}}return;};Player.prototype.play=function play(){this.techCall_("play");return this;};Player.prototype.pause=function pause(){this.techCall_("pause");return this;};Player.prototype.paused=function paused(){return this.techGet_("paused")===false?false:true;};Player.prototype.scrubbing=function scrubbing(isScrubbing){if(isScrubbing!==undefined){this.scrubbing_=!!isScrubbing;if(isScrubbing){this.addClass("vjs-scrubbing");}else{this.removeClass("vjs-scrubbing");}return this;}return this.scrubbing_;};Player.prototype.currentTime=function currentTime(seconds){if(seconds!==undefined){this.techCall_("setCurrentTime",seconds);return this;}return this.cache_.currentTime=this.techGet_("currentTime")||0;};Player.prototype.duration=function duration(seconds){if(seconds===undefined){return this.cache_.duration||0;}seconds=parseFloat(seconds)||0;if(seconds<0){seconds=Infinity;}if(seconds!==this.cache_.duration){this.cache_.duration=seconds;if(seconds===Infinity){this.addClass("vjs-live");}else{this.removeClass("vjs-live");}this.trigger("durationchange");}return this;};Player.prototype.remainingTime=function remainingTime(){return this.duration()-this.currentTime();};Player.prototype.buffered=function buffered(){var buffered=this.techGet_("buffered");if(!buffered||!buffered.length){buffered=_utilsTimeRangesJs.createTimeRange(0,0);}return buffered;};Player.prototype.bufferedPercent=function bufferedPercent(){return _utilsBufferJs.bufferedPercent(this.buffered(),this.duration());};Player.prototype.bufferedEnd=function bufferedEnd(){var buffered=this.buffered(),duration=this.duration(),end=buffered.end(buffered.length-1);if(end>duration){end=duration;}return end;};Player.prototype.volume=function volume(percentAsDecimal){var vol=undefined;if(percentAsDecimal!==undefined){vol=Math.max(0,Math.min(1,parseFloat(percentAsDecimal)));this.cache_.volume=vol;this.techCall_("setVolume",vol);return this;}vol=parseFloat(this.techGet_("volume"));return isNaN(vol)?1:vol;};Player.prototype.muted=function muted(_muted){if(_muted!==undefined){this.techCall_("setMuted",_muted);return this;}return this.techGet_("muted")||false;};Player.prototype.supportsFullScreen=function supportsFullScreen(){return this.techGet_("supportsFullScreen")||false;};Player.prototype.isFullscreen=function isFullscreen(isFS){if(isFS!==undefined){this.isFullscreen_=!!isFS;return this;}return!!this.isFullscreen_;};Player.prototype.requestFullscreen=function requestFullscreen(){var fsApi=_fullscreenApiJs2["default"];this.isFullscreen(true);if(fsApi.requestFullscreen){Events.on(_globalDocument2["default"],fsApi.fullscreenchange,Fn.bind(this,function documentFullscreenChange(e){this.isFullscreen(_globalDocument2["default"][fsApi.fullscreenElement]);if(this.isFullscreen()===false){Events.off(_globalDocument2["default"],fsApi.fullscreenchange,documentFullscreenChange);}this.trigger("fullscreenchange");}));this.el_[fsApi.requestFullscreen]();}else if(this.tech_.supportsFullScreen()){this.techCall_("enterFullScreen");}else{this.enterFullWindow();this.trigger("fullscreenchange");}return this;};Player.prototype.exitFullscreen=function exitFullscreen(){var fsApi=_fullscreenApiJs2["default"];this.isFullscreen(false);if(fsApi.requestFullscreen){_globalDocument2["default"][fsApi.exitFullscreen]();}else if(this.tech_.supportsFullScreen()){this.techCall_("exitFullScreen");}else{this.exitFullWindow();this.trigger("fullscreenchange");}return this;};Player.prototype.enterFullWindow=function enterFullWindow(){this.isFullWindow=true;this.docOrigOverflow=_globalDocument2["default"].documentElement.style.overflow;Events.on(_globalDocument2["default"],"keydown",Fn.bind(this,this.fullWindowOnEscKey));_globalDocument2["default"].documentElement.style.overflow="hidden";Dom.addElClass(_globalDocument2["default"].body,"vjs-full-window");this.trigger("enterFullWindow");};Player.prototype.fullWindowOnEscKey=function fullWindowOnEscKey(event){if(event.keyCode===27){if(this.isFullscreen()===true){this.exitFullscreen();}else{this.exitFullWindow();}}};Player.prototype.exitFullWindow=function exitFullWindow(){this.isFullWindow=false;Events.off(_globalDocument2["default"],"keydown",this.fullWindowOnEscKey);_globalDocument2["default"].documentElement.style.overflow=this.docOrigOverflow;Dom.removeElClass(_globalDocument2["default"].body,"vjs-full-window");this.trigger("exitFullWindow");};Player.prototype.canPlayType=function canPlayType(type){var can=undefined;for(var i=0,j=this.options_.techOrder;i<j.length;i++){var techName=_utilsToTitleCaseJs2["default"](j[i]);var tech=_techTechJs2["default"].getTech(techName);if(!tech){tech=_componentJs2["default"].getComponent(techName);}if(!tech){_utilsLogJs2["default"].error('The "'+techName+'" tech is undefined. Skipped browser support check for that tech.');continue;}if(tech.isSupported()){can=tech.canPlayType(type);if(can){return can;}}}return"";};Player.prototype.selectSource=function selectSource(sources){var techs=this.options_.techOrder.map(_utilsToTitleCaseJs2["default"]).map(function(techName){return[techName,_techTechJs2["default"].getTech(techName)||_componentJs2["default"].getComponent(techName)];}).filter(function(_ref){var techName=_ref[0];var tech=_ref[1];if(tech){return tech.isSupported();}_utilsLogJs2["default"].error('The "'+techName+'" tech is undefined. Skipped browser support check for that tech.');return false;});var findFirstPassingTechSourcePair=function findFirstPassingTechSourcePair(outerArray,innerArray,tester){var found=undefined;outerArray.some(function(outerChoice){return innerArray.some(function(innerChoice){found=tester(outerChoice,innerChoice);if(found){return true;}});});return found;};var foundSourceAndTech=undefined;var flip=function flip(fn){return function(a,b){return fn(b,a);};};var finder=function finder(_ref2,source){var techName=_ref2[0];var tech=_ref2[1];if(tech.canPlaySource(source)){return{source:source,tech:techName};}};if(this.options_.sourceOrder){foundSourceAndTech=findFirstPassingTechSourcePair(sources,techs,flip(finder));}else{foundSourceAndTech=findFirstPassingTechSourcePair(techs,sources,finder);}return foundSourceAndTech||false;};Player.prototype.src=function src(source){if(source===undefined){return this.techGet_("src");}var currentTech=_techTechJs2["default"].getTech(this.techName_);if(!currentTech){currentTech=_componentJs2["default"].getComponent(this.techName_);}if(Array.isArray(source)){this.sourceList_(source);}else if(typeof source==="string"){this.src({src:source});}else if(source instanceof Object){if(source.type&&!currentTech.canPlaySource(source)){this.sourceList_([source]);}else{this.cache_.src=source.src;this.currentType_=source.type||"";this.ready(function(){if(currentTech.prototype.hasOwnProperty("setSource")){this.techCall_("setSource",source);}else{this.techCall_("src",source.src);}if(this.options_.preload==="auto"){this.load();}if(this.options_.autoplay){this.play();}},true);}}return this;};Player.prototype.sourceList_=function sourceList_(sources){var sourceTech=this.selectSource(sources);if(sourceTech){if(sourceTech.tech===this.techName_){this.src(sourceTech.source);}else{this.loadTech_(sourceTech.tech,sourceTech.source);}}else{this.setTimeout(function(){this.error({code:4,message:this.localize(this.options_.notSupportedMessage)});},0);this.triggerReady();}};Player.prototype.load=function load(){this.techCall_("load");return this;};Player.prototype.currentSrc=function currentSrc(){return this.techGet_("currentSrc")||this.cache_.src||"";};Player.prototype.currentType=function currentType(){return this.currentType_||"";};Player.prototype.preload=function preload(value){if(value!==undefined){this.techCall_("setPreload",value);this.options_.preload=value;return this;}return this.techGet_("preload");};Player.prototype.autoplay=function autoplay(value){if(value!==undefined){this.techCall_("setAutoplay",value);this.options_.autoplay=value;return this;}return this.techGet_("autoplay",value);};Player.prototype.loop=function loop(value){if(value!==undefined){this.techCall_("setLoop",value);this.options_["loop"]=value;return this;}return this.techGet_("loop");};Player.prototype.poster=function poster(src){if(src===undefined){return this.poster_;}if(!src){src="";}this.poster_=src;this.techCall_("setPoster",src);this.trigger("posterchange");return this;};Player.prototype.handleTechPosterChange_=function handleTechPosterChange_(){if(!this.poster_&&this.tech_&&this.tech_.poster){this.poster_=this.tech_.poster()||"";this.trigger("posterchange");}};Player.prototype.controls=function controls(bool){if(bool!==undefined){bool=!!bool;if(this.controls_!==bool){this.controls_=bool;if(this.usingNativeControls()){this.techCall_("setControls",bool);}if(bool){this.removeClass("vjs-controls-disabled");this.addClass("vjs-controls-enabled");this.trigger("controlsenabled");if(!this.usingNativeControls()){this.addTechControlsListeners_();}}else{this.removeClass("vjs-controls-enabled");this.addClass("vjs-controls-disabled");this.trigger("controlsdisabled");if(!this.usingNativeControls()){this.removeTechControlsListeners_();}}}return this;}return!!this.controls_;};Player.prototype.usingNativeControls=function usingNativeControls(bool){if(bool!==undefined){bool=!!bool;if(this.usingNativeControls_!==bool){this.usingNativeControls_=bool;if(bool){this.addClass("vjs-using-native-controls");this.trigger("usingnativecontrols");}else{this.removeClass("vjs-using-native-controls");this.trigger("usingcustomcontrols");}}return this;}return!!this.usingNativeControls_;};Player.prototype.error=function error(err){if(err===undefined){return this.error_||null;}if(err===null){this.error_=err;this.removeClass("vjs-error");this.errorDisplay.close();return this;}if(err instanceof _mediaErrorJs2["default"]){this.error_=err;}else{this.error_=new _mediaErrorJs2["default"](err);}this.addClass("vjs-error");_utilsLogJs2["default"].error("(CODE:"+this.error_.code+" "+_mediaErrorJs2["default"].errorTypes[this.error_.code]+")",this.error_.message,this.error_);this.trigger("error");return this;};Player.prototype.ended=function ended(){return this.techGet_("ended");};Player.prototype.seeking=function seeking(){return this.techGet_("seeking");};Player.prototype.seekable=function seekable(){return this.techGet_("seekable");};Player.prototype.reportUserActivity=function reportUserActivity(event){this.userActivity_=true;};Player.prototype.userActive=function userActive(bool){if(bool!==undefined){bool=!!bool;if(bool!==this.userActive_){this.userActive_=bool;if(bool){this.userActivity_=true;this.removeClass("vjs-user-inactive");this.addClass("vjs-user-active");this.trigger("useractive");}else{this.userActivity_=false;if(this.tech_){this.tech_.one("mousemove",function(e){e.stopPropagation();e.preventDefault();});}this.removeClass("vjs-user-active");this.addClass("vjs-user-inactive");this.trigger("userinactive");}}return this;}return this.userActive_;};Player.prototype.listenForUserActivity_=function listenForUserActivity_(){var mouseInProgress=undefined,lastMoveX=undefined,lastMoveY=undefined;var handleActivity=Fn.bind(this,this.reportUserActivity);var handleMouseMove=function handleMouseMove(e){if(e.screenX!==lastMoveX||e.screenY!==lastMoveY){lastMoveX=e.screenX;lastMoveY=e.screenY;handleActivity();}};var handleMouseDown=function handleMouseDown(){handleActivity();this.clearInterval(mouseInProgress);mouseInProgress=this.setInterval(handleActivity,250);};var handleMouseUp=function handleMouseUp(event){handleActivity();this.clearInterval(mouseInProgress);};this.on("mousedown",handleMouseDown);this.on("mousemove",handleMouseMove);this.on("mouseup",handleMouseUp);this.on("keydown",handleActivity);this.on("keyup",handleActivity);var inactivityTimeout=undefined;var activityCheck=this.setInterval(function(){if(this.userActivity_){this.userActivity_=false;this.userActive(true);this.clearTimeout(inactivityTimeout);var timeout=this.options_["inactivityTimeout"];if(timeout>0){inactivityTimeout=this.setTimeout(function(){if(!this.userActivity_){this.userActive(false);}},timeout);}}},250);};Player.prototype.playbackRate=function playbackRate(rate){if(rate!==undefined){this.techCall_("setPlaybackRate",rate);return this;}if(this.tech_&&this.tech_["featuresPlaybackRate"]){return this.techGet_("playbackRate");}else{return 1;}};Player.prototype.isAudio=function isAudio(bool){if(bool!==undefined){this.isAudio_=!!bool;return this;}return!!this.isAudio_;};Player.prototype.networkState=function networkState(){return this.techGet_("networkState");};Player.prototype.readyState=function readyState(){return this.techGet_("readyState");};Player.prototype.textTracks=function textTracks(){return this.tech_&&this.tech_["textTracks"]();};Player.prototype.remoteTextTracks=function remoteTextTracks(){return this.tech_&&this.tech_["remoteTextTracks"]();};Player.prototype.addTextTrack=function addTextTrack(kind,label,language){return this.tech_&&this.tech_["addTextTrack"](kind,label,language);};Player.prototype.addRemoteTextTrack=function addRemoteTextTrack(options){return this.tech_&&this.tech_["addRemoteTextTrack"](options);};Player.prototype.removeRemoteTextTrack=function removeRemoteTextTrack(track){this.tech_&&this.tech_["removeRemoteTextTrack"](track);};Player.prototype.videoWidth=function videoWidth(){return this.tech_&&this.tech_.videoWidth&&this.tech_.videoWidth()||0;};Player.prototype.videoHeight=function videoHeight(){return this.tech_&&this.tech_.videoHeight&&this.tech_.videoHeight()||0;};Player.prototype.language=function language(code){if(code===undefined){return this.language_;}this.language_=(""+code).toLowerCase();return this;};Player.prototype.languages=function languages(){return _utilsMergeOptionsJs2["default"](Player.prototype.options_.languages,this.languages_);};Player.prototype.toJSON=function toJSON(){var options=_utilsMergeOptionsJs2["default"](this.options_);var tracks=options.tracks;options.tracks=[];for(var i=0;i<tracks.length;i++){var track=tracks[i];track=_utilsMergeOptionsJs2["default"](track);track.player=undefined;options.tracks[i]=track;}return options;};Player.prototype.createModal=function createModal(content,options){var player=this;options=options||{};options.content=content||"";var modal=new _modalDialog2["default"](player,options);player.addChild(modal);modal.on("dispose",function(){player.removeChild(modal);});return modal.open();};Player.getTagSettings=function getTagSettings(tag){var baseOptions={sources:[],tracks:[]};var tagOptions=Dom.getElAttributes(tag);var dataSetup=tagOptions["data-setup"];if(dataSetup!==null){var _safeParseTuple=_safeJsonParseTuple2["default"](dataSetup||"{}");var err=_safeParseTuple[0];var data=_safeParseTuple[1];if(err){_utilsLogJs2["default"].error(err);}_objectAssign2["default"](tagOptions,data);}_objectAssign2["default"](baseOptions,tagOptions);if(tag.hasChildNodes()){var children=tag.childNodes;for(var i=0,j=children.length;i<j;i++){var child=children[i];var childName=child.nodeName.toLowerCase();if(childName==="source"){baseOptions.sources.push(Dom.getElAttributes(child));}else if(childName==="track"){baseOptions.tracks.push(Dom.getElAttributes(child));}}}return baseOptions;};return Player;}(_componentJs2["default"]);Player.players={};var navigator=_globalWindow2["default"].navigator;Player.prototype.options_={techOrder:["html5","flash"],html5:{},flash:{},defaultVolume:0,inactivityTimeout:2e3,playbackRates:[],children:["mediaLoader","posterImage","textTrackDisplay","loadingSpinner","bigPlayButton","controlBar","errorDisplay","textTrackSettings"],language:_globalDocument2["default"].getElementsByTagName("html")[0].getAttribute("lang")||navigator.languages&&navigator.languages[0]||navigator.userLanguage||navigator.language||"en",languages:{},notSupportedMessage:"No compatible source was found for this video."};Player.prototype.handleLoadedMetaData_;Player.prototype.handleLoadedData_;Player.prototype.handleUserActive_;Player.prototype.handleUserInactive_;Player.prototype.handleTimeUpdate_;Player.prototype.handleTechEnded_;Player.prototype.handleVolumeChange_;Player.prototype.handleError_;Player.prototype.flexNotSupported_=function(){var elem=_globalDocument2["default"].createElement("i");return!("flexBasis"in elem.style||"webkitFlexBasis"in elem.style||"mozFlexBasis"in elem.style||"msFlexBasis"in elem.style||"msFlexOrder"in elem.style);};_componentJs2["default"].registerComponent("Player",Player);exports["default"]=Player;module.exports=exports["default"];},{"./big-play-button.js":62,"./component.js":65,"./control-bar/control-bar.js":66,"./error-display.js":96,"./fullscreen-api.js":99,"./loading-spinner.js":100,"./media-error.js":101,"./modal-dialog":105,"./poster-image.js":108,"./tech/html5.js":113,"./tech/loader.js":114,"./tech/tech.js":115,"./tracks/text-track-display.js":117,"./tracks/text-track-list-converter.js":119,"./tracks/text-track-settings.js":121,"./utils/browser.js":123,"./utils/buffer.js":124,"./utils/dom.js":126,"./utils/events.js":127,"./utils/fn.js":128,"./utils/guid.js":130,"./utils/log.js":131,"./utils/merge-options.js":132,"./utils/stylesheet.js":133,"./utils/time-ranges.js":134,"./utils/to-title-case.js":135,"global/document":1,"global/window":2,"object.assign":45,"safe-json-parse/tuple":53}],107:[function(_dereq_,module,exports){"use strict";exports.__esModule=true;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}var _playerJs=_dereq_("./player.js");var _playerJs2=_interopRequireDefault(_playerJs);var plugin=function plugin(name,init){_playerJs2["default"].prototype[name]=init;};exports["default"]=plugin;module.exports=exports["default"];},{"./player.js":106}],108:[function(_dereq_,module,exports){"use strict";exports.__esModule=true;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var _buttonJs=_dereq_("./button.js");var _buttonJs2=_interopRequireDefault(_buttonJs);var _componentJs=_dereq_("./component.js");var _componentJs2=_interopRequireDefault(_componentJs);var _utilsFnJs=_dereq_("./utils/fn.js");var Fn=_interopRequireWildcard(_utilsFnJs);var _utilsDomJs=_dereq_("./utils/dom.js");var Dom=_interopRequireWildcard(_utilsDomJs);var _utilsBrowserJs=_dereq_("./utils/browser.js");var browser=_interopRequireWildcard(_utilsBrowserJs);var PosterImage=function(_Button){_inherits(PosterImage,_Button);function PosterImage(player,options){_classCallCheck(this,PosterImage);_Button.call(this,player,options);this.update();player.on("posterchange",Fn.bind(this,this.update));}PosterImage.prototype.dispose=function dispose(){this.player().off("posterchange",this.update);_Button.prototype.dispose.call(this);};PosterImage.prototype.createEl=function createEl(){var el=Dom.createEl("div",{className:"vjs-poster",tabIndex:-1});if(!browser.BACKGROUND_SIZE_SUPPORTED){this.fallbackImg_=Dom.createEl("img");el.appendChild(this.fallbackImg_);}return el;};PosterImage.prototype.update=function update(){var url=this.player().poster();this.setSrc(url);if(url){this.show();}else{this.hide();}};PosterImage.prototype.setSrc=function setSrc(url){if(this.fallbackImg_){this.fallbackImg_.src=url;}else{var backgroundImage="";if(url){backgroundImage='url("'+url+'")';}this.el_.style.backgroundImage=backgroundImage;}};PosterImage.prototype.handleClick=function handleClick(){if(this.player_.paused()){this.player_.play();}else{this.player_.pause();}};return PosterImage;}(_buttonJs2["default"]);_componentJs2["default"].registerComponent("PosterImage",PosterImage);exports["default"]=PosterImage;module.exports=exports["default"];},{"./button.js":63,"./component.js":65,"./utils/browser.js":123,"./utils/dom.js":126,"./utils/fn.js":128}],109:[function(_dereq_,module,exports){"use strict";exports.__esModule=true;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}var _utilsEventsJs=_dereq_("./utils/events.js");var Events=_interopRequireWildcard(_utilsEventsJs);var _globalDocument=_dereq_("global/document");var _globalDocument2=_interopRequireDefault(_globalDocument);var _globalWindow=_dereq_("global/window");var _globalWindow2=_interopRequireDefault(_globalWindow);var _windowLoaded=false;var videojs=undefined;var autoSetup=function autoSetup(){var vids=_globalDocument2["default"].getElementsByTagName("video");var audios=_globalDocument2["default"].getElementsByTagName("audio");var mediaEls=[];if(vids&&vids.length>0){for(var i=0,e=vids.length;i<e;i++){mediaEls.push(vids[i]);}}if(audios&&audios.length>0){for(var i=0,e=audios.length;i<e;i++){mediaEls.push(audios[i]);}}if(mediaEls&&mediaEls.length>0){for(var i=0,e=mediaEls.length;i<e;i++){var mediaEl=mediaEls[i];if(mediaEl&&mediaEl.getAttribute){if(mediaEl["player"]===undefined){var options=mediaEl.getAttribute("data-setup");if(options!==null){var player=videojs(mediaEl);}}}else{autoSetupTimeout(1);break;}}}else if(!_windowLoaded){autoSetupTimeout(1);}};var autoSetupTimeout=function autoSetupTimeout(wait,vjs){videojs=vjs;setTimeout(autoSetup,wait);};if(_globalDocument2["default"].readyState==="complete"){_windowLoaded=true;}else{Events.one(_globalWindow2["default"],"load",function(){_windowLoaded=true;});}var hasLoaded=function hasLoaded(){return _windowLoaded;};exports.autoSetup=autoSetup;exports.autoSetupTimeout=autoSetupTimeout;exports.hasLoaded=hasLoaded;},{"./utils/events.js":127,"global/document":1,"global/window":2}],110:[function(_dereq_,module,exports){"use strict";exports.__esModule=true;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var _componentJs=_dereq_("../component.js");var _componentJs2=_interopRequireDefault(_componentJs);var _utilsDomJs=_dereq_("../utils/dom.js");var Dom=_interopRequireWildcard(_utilsDomJs);var _globalDocument=_dereq_("global/document");var _globalDocument2=_interopRequireDefault(_globalDocument);var _objectAssign=_dereq_("object.assign");var _objectAssign2=_interopRequireDefault(_objectAssign);var Slider=function(_Component){_inherits(Slider,_Component);function Slider(player,options){_classCallCheck(this,Slider);_Component.call(this,player,options);this.bar=this.getChild(this.options_.barName);this.vertical(!!this.options_.vertical);this.on("mousedown",this.handleMouseDown);this.on("touchstart",this.handleMouseDown);this.on("focus",this.handleFocus);this.on("blur",this.handleBlur);this.on("click",this.handleClick);this.on(player,"controlsvisible",this.update);this.on(player,this.playerEvent,this.update);}Slider.prototype.createEl=function createEl(type){var props=arguments.length<=1||arguments[1]===undefined?{}:arguments[1];var attributes=arguments.length<=2||arguments[2]===undefined?{}:arguments[2];props.className=props.className+" vjs-slider";props=_objectAssign2["default"]({tabIndex:0},props);attributes=_objectAssign2["default"]({role:"slider","aria-valuenow":0,"aria-valuemin":0,"aria-valuemax":100,tabIndex:0},attributes);return _Component.prototype.createEl.call(this,type,props,attributes);};Slider.prototype.handleMouseDown=function handleMouseDown(event){event.preventDefault();Dom.blockTextSelection();this.addClass("vjs-sliding");this.trigger("slideractive");this.on(_globalDocument2["default"],"mousemove",this.handleMouseMove);this.on(_globalDocument2["default"],"mouseup",this.handleMouseUp);this.on(_globalDocument2["default"],"touchmove",this.handleMouseMove);this.on(_globalDocument2["default"],"touchend",this.handleMouseUp);this.handleMouseMove(event);};Slider.prototype.handleMouseMove=function handleMouseMove(){};Slider.prototype.handleMouseUp=function handleMouseUp(){Dom.unblockTextSelection();this.removeClass("vjs-sliding");this.trigger("sliderinactive");this.off(_globalDocument2["default"],"mousemove",this.handleMouseMove);this.off(_globalDocument2["default"],"mouseup",this.handleMouseUp);this.off(_globalDocument2["default"],"touchmove",this.handleMouseMove);this.off(_globalDocument2["default"],"touchend",this.handleMouseUp);this.update();};Slider.prototype.update=function update(){if(!this.el_)return;var progress=this.getPercent();var bar=this.bar;if(!bar)return;if(typeof progress!=="number"||progress!==progress||progress<0||progress===Infinity){progress=0;}var percentage=(progress*100).toFixed(2)+"%";if(this.vertical()){bar.el().style.height=percentage;}else{bar.el().style.width=percentage;}};Slider.prototype.calculateDistance=function calculateDistance(event){var position=Dom.getPointerPosition(this.el_,event);if(this.vertical()){return position.y;}return position.x;};Slider.prototype.handleFocus=function handleFocus(){this.on(_globalDocument2["default"],"keydown",this.handleKeyPress);};Slider.prototype.handleKeyPress=function handleKeyPress(event){if(event.which===37||event.which===40){event.preventDefault();this.stepBack();}else if(event.which===38||event.which===39){event.preventDefault();this.stepForward();}};Slider.prototype.handleBlur=function handleBlur(){this.off(_globalDocument2["default"],"keydown",this.handleKeyPress);};Slider.prototype.handleClick=function handleClick(event){event.stopImmediatePropagation();event.preventDefault();};Slider.prototype.vertical=function vertical(bool){if(bool===undefined){return this.vertical_||false;}this.vertical_=!!bool;if(this.vertical_){this.addClass("vjs-slider-vertical");}else{this.addClass("vjs-slider-horizontal");}return this;};return Slider;}(_componentJs2["default"]);_componentJs2["default"].registerComponent("Slider",Slider);exports["default"]=Slider;module.exports=exports["default"];},{"../component.js":65,"../utils/dom.js":126,"global/document":1,"object.assign":45}],111:[function(_dereq_,module,exports){"use strict";exports.__esModule=true;function FlashRtmpDecorator(Flash){Flash.streamingFormats={"rtmp/mp4":"MP4","rtmp/flv":"FLV"};Flash.streamFromParts=function(connection,stream){return connection+"&"+stream;};Flash.streamToParts=function(src){var parts={connection:"",stream:""};if(!src)return parts;var connEnd=src.search(/&(?!\w+=)/);var streamBegin=undefined;if(connEnd!==-1){streamBegin=connEnd+1;}else{connEnd=streamBegin=src.lastIndexOf("/")+1;if(connEnd===0){connEnd=streamBegin=src.length;}}parts.connection=src.substring(0,connEnd);parts.stream=src.substring(streamBegin,src.length);return parts;};Flash.isStreamingType=function(srcType){return srcType in Flash.streamingFormats;};Flash.RTMP_RE=/^rtmp[set]?:\/\//i;Flash.isStreamingSrc=function(src){return Flash.RTMP_RE.test(src);};Flash.rtmpSourceHandler={};Flash.rtmpSourceHandler.canPlayType=function(type){if(Flash.isStreamingType(type)){return"maybe";}return"";};Flash.rtmpSourceHandler.canHandleSource=function(source){var can=Flash.rtmpSourceHandler.canPlayType(source.type);if(can){return can;}if(Flash.isStreamingSrc(source.src)){return"maybe";}return"";};Flash.rtmpSourceHandler.handleSource=function(source,tech){var srcParts=Flash.streamToParts(source.src);tech["setRtmpConnection"](srcParts.connection);tech["setRtmpStream"](srcParts.stream);};Flash.registerSourceHandler(Flash.rtmpSourceHandler);return Flash;}exports["default"]=FlashRtmpDecorator;module.exports=exports["default"];},{}],112:[function(_dereq_,module,exports){"use strict";exports.__esModule=true;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var _tech=_dereq_("./tech");var _tech2=_interopRequireDefault(_tech);var _utilsDomJs=_dereq_("../utils/dom.js");var Dom=_interopRequireWildcard(_utilsDomJs);var _utilsUrlJs=_dereq_("../utils/url.js");var Url=_interopRequireWildcard(_utilsUrlJs);var _utilsTimeRangesJs=_dereq_("../utils/time-ranges.js");var _flashRtmp=_dereq_("./flash-rtmp");var _flashRtmp2=_interopRequireDefault(_flashRtmp);var _component=_dereq_("../component");var _component2=_interopRequireDefault(_component);var _globalWindow=_dereq_("global/window");var _globalWindow2=_interopRequireDefault(_globalWindow);var _objectAssign=_dereq_("object.assign");var _objectAssign2=_interopRequireDefault(_objectAssign);var navigator=_globalWindow2["default"].navigator;var Flash=function(_Tech){_inherits(Flash,_Tech);function Flash(options,ready){_classCallCheck(this,Flash);_Tech.call(this,options,ready);if(options.source){this.ready(function(){this.setSource(options.source);},true);}if(options.startTime){this.ready(function(){this.load();this.play();this.currentTime(options.startTime);},true);}_globalWindow2["default"].videojs=_globalWindow2["default"].videojs||{};_globalWindow2["default"].videojs.Flash=_globalWindow2["default"].videojs.Flash||{};_globalWindow2["default"].videojs.Flash.onReady=Flash.onReady;_globalWindow2["default"].videojs.Flash.onEvent=Flash.onEvent;_globalWindow2["default"].videojs.Flash.onError=Flash.onError;this.on("seeked",function(){this.lastSeekTarget_=undefined;});}Flash.prototype.createEl=function createEl(){var options=this.options_;if(!options.swf){options.swf="//vjs.zencdn.net/swf/5.0.1/video-js.swf";}var objId=options.techId;var flashVars=_objectAssign2["default"]({readyFunction:"videojs.Flash.onReady",eventProxyFunction:"videojs.Flash.onEvent",errorEventProxyFunction:"videojs.Flash.onError",autoplay:options.autoplay,preload:options.preload,loop:options.loop,muted:options.muted},options.flashVars);var params=_objectAssign2["default"]({wmode:"opaque",bgcolor:"#000000"},options.params);var attributes=_objectAssign2["default"]({id:objId,name:objId,class:"vjs-tech"},options.attributes);this.el_=Flash.embed(options.swf,flashVars,params,attributes);this.el_.tech=this;return this.el_;};Flash.prototype.play=function play(){if(this.ended()){this.setCurrentTime(0);}this.el_.vjs_play();};Flash.prototype.pause=function pause(){this.el_.vjs_pause();};Flash.prototype.src=function src(_src){if(_src===undefined){return this.currentSrc();}return this.setSrc(_src);};Flash.prototype.setSrc=function setSrc(src){src=Url.getAbsoluteURL(src);this.el_.vjs_src(src);if(this.autoplay()){var tech=this;this.setTimeout(function(){tech.play();},0);}};Flash.prototype.seeking=function seeking(){return this.lastSeekTarget_!==undefined;};Flash.prototype.setCurrentTime=function setCurrentTime(time){var seekable=this.seekable();if(seekable.length){time=time>seekable.start(0)?time:seekable.start(0);time=time<seekable.end(seekable.length-1)?time:seekable.end(seekable.length-1);this.lastSeekTarget_=time;this.trigger("seeking");this.el_.vjs_setProperty("currentTime",time);_Tech.prototype.setCurrentTime.call(this);}};Flash.prototype.currentTime=function currentTime(time){if(this.seeking()){return this.lastSeekTarget_||0;}return this.el_.vjs_getProperty("currentTime");};Flash.prototype.currentSrc=function currentSrc(){if(this.currentSource_){return this.currentSource_.src;}else{return this.el_.vjs_getProperty("currentSrc");}};Flash.prototype.load=function load(){this.el_.vjs_load();};Flash.prototype.poster=function poster(){this.el_.vjs_getProperty("poster");};Flash.prototype.setPoster=function setPoster(){};Flash.prototype.seekable=function seekable(){var duration=this.duration();if(duration===0){return _utilsTimeRangesJs.createTimeRange();}return _utilsTimeRangesJs.createTimeRange(0,duration);};Flash.prototype.buffered=function buffered(){var ranges=this.el_.vjs_getProperty("buffered");if(ranges.length===0){return _utilsTimeRangesJs.createTimeRange();}return _utilsTimeRangesJs.createTimeRange(ranges[0][0],ranges[0][1]);};Flash.prototype.supportsFullScreen=function supportsFullScreen(){return false;};Flash.prototype.enterFullScreen=function enterFullScreen(){return false;};return Flash;}(_tech2["default"]);var _api=Flash.prototype;var _readWrite="rtmpConnection,rtmpStream,preload,defaultPlaybackRate,playbackRate,autoplay,loop,mediaGroup,controller,controls,volume,muted,defaultMuted".split(",");var _readOnly="networkState,readyState,initialTime,duration,startOffsetTime,paused,ended,videoTracks,audioTracks,videoWidth,videoHeight".split(",");function _createSetter(attr){var attrUpper=attr.charAt(0).toUpperCase()+attr.slice(1);_api["set"+attrUpper]=function(val){return this.el_.vjs_setProperty(attr,val);};}function _createGetter(attr){_api[attr]=function(){return this.el_.vjs_getProperty(attr);};}for(var i=0;i<_readWrite.length;i++){_createGetter(_readWrite[i]);_createSetter(_readWrite[i]);}for(var i=0;i<_readOnly.length;i++){_createGetter(_readOnly[i]);}Flash.isSupported=function(){return Flash.version()[0]>=10;};_tech2["default"].withSourceHandlers(Flash);Flash.nativeSourceHandler={};Flash.nativeSourceHandler.canPlayType=function(type){if(type in Flash.formats){return"maybe";}return"";};Flash.nativeSourceHandler.canHandleSource=function(source){var type;function guessMimeType(src){var ext=Url.getFileExtension(src);if(ext){return"video/"+ext;}return"";}if(!source.type){type=guessMimeType(source.src);}else{type=source.type.replace(/;.*/,"").toLowerCase();}return Flash.nativeSourceHandler.canPlayType(type);};Flash.nativeSourceHandler.handleSource=function(source,tech){tech.setSrc(source.src);};Flash.nativeSourceHandler.dispose=function(){};Flash.registerSourceHandler(Flash.nativeSourceHandler);Flash.formats={"video/flv":"FLV","video/x-flv":"FLV","video/mp4":"MP4","video/m4v":"MP4"};Flash.onReady=function(currSwf){var el=Dom.getEl(currSwf);var tech=el&&el.tech;if(tech&&tech.el()){Flash.checkReady(tech);}};Flash.checkReady=function(tech){if(!tech.el()){return;}if(tech.el().vjs_getProperty){tech.triggerReady();}else{this.setTimeout(function(){Flash["checkReady"](tech);},50);}};Flash.onEvent=function(swfID,eventName){var tech=Dom.getEl(swfID).tech;tech.trigger(eventName);};Flash.onError=function(swfID,err){var tech=Dom.getEl(swfID).tech;if(err==="srcnotfound"){return tech.error(4);}tech.error("FLASH: "+err);};Flash.version=function(){var version="0,0,0";try{version=new _globalWindow2["default"].ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version").replace(/\D+/g,",").match(/^,?(.+),?$/)[1];}catch(e){try{if(navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin){version=(navigator.plugins["Shockwave Flash 2.0"]||navigator.plugins["Shockwave Flash"]).description.replace(/\D+/g,",").match(/^,?(.+),?$/)[1];}}catch(err){}}return version.split(",");};Flash.embed=function(swf,flashVars,params,attributes){var code=Flash.getEmbedCode(swf,flashVars,params,attributes);var obj=Dom.createEl("div",{innerHTML:code}).childNodes[0];return obj;};Flash.getEmbedCode=function(swf,flashVars,params,attributes){var objTag='<object type="application/x-shockwave-flash" ';var flashVarsString="";var paramsString="";var attrsString="";if(flashVars){Object.getOwnPropertyNames(flashVars).forEach(function(key){flashVarsString+=key+"="+flashVars[key]+"&amp;";});}params=_objectAssign2["default"]({movie:swf,flashvars:flashVarsString,allowScriptAccess:"always",allowNetworking:"all"},params);Object.getOwnPropertyNames(params).forEach(function(key){paramsString+='<param name="'+key+'" value="'+params[key]+'" />';});attributes=_objectAssign2["default"]({data:swf,width:"100%",height:"100%"},attributes);Object.getOwnPropertyNames(attributes).forEach(function(key){attrsString+=key+'="'+attributes[key]+'" ';});return""+objTag+attrsString+">"+paramsString+"</object>";};_flashRtmp2["default"](Flash);_component2["default"].registerComponent("Flash",Flash);_tech2["default"].registerTech("Flash",Flash);exports["default"]=Flash;module.exports=exports["default"];},{"../component":65,"../utils/dom.js":126,"../utils/time-ranges.js":134,"../utils/url.js":136,"./flash-rtmp":111,"./tech":115,"global/window":2,"object.assign":45}],113:[function(_dereq_,module,exports){"use strict";exports.__esModule=true;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var _techJs=_dereq_("./tech.js");var _techJs2=_interopRequireDefault(_techJs);var _component=_dereq_("../component");var _component2=_interopRequireDefault(_component);var _utilsDomJs=_dereq_("../utils/dom.js");var Dom=_interopRequireWildcard(_utilsDomJs);var _utilsUrlJs=_dereq_("../utils/url.js");var Url=_interopRequireWildcard(_utilsUrlJs);var _utilsFnJs=_dereq_("../utils/fn.js");var Fn=_interopRequireWildcard(_utilsFnJs);var _utilsLogJs=_dereq_("../utils/log.js");var _utilsLogJs2=_interopRequireDefault(_utilsLogJs);var _utilsBrowserJs=_dereq_("../utils/browser.js");var browser=_interopRequireWildcard(_utilsBrowserJs);var _globalDocument=_dereq_("global/document");var _globalDocument2=_interopRequireDefault(_globalDocument);var _globalWindow=_dereq_("global/window");var _globalWindow2=_interopRequireDefault(_globalWindow);var _objectAssign=_dereq_("object.assign");var _objectAssign2=_interopRequireDefault(_objectAssign);var _utilsMergeOptionsJs=_dereq_("../utils/merge-options.js");var _utilsMergeOptionsJs2=_interopRequireDefault(_utilsMergeOptionsJs);var Html5=function(_Tech){_inherits(Html5,_Tech);function Html5(options,ready){_classCallCheck(this,Html5);_Tech.call(this,options,ready);var source=options.source;if(source&&(this.el_.currentSrc!==source.src||options.tag&&options.tag.initNetworkState_===3)){this.setSource(source);}else{this.handleLateInit_(this.el_);}if(this.el_.hasChildNodes()){var nodes=this.el_.childNodes;var nodesLength=nodes.length;var removeNodes=[];while(nodesLength--){var node=nodes[nodesLength];var nodeName=node.nodeName.toLowerCase();if(nodeName==="track"){if(!this.featuresNativeTextTracks){removeNodes.push(node);}else{this.remoteTextTracks().addTrack_(node.track);}}}for(var i=0;i<removeNodes.length;i++){this.el_.removeChild(removeNodes[i]);}}if(this.featuresNativeTextTracks){this.handleTextTrackChange_=Fn.bind(this,this.handleTextTrackChange);this.handleTextTrackAdd_=Fn.bind(this,this.handleTextTrackAdd);this.handleTextTrackRemove_=Fn.bind(this,this.handleTextTrackRemove);this.proxyNativeTextTracks_();}if(browser.TOUCH_ENABLED&&options.nativeControlsForTouch===true||browser.IS_IPHONE||browser.IS_NATIVE_ANDROID){this.setControls(true);}this.triggerReady();}Html5.prototype.dispose=function dispose(){var tt=this.el().textTracks;var emulatedTt=this.textTracks();if(tt&&tt.removeEventListener){tt.removeEventListener("change",this.handleTextTrackChange_);tt.removeEventListener("addtrack",this.handleTextTrackAdd_);tt.removeEventListener("removetrack",this.handleTextTrackRemove_);}var i=emulatedTt.length;while(i--){emulatedTt.removeTrack_(emulatedTt[i]);}Html5.disposeMediaElement(this.el_);_Tech.prototype.dispose.call(this);};Html5.prototype.createEl=function createEl(){var el=this.options_.tag;if(!el||this["movingMediaElementInDOM"]===false){if(el){var clone=el.cloneNode(true);el.parentNode.insertBefore(clone,el);Html5.disposeMediaElement(el);el=clone;}else{el=_globalDocument2["default"].createElement("video");var tagAttributes=this.options_.tag&&Dom.getElAttributes(this.options_.tag);var attributes=_utilsMergeOptionsJs2["default"]({},tagAttributes);if(!browser.TOUCH_ENABLED||this.options_.nativeControlsForTouch!==true){delete attributes.controls;}Dom.setElAttributes(el,_objectAssign2["default"](attributes,{id:this.options_.techId,class:"vjs-tech"}));}}var settingsAttrs=["autoplay","preload","loop","muted"];for(var i=settingsAttrs.length-1;i>=0;i--){var attr=settingsAttrs[i];var overwriteAttrs={};if(typeof this.options_[attr]!=="undefined"){overwriteAttrs[attr]=this.options_[attr];}Dom.setElAttributes(el,overwriteAttrs);}return el;};Html5.prototype.handleLateInit_=function handleLateInit_(el){var _this=this;if(el.networkState===0||el.networkState===3){return;}if(el.readyState===0){var _ret=function(){var loadstartFired=false;var setLoadstartFired=function setLoadstartFired(){loadstartFired=true;};_this.on("loadstart",setLoadstartFired);var triggerLoadstart=function triggerLoadstart(){if(!loadstartFired){this.trigger("loadstart");}};_this.on("loadedmetadata",triggerLoadstart);_this.ready(function(){this.off("loadstart",setLoadstartFired);this.off("loadedmetadata",triggerLoadstart);if(!loadstartFired){this.trigger("loadstart");}});return{v:undefined};}();if((typeof _ret==="undefined"?"undefined":_typeof2(_ret))==="object")return _ret.v;}var eventsToTrigger=["loadstart"];eventsToTrigger.push("loadedmetadata");if(el.readyState>=2){eventsToTrigger.push("loadeddata");}if(el.readyState>=3){eventsToTrigger.push("canplay");}if(el.readyState>=4){eventsToTrigger.push("canplaythrough");}this.ready(function(){eventsToTrigger.forEach(function(type){this.trigger(type);},this);});};Html5.prototype.proxyNativeTextTracks_=function proxyNativeTextTracks_(){var tt=this.el().textTracks;if(tt&&tt.addEventListener){tt.addEventListener("change",this.handleTextTrackChange_);tt.addEventListener("addtrack",this.handleTextTrackAdd_);tt.addEventListener("removetrack",this.handleTextTrackRemove_);}};Html5.prototype.handleTextTrackChange=function handleTextTrackChange(e){var tt=this.textTracks();this.textTracks().trigger({type:"change",target:tt,currentTarget:tt,srcElement:tt});};Html5.prototype.handleTextTrackAdd=function handleTextTrackAdd(e){this.textTracks().addTrack_(e.track);};Html5.prototype.handleTextTrackRemove=function handleTextTrackRemove(e){this.textTracks().removeTrack_(e.track);};Html5.prototype.play=function play(){this.el_.play();};Html5.prototype.pause=function pause(){this.el_.pause();};Html5.prototype.paused=function paused(){return this.el_.paused;};Html5.prototype.currentTime=function currentTime(){return this.el_.currentTime;};Html5.prototype.setCurrentTime=function setCurrentTime(seconds){try{this.el_.currentTime=seconds;}catch(e){_utilsLogJs2["default"](e,"Video is not ready. (Video.js)");}};Html5.prototype.duration=function duration(){return this.el_.duration||0;};Html5.prototype.buffered=function buffered(){return this.el_.buffered;};Html5.prototype.volume=function volume(){return this.el_.volume;};Html5.prototype.setVolume=function setVolume(percentAsDecimal){this.el_.volume=percentAsDecimal;};Html5.prototype.muted=function muted(){return this.el_.muted;};Html5.prototype.setMuted=function setMuted(muted){this.el_.muted=muted;};Html5.prototype.width=function width(){return this.el_.offsetWidth;};Html5.prototype.height=function height(){return this.el_.offsetHeight;};Html5.prototype.supportsFullScreen=function supportsFullScreen(){if(typeof this.el_.webkitEnterFullScreen==="function"){var userAgent=_globalWindow2["default"].navigator.userAgent;if(/Android/.test(userAgent)||!/Chrome|Mac OS X 10.5/.test(userAgent)){return true;}}return false;};Html5.prototype.enterFullScreen=function enterFullScreen(){var video=this.el_;if("webkitDisplayingFullscreen"in video){this.one("webkitbeginfullscreen",function(){this.one("webkitendfullscreen",function(){this.trigger("fullscreenchange",{isFullscreen:false});});this.trigger("fullscreenchange",{isFullscreen:true});});}if(video.paused&&video.networkState<=video.HAVE_METADATA){this.el_.play();this.setTimeout(function(){video.pause();video.webkitEnterFullScreen();},0);}else{video.webkitEnterFullScreen();}};Html5.prototype.exitFullScreen=function exitFullScreen(){this.el_.webkitExitFullScreen();};Html5.prototype.src=function src(_src){if(_src===undefined){return this.el_.src;}else{this.setSrc(_src);}};Html5.prototype.setSrc=function setSrc(src){this.el_.src=src;};Html5.prototype.load=function load(){this.el_.load();};Html5.prototype.currentSrc=function currentSrc(){if(this.currentSource_){return this.currentSource_.src;}else{return this.el_.currentSrc;}};Html5.prototype.poster=function poster(){return this.el_.poster;};Html5.prototype.setPoster=function setPoster(val){this.el_.poster=val;};Html5.prototype.preload=function preload(){return this.el_.preload;};Html5.prototype.setPreload=function setPreload(val){this.el_.preload=val;};Html5.prototype.autoplay=function autoplay(){return this.el_.autoplay;};Html5.prototype.setAutoplay=function setAutoplay(val){this.el_.autoplay=val;};Html5.prototype.controls=function controls(){return this.el_.controls;};Html5.prototype.setControls=function setControls(val){this.el_.controls=!!val;};Html5.prototype.loop=function loop(){return this.el_.loop;};Html5.prototype.setLoop=function setLoop(val){this.el_.loop=val;};Html5.prototype.error=function error(){return this.el_.error;};Html5.prototype.seeking=function seeking(){return this.el_.seeking;};Html5.prototype.seekable=function seekable(){return this.el_.seekable;};Html5.prototype.ended=function ended(){return this.el_.ended;};Html5.prototype.defaultMuted=function defaultMuted(){return this.el_.defaultMuted;};Html5.prototype.playbackRate=function playbackRate(){return this.el_.playbackRate;};Html5.prototype.played=function played(){return this.el_.played;};Html5.prototype.setPlaybackRate=function setPlaybackRate(val){this.el_.playbackRate=val;};Html5.prototype.networkState=function networkState(){return this.el_.networkState;};Html5.prototype.readyState=function readyState(){return this.el_.readyState;};Html5.prototype.videoWidth=function videoWidth(){return this.el_.videoWidth;};Html5.prototype.videoHeight=function videoHeight(){return this.el_.videoHeight;};Html5.prototype.textTracks=function textTracks(){return _Tech.prototype.textTracks.call(this);};Html5.prototype.addTextTrack=function addTextTrack(kind,label,language){if(!this["featuresNativeTextTracks"]){return _Tech.prototype.addTextTrack.call(this,kind,label,language);}return this.el_.addTextTrack(kind,label,language);};Html5.prototype.addRemoteTextTrack=function addRemoteTextTrack(){var options=arguments.length<=0||arguments[0]===undefined?{}:arguments[0];if(!this["featuresNativeTextTracks"]){return _Tech.prototype.addRemoteTextTrack.call(this,options);}var track=_globalDocument2["default"].createElement("track");if(options["kind"]){track["kind"]=options["kind"];}if(options["label"]){track["label"]=options["label"];}if(options["language"]||options["srclang"]){track["srclang"]=options["language"]||options["srclang"];}if(options["default"]){track["default"]=options["default"];}if(options["id"]){track["id"]=options["id"];}if(options["src"]){track["src"]=options["src"];}this.el().appendChild(track);this.remoteTextTracks().addTrack_(track.track);return track;};Html5.prototype.removeRemoteTextTrack=function removeRemoteTextTrack(track){if(!this["featuresNativeTextTracks"]){return _Tech.prototype.removeRemoteTextTrack.call(this,track);}var tracks,i;this.remoteTextTracks().removeTrack_(track);tracks=this.$$("track");i=tracks.length;while(i--){if(track===tracks[i]||track===tracks[i].track){this.el().removeChild(tracks[i]);}}};return Html5;}(_techJs2["default"]);Html5.TEST_VID=_globalDocument2["default"].createElement("video");var track=_globalDocument2["default"].createElement("track");track.kind="captions";track.srclang="en";track.label="English";Html5.TEST_VID.appendChild(track);Html5.isSupported=function(){try{Html5.TEST_VID["volume"]=.5;}catch(e){return false;}return!!Html5.TEST_VID.canPlayType;};_techJs2["default"].withSourceHandlers(Html5);Html5.nativeSourceHandler={};Html5.nativeSourceHandler.canPlayType=function(type){try{return Html5.TEST_VID.canPlayType(type);}catch(e){return"";}};Html5.nativeSourceHandler.canHandleSource=function(source){var match,ext;if(source.type){return Html5.nativeSourceHandler.canPlayType(source.type);}else if(source.src){ext=Url.getFileExtension(source.src);return Html5.nativeSourceHandler.canPlayType("video/"+ext);}return"";};Html5.nativeSourceHandler.handleSource=function(source,tech){tech.setSrc(source.src);};Html5.nativeSourceHandler.dispose=function(){};Html5.registerSourceHandler(Html5.nativeSourceHandler);Html5.canControlVolume=function(){var volume=Html5.TEST_VID.volume;Html5.TEST_VID.volume=volume/2+.1;return volume!==Html5.TEST_VID.volume;};Html5.canControlPlaybackRate=function(){var playbackRate=Html5.TEST_VID.playbackRate;Html5.TEST_VID.playbackRate=playbackRate/2+.1;return playbackRate!==Html5.TEST_VID.playbackRate;};Html5.supportsNativeTextTracks=function(){var supportsTextTracks;supportsTextTracks=!!Html5.TEST_VID.textTracks;if(supportsTextTracks&&Html5.TEST_VID.textTracks.length>0){supportsTextTracks=typeof Html5.TEST_VID.textTracks[0]["mode"]!=="number";}if(supportsTextTracks&&browser.IS_FIREFOX){supportsTextTracks=false;}if(supportsTextTracks&&!("onremovetrack"in Html5.TEST_VID.textTracks)){supportsTextTracks=false;}return supportsTextTracks;};Html5.Events=["loadstart","suspend","abort","error","emptied","stalled","loadedmetadata","loadeddata","canplay","canplaythrough","playing","waiting","seeking","seeked","ended","durationchange","timeupdate","progress","play","pause","ratechange","volumechange"];Html5.prototype["featuresVolumeControl"]=Html5.canControlVolume();Html5.prototype["featuresPlaybackRate"]=Html5.canControlPlaybackRate();Html5.prototype["movingMediaElementInDOM"]=!browser.IS_IOS;Html5.prototype["featuresFullscreenResize"]=true;Html5.prototype["featuresProgressEvents"]=true;Html5.prototype["featuresNativeTextTracks"]=Html5.supportsNativeTextTracks();var canPlayType=undefined;var mpegurlRE=/^application\/(?:x-|vnd\.apple\.)mpegurl/i;var mp4RE=/^video\/mp4/i;Html5.patchCanPlayType=function(){if(browser.ANDROID_VERSION>=4){if(!canPlayType){canPlayType=Html5.TEST_VID.constructor.prototype.canPlayType;}Html5.TEST_VID.constructor.prototype.canPlayType=function(type){if(type&&mpegurlRE.test(type)){return"maybe";}return canPlayType.call(this,type);};}if(browser.IS_OLD_ANDROID){if(!canPlayType){canPlayType=Html5.TEST_VID.constructor.prototype.canPlayType;}Html5.TEST_VID.constructor.prototype.canPlayType=function(type){if(type&&mp4RE.test(type)){return"maybe";}return canPlayType.call(this,type);};}};Html5.unpatchCanPlayType=function(){var r=Html5.TEST_VID.constructor.prototype.canPlayType;Html5.TEST_VID.constructor.prototype.canPlayType=canPlayType;canPlayType=null;return r;};Html5.patchCanPlayType();Html5.disposeMediaElement=function(el){if(!el){return;}if(el.parentNode){el.parentNode.removeChild(el);}while(el.hasChildNodes()){el.removeChild(el.firstChild);}el.removeAttribute("src");if(typeof el.load==="function"){(function(){try{el.load();}catch(e){}})();}};_component2["default"].registerComponent("Html5",Html5);_techJs2["default"].registerTech("Html5",Html5);exports["default"]=Html5;module.exports=exports["default"];},{"../component":65,"../utils/browser.js":123,"../utils/dom.js":126,"../utils/fn.js":128,"../utils/log.js":131,"../utils/merge-options.js":132,"../utils/url.js":136,"./tech.js":115,"global/document":1,"global/window":2,"object.assign":45}],114:[function(_dereq_,module,exports){"use strict";exports.__esModule=true;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var _componentJs=_dereq_("../component.js");var _componentJs2=_interopRequireDefault(_componentJs);var _techJs=_dereq_("./tech.js");var _techJs2=_interopRequireDefault(_techJs);var _globalWindow=_dereq_("global/window");var _globalWindow2=_interopRequireDefault(_globalWindow);var _utilsToTitleCaseJs=_dereq_("../utils/to-title-case.js");var _utilsToTitleCaseJs2=_interopRequireDefault(_utilsToTitleCaseJs);var MediaLoader=function(_Component){_inherits(MediaLoader,_Component);function MediaLoader(player,options,ready){_classCallCheck(this,MediaLoader);_Component.call(this,player,options,ready);if(!options.playerOptions["sources"]||options.playerOptions["sources"].length===0){for(var i=0,j=options.playerOptions["techOrder"];i<j.length;i++){var techName=_utilsToTitleCaseJs2["default"](j[i]);var tech=_techJs2["default"].getTech(techName);if(!techName){tech=_componentJs2["default"].getComponent(techName);}if(tech&&tech.isSupported()){player.loadTech_(techName);break;}}}else{player.src(options.playerOptions["sources"]);}}return MediaLoader;}(_componentJs2["default"]);_componentJs2["default"].registerComponent("MediaLoader",MediaLoader);exports["default"]=MediaLoader;module.exports=exports["default"];},{"../component.js":65,"../utils/to-title-case.js":135,"./tech.js":115,"global/window":2}],115:[function(_dereq_,module,exports){"use strict";exports.__esModule=true;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var _component=_dereq_("../component");var _component2=_interopRequireDefault(_component);var _tracksTextTrack=_dereq_("../tracks/text-track");var _tracksTextTrack2=_interopRequireDefault(_tracksTextTrack);var _tracksTextTrackList=_dereq_("../tracks/text-track-list");var _tracksTextTrackList2=_interopRequireDefault(_tracksTextTrackList);var _utilsFnJs=_dereq_("../utils/fn.js");var Fn=_interopRequireWildcard(_utilsFnJs);var _utilsLogJs=_dereq_("../utils/log.js");var _utilsLogJs2=_interopRequireDefault(_utilsLogJs);var _utilsTimeRangesJs=_dereq_("../utils/time-ranges.js");var _utilsBufferJs=_dereq_("../utils/buffer.js");var _mediaErrorJs=_dereq_("../media-error.js");var _mediaErrorJs2=_interopRequireDefault(_mediaErrorJs);var _globalWindow=_dereq_("global/window");var _globalWindow2=_interopRequireDefault(_globalWindow);var _globalDocument=_dereq_("global/document");var _globalDocument2=_interopRequireDefault(_globalDocument);var Tech=function(_Component){_inherits(Tech,_Component);function Tech(){var options=arguments.length<=0||arguments[0]===undefined?{}:arguments[0];var ready=arguments.length<=1||arguments[1]===undefined?function(){}:arguments[1];_classCallCheck(this,Tech);options.reportTouchActivity=false;_Component.call(this,null,options,ready);this.hasStarted_=false;this.on("playing",function(){this.hasStarted_=true;});this.on("loadstart",function(){this.hasStarted_=false;});this.textTracks_=options.textTracks;if(!this.featuresProgressEvents){this.manualProgressOn();}if(!this.featuresTimeupdateEvents){this.manualTimeUpdatesOn();}if(options.nativeCaptions===false||options.nativeTextTracks===false){this.featuresNativeTextTracks=false;}if(!this.featuresNativeTextTracks){this.on("ready",this.emulateTextTracks);}this.initTextTrackListeners();this.emitTapEvents();}Tech.prototype.manualProgressOn=function manualProgressOn(){this.on("durationchange",this.onDurationChange);this.manualProgress=true;this.one("ready",this.trackProgress);};Tech.prototype.manualProgressOff=function manualProgressOff(){this.manualProgress=false;this.stopTrackingProgress();this.off("durationchange",this.onDurationChange);};Tech.prototype.trackProgress=function trackProgress(){this.stopTrackingProgress();this.progressInterval=this.setInterval(Fn.bind(this,function(){var numBufferedPercent=this.bufferedPercent();if(this.bufferedPercent_!==numBufferedPercent){this.trigger("progress");}this.bufferedPercent_=numBufferedPercent;if(numBufferedPercent===1){this.stopTrackingProgress();}}),500);};Tech.prototype.onDurationChange=function onDurationChange(){this.duration_=this.duration();};Tech.prototype.buffered=function buffered(){return _utilsTimeRangesJs.createTimeRange(0,0);};Tech.prototype.bufferedPercent=function bufferedPercent(){return _utilsBufferJs.bufferedPercent(this.buffered(),this.duration_);};Tech.prototype.stopTrackingProgress=function stopTrackingProgress(){this.clearInterval(this.progressInterval);};Tech.prototype.manualTimeUpdatesOn=function manualTimeUpdatesOn(){this.manualTimeUpdates=true;this.on("play",this.trackCurrentTime);this.on("pause",this.stopTrackingCurrentTime);};Tech.prototype.manualTimeUpdatesOff=function manualTimeUpdatesOff(){this.manualTimeUpdates=false;this.stopTrackingCurrentTime();this.off("play",this.trackCurrentTime);this.off("pause",this.stopTrackingCurrentTime);};Tech.prototype.trackCurrentTime=function trackCurrentTime(){if(this.currentTimeInterval){this.stopTrackingCurrentTime();}this.currentTimeInterval=this.setInterval(function(){this.trigger({type:"timeupdate",target:this,manuallyTriggered:true});},250);};Tech.prototype.stopTrackingCurrentTime=function stopTrackingCurrentTime(){this.clearInterval(this.currentTimeInterval);this.trigger({type:"timeupdate",target:this,manuallyTriggered:true});};Tech.prototype.dispose=function dispose(){var textTracks=this.textTracks();if(textTracks){var i=textTracks.length;while(i--){this.removeRemoteTextTrack(textTracks[i]);}}if(this.manualProgress){this.manualProgressOff();}if(this.manualTimeUpdates){this.manualTimeUpdatesOff();}_Component.prototype.dispose.call(this);};Tech.prototype.error=function error(err){if(err!==undefined){if(err instanceof _mediaErrorJs2["default"]){this.error_=err;}else{this.error_=new _mediaErrorJs2["default"](err);}this.trigger("error");}return this.error_;};Tech.prototype.played=function played(){if(this.hasStarted_){return _utilsTimeRangesJs.createTimeRange(0,0);}return _utilsTimeRangesJs.createTimeRange();};Tech.prototype.setCurrentTime=function setCurrentTime(){if(this.manualTimeUpdates){this.trigger({type:"timeupdate",target:this,manuallyTriggered:true});}};Tech.prototype.initTextTrackListeners=function initTextTrackListeners(){var textTrackListChanges=Fn.bind(this,function(){this.trigger("texttrackchange");});var tracks=this.textTracks();if(!tracks)return;tracks.addEventListener("removetrack",textTrackListChanges);tracks.addEventListener("addtrack",textTrackListChanges);this.on("dispose",Fn.bind(this,function(){tracks.removeEventListener("removetrack",textTrackListChanges);tracks.removeEventListener("addtrack",textTrackListChanges);}));};Tech.prototype.emulateTextTracks=function emulateTextTracks(){var _this=this;var tracks=this.textTracks();if(!tracks){return;}if(!_globalWindow2["default"]["WebVTT"]&&this.el().parentNode!=null){var script=_globalDocument2["default"].createElement("script");script.src=this.options_["vtt.js"]||"https://cdn.rawgit.com/gkatsev/vtt.js/vjs-v0.12.1/dist/vtt.min.js";this.el().parentNode.appendChild(script);_globalWindow2["default"]["WebVTT"]=true;}var updateDisplay=function updateDisplay(){return _this.trigger("texttrackchange");};var textTracksChanges=function textTracksChanges(){updateDisplay();for(var i=0;i<tracks.length;i++){var track=tracks[i];track.removeEventListener("cuechange",updateDisplay);if(track.mode==="showing"){track.addEventListener("cuechange",updateDisplay);}}};textTracksChanges();tracks.addEventListener("change",textTracksChanges);this.on("dispose",function(){tracks.removeEventListener("change",textTracksChanges);});};Tech.prototype.textTracks=function textTracks(){this.textTracks_=this.textTracks_||new _tracksTextTrackList2["default"]();return this.textTracks_;};Tech.prototype.remoteTextTracks=function remoteTextTracks(){this.remoteTextTracks_=this.remoteTextTracks_||new _tracksTextTrackList2["default"]();return this.remoteTextTracks_;};Tech.prototype.addTextTrack=function addTextTrack(kind,label,language){if(!kind){throw new Error("TextTrack kind is required but was not provided");}return createTrackHelper(this,kind,label,language);};Tech.prototype.addRemoteTextTrack=function addRemoteTextTrack(options){var track=createTrackHelper(this,options.kind,options.label,options.language,options);this.remoteTextTracks().addTrack_(track);return{track:track};};Tech.prototype.removeRemoteTextTrack=function removeRemoteTextTrack(track){this.textTracks().removeTrack_(track);this.remoteTextTracks().removeTrack_(track);};Tech.prototype.setPoster=function setPoster(){};Tech.prototype.canPlayType=function canPlayType(){return"";};Tech.isTech=function isTech(component){return component.prototype instanceof Tech||component instanceof Tech||component===Tech;};Tech.registerTech=function registerTech(name,tech){if(!Tech.techs_){Tech.techs_={};}if(!Tech.isTech(tech)){throw new Error("Tech "+name+" must be a Tech");}Tech.techs_[name]=tech;return tech;};Tech.getTech=function getTech(name){if(Tech.techs_&&Tech.techs_[name]){return Tech.techs_[name];}if(_globalWindow2["default"]&&_globalWindow2["default"].videojs&&_globalWindow2["default"].videojs[name]){_utilsLogJs2["default"].warn("The "+name+" tech was added to the videojs object when it should be registered using videojs.registerTech(name, tech)");return _globalWindow2["default"].videojs[name];}};return Tech;}(_component2["default"]);Tech.prototype.textTracks_;var createTrackHelper=function createTrackHelper(self,kind,label,language){var options=arguments.length<=4||arguments[4]===undefined?{}:arguments[4];var tracks=self.textTracks();options.kind=kind;if(label){options.label=label;}if(language){options.language=language;}options.tech=self;var track=new _tracksTextTrack2["default"](options);tracks.addTrack_(track);return track;};Tech.prototype.featuresVolumeControl=true;Tech.prototype.featuresFullscreenResize=false;Tech.prototype.featuresPlaybackRate=false;Tech.prototype.featuresProgressEvents=false;Tech.prototype.featuresTimeupdateEvents=false;Tech.prototype.featuresNativeTextTracks=false;Tech.withSourceHandlers=function(_Tech){_Tech.registerSourceHandler=function(handler,index){var handlers=_Tech.sourceHandlers;if(!handlers){handlers=_Tech.sourceHandlers=[];}if(index===undefined){index=handlers.length;}handlers.splice(index,0,handler);};_Tech.canPlayType=function(type){var handlers=_Tech.sourceHandlers||[];var can=undefined;for(var i=0;i<handlers.length;i++){can=handlers[i].canPlayType(type);if(can){return can;}}return"";};_Tech.selectSourceHandler=function(source){var handlers=_Tech.sourceHandlers||[];var can=undefined;for(var i=0;i<handlers.length;i++){can=handlers[i].canHandleSource(source);if(can){return handlers[i];}}return null;};_Tech.canPlaySource=function(srcObj){var sh=_Tech.selectSourceHandler(srcObj);if(sh){return sh.canHandleSource(srcObj);}return"";};var deferrable=["seekable","duration"];deferrable.forEach(function(fnName){var originalFn=this[fnName];if(typeof originalFn!=="function"){return;}this[fnName]=function(){if(this.sourceHandler_&&this.sourceHandler_[fnName]){return this.sourceHandler_[fnName].apply(this.sourceHandler_,arguments);}return originalFn.apply(this,arguments);};},_Tech.prototype);_Tech.prototype.setSource=function(source){var sh=_Tech.selectSourceHandler(source);if(!sh){if(_Tech.nativeSourceHandler){sh=_Tech.nativeSourceHandler;}else{_utilsLogJs2["default"].error("No source hander found for the current source.");}}this.disposeSourceHandler();this.off("dispose",this.disposeSourceHandler);this.currentSource_=source;this.sourceHandler_=sh.handleSource(source,this);this.on("dispose",this.disposeSourceHandler);return this;};_Tech.prototype.disposeSourceHandler=function(){if(this.sourceHandler_&&this.sourceHandler_.dispose){this.sourceHandler_.dispose();}};};_component2["default"].registerComponent("Tech",Tech);_component2["default"].registerComponent("MediaTechController",Tech);Tech.registerTech("Tech",Tech);exports["default"]=Tech;module.exports=exports["default"];},{"../component":65,"../media-error.js":101,"../tracks/text-track":122,"../tracks/text-track-list":120,"../utils/buffer.js":124,"../utils/fn.js":128,"../utils/log.js":131,"../utils/time-ranges.js":134,"global/document":1,"global/window":2}],116:[function(_dereq_,module,exports){"use strict";exports.__esModule=true;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}var _utilsBrowserJs=_dereq_("../utils/browser.js");var browser=_interopRequireWildcard(_utilsBrowserJs);var _globalDocument=_dereq_("global/document");var _globalDocument2=_interopRequireDefault(_globalDocument);var TextTrackCueList=function TextTrackCueList(cues){var list=this;if(browser.IS_IE8){list=_globalDocument2["default"].createElement("custom");for(var prop in TextTrackCueList.prototype){if(prop!=="constructor"){list[prop]=TextTrackCueList.prototype[prop];}}}TextTrackCueList.prototype.setCues_.call(list,cues);Object.defineProperty(list,"length",{get:function get(){return this.length_;}});if(browser.IS_IE8){return list;}};TextTrackCueList.prototype.setCues_=function(cues){var oldLength=this.length||0;var i=0;var l=cues.length;this.cues_=cues;this.length_=cues.length;var defineProp=function defineProp(i){if(!(""+i in this)){Object.defineProperty(this,""+i,{get:function get(){return this.cues_[i];}});}};if(oldLength<l){i=oldLength;for(;i<l;i++){defineProp.call(this,i);}}};TextTrackCueList.prototype.getCueById=function(id){var result=null;for(var i=0,l=this.length;i<l;i++){var cue=this[i];if(cue.id===id){result=cue;break;}}return result;};exports["default"]=TextTrackCueList;module.exports=exports["default"];},{"../utils/browser.js":123,"global/document":1}],117:[function(_dereq_,module,exports){"use strict";exports.__esModule=true;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var _component=_dereq_("../component");var _component2=_interopRequireDefault(_component);var _menuMenuJs=_dereq_("../menu/menu.js");var _menuMenuJs2=_interopRequireDefault(_menuMenuJs);var _menuMenuItemJs=_dereq_("../menu/menu-item.js");var _menuMenuItemJs2=_interopRequireDefault(_menuMenuItemJs);var _menuMenuButtonJs=_dereq_("../menu/menu-button.js");var _menuMenuButtonJs2=_interopRequireDefault(_menuMenuButtonJs);var _utilsFnJs=_dereq_("../utils/fn.js");var Fn=_interopRequireWildcard(_utilsFnJs);var _globalDocument=_dereq_("global/document");var _globalDocument2=_interopRequireDefault(_globalDocument);var _globalWindow=_dereq_("global/window");var _globalWindow2=_interopRequireDefault(_globalWindow);var darkGray="#222";var lightGray="#ccc";var fontMap={monospace:"monospace",sansSerif:"sans-serif",serif:"serif",monospaceSansSerif:'"Andale Mono", "Lucida Console", monospace',monospaceSerif:'"Courier New", monospace',proportionalSansSerif:"sans-serif",proportionalSerif:"serif",casual:'"Comic Sans MS", Impact, fantasy',script:'"Monotype Corsiva", cursive',smallcaps:'"Andale Mono", "Lucida Console", monospace, sans-serif'};var TextTrackDisplay=function(_Component){_inherits(TextTrackDisplay,_Component);function TextTrackDisplay(player,options,ready){_classCallCheck(this,TextTrackDisplay);_Component.call(this,player,options,ready);player.on("loadstart",Fn.bind(this,this.toggleDisplay));player.on("texttrackchange",Fn.bind(this,this.updateDisplay));player.ready(Fn.bind(this,function(){if(player.tech_&&player.tech_["featuresNativeTextTracks"]){this.hide();return;}player.on("fullscreenchange",Fn.bind(this,this.updateDisplay));var tracks=this.options_.playerOptions["tracks"]||[];for(var i=0;i<tracks.length;i++){var track=tracks[i];this.player_.addRemoteTextTrack(track);}}));}TextTrackDisplay.prototype.toggleDisplay=function toggleDisplay(){if(this.player_.tech_&&this.player_.tech_["featuresNativeTextTracks"]){this.hide();}else{this.show();}};TextTrackDisplay.prototype.createEl=function createEl(){return _Component.prototype.createEl.call(this,"div",{className:"vjs-text-track-display"});};TextTrackDisplay.prototype.clearDisplay=function clearDisplay(){if(typeof _globalWindow2["default"]["WebVTT"]==="function"){_globalWindow2["default"]["WebVTT"]["processCues"](_globalWindow2["default"],[],this.el_);}};TextTrackDisplay.prototype.updateDisplay=function updateDisplay(){var tracks=this.player_.textTracks();this.clearDisplay();if(!tracks){return;}for(var i=0;i<tracks.length;i++){var track=tracks[i];if(track["mode"]==="showing"){this.updateForTrack(track);}}};TextTrackDisplay.prototype.updateForTrack=function updateForTrack(track){if(typeof _globalWindow2["default"]["WebVTT"]!=="function"||!track["activeCues"]){return;}var overrides=this.player_["textTrackSettings"].getValues();var cues=[];for(var _i=0;_i<track["activeCues"].length;_i++){cues.push(track["activeCues"][_i]);}_globalWindow2["default"]["WebVTT"]["processCues"](_globalWindow2["default"],track["activeCues"],this.el_);var i=cues.length;while(i--){var cueDiv=cues[i].displayState;if(overrides.color){cueDiv.firstChild.style.color=overrides.color;}if(overrides.textOpacity){tryUpdateStyle(cueDiv.firstChild,"color",constructColor(overrides.color||"#fff",overrides.textOpacity));}if(overrides.backgroundColor){cueDiv.firstChild.style.backgroundColor=overrides.backgroundColor;}if(overrides.backgroundOpacity){tryUpdateStyle(cueDiv.firstChild,"backgroundColor",constructColor(overrides.backgroundColor||"#000",overrides.backgroundOpacity));}if(overrides.windowColor){if(overrides.windowOpacity){tryUpdateStyle(cueDiv,"backgroundColor",constructColor(overrides.windowColor,overrides.windowOpacity));}else{cueDiv.style.backgroundColor=overrides.windowColor;}}if(overrides.edgeStyle){if(overrides.edgeStyle==="dropshadow"){cueDiv.firstChild.style.textShadow="2px 2px 3px "+darkGray+", 2px 2px 4px "+darkGray+", 2px 2px 5px "+darkGray;}else if(overrides.edgeStyle==="raised"){cueDiv.firstChild.style.textShadow="1px 1px "+darkGray+", 2px 2px "+darkGray+", 3px 3px "+darkGray;}else if(overrides.edgeStyle==="depressed"){cueDiv.firstChild.style.textShadow="1px 1px "+lightGray+", 0 1px "+lightGray+", -1px -1px "+darkGray+", 0 -1px "+darkGray;}else if(overrides.edgeStyle==="uniform"){cueDiv.firstChild.style.textShadow="0 0 4px "+darkGray+", 0 0 4px "+darkGray+", 0 0 4px "+darkGray+", 0 0 4px "+darkGray;}}if(overrides.fontPercent&&overrides.fontPercent!==1){var fontSize=_globalWindow2["default"].parseFloat(cueDiv.style.fontSize);cueDiv.style.fontSize=fontSize*overrides.fontPercent+"px";cueDiv.style.height="auto";cueDiv.style.top="auto";cueDiv.style.bottom="2px";}if(overrides.fontFamily&&overrides.fontFamily!=="default"){if(overrides.fontFamily==="small-caps"){cueDiv.firstChild.style.fontVariant="small-caps";}else{cueDiv.firstChild.style.fontFamily=fontMap[overrides.fontFamily];}}}};return TextTrackDisplay;}(_component2["default"]);function constructColor(color,opacity){return"rgba("+parseInt(color[1]+color[1],16)+","+parseInt(color[2]+color[2],16)+","+parseInt(color[3]+color[3],16)+","+opacity+")";}function tryUpdateStyle(el,style,rule){try{el.style[style]=rule;}catch(e){}}_component2["default"].registerComponent("TextTrackDisplay",TextTrackDisplay);exports["default"]=TextTrackDisplay;module.exports=exports["default"];},{"../component":65,"../menu/menu-button.js":102,"../menu/menu-item.js":103,"../menu/menu.js":104,"../utils/fn.js":128,"global/document":1,"global/window":2}],118:[function(_dereq_,module,exports){"use strict";exports.__esModule=true;var TextTrackMode={disabled:"disabled",hidden:"hidden",showing:"showing"};var TextTrackKind={subtitles:"subtitles",captions:"captions",descriptions:"descriptions",chapters:"chapters",metadata:"metadata"};exports.TextTrackMode=TextTrackMode;exports.TextTrackKind=TextTrackKind;},{}],119:[function(_dereq_,module,exports){"use strict";exports.__esModule=true;var trackToJson_=function trackToJson_(track){var ret=["kind","label","language","id","inBandMetadataTrackDispatchType","mode","src"].reduce(function(acc,prop,i){if(track[prop]){acc[prop]=track[prop];}return acc;},{cues:track.cues&&Array.prototype.map.call(track.cues,function(cue){return{startTime:cue.startTime,endTime:cue.endTime,text:cue.text,id:cue.id};})});return ret;};var textTracksToJson=function textTracksToJson(tech){var trackEls=tech.$$("track");var trackObjs=Array.prototype.map.call(trackEls,function(t){return t.track;});var tracks=Array.prototype.map.call(trackEls,function(trackEl){var json=trackToJson_(trackEl.track);if(trackEl.src){json.src=trackEl.src;}return json;});return tracks.concat(Array.prototype.filter.call(tech.textTracks(),function(track){return trackObjs.indexOf(track)===-1;}).map(trackToJson_));};var jsonToTextTracks=function jsonToTextTracks(json,tech){json.forEach(function(track){var addedTrack=tech.addRemoteTextTrack(track).track;if(!track.src&&track.cues){track.cues.forEach(function(cue){return addedTrack.addCue(cue);});}});return tech.textTracks();};exports["default"]={textTracksToJson:textTracksToJson,jsonToTextTracks:jsonToTextTracks,trackToJson_:trackToJson_};module.exports=exports["default"];},{}],120:[function(_dereq_,module,exports){"use strict";exports.__esModule=true;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}var _eventTarget=_dereq_("../event-target");var _eventTarget2=_interopRequireDefault(_eventTarget);var _utilsFnJs=_dereq_("../utils/fn.js");var Fn=_interopRequireWildcard(_utilsFnJs);var _utilsBrowserJs=_dereq_("../utils/browser.js");var browser=_interopRequireWildcard(_utilsBrowserJs);var _globalDocument=_dereq_("global/document");var _globalDocument2=_interopRequireDefault(_globalDocument);var TextTrackList=function TextTrackList(tracks){var list=this;if(browser.IS_IE8){list=_globalDocument2["default"].createElement("custom");for(var prop in TextTrackList.prototype){if(prop!=="constructor"){list[prop]=TextTrackList.prototype[prop];}}}tracks=tracks||[];list.tracks_=[];Object.defineProperty(list,"length",{get:function get(){return this.tracks_.length;}});for(var i=0;i<tracks.length;i++){list.addTrack_(tracks[i]);}if(browser.IS_IE8){return list;}};TextTrackList.prototype=Object.create(_eventTarget2["default"].prototype);TextTrackList.prototype.constructor=TextTrackList;TextTrackList.prototype.allowedEvents_={change:"change",addtrack:"addtrack",removetrack:"removetrack"};for(var _event in TextTrackList.prototype.allowedEvents_){TextTrackList.prototype["on"+_event]=null;}TextTrackList.prototype.addTrack_=function(track){var index=this.tracks_.length;if(!(""+index in this)){Object.defineProperty(this,index,{get:function get(){return this.tracks_[index];}});}track.addEventListener("modechange",Fn.bind(this,function(){this.trigger("change");}));this.tracks_.push(track);this.trigger({type:"addtrack",track:track});};TextTrackList.prototype.removeTrack_=function(rtrack){var result=null;var track=undefined;for(var i=0,l=this.length;i<l;i++){track=this[i];if(track===rtrack){this.tracks_.splice(i,1);break;}}this.trigger({type:"removetrack",track:track});};TextTrackList.prototype.getTrackById=function(id){var result=null;for(var i=0,l=this.length;i<l;i++){var track=this[i];if(track.id===id){result=track;break;}}return result;};exports["default"]=TextTrackList;module.exports=exports["default"];},{"../event-target":97,"../utils/browser.js":123,"../utils/fn.js":128,"global/document":1}],121:[function(_dereq_,module,exports){"use strict";exports.__esModule=true;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":_typeof2(superClass)));}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var _component=_dereq_("../component");var _component2=_interopRequireDefault(_component);var _utilsEventsJs=_dereq_("../utils/events.js");var Events=_interopRequireWildcard(_utilsEventsJs);var _utilsFnJs=_dereq_("../utils/fn.js");var Fn=_interopRequireWildcard(_utilsFnJs);var _utilsLogJs=_dereq_("../utils/log.js");var _utilsLogJs2=_interopRequireDefault(_utilsLogJs);var _safeJsonParseTuple=_dereq_("safe-json-parse/tuple");var _safeJsonParseTuple2=_interopRequireDefault(_safeJsonParseTuple);var _globalWindow=_dereq_("global/window");var _globalWindow2=_interopRequireDefault(_globalWindow);var TextTrackSettings=function(_Component){_inherits(TextTrackSettings,_Component);function TextTrackSettings(player,options){_classCallCheck(this,TextTrackSettings);_Component.call(this,player,options);this.hide();if(options.persistTextTrackSettings===undefined){this.options_.persistTextTrackSettings=this.options_.playerOptions.persistTextTrackSettings;}Events.on(this.$(".vjs-done-button"),"click",Fn.bind(this,function(){this.saveSettings();this.hide();}));Events.on(this.$(".vjs-default-button"),"click",Fn.bind(this,function(){this.$(".vjs-fg-color > select").selectedIndex=0;this.$(".vjs-bg-color > select").selectedIndex=0;this.$(".window-color > select").selectedIndex=0;this.$(".vjs-text-opacity > select").selectedIndex=0;this.$(".vjs-bg-opacity > select").selectedIndex=0;this.$(".vjs-window-opacity > select").selectedIndex=0;this.$(".vjs-edge-style select").selectedIndex=0;this.$(".vjs-font-family select").selectedIndex=0;this.$(".vjs-font-percent select").selectedIndex=2;this.updateDisplay();}));Events.on(this.$(".vjs-fg-color > select"),"change",Fn.bind(this,this.updateDisplay));Events.on(this.$(".vjs-bg-color > select"),"change",Fn.bind(this,this.updateDisplay));Events.on(this.$(".window-color > select"),"change",Fn.bind(this,this.updateDisplay));Events.on(this.$(".vjs-text-opacity > select"),"change",Fn.bind(this,this.updateDisplay));Events.on(this.$(".vjs-bg-opacity > select"),"change",Fn.bind(this,this.updateDisplay));Events.on(this.$(".vjs-window-opacity > select"),"change",Fn.bind(this,this.updateDisplay));Events.on(this.$(".vjs-font-percent select"),"change",Fn.bind(this,this.updateDisplay));Events.on(this.$(".vjs-edge-style select"),"change",Fn.bind(this,this.updateDisplay));Events.on(this.$(".vjs-font-family select"),"change",Fn.bind(this,this.updateDisplay));if(this.options_.persistTextTrackSettings){this.restoreSettings();}}TextTrackSettings.prototype.createEl=function createEl(){return _Component.prototype.createEl.call(this,"div",{className:"vjs-caption-settings vjs-modal-overlay",innerHTML:captionOptionsMenuTemplate()});};TextTrackSettings.prototype.getValues=function getValues(){var textEdge=getSelectedOptionValue(this.$(".vjs-edge-style select"));var fontFamily=getSelectedOptionValue(this.$(".vjs-font-family select"));var fgColor=getSelectedOptionValue(this.$(".vjs-fg-color > select"));var textOpacity=getSelectedOptionValue(this.$(".vjs-text-opacity > select"));var bgColor=getSelectedOptionValue(this.$(".vjs-bg-color > select"));var bgOpacity=getSelectedOptionValue(this.$(".vjs-bg-opacity > select"));var windowColor=getSelectedOptionValue(this.$(".window-color > select"));var windowOpacity=getSelectedOptionValue(this.$(".vjs-window-opacity > select"));var fontPercent=_globalWindow2["default"]["parseFloat"](getSelectedOptionValue(this.$(".vjs-font-percent > select")));var result={backgroundOpacity:bgOpacity,textOpacity:textOpacity,windowOpacity:windowOpacity,edgeStyle:textEdge,fontFamily:fontFamily,color:fgColor,backgroundColor:bgColor,windowColor:windowColor,fontPercent:fontPercent};for(var _name in result){if(result[_name]===""||result[_name]==="none"||_name==="fontPercent"&&result[_name]===1){delete result[_name];}}return result;};TextTrackSettings.prototype.setValues=function setValues(values){setSelectedOption(this.$(".vjs-edge-style select"),values.edgeStyle);setSelectedOption(this.$(".vjs-font-family select"),values.fontFamily);setSelectedOption(this.$(".vjs-fg-color > select"),values.color);setSelectedOption(this.$(".vjs-text-opacity > select"),values.textOpacity);setSelectedOption(this.$(".vjs-bg-color > select"),values.backgroundColor);setSelectedOption(this.$(".vjs-bg-opacity > select"),values.backgroundOpacity);setSelectedOption(this.$(".window-color > select"),values.windowColor);setSelectedOption(this.$(".vjs-window-opacity > select"),values.windowOpacity);var fontPercent=values.fontPercent;if(fontPercent){fontPercent=fontPercent.toFixed(2);}setSelectedOption(this.$(".vjs-font-percent > select"),fontPercent);};TextTrackSettings.prototype.restoreSettings=function restoreSettings(){var _safeParseTuple=_safeJsonParseTuple2["default"](_globalWindow2["default"].localStorage.getItem("vjs-text-track-settings"));var err=_safeParseTuple[0];var values=_safeParseTuple[1];if(err){_utilsLogJs2["default"].error(err);}if(values){this.setValues(values);}};TextTrackSettings.prototype.saveSettings=function saveSettings(){if(!this.options_.persistTextTrackSettings){return;}var values=this.getValues();try{if(Object.getOwnPropertyNames(values).length>0){_globalWindow2["default"].localStorage.setItem("vjs-text-track-settings",JSON.stringify(values));}else{_globalWindow2["default"].localStorage.removeItem("vjs-text-track-settings");}}catch(e){}};TextTrackSettings.prototype.updateDisplay=function updateDisplay(){var ttDisplay=this.player_.getChild("textTrackDisplay");if(ttDisplay){ttDisplay.updateDisplay();}};return TextTrackSettings;}(_component2["default"]);_component2["default"].registerComponent("TextTrackSettings",TextTrackSettings);function getSelectedOptionValue(target){var selectedOption=undefined;if(target.selectedOptions){selectedOption=target.selectedOptions[0];}else if(target.options){selectedOption=target.options[target.options.selectedIndex];}return selectedOption.value;}function setSelectedOption(target,value){if(!value){return;}var i=undefined;for(i=0;i<target.options.length;i++){var option=target.options[i];if(option.value===value){break;}}target.selectedIndex=i;}function captionOptionsMenuTemplate(){var template='<div class="vjs-tracksettings">\n      <div class="vjs-tracksettings-colors">\n        <div class="vjs-fg-color vjs-tracksetting">\n            <label class="vjs-label">Foreground</label>\n            <select>\n              <option value="">---</option>\n              <option value="#FFF">White</option>\n              <option value="#000">Black</option>\n              <option value="#F00">Red</option>\n              <option value="#0F0">Green</option>\n              <option value="#00F">Blue</option>\n              <option value="#FF0">Yellow</option>\n              <option value="#F0F">Magenta</option>\n              <option value="#0FF">Cyan</option>\n            </select>\n            <span class="vjs-text-opacity vjs-opacity">\n              <select>\n                <option value="">---</option>\n                <option value="1">Opaque</option>\n                <option value="0.5">Semi-Opaque</option>\n              </select>\n            </span>\n        </div> \x3c!-- vjs-fg-color --\x3e\n        <div class="vjs-bg-color vjs-tracksetting">\n            <label class="vjs-label">Background</label>\n            <select>\n              <option value="">---</option>\n              <option value="#FFF">White</option>\n              <option value="#000">Black</option>\n              <option value="#F00">Red</option>\n              <option value="#0F0">Green</option>\n              <option value="#00F">Blue</option>\n              <option value="#FF0">Yellow</option>\n              <option value="#F0F">Magenta</option>\n              <option value="#0FF">Cyan</option>\n            </select>\n            <span class="vjs-bg-opacity vjs-opacity">\n                <select>\n                  <option value="">---</option>\n                  <option value="1">Opaque</option>\n                  <option value="0.5">Semi-Transparent</option>\n                  <option value="0">Transparent</option>\n                </select>\n            </span>\n        </div> \x3c!-- vjs-bg-color --\x3e\n        <div class="window-color vjs-tracksetting">\n            <label class="vjs-label">Window</label>\n            <select>\n              <option value="">---</option>\n              <option value="#FFF">White</option>\n              <option value="#000">Black</option>\n              <option value="#F00">Red</option>\n              <option value="#0F0">Green</option>\n              <option value="#00F">Blue</option>\n              <option value="#FF0">Yellow</option>\n              <option value="#F0F">Magenta</option>\n              <option value="#0FF">Cyan</option>\n            </select>\n            <span class="vjs-window-opacity vjs-opacity">\n                <select>\n                  <option value="">---</option>\n                  <option value="1">Opaque</option>\n                  <option value="0.5">Semi-Transparent</option>\n                  <option value="0">Transparent</option>\n                </select>\n            </span>\n        </div> \x3c!-- vjs-window-color --\x3e\n      </div> \x3c!-- vjs-tracksettings --\x3e\n      <div class="vjs-tracksettings-font">\n        <div class="vjs-font-percent vjs-tracksetting">\n          <label class="vjs-label">Font Size</label>\n          <select>\n            <option value="0.50">50%</option>\n            <option value="0.75">75%</option>\n            <option value="1.00" selected>100%</option>\n            <option value="1.25">125%</option>\n            <option value="1.50">150%</option>\n            <option value="1.75">175%</option>\n            <option value="2.00">200%</option>\n            <option value="3.00">300%</option>\n            <option value="4.00">400%</option>\n          </select>\n        </div> \x3c!-- vjs-font-percent --\x3e\n        <div class="vjs-edge-style vjs-tracksetting">\n          <label class="vjs-label">Text Edge Style</label>\n          <select>\n            <option value="none">None</option>\n            <option value="raised">Raised</option>\n            <option value="depressed">Depressed</option>\n            <option value="uniform">Uniform</option>\n            <option value="dropshadow">Dropshadow</option>\n          </select>\n        </div> \x3c!-- vjs-edge-style --\x3e\n        <div class="vjs-font-family vjs-tracksetting">\n          <label class="vjs-label">Font Family</label>\n          <select>\n            <option value="">Default</option>\n            <option value="monospaceSerif">Monospace Serif</option>\n            <option value="proportionalSerif">Proportional Serif</option>\n            <option value="monospaceSansSerif">Monospace Sans-Serif</option>\n            <option value="proportionalSansSerif">Proportional Sans-Serif</option>\n            <option value="casual">Casual</option>\n            <option value="script">Script</option>\n            <option value="small-caps">Small Caps</option>\n          </select>\n        </div> \x3c!-- vjs-font-family --\x3e\n      </div>\n    </div>\n    <div class="vjs-tracksettings-controls">\n      <button class="vjs-default-button">Defaults</button>\n      <button class="vjs-done-button">Done</button>\n    </div>';return template;}exports["default"]=TextTrackSettings;module.exports=exports["default"];},{"../component":65,"../utils/events.js":127,"../utils/fn.js":128,"../utils/log.js":131,"global/window":2,"safe-json-parse/tuple":53}],122:[function(_dereq_,module,exports){"use strict";exports.__esModule=true;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}var _textTrackCueList=_dereq_("./text-track-cue-list");var _textTrackCueList2=_interopRequireDefault(_textTrackCueList);var _utilsFnJs=_dereq_("../utils/fn.js");var Fn=_interopRequireWildcard(_utilsFnJs);var _utilsGuidJs=_dereq_("../utils/guid.js");var Guid=_interopRequireWildcard(_utilsGuidJs);var _utilsBrowserJs=_dereq_("../utils/browser.js");var browser=_interopRequireWildcard(_utilsBrowserJs);var _textTrackEnums=_dereq_("./text-track-enums");var TextTrackEnum=_interopRequireWildcard(_textTrackEnums);var _utilsLogJs=_dereq_("../utils/log.js");var _utilsLogJs2=_interopRequireDefault(_utilsLogJs);var _eventTarget=_dereq_("../event-target");var _eventTarget2=_interopRequireDefault(_eventTarget);var _globalDocument=_dereq_("global/document");var _globalDocument2=_interopRequireDefault(_globalDocument);var _globalWindow=_dereq_("global/window");var _globalWindow2=_interopRequireDefault(_globalWindow);var _utilsUrlJs=_dereq_("../utils/url.js");var _xhr=_dereq_("xhr");var _xhr2=_interopRequireDefault(_xhr);var TextTrack=function TextTrack(){var options=arguments.length<=0||arguments[0]===undefined?{}:arguments[0];if(!options.tech){throw new Error("A tech was not provided.");}var tt=this;if(browser.IS_IE8){tt=_globalDocument2["default"].createElement("custom");for(var prop in TextTrack.prototype){tt[prop]=TextTrack.prototype[prop];}}tt.tech_=options.tech;var mode=TextTrackEnum.TextTrackMode[options["mode"]]||"disabled";var kind=TextTrackEnum.TextTrackKind[options["kind"]]||"subtitles";var label=options["label"]||"";var language=options["language"]||options["srclang"]||"";var id=options["id"]||"vjs_text_track_"+Guid.newGUID();if(kind==="metadata"||kind==="chapters"){mode="hidden";}tt.cues_=[];tt.activeCues_=[];var cues=new _textTrackCueList2["default"](tt.cues_);var activeCues=new _textTrackCueList2["default"](tt.activeCues_);var changed=false;var timeupdateHandler=Fn.bind(tt,function(){this["activeCues"];if(changed){this["trigger"]("cuechange");changed=false;}});if(mode!=="disabled"){tt.tech_.on("timeupdate",timeupdateHandler);}Object.defineProperty(tt,"kind",{get:function get(){return kind;},set:Function.prototype});Object.defineProperty(tt,"label",{get:function get(){return label;},set:Function.prototype});Object.defineProperty(tt,"language",{get:function get(){return language;},set:Function.prototype});Object.defineProperty(tt,"id",{get:function get(){return id;},set:Function.prototype});Object.defineProperty(tt,"mode",{get:function get(){return mode;},set:function set(newMode){if(!TextTrackEnum.TextTrackMode[newMode]){return;}mode=newMode;if(mode==="showing"){this.tech_.on("timeupdate",timeupdateHandler);}this.trigger("modechange");}});Object.defineProperty(tt,"cues",{get:function get(){if(!this.loaded_){return null;}return cues;},set:Function.prototype});Object.defineProperty(tt,"activeCues",{get:function get(){if(!this.loaded_){return null;}if(this["cues"].length===0){return activeCues;}var ct=this.tech_.currentTime();var active=[];for(var i=0,l=this["cues"].length;i<l;i++){var cue=this["cues"][i];if(cue["startTime"]<=ct&&cue["endTime"]>=ct){active.push(cue);}else if(cue["startTime"]===cue["endTime"]&&cue["startTime"]<=ct&&cue["startTime"]+.5>=ct){active.push(cue);}}changed=false;if(active.length!==this.activeCues_.length){changed=true;}else{for(var i=0;i<active.length;i++){if(indexOf.call(this.activeCues_,active[i])===-1){changed=true;}}}this.activeCues_=active;activeCues.setCues_(this.activeCues_);return activeCues;},set:Function.prototype});if(options.src){tt.src=options.src;loadTrack(options.src,tt);}else{tt.loaded_=true;}if(browser.IS_IE8){return tt;}};TextTrack.prototype=Object.create(_eventTarget2["default"].prototype);TextTrack.prototype.constructor=TextTrack;TextTrack.prototype.allowedEvents_={cuechange:"cuechange"};TextTrack.prototype.addCue=function(cue){var tracks=this.tech_.textTracks();if(tracks){for(var i=0;i<tracks.length;i++){if(tracks[i]!==this){tracks[i].removeCue(cue);}}}this.cues_.push(cue);this["cues"].setCues_(this.cues_);};TextTrack.prototype.removeCue=function(removeCue){var removed=false;for(var i=0,l=this.cues_.length;i<l;i++){var cue=this.cues_[i];if(cue===removeCue){this.cues_.splice(i,1);removed=true;}}if(removed){this.cues.setCues_(this.cues_);}};var parseCues=function parseCues(srcContent,track){if(typeof _globalWindow2["default"]["WebVTT"]!=="function"){return _globalWindow2["default"].setTimeout(function(){parseCues(srcContent,track);},25);}var parser=new _globalWindow2["default"]["WebVTT"]["Parser"](_globalWindow2["default"],_globalWindow2["default"]["vttjs"],_globalWindow2["default"]["WebVTT"]["StringDecoder"]());parser["oncue"]=function(cue){track.addCue(cue);};parser["onparsingerror"]=function(error){_utilsLogJs2["default"].error(error);};parser["parse"](srcContent);parser["flush"]();};var loadTrack=function loadTrack(src,track){var opts={uri:src};var crossOrigin=_utilsUrlJs.isCrossOrigin(src);if(crossOrigin){opts.cors=crossOrigin;}_xhr2["default"](opts,Fn.bind(this,function(err,response,responseBody){if(err){return _utilsLogJs2["default"].error(err,response);}track.loaded_=true;parseCues(responseBody,track);}));};var indexOf=function indexOf(searchElement,fromIndex){if(this==null){throw new TypeError('"this" is null or not defined');}var O=Object(this);var len=O.length>>>0;if(len===0){return-1;}var n=+fromIndex||0;if(Math.abs(n)===Infinity){n=0;}if(n>=len){return-1;}var k=Math.max(n>=0?n:len-Math.abs(n),0);while(k<len){if(k in O&&O[k]===searchElement){return k;}k++;}return-1;};exports["default"]=TextTrack;module.exports=exports["default"];},{"../event-target":97,"../utils/browser.js":123,"../utils/fn.js":128,"../utils/guid.js":130,"../utils/log.js":131,"../utils/url.js":136,"./text-track-cue-list":116,"./text-track-enums":118,"global/document":1,"global/window":2,xhr:55}],123:[function(_dereq_,module,exports){"use strict";exports.__esModule=true;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}var _globalDocument=_dereq_("global/document");var _globalDocument2=_interopRequireDefault(_globalDocument);var _globalWindow=_dereq_("global/window");var _globalWindow2=_interopRequireDefault(_globalWindow);var USER_AGENT=_globalWindow2["default"].navigator.userAgent;var webkitVersionMap=/AppleWebKit\/([\d.]+)/i.exec(USER_AGENT);var appleWebkitVersion=webkitVersionMap?parseFloat(webkitVersionMap.pop()):null;var IS_IPHONE=/iPhone/i.test(USER_AGENT);exports.IS_IPHONE=IS_IPHONE;var IS_IPAD=/iPad/i.test(USER_AGENT);exports.IS_IPAD=IS_IPAD;var IS_IPOD=/iPod/i.test(USER_AGENT);exports.IS_IPOD=IS_IPOD;var IS_IOS=IS_IPHONE||IS_IPAD||IS_IPOD;exports.IS_IOS=IS_IOS;var IOS_VERSION=function(){var match=USER_AGENT.match(/OS (\d+)_/i);if(match&&match[1]){return match[1];}}();exports.IOS_VERSION=IOS_VERSION;var IS_ANDROID=/Android/i.test(USER_AGENT);exports.IS_ANDROID=IS_ANDROID;var ANDROID_VERSION=function(){var match=USER_AGENT.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i),major,minor;if(!match){return null;}major=match[1]&&parseFloat(match[1]);minor=match[2]&&parseFloat(match[2]);if(major&&minor){return parseFloat(match[1]+"."+match[2]);}else if(major){return major;}else{return null;}}();exports.ANDROID_VERSION=ANDROID_VERSION;var IS_OLD_ANDROID=IS_ANDROID&&/webkit/i.test(USER_AGENT)&&ANDROID_VERSION<2.3;exports.IS_OLD_ANDROID=IS_OLD_ANDROID;var IS_NATIVE_ANDROID=IS_ANDROID&&ANDROID_VERSION<5&&appleWebkitVersion<537;exports.IS_NATIVE_ANDROID=IS_NATIVE_ANDROID;var IS_FIREFOX=/Firefox/i.test(USER_AGENT);exports.IS_FIREFOX=IS_FIREFOX;var IS_CHROME=/Chrome/i.test(USER_AGENT);exports.IS_CHROME=IS_CHROME;var IS_IE8=/MSIE\s8\.0/.test(USER_AGENT);exports.IS_IE8=IS_IE8;var TOUCH_ENABLED=!!("ontouchstart"in _globalWindow2["default"]||_globalWindow2["default"].DocumentTouch&&_globalDocument2["default"]instanceof _globalWindow2["default"].DocumentTouch);exports.TOUCH_ENABLED=TOUCH_ENABLED;var BACKGROUND_SIZE_SUPPORTED="backgroundSize"in _globalDocument2["default"].createElement("video").style;exports.BACKGROUND_SIZE_SUPPORTED=BACKGROUND_SIZE_SUPPORTED;},{"global/document":1,"global/window":2}],124:[function(_dereq_,module,exports){"use strict";exports.__esModule=true;exports.bufferedPercent=bufferedPercent;var _timeRangesJs=_dereq_("./time-ranges.js");function bufferedPercent(buffered,duration){var bufferedDuration=0,start,end;if(!duration){return 0;}if(!buffered||!buffered.length){buffered=_timeRangesJs.createTimeRange(0,0);}for(var i=0;i<buffered.length;i++){start=buffered.start(i);end=buffered.end(i);if(end>duration){end=duration;}bufferedDuration+=end-start;}return bufferedDuration/duration;}},{"./time-ranges.js":134}],125:[function(_dereq_,module,exports){"use strict";exports.__esModule=true;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}var _logJs=_dereq_("./log.js");var _logJs2=_interopRequireDefault(_logJs);var defaultBehaviors={get:function get(obj,key){return obj[key];},set:function set(obj,key,value){obj[key]=value;return true;}};exports["default"]=function(target){var messages=arguments.length<=1||arguments[1]===undefined?{}:arguments[1];if(typeof Proxy==="function"){var _ret=function(){var handler={};Object.keys(messages).forEach(function(key){if(defaultBehaviors.hasOwnProperty(key)){handler[key]=function(){_logJs2["default"].warn(messages[key]);return defaultBehaviors[key].apply(this,arguments);};}});return{v:new Proxy(target,handler)};}();if((typeof _ret==="undefined"?"undefined":_typeof2(_ret))==="object")return _ret.v;}return target;};module.exports=exports["default"];},{"./log.js":131}],126:[function(_dereq_,module,exports){"use strict";exports.__esModule=true;exports.getEl=getEl;exports.createEl=createEl;exports.textContent=textContent;exports.insertElFirst=insertElFirst;exports.getElData=getElData;exports.hasElData=hasElData;exports.removeElData=removeElData;exports.hasElClass=hasElClass;exports.addElClass=addElClass;exports.removeElClass=removeElClass;exports.toggleElClass=toggleElClass;exports.setElAttributes=setElAttributes;exports.getElAttributes=getElAttributes;exports.blockTextSelection=blockTextSelection;exports.unblockTextSelection=unblockTextSelection;exports.findElPosition=findElPosition;exports.getPointerPosition=getPointerPosition;exports.isEl=isEl;exports.isTextNode=isTextNode;exports.emptyEl=emptyEl;exports.normalizeContent=normalizeContent;exports.appendContent=appendContent;exports.insertContent=insertContent;var _templateObject=_taggedTemplateLiteralLoose(["Setting attributes in the second argument of createEl()\n                has been deprecated. Use the third argument instead.\n                createEl(type, properties, attributes). Attempting to set "," to ","."],["Setting attributes in the second argument of createEl()\n                has been deprecated. Use the third argument instead.\n                createEl(type, properties, attributes). Attempting to set "," to ","."]);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _taggedTemplateLiteralLoose(strings,raw){strings.raw=raw;return strings;}var _globalDocument=_dereq_("global/document");var _globalDocument2=_interopRequireDefault(_globalDocument);var _globalWindow=_dereq_("global/window");var _globalWindow2=_interopRequireDefault(_globalWindow);var _guidJs=_dereq_("./guid.js");var Guid=_interopRequireWildcard(_guidJs);var _logJs=_dereq_("./log.js");var _logJs2=_interopRequireDefault(_logJs);var _tsml=_dereq_("tsml");var _tsml2=_interopRequireDefault(_tsml);function isNonBlankString(str){return typeof str==="string"&&/\S/.test(str);}function throwIfWhitespace(str){if(/\s/.test(str)){throw new Error("class has illegal whitespace characters");}}function classRegExp(className){return new RegExp("(^|\\s)"+className+"($|\\s)");}function createQuerier(method){return function(selector,context){if(!isNonBlankString(selector)){return _globalDocument2["default"][method](null);}if(isNonBlankString(context)){context=_globalDocument2["default"].querySelector(context);}return(isEl(context)?context:_globalDocument2["default"])[method](selector);};}function getEl(id){if(id.indexOf("#")===0){id=id.slice(1);}return _globalDocument2["default"].getElementById(id);}function createEl(){var tagName=arguments.length<=0||arguments[0]===undefined?"div":arguments[0];var properties=arguments.length<=1||arguments[1]===undefined?{}:arguments[1];var attributes=arguments.length<=2||arguments[2]===undefined?{}:arguments[2];var el=_globalDocument2["default"].createElement(tagName);Object.getOwnPropertyNames(properties).forEach(function(propName){var val=properties[propName];if(propName.indexOf("aria-")!==-1||propName==="role"||propName==="type"){_logJs2["default"].warn(_tsml2["default"](_templateObject,propName,val));el.setAttribute(propName,val);}else{el[propName]=val;}});Object.getOwnPropertyNames(attributes).forEach(function(attrName){var val=attributes[attrName];el.setAttribute(attrName,attributes[attrName]);});return el;}function textContent(el,text){if(typeof el.textContent==="undefined"){el.innerText=text;}else{el.textContent=text;}}function insertElFirst(child,parent){if(parent.firstChild){parent.insertBefore(child,parent.firstChild);}else{parent.appendChild(child);}}var elData={};var elIdAttr="vdata"+new Date().getTime();function getElData(el){var id=el[elIdAttr];if(!id){id=el[elIdAttr]=Guid.newGUID();}if(!elData[id]){elData[id]={};}return elData[id];}function hasElData(el){var id=el[elIdAttr];if(!id){return false;}return!!Object.getOwnPropertyNames(elData[id]).length;}function removeElData(el){var id=el[elIdAttr];if(!id){return;}delete elData[id];try{delete el[elIdAttr];}catch(e){if(el.removeAttribute){el.removeAttribute(elIdAttr);}else{el[elIdAttr]=null;}}}function hasElClass(element,classToCheck){if(element.classList){return element.classList.contains(classToCheck);}else{throwIfWhitespace(classToCheck);return classRegExp(classToCheck).test(element.className);}}function addElClass(element,classToAdd){if(element.classList){element.classList.add(classToAdd);}else if(!hasElClass(element,classToAdd)){element.className=(element.className+" "+classToAdd).trim();}return element;}function removeElClass(element,classToRemove){if(element.classList){element.classList.remove(classToRemove);}else{throwIfWhitespace(classToRemove);element.className=element.className.split(/\s+/).filter(function(c){return c!==classToRemove;}).join(" ");}return element;}function toggleElClass(element,classToToggle,predicate){var has=hasElClass(element,classToToggle);if(typeof predicate==="function"){predicate=predicate(element,classToToggle);}if(typeof predicate!=="boolean"){predicate=!has;}if(predicate===has){return;}if(predicate){addElClass(element,classToToggle);}else{removeElClass(element,classToToggle);}return element;}function setElAttributes(el,attributes){Object.getOwnPropertyNames(attributes).forEach(function(attrName){var attrValue=attributes[attrName];if(attrValue===null||typeof attrValue==="undefined"||attrValue===false){el.removeAttribute(attrName);}else{el.setAttribute(attrName,attrValue===true?"":attrValue);}});}function getElAttributes(tag){var obj,knownBooleans,attrs,attrName,attrVal;obj={};knownBooleans=","+"autoplay,controls,loop,muted,default"+",";if(tag&&tag.attributes&&tag.attributes.length>0){attrs=tag.attributes;for(var i=attrs.length-1;i>=0;i--){attrName=attrs[i].name;attrVal=attrs[i].value;if(typeof tag[attrName]==="boolean"||knownBooleans.indexOf(","+attrName+",")!==-1){attrVal=attrVal!==null?true:false;}obj[attrName]=attrVal;}}return obj;}function blockTextSelection(){_globalDocument2["default"].body.focus();_globalDocument2["default"].onselectstart=function(){return false;};}function unblockTextSelection(){_globalDocument2["default"].onselectstart=function(){return true;};}function findElPosition(el){var box=undefined;if(el.getBoundingClientRect&&el.parentNode){box=el.getBoundingClientRect();}if(!box){return{left:0,top:0};}var docEl=_globalDocument2["default"].documentElement;var body=_globalDocument2["default"].body;var clientLeft=docEl.clientLeft||body.clientLeft||0;var scrollLeft=_globalWindow2["default"].pageXOffset||body.scrollLeft;var left=box.left+scrollLeft-clientLeft;var clientTop=docEl.clientTop||body.clientTop||0;var scrollTop=_globalWindow2["default"].pageYOffset||body.scrollTop;var top=box.top+scrollTop-clientTop;return{left:Math.round(left),top:Math.round(top)};}function getPointerPosition(el,event){var position={};var box=findElPosition(el);var boxW=el.offsetWidth;var boxH=el.offsetHeight;var boxY=box.top;var boxX=box.left;var pageY=event.pageY;var pageX=event.pageX;if(event.changedTouches){pageX=event.changedTouches[0].pageX;pageY=event.changedTouches[0].pageY;}position.y=Math.max(0,Math.min(1,(boxY-pageY+boxH)/boxH));position.x=Math.max(0,Math.min(1,(pageX-boxX)/boxW));return position;}function isEl(value){return!!value&&(typeof value==="undefined"?"undefined":_typeof2(value))==="object"&&value.nodeType===1;}function isTextNode(value){return!!value&&(typeof value==="undefined"?"undefined":_typeof2(value))==="object"&&value.nodeType===3;}function emptyEl(el){while(el.firstChild){el.removeChild(el.firstChild);}return el;}function normalizeContent(content){if(typeof content==="function"){content=content();}return(Array.isArray(content)?content:[content]).map(function(value){if(typeof value==="function"){value=value();}if(isEl(value)||isTextNode(value)){return value;}if(typeof value==="string"&&/\S/.test(value)){return _globalDocument2["default"].createTextNode(value);}}).filter(function(value){return value;});}function appendContent(el,content){normalizeContent(content).forEach(function(node){return el.appendChild(node);});return el;}function insertContent(el,content){return appendContent(emptyEl(el),content);}var $=createQuerier("querySelector");exports.$=$;var $$=createQuerier("querySelectorAll");exports.$$=$$;},{"./guid.js":130,"./log.js":131,"global/document":1,"global/window":2,tsml:54}],127:[function(_dereq_,module,exports){"use strict";exports.__esModule=true;exports.on=on;exports.off=off;exports.trigger=trigger;exports.one=one;exports.fixEvent=fixEvent;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}var _domJs=_dereq_("./dom.js");var Dom=_interopRequireWildcard(_domJs);var _guidJs=_dereq_("./guid.js");var Guid=_interopRequireWildcard(_guidJs);var _globalWindow=_dereq_("global/window");var _globalWindow2=_interopRequireDefault(_globalWindow);var _globalDocument=_dereq_("global/document");var _globalDocument2=_interopRequireDefault(_globalDocument);function on(elem,type,fn){if(Array.isArray(type)){return _handleMultipleEvents(on,elem,type,fn);}var data=Dom.getElData(elem);if(!data.handlers)data.handlers={};if(!data.handlers[type])data.handlers[type]=[];if(!fn.guid)fn.guid=Guid.newGUID();data.handlers[type].push(fn);if(!data.dispatcher){data.disabled=false;data.dispatcher=function(event,hash){if(data.disabled)return;event=fixEvent(event);var handlers=data.handlers[event.type];if(handlers){var handlersCopy=handlers.slice(0);for(var m=0,n=handlersCopy.length;m<n;m++){if(event.isImmediatePropagationStopped()){break;}else{handlersCopy[m].call(elem,event,hash);}}}};}if(data.handlers[type].length===1){if(elem.addEventListener){elem.addEventListener(type,data.dispatcher,false);}else if(elem.attachEvent){elem.attachEvent("on"+type,data.dispatcher);}}}function off(elem,type,fn){if(!Dom.hasElData(elem))return;var data=Dom.getElData(elem);if(!data.handlers){return;}if(Array.isArray(type)){return _handleMultipleEvents(off,elem,type,fn);}var removeType=function removeType(t){data.handlers[t]=[];_cleanUpEvents(elem,t);};if(!type){for(var t in data.handlers){removeType(t);}return;}var handlers=data.handlers[type];if(!handlers)return;if(!fn){removeType(type);return;}if(fn.guid){for(var n=0;n<handlers.length;n++){if(handlers[n].guid===fn.guid){handlers.splice(n--,1);}}}_cleanUpEvents(elem,type);}function trigger(elem,event,hash){var elemData=Dom.hasElData(elem)?Dom.getElData(elem):{};var parent=elem.parentNode||elem.ownerDocument;if(typeof event==="string"){event={type:event,target:elem};}event=fixEvent(event);if(elemData.dispatcher){elemData.dispatcher.call(elem,event,hash);}if(parent&&!event.isPropagationStopped()&&event.bubbles===true){trigger.call(null,parent,event,hash);}else if(!parent&&!event.defaultPrevented){var targetData=Dom.getElData(event.target);if(event.target[event.type]){targetData.disabled=true;if(typeof event.target[event.type]==="function"){event.target[event.type]();}targetData.disabled=false;}}return!event.defaultPrevented;}function one(elem,type,fn){if(Array.isArray(type)){return _handleMultipleEvents(one,elem,type,fn);}var func=function func(){off(elem,type,func);fn.apply(this,arguments);};func.guid=fn.guid=fn.guid||Guid.newGUID();on(elem,type,func);}function fixEvent(event){function returnTrue(){return true;}function returnFalse(){return false;}if(!event||!event.isPropagationStopped){var old=event||_globalWindow2["default"].event;event={};for(var key in old){if(key!=="layerX"&&key!=="layerY"&&key!=="keyLocation"&&key!=="webkitMovementX"&&key!=="webkitMovementY"){if(!(key==="returnValue"&&old.preventDefault)){event[key]=old[key];}}}if(!event.target){event.target=event.srcElement||_globalDocument2["default"];}if(!event.relatedTarget){event.relatedTarget=event.fromElement===event.target?event.toElement:event.fromElement;}event.preventDefault=function(){if(old.preventDefault){old.preventDefault();}event.returnValue=false;old.returnValue=false;event.defaultPrevented=true;};event.defaultPrevented=false;event.stopPropagation=function(){if(old.stopPropagation){old.stopPropagation();}event.cancelBubble=true;old.cancelBubble=true;event.isPropagationStopped=returnTrue;};event.isPropagationStopped=returnFalse;event.stopImmediatePropagation=function(){if(old.stopImmediatePropagation){old.stopImmediatePropagation();}event.isImmediatePropagationStopped=returnTrue;event.stopPropagation();};event.isImmediatePropagationStopped=returnFalse;if(event.clientX!=null){var doc=_globalDocument2["default"].documentElement,body=_globalDocument2["default"].body;event.pageX=event.clientX+(doc&&doc.scrollLeft||body&&body.scrollLeft||0)-(doc&&doc.clientLeft||body&&body.clientLeft||0);event.pageY=event.clientY+(doc&&doc.scrollTop||body&&body.scrollTop||0)-(doc&&doc.clientTop||body&&body.clientTop||0);}event.which=event.charCode||event.keyCode;if(event.button!=null){event.button=event.button&1?0:event.button&4?1:event.button&2?2:0;}}return event;}function _cleanUpEvents(elem,type){var data=Dom.getElData(elem);if(data.handlers[type].length===0){delete data.handlers[type];if(elem.removeEventListener){elem.removeEventListener(type,data.dispatcher,false);}else if(elem.detachEvent){elem.detachEvent("on"+type,data.dispatcher);}}if(Object.getOwnPropertyNames(data.handlers).length<=0){delete data.handlers;delete data.dispatcher;delete data.disabled;}if(Object.getOwnPropertyNames(data).length===0){Dom.removeElData(elem);}}function _handleMultipleEvents(fn,elem,types,callback){types.forEach(function(type){fn(elem,type,callback);});}},{"./dom.js":126,"./guid.js":130,"global/document":1,"global/window":2}],128:[function(_dereq_,module,exports){"use strict";exports.__esModule=true;var _guidJs=_dereq_("./guid.js");var bind=function bind(context,fn,uid){if(!fn.guid){fn.guid=_guidJs.newGUID();}var ret=function ret(){return fn.apply(context,arguments);};ret.guid=uid?uid+"_"+fn.guid:fn.guid;return ret;};exports.bind=bind;},{"./guid.js":130}],129:[function(_dereq_,module,exports){"use strict";exports.__esModule=true;function formatTime(seconds){var guide=arguments.length<=1||arguments[1]===undefined?seconds:arguments[1];return function(){seconds=seconds<0?0:seconds;var s=Math.floor(seconds%60);var m=Math.floor(seconds/60%60);var h=Math.floor(seconds/3600);var gm=Math.floor(guide/60%60);var gh=Math.floor(guide/3600);if(isNaN(seconds)||seconds===Infinity){h=m=s="-";}h=h>0||gh>0?h+":":"";m=((h||gm>=10)&&m<10?"0"+m:m)+":";s=s<10?"0"+s:s;return h+m+s;}();}exports["default"]=formatTime;module.exports=exports["default"];},{}],130:[function(_dereq_,module,exports){"use strict";exports.__esModule=true;exports.newGUID=newGUID;var _guid=1;function newGUID(){return _guid++;}},{}],131:[function(_dereq_,module,exports){"use strict";exports.__esModule=true;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}var _globalWindow=_dereq_("global/window");var _globalWindow2=_interopRequireDefault(_globalWindow);var log=function log(){_logType(null,arguments);};log.history=[];log.error=function(){_logType("error",arguments);};log.warn=function(){_logType("warn",arguments);};function _logType(type,args){var argsArray=Array.prototype.slice.call(args);var noop=function noop(){};var console=_globalWindow2["default"]["console"]||{log:noop,warn:noop,error:noop};if(type){argsArray.unshift(type.toUpperCase()+":");}else{type="log";}log.history.push(argsArray);argsArray.unshift("VIDEOJS:");if(console[type].apply){console[type].apply(console,argsArray);}else{console[type](argsArray.join(" "));}}exports["default"]=log;module.exports=exports["default"];},{"global/window":2}],132:[function(_dereq_,module,exports){"use strict";exports.__esModule=true;exports["default"]=mergeOptions;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}var _lodashCompatObjectMerge=_dereq_("lodash-compat/object/merge");var _lodashCompatObjectMerge2=_interopRequireDefault(_lodashCompatObjectMerge);function isPlain(obj){return!!obj&&(typeof obj==="undefined"?"undefined":_typeof2(obj))==="object"&&obj.toString()==="[object Object]"&&obj.constructor===Object;}var customizer=function customizer(destination,source){if(!isPlain(source)){return source;}if(!isPlain(destination)){return mergeOptions(source);}};function mergeOptions(){var args=Array.prototype.slice.call(arguments);args.unshift({});args.push(customizer);_lodashCompatObjectMerge2["default"].apply(null,args);return args[0];}module.exports=exports["default"];},{"lodash-compat/object/merge":40}],133:[function(_dereq_,module,exports){"use strict";exports.__esModule=true;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}var _globalDocument=_dereq_("global/document");var _globalDocument2=_interopRequireDefault(_globalDocument);var createStyleElement=function createStyleElement(className){var style=_globalDocument2["default"].createElement("style");style.className=className;return style;};exports.createStyleElement=createStyleElement;var setTextContent=function setTextContent(el,content){if(el.styleSheet){el.styleSheet.cssText=content;}else{el.textContent=content;}};exports.setTextContent=setTextContent;},{"global/document":1}],134:[function(_dereq_,module,exports){"use strict";exports.__esModule=true;exports.createTimeRanges=createTimeRanges;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}var _logJs=_dereq_("./log.js");var _logJs2=_interopRequireDefault(_logJs);function createTimeRanges(start,end){if(Array.isArray(start)){return createTimeRangesObj(start);}else if(start===undefined||end===undefined){return createTimeRangesObj();}return createTimeRangesObj([[start,end]]);}exports.createTimeRange=createTimeRanges;function createTimeRangesObj(ranges){if(ranges===undefined||ranges.length===0){return{length:0,start:function start(){throw new Error("This TimeRanges object is empty");},end:function end(){throw new Error("This TimeRanges object is empty");}};}return{length:ranges.length,start:getRange.bind(null,"start",0,ranges),end:getRange.bind(null,"end",1,ranges)};}function getRange(fnName,valueIndex,ranges,rangeIndex){if(rangeIndex===undefined){_logJs2["default"].warn("DEPRECATED: Function '"+fnName+"' on 'TimeRanges' called without an index argument.");rangeIndex=0;}rangeCheck(fnName,rangeIndex,ranges.length-1);return ranges[rangeIndex][valueIndex];}function rangeCheck(fnName,index,maxIndex){if(index<0||index>maxIndex){throw new Error("Failed to execute '"+fnName+"' on 'TimeRanges': The index provided ("+index+") is greater than or equal to the maximum bound ("+maxIndex+").");}}},{"./log.js":131}],135:[function(_dereq_,module,exports){"use strict";exports.__esModule=true;function toTitleCase(string){return string.charAt(0).toUpperCase()+string.slice(1);}exports["default"]=toTitleCase;module.exports=exports["default"];},{}],136:[function(_dereq_,module,exports){"use strict";exports.__esModule=true;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}var _globalDocument=_dereq_("global/document");var _globalDocument2=_interopRequireDefault(_globalDocument);var _globalWindow=_dereq_("global/window");var _globalWindow2=_interopRequireDefault(_globalWindow);var parseUrl=function parseUrl(url){var props=["protocol","hostname","port","pathname","search","hash","host"];var a=_globalDocument2["default"].createElement("a");a.href=url;var addToBody=a.host===""&&a.protocol!=="file:";var div=undefined;if(addToBody){div=_globalDocument2["default"].createElement("div");div.innerHTML='<a href="'+url+'"></a>';a=div.firstChild;div.setAttribute("style","display:none; position:absolute;");_globalDocument2["default"].body.appendChild(div);}var details={};for(var i=0;i<props.length;i++){details[props[i]]=a[props[i]];}if(details.protocol==="http:"){details.host=details.host.replace(/:80$/,"");}if(details.protocol==="https:"){details.host=details.host.replace(/:443$/,"");}if(addToBody){_globalDocument2["default"].body.removeChild(div);}return details;};exports.parseUrl=parseUrl;var getAbsoluteURL=function getAbsoluteURL(url){if(!url.match(/^https?:\/\//)){var div=_globalDocument2["default"].createElement("div");div.innerHTML='<a href="'+url+'">x</a>';url=div.firstChild.href;}return url;};exports.getAbsoluteURL=getAbsoluteURL;var getFileExtension=function getFileExtension(path){if(typeof path==="string"){var splitPathRe=/^(\/?)([\s\S]*?)((?:\.{1,2}|[^\/]+?)(\.([^\.\/\?]+)))(?:[\/]*|[\?].*)$/i;var pathParts=splitPathRe.exec(path);if(pathParts){return pathParts.pop().toLowerCase();}}return"";};exports.getFileExtension=getFileExtension;var isCrossOrigin=function isCrossOrigin(url){var winLoc=_globalWindow2["default"].location;var urlInfo=parseUrl(url);var srcProtocol=urlInfo.protocol===":"?winLoc.protocol:urlInfo.protocol;var crossOrigin=srcProtocol+urlInfo.host!==winLoc.protocol+winLoc.host;return crossOrigin;};exports.isCrossOrigin=isCrossOrigin;},{"global/document":1,"global/window":2}],137:[function(_dereq_,module,exports){"use strict";exports.__esModule=true;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj["default"]=obj;return newObj;}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}var _globalDocument=_dereq_("global/document");var _globalDocument2=_interopRequireDefault(_globalDocument);var _setup=_dereq_("./setup");var setup=_interopRequireWildcard(_setup);var _utilsStylesheetJs=_dereq_("./utils/stylesheet.js");var stylesheet=_interopRequireWildcard(_utilsStylesheetJs);var _component=_dereq_("./component");var _component2=_interopRequireDefault(_component);var _eventTarget=_dereq_("./event-target");var _eventTarget2=_interopRequireDefault(_eventTarget);var _utilsEventsJs=_dereq_("./utils/events.js");var Events=_interopRequireWildcard(_utilsEventsJs);var _player=_dereq_("./player");var _player2=_interopRequireDefault(_player);var _pluginsJs=_dereq_("./plugins.js");var _pluginsJs2=_interopRequireDefault(_pluginsJs);var _srcJsUtilsMergeOptionsJs=_dereq_("../../src/js/utils/merge-options.js");var _srcJsUtilsMergeOptionsJs2=_interopRequireDefault(_srcJsUtilsMergeOptionsJs);var _utilsFnJs=_dereq_("./utils/fn.js");var Fn=_interopRequireWildcard(_utilsFnJs);var _tracksTextTrackJs=_dereq_("./tracks/text-track.js");var _tracksTextTrackJs2=_interopRequireDefault(_tracksTextTrackJs);var _objectAssign=_dereq_("object.assign");var _objectAssign2=_interopRequireDefault(_objectAssign);var _utilsTimeRangesJs=_dereq_("./utils/time-ranges.js");var _utilsFormatTimeJs=_dereq_("./utils/format-time.js");var _utilsFormatTimeJs2=_interopRequireDefault(_utilsFormatTimeJs);var _utilsLogJs=_dereq_("./utils/log.js");var _utilsLogJs2=_interopRequireDefault(_utilsLogJs);var _utilsDomJs=_dereq_("./utils/dom.js");var Dom=_interopRequireWildcard(_utilsDomJs);var _utilsBrowserJs=_dereq_("./utils/browser.js");var browser=_interopRequireWildcard(_utilsBrowserJs);var _utilsUrlJs=_dereq_("./utils/url.js");var Url=_interopRequireWildcard(_utilsUrlJs);var _extendJs=_dereq_("./extend.js");var _extendJs2=_interopRequireDefault(_extendJs);var _lodashCompatObjectMerge=_dereq_("lodash-compat/object/merge");var _lodashCompatObjectMerge2=_interopRequireDefault(_lodashCompatObjectMerge);var _utilsCreateDeprecationProxyJs=_dereq_("./utils/create-deprecation-proxy.js");var _utilsCreateDeprecationProxyJs2=_interopRequireDefault(_utilsCreateDeprecationProxyJs);var _xhr=_dereq_("xhr");var _xhr2=_interopRequireDefault(_xhr);var _techTechJs=_dereq_("./tech/tech.js");var _techTechJs2=_interopRequireDefault(_techTechJs);var _techHtml5Js=_dereq_("./tech/html5.js");var _techHtml5Js2=_interopRequireDefault(_techHtml5Js);var _techFlashJs=_dereq_("./tech/flash.js");var _techFlashJs2=_interopRequireDefault(_techFlashJs);if(typeof HTMLVideoElement==="undefined"){_globalDocument2["default"].createElement("video");_globalDocument2["default"].createElement("audio");_globalDocument2["default"].createElement("track");}var videojs=function videojs(id,options,ready){var tag;if(typeof id==="string"){if(id.indexOf("#")===0){id=id.slice(1);}if(videojs.getPlayers()[id]){if(options){_utilsLogJs2["default"].warn('Player "'+id+'" is already initialised. Options will not be applied.');}if(ready){videojs.getPlayers()[id].ready(ready);}return videojs.getPlayers()[id];}else{tag=Dom.getEl(id);}}else{tag=id;}if(!tag||!tag.nodeName){throw new TypeError("The element or ID supplied is not valid. (videojs)");}return tag["player"]||new _player2["default"](tag,options,ready);};var style=Dom.$(".vjs-styles-defaults");if(!style){style=stylesheet.createStyleElement("vjs-styles-defaults");var head=Dom.$("head");head.insertBefore(style,head.firstChild);stylesheet.setTextContent(style,"\n    .video-js {\n      width: 300px;\n      height: 150px;\n    }\n\n    .vjs-fluid {\n      padding-top: 56.25%\n    }\n  ");}setup.autoSetupTimeout(1,videojs);videojs.VERSION="5.3.0";videojs.options=_player2["default"].prototype.options_;videojs.getPlayers=function(){return _player2["default"].players;};videojs.players=_utilsCreateDeprecationProxyJs2["default"](_player2["default"].players,{get:"Access to videojs.players is deprecated; use videojs.getPlayers instead",set:"Modification of videojs.players is deprecated"});videojs.getComponent=_component2["default"].getComponent;videojs.registerComponent=function(name,comp){if(_techTechJs2["default"].isTech(comp)){_utilsLogJs2["default"].warn("The "+name+" tech was registered as a component. It should instead be registered using videojs.registerTech(name, tech)");}_component2["default"].registerComponent.call(_component2["default"],name,comp);};videojs.getTech=_techTechJs2["default"].getTech;videojs.registerTech=_techTechJs2["default"].registerTech;videojs.browser=browser;videojs.TOUCH_ENABLED=browser.TOUCH_ENABLED;videojs.extend=_extendJs2["default"];videojs.mergeOptions=_srcJsUtilsMergeOptionsJs2["default"];videojs.bind=Fn.bind;videojs.plugin=_pluginsJs2["default"];videojs.addLanguage=function(code,data){var _merge;code=(""+code).toLowerCase();return _lodashCompatObjectMerge2["default"](videojs.options.languages,(_merge={},_merge[code]=data,_merge))[code];};videojs.log=_utilsLogJs2["default"];videojs.createTimeRange=videojs.createTimeRanges=_utilsTimeRangesJs.createTimeRanges;videojs.formatTime=_utilsFormatTimeJs2["default"];videojs.parseUrl=Url.parseUrl;videojs.isCrossOrigin=Url.isCrossOrigin;videojs.EventTarget=_eventTarget2["default"];videojs.on=Events.on;videojs.one=Events.one;videojs.off=Events.off;videojs.trigger=Events.trigger;videojs.xhr=_xhr2["default"];videojs.TextTrack=_tracksTextTrackJs2["default"];videojs.isEl=Dom.isEl;videojs.isTextNode=Dom.isTextNode;videojs.hasClass=Dom.hasElClass;videojs.addClass=Dom.addElClass;videojs.removeClass=Dom.removeElClass;videojs.toggleClass=Dom.toggleElClass;videojs.setAttributes=Dom.setElAttributes;videojs.getAttributes=Dom.getElAttributes;videojs.emptyEl=Dom.emptyEl;videojs.appendContent=Dom.appendContent;videojs.insertContent=Dom.insertContent;if(typeof define==="function"&&define["amd"]){define("videojs",[],function(){return videojs;});}else if((typeof exports==="undefined"?"undefined":_typeof2(exports))==="object"&&(typeof module==="undefined"?"undefined":_typeof2(module))==="object"){module["exports"]=videojs;}exports["default"]=videojs;module.exports=exports["default"];},{"../../src/js/utils/merge-options.js":132,"./component":65,"./event-target":97,"./extend.js":98,"./player":106,"./plugins.js":107,"./setup":109,"./tech/flash.js":112,"./tech/html5.js":113,"./tech/tech.js":115,"./tracks/text-track.js":122,"./utils/browser.js":123,"./utils/create-deprecation-proxy.js":125,"./utils/dom.js":126,"./utils/events.js":127,"./utils/fn.js":128,"./utils/format-time.js":129,"./utils/log.js":131,"./utils/stylesheet.js":133,"./utils/time-ranges.js":134,"./utils/url.js":136,"global/document":1,"lodash-compat/object/merge":40,"object.assign":45,xhr:55}]},{},[137])(137);});(function(root){var vttjs=root.vttjs={};var cueShim=vttjs.VTTCue;var regionShim=vttjs.VTTRegion;var oldVTTCue=root.VTTCue;var oldVTTRegion=root.VTTRegion;vttjs.shim=function(){vttjs.VTTCue=cueShim;vttjs.VTTRegion=regionShim;};vttjs.restore=function(){vttjs.VTTCue=oldVTTCue;vttjs.VTTRegion=oldVTTRegion;};})(this);(function(root,vttjs){var autoKeyword="auto";var directionSetting={"":true,lr:true,rl:true};var alignSetting={start:true,middle:true,end:true,left:true,right:true};function findDirectionSetting(value){if(typeof value!=="string"){return false;}var dir=directionSetting[value.toLowerCase()];return dir?value.toLowerCase():false;}function findAlignSetting(value){if(typeof value!=="string"){return false;}var align=alignSetting[value.toLowerCase()];return align?value.toLowerCase():false;}function extend(obj){var i=1;for(;i<arguments.length;i++){var cobj=arguments[i];for(var p in cobj){obj[p]=cobj[p];}}return obj;}function VTTCue(startTime,endTime,text){var cue=this;var isIE8=/MSIE\s8\.0/.test(navigator.userAgent);var baseObj={};if(isIE8){cue=document.createElement("custom");}else{baseObj.enumerable=true;}cue.hasBeenReset=false;var _id="";var _pauseOnExit=false;var _startTime=startTime;var _endTime=endTime;var _text=text;var _region=null;var _vertical="";var _snapToLines=true;var _line="auto";var _lineAlign="start";var _position=50;var _positionAlign="middle";var _size=50;var _align="middle";Object.defineProperty(cue,"id",extend({},baseObj,{get:function get(){return _id;},set:function set(value){_id=""+value;}}));Object.defineProperty(cue,"pauseOnExit",extend({},baseObj,{get:function get(){return _pauseOnExit;},set:function set(value){_pauseOnExit=!!value;}}));Object.defineProperty(cue,"startTime",extend({},baseObj,{get:function get(){return _startTime;},set:function set(value){if(typeof value!=="number"){throw new TypeError("Start time must be set to a number.");}_startTime=value;this.hasBeenReset=true;}}));Object.defineProperty(cue,"endTime",extend({},baseObj,{get:function get(){return _endTime;},set:function set(value){if(typeof value!=="number"){throw new TypeError("End time must be set to a number.");}_endTime=value;this.hasBeenReset=true;}}));Object.defineProperty(cue,"text",extend({},baseObj,{get:function get(){return _text;},set:function set(value){_text=""+value;this.hasBeenReset=true;}}));Object.defineProperty(cue,"region",extend({},baseObj,{get:function get(){return _region;},set:function set(value){_region=value;this.hasBeenReset=true;}}));Object.defineProperty(cue,"vertical",extend({},baseObj,{get:function get(){return _vertical;},set:function set(value){var setting=findDirectionSetting(value);if(setting===false){throw new SyntaxError("An invalid or illegal string was specified.");}_vertical=setting;this.hasBeenReset=true;}}));Object.defineProperty(cue,"snapToLines",extend({},baseObj,{get:function get(){return _snapToLines;},set:function set(value){_snapToLines=!!value;this.hasBeenReset=true;}}));Object.defineProperty(cue,"line",extend({},baseObj,{get:function get(){return _line;},set:function set(value){if(typeof value!=="number"&&value!==autoKeyword){throw new SyntaxError("An invalid number or illegal string was specified.");}_line=value;this.hasBeenReset=true;}}));Object.defineProperty(cue,"lineAlign",extend({},baseObj,{get:function get(){return _lineAlign;},set:function set(value){var setting=findAlignSetting(value);if(!setting){throw new SyntaxError("An invalid or illegal string was specified.");}_lineAlign=setting;this.hasBeenReset=true;}}));Object.defineProperty(cue,"position",extend({},baseObj,{get:function get(){return _position;},set:function set(value){if(value<0||value>100){throw new Error("Position must be between 0 and 100.");}_position=value;this.hasBeenReset=true;}}));Object.defineProperty(cue,"positionAlign",extend({},baseObj,{get:function get(){return _positionAlign;},set:function set(value){var setting=findAlignSetting(value);if(!setting){throw new SyntaxError("An invalid or illegal string was specified.");}_positionAlign=setting;this.hasBeenReset=true;}}));Object.defineProperty(cue,"size",extend({},baseObj,{get:function get(){return _size;},set:function set(value){if(value<0||value>100){throw new Error("Size must be between 0 and 100.");}_size=value;this.hasBeenReset=true;}}));Object.defineProperty(cue,"align",extend({},baseObj,{get:function get(){return _align;},set:function set(value){var setting=findAlignSetting(value);if(!setting){throw new SyntaxError("An invalid or illegal string was specified.");}_align=setting;this.hasBeenReset=true;}}));cue.displayState=undefined;if(isIE8){return cue;}}VTTCue.prototype.getCueAsHTML=function(){return WebVTT.convertCueToDOMTree(window,this.text);};root.VTTCue=root.VTTCue||VTTCue;vttjs.VTTCue=VTTCue;})(this,this.vttjs||{});(function(root,vttjs){var scrollSetting={"":true,up:true};function findScrollSetting(value){if(typeof value!=="string"){return false;}var scroll=scrollSetting[value.toLowerCase()];return scroll?value.toLowerCase():false;}function isValidPercentValue(value){return typeof value==="number"&&value>=0&&value<=100;}function VTTRegion(){var _width=100;var _lines=3;var _regionAnchorX=0;var _regionAnchorY=100;var _viewportAnchorX=0;var _viewportAnchorY=100;var _scroll="";Object.defineProperties(this,{width:{enumerable:true,get:function get(){return _width;},set:function set(value){if(!isValidPercentValue(value)){throw new Error("Width must be between 0 and 100.");}_width=value;}},lines:{enumerable:true,get:function get(){return _lines;},set:function set(value){if(typeof value!=="number"){throw new TypeError("Lines must be set to a number.");}_lines=value;}},regionAnchorY:{enumerable:true,get:function get(){return _regionAnchorY;},set:function set(value){if(!isValidPercentValue(value)){throw new Error("RegionAnchorX must be between 0 and 100.");}_regionAnchorY=value;}},regionAnchorX:{enumerable:true,get:function get(){return _regionAnchorX;},set:function set(value){if(!isValidPercentValue(value)){throw new Error("RegionAnchorY must be between 0 and 100.");}_regionAnchorX=value;}},viewportAnchorY:{enumerable:true,get:function get(){return _viewportAnchorY;},set:function set(value){if(!isValidPercentValue(value)){throw new Error("ViewportAnchorY must be between 0 and 100.");}_viewportAnchorY=value;}},viewportAnchorX:{enumerable:true,get:function get(){return _viewportAnchorX;},set:function set(value){if(!isValidPercentValue(value)){throw new Error("ViewportAnchorX must be between 0 and 100.");}_viewportAnchorX=value;}},scroll:{enumerable:true,get:function get(){return _scroll;},set:function set(value){var setting=findScrollSetting(value);if(setting===false){throw new SyntaxError("An invalid or illegal string was specified.");}_scroll=setting;}}});}root.VTTRegion=root.VTTRegion||VTTRegion;vttjs.VTTRegion=VTTRegion;})(this,this.vttjs||{});(function(global){var _objCreate=Object.create||function(){function F(){}return function(o){if(arguments.length!==1){throw new Error("Object.create shim only accepts one parameter.");}F.prototype=o;return new F();};}();function ParsingError(errorData,message){this.name="ParsingError";this.code=errorData.code;this.message=message||errorData.message;}ParsingError.prototype=_objCreate(Error.prototype);ParsingError.prototype.constructor=ParsingError;ParsingError.Errors={BadSignature:{code:0,message:"Malformed WebVTT signature."},BadTimeStamp:{code:1,message:"Malformed time stamp."}};function parseTimeStamp(input){function computeSeconds(h,m,s,f){return(h|0)*3600+(m|0)*60+(s|0)+(f|0)/1e3;}var m=input.match(/^(\d+):(\d{2})(:\d{2})?\.(\d{3})/);if(!m){return null;}if(m[3]){return computeSeconds(m[1],m[2],m[3].replace(":",""),m[4]);}else if(m[1]>59){return computeSeconds(m[1],m[2],0,m[4]);}else{return computeSeconds(0,m[1],m[2],m[4]);}}function Settings(){this.values=_objCreate(null);}Settings.prototype={set:function set(k,v){if(!this.get(k)&&v!==""){this.values[k]=v;}},get:function get(k,dflt,defaultKey){if(defaultKey){return this.has(k)?this.values[k]:dflt[defaultKey];}return this.has(k)?this.values[k]:dflt;},has:function has(k){return k in this.values;},alt:function alt(k,v,a){for(var n=0;n<a.length;++n){if(v===a[n]){this.set(k,v);break;}}},integer:function integer(k,v){if(/^-?\d+$/.test(v)){this.set(k,parseInt(v,10));}},percent:function percent(k,v){var m;if(m=v.match(/^([\d]{1,3})(\.[\d]*)?%$/)){v=parseFloat(v);if(v>=0&&v<=100){this.set(k,v);return true;}}return false;}};function parseOptions(input,callback,keyValueDelim,groupDelim){var groups=groupDelim?input.split(groupDelim):[input];for(var i in groups){if(typeof groups[i]!=="string"){continue;}var kv=groups[i].split(keyValueDelim);if(kv.length!==2){continue;}var k=kv[0];var v=kv[1];callback(k,v);}}function parseCue(input,cue,regionList){var oInput=input;function consumeTimeStamp(){var ts=parseTimeStamp(input);if(ts===null){throw new ParsingError(ParsingError.Errors.BadTimeStamp,"Malformed timestamp: "+oInput);}input=input.replace(/^[^\sa-zA-Z-]+/,"");return ts;}function consumeCueSettings(input,cue){var settings=new Settings();parseOptions(input,function(k,v){switch(k){case"region":for(var i=regionList.length-1;i>=0;i--){if(regionList[i].id===v){settings.set(k,regionList[i].region);break;}}break;case"vertical":settings.alt(k,v,["rl","lr"]);break;case"line":var vals=v.split(","),vals0=vals[0];settings.integer(k,vals0);settings.percent(k,vals0)?settings.set("snapToLines",false):null;settings.alt(k,vals0,["auto"]);if(vals.length===2){settings.alt("lineAlign",vals[1],["start","middle","end"]);}break;case"position":vals=v.split(",");settings.percent(k,vals[0]);if(vals.length===2){settings.alt("positionAlign",vals[1],["start","middle","end"]);}break;case"size":settings.percent(k,v);break;case"align":settings.alt(k,v,["start","middle","end","left","right"]);break;}},/:/,/\s/);cue.region=settings.get("region",null);cue.vertical=settings.get("vertical","");cue.line=settings.get("line","auto");cue.lineAlign=settings.get("lineAlign","start");cue.snapToLines=settings.get("snapToLines",true);cue.size=settings.get("size",100);cue.align=settings.get("align","middle");cue.position=settings.get("position",{start:0,left:0,middle:50,end:100,right:100},cue.align);cue.positionAlign=settings.get("positionAlign",{start:"start",left:"start",middle:"middle",end:"end",right:"end"},cue.align);}function skipWhitespace(){input=input.replace(/^\s+/,"");}skipWhitespace();cue.startTime=consumeTimeStamp();skipWhitespace();if(input.substr(0,3)!=="--\x3e"){throw new ParsingError(ParsingError.Errors.BadTimeStamp,"Malformed time stamp (time stamps must be separated by '--\x3e'): "+oInput);}input=input.substr(3);skipWhitespace();cue.endTime=consumeTimeStamp();skipWhitespace();consumeCueSettings(input,cue);}var ESCAPE={"&amp;":"&","&lt;":"<","&gt;":">","&lrm;":"","&rlm;":"","&nbsp;":""};var TAG_NAME={c:"span",i:"i",b:"b",u:"u",ruby:"ruby",rt:"rt",v:"span",lang:"span"};var TAG_ANNOTATION={v:"title",lang:"lang"};var NEEDS_PARENT={rt:"ruby"};function parseContent(window,input){function nextToken(){if(!input){return null;}function consume(result){input=input.substr(result.length);return result;}var m=input.match(/^([^<]*)(<[^>]+>?)?/);return consume(m[1]?m[1]:m[2]);}function unescape1(e){return ESCAPE[e];}function unescape(s){while(m=s.match(/&(amp|lt|gt|lrm|rlm|nbsp);/)){s=s.replace(m[0],unescape1);}return s;}function shouldAdd(current,element){return!NEEDS_PARENT[element.localName]||NEEDS_PARENT[element.localName]===current.localName;}function createElement(type,annotation){var tagName=TAG_NAME[type];if(!tagName){return null;}var element=window.document.createElement(tagName);element.localName=tagName;var name=TAG_ANNOTATION[type];if(name&&annotation){element[name]=annotation.trim();}return element;}var rootDiv=window.document.createElement("div"),current=rootDiv,t,tagStack=[];while((t=nextToken())!==null){if(t[0]==="<"){if(t[1]==="/"){if(tagStack.length&&tagStack[tagStack.length-1]===t.substr(2).replace(">","")){tagStack.pop();current=current.parentNode;}continue;}var ts=parseTimeStamp(t.substr(1,t.length-2));var node;if(ts){node=window.document.createProcessingInstruction("timestamp",ts);current.appendChild(node);continue;}var m=t.match(/^<([^.\s/0-9>]+)(\.[^\s\\>]+)?([^>\\]+)?(\\?)>?$/);if(!m){continue;}node=createElement(m[1],m[3]);if(!node){continue;}if(!shouldAdd(current,node)){continue;}if(m[2]){node.className=m[2].substr(1).replace("."," ");}tagStack.push(m[1]);current.appendChild(node);current=node;continue;}current.appendChild(window.document.createTextNode(unescape(t)));}return rootDiv;}var strongRTLChars=[1470,1472,1475,1478,1488,1489,1490,1491,1492,1493,1494,1495,1496,1497,1498,1499,1500,1501,1502,1503,1504,1505,1506,1507,1508,1509,1510,1511,1512,1513,1514,1520,1521,1522,1523,1524,1544,1547,1549,1563,1566,1567,1568,1569,1570,1571,1572,1573,1574,1575,1576,1577,1578,1579,1580,1581,1582,1583,1584,1585,1586,1587,1588,1589,1590,1591,1592,1593,1594,1595,1596,1597,1598,1599,1600,1601,1602,1603,1604,1605,1606,1607,1608,1609,1610,1645,1646,1647,1649,1650,1651,1652,1653,1654,1655,1656,1657,1658,1659,1660,1661,1662,1663,1664,1665,1666,1667,1668,1669,1670,1671,1672,1673,1674,1675,1676,1677,1678,1679,1680,1681,1682,1683,1684,1685,1686,1687,1688,1689,1690,1691,1692,1693,1694,1695,1696,1697,1698,1699,1700,1701,1702,1703,1704,1705,1706,1707,1708,1709,1710,1711,1712,1713,1714,1715,1716,1717,1718,1719,1720,1721,1722,1723,1724,1725,1726,1727,1728,1729,1730,1731,1732,1733,1734,1735,1736,1737,1738,1739,1740,1741,1742,1743,1744,1745,1746,1747,1748,1749,1765,1766,1774,1775,1786,1787,1788,1789,1790,1791,1792,1793,1794,1795,1796,1797,1798,1799,1800,1801,1802,1803,1804,1805,1807,1808,1810,1811,1812,1813,1814,1815,1816,1817,1818,1819,1820,1821,1822,1823,1824,1825,1826,1827,1828,1829,1830,1831,1832,1833,1834,1835,1836,1837,1838,1839,1869,1870,1871,1872,1873,1874,1875,1876,1877,1878,1879,1880,1881,1882,1883,1884,1885,1886,1887,1888,1889,1890,1891,1892,1893,1894,1895,1896,1897,1898,1899,1900,1901,1902,1903,1904,1905,1906,1907,1908,1909,1910,1911,1912,1913,1914,1915,1916,1917,1918,1919,1920,1921,1922,1923,1924,1925,1926,1927,1928,1929,1930,1931,1932,1933,1934,1935,1936,1937,1938,1939,1940,1941,1942,1943,1944,1945,1946,1947,1948,1949,1950,1951,1952,1953,1954,1955,1956,1957,1969,1984,1985,1986,1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2e3,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022,2023,2024,2025,2026,2036,2037,2042,2048,2049,2050,2051,2052,2053,2054,2055,2056,2057,2058,2059,2060,2061,2062,2063,2064,2065,2066,2067,2068,2069,2074,2084,2088,2096,2097,2098,2099,2100,2101,2102,2103,2104,2105,2106,2107,2108,2109,2110,2112,2113,2114,2115,2116,2117,2118,2119,2120,2121,2122,2123,2124,2125,2126,2127,2128,2129,2130,2131,2132,2133,2134,2135,2136,2142,2208,2210,2211,2212,2213,2214,2215,2216,2217,2218,2219,2220,8207,64285,64287,64288,64289,64290,64291,64292,64293,64294,64295,64296,64298,64299,64300,64301,64302,64303,64304,64305,64306,64307,64308,64309,64310,64312,64313,64314,64315,64316,64318,64320,64321,64323,64324,64326,64327,64328,64329,64330,64331,64332,64333,64334,64335,64336,64337,64338,64339,64340,64341,64342,64343,64344,64345,64346,64347,64348,64349,64350,64351,64352,64353,64354,64355,64356,64357,64358,64359,64360,64361,64362,64363,64364,64365,64366,64367,64368,64369,64370,64371,64372,64373,64374,64375,64376,64377,64378,64379,64380,64381,64382,64383,64384,64385,64386,64387,64388,64389,64390,64391,64392,64393,64394,64395,64396,64397,64398,64399,64400,64401,64402,64403,64404,64405,64406,64407,64408,64409,64410,64411,64412,64413,64414,64415,64416,64417,64418,64419,64420,64421,64422,64423,64424,64425,64426,64427,64428,64429,64430,64431,64432,64433,64434,64435,64436,64437,64438,64439,64440,64441,64442,64443,64444,64445,64446,64447,64448,64449,64467,64468,64469,64470,64471,64472,64473,64474,64475,64476,64477,64478,64479,64480,64481,64482,64483,64484,64485,64486,64487,64488,64489,64490,64491,64492,64493,64494,64495,64496,64497,64498,64499,64500,64501,64502,64503,64504,64505,64506,64507,64508,64509,64510,64511,64512,64513,64514,64515,64516,64517,64518,64519,64520,64521,64522,64523,64524,64525,64526,64527,64528,64529,64530,64531,64532,64533,64534,64535,64536,64537,64538,64539,64540,64541,64542,64543,64544,64545,64546,64547,64548,64549,64550,64551,64552,64553,64554,64555,64556,64557,64558,64559,64560,64561,64562,64563,64564,64565,64566,64567,64568,64569,64570,64571,64572,64573,64574,64575,64576,64577,64578,64579,64580,64581,64582,64583,64584,64585,64586,64587,64588,64589,64590,64591,64592,64593,64594,64595,64596,64597,64598,64599,64600,64601,64602,64603,64604,64605,64606,64607,64608,64609,64610,64611,64612,64613,64614,64615,64616,64617,64618,64619,64620,64621,64622,64623,64624,64625,64626,64627,64628,64629,64630,64631,64632,64633,64634,64635,64636,64637,64638,64639,64640,64641,64642,64643,64644,64645,64646,64647,64648,64649,64650,64651,64652,64653,64654,64655,64656,64657,64658,64659,64660,64661,64662,64663,64664,64665,64666,64667,64668,64669,64670,64671,64672,64673,64674,64675,64676,64677,64678,64679,64680,64681,64682,64683,64684,64685,64686,64687,64688,64689,64690,64691,64692,64693,64694,64695,64696,64697,64698,64699,64700,64701,64702,64703,64704,64705,64706,64707,64708,64709,64710,64711,64712,64713,64714,64715,64716,64717,64718,64719,64720,64721,64722,64723,64724,64725,64726,64727,64728,64729,64730,64731,64732,64733,64734,64735,64736,64737,64738,64739,64740,64741,64742,64743,64744,64745,64746,64747,64748,64749,64750,64751,64752,64753,64754,64755,64756,64757,64758,64759,64760,64761,64762,64763,64764,64765,64766,64767,64768,64769,64770,64771,64772,64773,64774,64775,64776,64777,64778,64779,64780,64781,64782,64783,64784,64785,64786,64787,64788,64789,64790,64791,64792,64793,64794,64795,64796,64797,64798,64799,64800,64801,64802,64803,64804,64805,64806,64807,64808,64809,64810,64811,64812,64813,64814,64815,64816,64817,64818,64819,64820,64821,64822,64823,64824,64825,64826,64827,64828,64829,64848,64849,64850,64851,64852,64853,64854,64855,64856,64857,64858,64859,64860,64861,64862,64863,64864,64865,64866,64867,64868,64869,64870,64871,64872,64873,64874,64875,64876,64877,64878,64879,64880,64881,64882,64883,64884,64885,64886,64887,64888,64889,64890,64891,64892,64893,64894,64895,64896,64897,64898,64899,64900,64901,64902,64903,64904,64905,64906,64907,64908,64909,64910,64911,64914,64915,64916,64917,64918,64919,64920,64921,64922,64923,64924,64925,64926,64927,64928,64929,64930,64931,64932,64933,64934,64935,64936,64937,64938,64939,64940,64941,64942,64943,64944,64945,64946,64947,64948,64949,64950,64951,64952,64953,64954,64955,64956,64957,64958,64959,64960,64961,64962,64963,64964,64965,64966,64967,65008,65009,65010,65011,65012,65013,65014,65015,65016,65017,65018,65019,65020,65136,65137,65138,65139,65140,65142,65143,65144,65145,65146,65147,65148,65149,65150,65151,65152,65153,65154,65155,65156,65157,65158,65159,65160,65161,65162,65163,65164,65165,65166,65167,65168,65169,65170,65171,65172,65173,65174,65175,65176,65177,65178,65179,65180,65181,65182,65183,65184,65185,65186,65187,65188,65189,65190,65191,65192,65193,65194,65195,65196,65197,65198,65199,65200,65201,65202,65203,65204,65205,65206,65207,65208,65209,65210,65211,65212,65213,65214,65215,65216,65217,65218,65219,65220,65221,65222,65223,65224,65225,65226,65227,65228,65229,65230,65231,65232,65233,65234,65235,65236,65237,65238,65239,65240,65241,65242,65243,65244,65245,65246,65247,65248,65249,65250,65251,65252,65253,65254,65255,65256,65257,65258,65259,65260,65261,65262,65263,65264,65265,65266,65267,65268,65269,65270,65271,65272,65273,65274,65275,65276,67584,67585,67586,67587,67588,67589,67592,67594,67595,67596,67597,67598,67599,67600,67601,67602,67603,67604,67605,67606,67607,67608,67609,67610,67611,67612,67613,67614,67615,67616,67617,67618,67619,67620,67621,67622,67623,67624,67625,67626,67627,67628,67629,67630,67631,67632,67633,67634,67635,67636,67637,67639,67640,67644,67647,67648,67649,67650,67651,67652,67653,67654,67655,67656,67657,67658,67659,67660,67661,67662,67663,67664,67665,67666,67667,67668,67669,67671,67672,67673,67674,67675,67676,67677,67678,67679,67840,67841,67842,67843,67844,67845,67846,67847,67848,67849,67850,67851,67852,67853,67854,67855,67856,67857,67858,67859,67860,67861,67862,67863,67864,67865,67866,67867,67872,67873,67874,67875,67876,67877,67878,67879,67880,67881,67882,67883,67884,67885,67886,67887,67888,67889,67890,67891,67892,67893,67894,67895,67896,67897,67903,67968,67969,67970,67971,67972,67973,67974,67975,67976,67977,67978,67979,67980,67981,67982,67983,67984,67985,67986,67987,67988,67989,67990,67991,67992,67993,67994,67995,67996,67997,67998,67999,68e3,68001,68002,68003,68004,68005,68006,68007,68008,68009,68010,68011,68012,68013,68014,68015,68016,68017,68018,68019,68020,68021,68022,68023,68030,68031,68096,68112,68113,68114,68115,68117,68118,68119,68121,68122,68123,68124,68125,68126,68127,68128,68129,68130,68131,68132,68133,68134,68135,68136,68137,68138,68139,68140,68141,68142,68143,68144,68145,68146,68147,68160,68161,68162,68163,68164,68165,68166,68167,68176,68177,68178,68179,68180,68181,68182,68183,68184,68192,68193,68194,68195,68196,68197,68198,68199,68200,68201,68202,68203,68204,68205,68206,68207,68208,68209,68210,68211,68212,68213,68214,68215,68216,68217,68218,68219,68220,68221,68222,68223,68352,68353,68354,68355,68356,68357,68358,68359,68360,68361,68362,68363,68364,68365,68366,68367,68368,68369,68370,68371,68372,68373,68374,68375,68376,68377,68378,68379,68380,68381,68382,68383,68384,68385,68386,68387,68388,68389,68390,68391,68392,68393,68394,68395,68396,68397,68398,68399,68400,68401,68402,68403,68404,68405,68416,68417,68418,68419,68420,68421,68422,68423,68424,68425,68426,68427,68428,68429,68430,68431,68432,68433,68434,68435,68436,68437,68440,68441,68442,68443,68444,68445,68446,68447,68448,68449,68450,68451,68452,68453,68454,68455,68456,68457,68458,68459,68460,68461,68462,68463,68464,68465,68466,68472,68473,68474,68475,68476,68477,68478,68479,68608,68609,68610,68611,68612,68613,68614,68615,68616,68617,68618,68619,68620,68621,68622,68623,68624,68625,68626,68627,68628,68629,68630,68631,68632,68633,68634,68635,68636,68637,68638,68639,68640,68641,68642,68643,68644,68645,68646,68647,68648,68649,68650,68651,68652,68653,68654,68655,68656,68657,68658,68659,68660,68661,68662,68663,68664,68665,68666,68667,68668,68669,68670,68671,68672,68673,68674,68675,68676,68677,68678,68679,68680,126464,126465,126466,126467,126469,126470,126471,126472,126473,126474,126475,126476,126477,126478,126479,126480,126481,126482,126483,126484,126485,126486,126487,126488,126489,126490,126491,126492,126493,126494,126495,126497,126498,126500,126503,126505,126506,126507,126508,126509,126510,126511,126512,126513,126514,126516,126517,126518,126519,126521,126523,126530,126535,126537,126539,126541,126542,126543,126545,126546,126548,126551,126553,126555,126557,126559,126561,126562,126564,126567,126568,126569,126570,126572,126573,126574,126575,126576,126577,126578,126580,126581,126582,126583,126585,126586,126587,126588,126590,126592,126593,126594,126595,126596,126597,126598,126599,126600,126601,126603,126604,126605,126606,126607,126608,126609,126610,126611,126612,126613,126614,126615,126616,126617,126618,126619,126625,126626,126627,126629,126630,126631,126632,126633,126635,126636,126637,126638,126639,126640,126641,126642,126643,126644,126645,126646,126647,126648,126649,126650,126651,1114109];function determineBidi(cueDiv){var nodeStack=[],text="",charCode;if(!cueDiv||!cueDiv.childNodes){return"ltr";}function pushNodes(nodeStack,node){for(var i=node.childNodes.length-1;i>=0;i--){nodeStack.push(node.childNodes[i]);}}function nextTextNode(nodeStack){if(!nodeStack||!nodeStack.length){return null;}var node=nodeStack.pop(),text=node.textContent||node.innerText;if(text){var m=text.match(/^.*(\n|\r)/);if(m){nodeStack.length=0;return m[0];}return text;}if(node.tagName==="ruby"){return nextTextNode(nodeStack);}if(node.childNodes){pushNodes(nodeStack,node);return nextTextNode(nodeStack);}}pushNodes(nodeStack,cueDiv);while(text=nextTextNode(nodeStack)){for(var i=0;i<text.length;i++){charCode=text.charCodeAt(i);for(var j=0;j<strongRTLChars.length;j++){if(strongRTLChars[j]===charCode){return"rtl";}}}}return"ltr";}function computeLinePos(cue){if(typeof cue.line==="number"&&(cue.snapToLines||cue.line>=0&&cue.line<=100)){return cue.line;}if(!cue.track||!cue.track.textTrackList||!cue.track.textTrackList.mediaElement){return-1;}var track=cue.track,trackList=track.textTrackList,count=0;for(var i=0;i<trackList.length&&trackList[i]!==track;i++){if(trackList[i].mode==="showing"){count++;}}return++count*-1;}function StyleBox(){}StyleBox.prototype.applyStyles=function(styles,div){div=div||this.div;for(var prop in styles){if(styles.hasOwnProperty(prop)){div.style[prop]=styles[prop];}}};StyleBox.prototype.formatStyle=function(val,unit){return val===0?0:val+unit;};function CueStyleBox(window,cue,styleOptions){var isIE8=/MSIE\s8\.0/.test(navigator.userAgent);var color="rgba(255, 255, 255, 1)";var backgroundColor="rgba(0, 0, 0, 0.8)";if(isIE8){color="rgb(255, 255, 255)";backgroundColor="rgb(0, 0, 0)";}StyleBox.call(this);this.cue=cue;this.cueDiv=parseContent(window,cue.text);var styles={color:color,backgroundColor:backgroundColor,position:"relative",left:0,right:0,top:0,bottom:0,display:"inline"};if(!isIE8){styles.writingMode=cue.vertical===""?"horizontal-tb":cue.vertical==="lr"?"vertical-lr":"vertical-rl";styles.unicodeBidi="plaintext";}this.applyStyles(styles,this.cueDiv);this.div=window.document.createElement("div");styles={textAlign:cue.align==="middle"?"center":cue.align,font:styleOptions.font,whiteSpace:"pre-line",position:"absolute"};if(!isIE8){styles.direction=determineBidi(this.cueDiv);styles.writingMode=cue.vertical===""?"horizontal-tb":cue.vertical==="lr"?"vertical-lr":"vertical-rl".stylesunicodeBidi="plaintext";}this.applyStyles(styles);this.div.appendChild(this.cueDiv);var textPos=0;switch(cue.positionAlign){case"start":textPos=cue.position;break;case"middle":textPos=cue.position-cue.size/2;break;case"end":textPos=cue.position-cue.size;break;}if(cue.vertical===""){this.applyStyles({left:this.formatStyle(textPos,"%"),width:this.formatStyle(cue.size,"%")});}else{this.applyStyles({top:this.formatStyle(textPos,"%"),height:this.formatStyle(cue.size,"%")});}this.move=function(box){this.applyStyles({top:this.formatStyle(box.top,"px"),bottom:this.formatStyle(box.bottom,"px"),left:this.formatStyle(box.left,"px"),right:this.formatStyle(box.right,"px"),height:this.formatStyle(box.height,"px"),width:this.formatStyle(box.width,"px")});};}CueStyleBox.prototype=_objCreate(StyleBox.prototype);CueStyleBox.prototype.constructor=CueStyleBox;function BoxPosition(obj){var isIE8=/MSIE\s8\.0/.test(navigator.userAgent);var lh,height,width,top;if(obj.div){height=obj.div.offsetHeight;width=obj.div.offsetWidth;top=obj.div.offsetTop;var rects=(rects=obj.div.childNodes)&&(rects=rects[0])&&rects.getClientRects&&rects.getClientRects();obj=obj.div.getBoundingClientRect();lh=rects?Math.max(rects[0]&&rects[0].height||0,obj.height/rects.length):0;}this.left=obj.left;this.right=obj.right;this.top=obj.top||top;this.height=obj.height||height;this.bottom=obj.bottom||top+(obj.height||height);this.width=obj.width||width;this.lineHeight=lh!==undefined?lh:obj.lineHeight;if(isIE8&&!this.lineHeight){this.lineHeight=13;}}BoxPosition.prototype.move=function(axis,toMove){toMove=toMove!==undefined?toMove:this.lineHeight;switch(axis){case"+x":this.left+=toMove;this.right+=toMove;break;case"-x":this.left-=toMove;this.right-=toMove;break;case"+y":this.top+=toMove;this.bottom+=toMove;break;case"-y":this.top-=toMove;this.bottom-=toMove;break;}};BoxPosition.prototype.overlaps=function(b2){return this.left<b2.right&&this.right>b2.left&&this.top<b2.bottom&&this.bottom>b2.top;};BoxPosition.prototype.overlapsAny=function(boxes){for(var i=0;i<boxes.length;i++){if(this.overlaps(boxes[i])){return true;}}return false;};BoxPosition.prototype.within=function(container){return this.top>=container.top&&this.bottom<=container.bottom&&this.left>=container.left&&this.right<=container.right;};BoxPosition.prototype.overlapsOppositeAxis=function(container,axis){switch(axis){case"+x":return this.left<container.left;case"-x":return this.right>container.right;case"+y":return this.top<container.top;case"-y":return this.bottom>container.bottom;}};BoxPosition.prototype.intersectPercentage=function(b2){var x=Math.max(0,Math.min(this.right,b2.right)-Math.max(this.left,b2.left)),y=Math.max(0,Math.min(this.bottom,b2.bottom)-Math.max(this.top,b2.top)),intersectArea=x*y;return intersectArea/(this.height*this.width);};BoxPosition.prototype.toCSSCompatValues=function(reference){return{top:this.top-reference.top,bottom:reference.bottom-this.bottom,left:this.left-reference.left,right:reference.right-this.right,height:this.height,width:this.width};};BoxPosition.getSimpleBoxPosition=function(obj){var height=obj.div?obj.div.offsetHeight:obj.tagName?obj.offsetHeight:0;var width=obj.div?obj.div.offsetWidth:obj.tagName?obj.offsetWidth:0;var top=obj.div?obj.div.offsetTop:obj.tagName?obj.offsetTop:0;obj=obj.div?obj.div.getBoundingClientRect():obj.tagName?obj.getBoundingClientRect():obj;var ret={left:obj.left,right:obj.right,top:obj.top||top,height:obj.height||height,bottom:obj.bottom||top+(obj.height||height),width:obj.width||width};return ret;};function moveBoxToLinePosition(window,styleBox,containerBox,boxPositions){function findBestPosition(b,axis){var bestPosition,specifiedPosition=new BoxPosition(b),percentage=1;for(var i=0;i<axis.length;i++){while(b.overlapsOppositeAxis(containerBox,axis[i])||b.within(containerBox)&&b.overlapsAny(boxPositions)){b.move(axis[i]);}if(b.within(containerBox)){return b;}var p=b.intersectPercentage(containerBox);if(percentage>p){bestPosition=new BoxPosition(b);percentage=p;}b=new BoxPosition(specifiedPosition);}return bestPosition||specifiedPosition;}var boxPosition=new BoxPosition(styleBox),cue=styleBox.cue,linePos=computeLinePos(cue),axis=[];if(cue.snapToLines){var size;switch(cue.vertical){case"":axis=["+y","-y"];size="height";break;case"rl":axis=["+x","-x"];size="width";break;case"lr":axis=["-x","+x"];size="width";break;}var step=boxPosition.lineHeight,position=step*Math.round(linePos),maxPosition=containerBox[size]+step,initialAxis=axis[0];if(Math.abs(position)>maxPosition){position=position<0?-1:1;position*=Math.ceil(maxPosition/step)*step;}if(linePos<0){position+=cue.vertical===""?containerBox.height:containerBox.width;axis=axis.reverse();}boxPosition.move(initialAxis,position);}else{var calculatedPercentage=boxPosition.lineHeight/containerBox.height*100;switch(cue.lineAlign){case"middle":linePos-=calculatedPercentage/2;break;case"end":linePos-=calculatedPercentage;break;}switch(cue.vertical){case"":styleBox.applyStyles({top:styleBox.formatStyle(linePos,"%")});break;case"rl":styleBox.applyStyles({left:styleBox.formatStyle(linePos,"%")});break;case"lr":styleBox.applyStyles({right:styleBox.formatStyle(linePos,"%")});break;}axis=["+y","-x","+x","-y"];boxPosition=new BoxPosition(styleBox);}var bestPosition=findBestPosition(boxPosition,axis);styleBox.move(bestPosition.toCSSCompatValues(containerBox));}function WebVTT(){}WebVTT.StringDecoder=function(){return{decode:function decode(data){if(!data){return"";}if(typeof data!=="string"){throw new Error("Error - expected string data.");}return decodeURIComponent(encodeURIComponent(data));}};};WebVTT.convertCueToDOMTree=function(window,cuetext){if(!window||!cuetext){return null;}return parseContent(window,cuetext);};var FONT_SIZE_PERCENT=.05;var FONT_STYLE="sans-serif";var CUE_BACKGROUND_PADDING="1.5%";WebVTT.processCues=function(window,cues,overlay){if(!window||!cues||!overlay){return null;}while(overlay.firstChild){overlay.removeChild(overlay.firstChild);}var paddedOverlay=window.document.createElement("div");paddedOverlay.style.position="absolute";paddedOverlay.style.left="0";paddedOverlay.style.right="0";paddedOverlay.style.top="0";paddedOverlay.style.bottom="0";paddedOverlay.style.margin=CUE_BACKGROUND_PADDING;overlay.appendChild(paddedOverlay);function shouldCompute(cues){for(var i=0;i<cues.length;i++){if(cues[i].hasBeenReset||!cues[i].displayState){return true;}}return false;}if(!shouldCompute(cues)){for(var i=0;i<cues.length;i++){paddedOverlay.appendChild(cues[i].displayState);}return;}var boxPositions=[],containerBox=BoxPosition.getSimpleBoxPosition(paddedOverlay),fontSize=Math.round(containerBox.height*FONT_SIZE_PERCENT*100)/100;var styleOptions={font:fontSize+"px "+FONT_STYLE};(function(){var styleBox,cue;for(var i=0;i<cues.length;i++){cue=cues[i];styleBox=new CueStyleBox(window,cue,styleOptions);paddedOverlay.appendChild(styleBox.div);moveBoxToLinePosition(window,styleBox,containerBox,boxPositions);cue.displayState=styleBox.div;boxPositions.push(BoxPosition.getSimpleBoxPosition(styleBox));}})();};WebVTT.Parser=function(window,vttjs,decoder){if(!decoder){decoder=vttjs;vttjs={};}if(!vttjs){vttjs={};}this.window=window;this.vttjs=vttjs;this.state="INITIAL";this.buffer="";this.decoder=decoder||new TextDecoder("utf8");this.regionList=[];};WebVTT.Parser.prototype={reportOrThrowError:function reportOrThrowError(e){if(e instanceof ParsingError){this.onparsingerror&&this.onparsingerror(e);}else{throw e;}},parse:function parse(data){var self=this;if(data){self.buffer+=self.decoder.decode(data,{stream:true});}function collectNextLine(){var buffer=self.buffer;var pos=0;while(pos<buffer.length&&buffer[pos]!=="\r"&&buffer[pos]!=="\n"){++pos;}var line=buffer.substr(0,pos);if(buffer[pos]==="\r"){++pos;}if(buffer[pos]==="\n"){++pos;}self.buffer=buffer.substr(pos);return line;}function parseRegion(input){var settings=new Settings();parseOptions(input,function(k,v){switch(k){case"id":settings.set(k,v);break;case"width":settings.percent(k,v);break;case"lines":settings.integer(k,v);break;case"regionanchor":case"viewportanchor":var xy=v.split(",");if(xy.length!==2){break;}var anchor=new Settings();anchor.percent("x",xy[0]);anchor.percent("y",xy[1]);if(!anchor.has("x")||!anchor.has("y")){break;}settings.set(k+"X",anchor.get("x"));settings.set(k+"Y",anchor.get("y"));break;case"scroll":settings.alt(k,v,["up"]);break;}},/=/,/\s/);if(settings.has("id")){var region=new(self.vttjs.VTTRegion||self.window.VTTRegion)();region.width=settings.get("width",100);region.lines=settings.get("lines",3);region.regionAnchorX=settings.get("regionanchorX",0);region.regionAnchorY=settings.get("regionanchorY",100);region.viewportAnchorX=settings.get("viewportanchorX",0);region.viewportAnchorY=settings.get("viewportanchorY",100);region.scroll=settings.get("scroll","");self.onregion&&self.onregion(region);self.regionList.push({id:settings.get("id"),region:region});}}function parseHeader(input){parseOptions(input,function(k,v){switch(k){case"Region":parseRegion(v);break;}},/:/);}try{var line;if(self.state==="INITIAL"){if(!/\r\n|\n/.test(self.buffer)){return this;}line=collectNextLine();var m=line.match(/^WEBVTT([ \t].*)?$/);if(!m||!m[0]){throw new ParsingError(ParsingError.Errors.BadSignature);}self.state="HEADER";}var alreadyCollectedLine=false;while(self.buffer){if(!/\r\n|\n/.test(self.buffer)){return this;}if(!alreadyCollectedLine){line=collectNextLine();}else{alreadyCollectedLine=false;}switch(self.state){case"HEADER":if(/:/.test(line)){parseHeader(line);}else if(!line){self.state="ID";}continue;case"NOTE":if(!line){self.state="ID";}continue;case"ID":if(/^NOTE($|[ \t])/.test(line)){self.state="NOTE";break;}if(!line){continue;}self.cue=new(self.vttjs.VTTCue||self.window.VTTCue)(0,0,"");self.state="CUE";if(line.indexOf("--\x3e")===-1){self.cue.id=line;continue;}case"CUE":try{parseCue(line,self.cue,self.regionList);}catch(e){self.reportOrThrowError(e);self.cue=null;self.state="BADCUE";continue;}self.state="CUETEXT";continue;case"CUETEXT":var hasSubstring=line.indexOf("--\x3e")!==-1;if(!line||hasSubstring&&(alreadyCollectedLine=true)){self.oncue&&self.oncue(self.cue);self.cue=null;self.state="ID";continue;}if(self.cue.text){self.cue.text+="\n";}self.cue.text+=line;continue;case"BADCUE":if(!line){self.state="ID";}continue;}}}catch(e){self.reportOrThrowError(e);if(self.state==="CUETEXT"&&self.cue&&self.oncue){self.oncue(self.cue);}self.cue=null;self.state=self.state==="INITIAL"?"BADWEBVTT":"BADCUE";}return this;},flush:function flush(){var self=this;try{self.buffer+=self.decoder.decode();if(self.cue||self.state==="HEADER"){self.buffer+="\n\n";self.parse();}if(self.state==="INITIAL"){throw new ParsingError(ParsingError.Errors.BadSignature);}}catch(e){self.reportOrThrowError(e);}self.onflush&&self.onflush();return this;}};global.WebVTT=WebVTT;})(this,this.vttjs||{});}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{});},{}],341:[function(require,module,exports){(function(factory){if(typeof define==="function"&&define["amd"]){define(["video.js","videojs-contrib-ads"],function(videojs){factory(window,document,videojs);});}else if((typeof exports==="undefined"?"undefined":_typeof2(exports))==="object"&&(typeof module==="undefined"?"undefined":_typeof2(module))==="object"){var vjs=require("video.js");require("videojs-contrib-ads");factory(window,document,vjs);}else{factory(window,document,videojs);}})(function(window,document,videojs){"use strict";var extend=function extend(obj){var arg;var index;var key;for(index=1;index<arguments.length;index++){arg=arguments[index];for(key in arg){if(arg.hasOwnProperty(key)){obj[key]=arg[key];}}}return obj;};var ima_defaults={debug:false,timeout:5e3,prerollTimeout:100,adLabel:"Advertisement",showControlsForJSAds:true};var init=function init(options,readyCallback){this.ima=new ImaPlugin(this,options,readyCallback);};var ImaPlugin=function ImaPlugin(player,options,readyCallback){this.player=player;var assignControlAttributes_=function(element,controlName){element.id=this.controlPrefix+controlName;element.className=this.controlPrefix+controlName+" "+controlName;}.bind(this);var getClassRegexp_=function getClassRegexp_(className){return new RegExp("(^|[^A-Za-z-])"+className+"((?![A-Za-z-])|$)","gi");};var addClass_=function addClass_(element,classToAdd){if(getClassRegexp_(classToAdd).test(element.className)){return element;}return element.className=element.className.trim()+" "+classToAdd;};var removeClass_=function removeClass_(element,classToRemove){var classRegexp=getClassRegexp_(classToRemove);if(!classRegexp.test(element.className)){return element;}return element.className=element.className.trim().replace(classRegexp,"");};var createAdContainer_=function(){this.vjsControls=this.player.getChild("controlBar");this.adContainerDiv=this.vjsControls.el().parentNode.appendChild(document.createElement("div"));assignControlAttributes_(this.adContainerDiv,"ima-ad-container");this.adContainerDiv.style.position="absolute";this.adContainerDiv.style.zIndex=1111;this.adContainerDiv.addEventListener("mouseenter",showAdControls_,false);this.adContainerDiv.addEventListener("mouseleave",hideAdControls_,false);createControls_();this.adDisplayContainer=new google.ima.AdDisplayContainer(this.adContainerDiv,this.contentPlayer);}.bind(this);var createControls_=function(){this.controlsDiv=document.createElement("div");assignControlAttributes_(this.controlsDiv,"ima-controls-div");this.controlsDiv.style.width="100%";this.countdownDiv=document.createElement("div");assignControlAttributes_(this.countdownDiv,"ima-countdown-div");this.countdownDiv.innerHTML=this.settings.adLabel;this.countdownDiv.style.display=this.showCountdown?"block":"none";this.seekBarDiv=document.createElement("div");assignControlAttributes_(this.seekBarDiv,"ima-seek-bar-div");this.seekBarDiv.style.width="100%";this.progressDiv=document.createElement("div");assignControlAttributes_(this.progressDiv,"ima-progress-div");this.playPauseDiv=document.createElement("div");assignControlAttributes_(this.playPauseDiv,"ima-play-pause-div");addClass_(this.playPauseDiv,"ima-playing");this.playPauseDiv.addEventListener("click",onAdPlayPauseClick_,false);this.muteDiv=document.createElement("div");assignControlAttributes_(this.muteDiv,"ima-mute-div");addClass_(this.muteDiv,"ima-non-muted");this.muteDiv.addEventListener("click",onAdMuteClick_,false);this.sliderDiv=document.createElement("div");assignControlAttributes_(this.sliderDiv,"ima-slider-div");this.sliderDiv.addEventListener("mousedown",onAdVolumeSliderMouseDown_,false);this.sliderLevelDiv=document.createElement("div");assignControlAttributes_(this.sliderLevelDiv,"ima-slider-level-div");this.fullscreenDiv=document.createElement("div");assignControlAttributes_(this.fullscreenDiv,"ima-fullscreen-div");addClass_(this.fullscreenDiv,"ima-non-fullscreen");this.fullscreenDiv.addEventListener("click",onAdFullscreenClick_,false);this.adContainerDiv.appendChild(this.controlsDiv);this.controlsDiv.appendChild(this.countdownDiv);this.controlsDiv.appendChild(this.seekBarDiv);this.controlsDiv.appendChild(this.playPauseDiv);this.controlsDiv.appendChild(this.muteDiv);this.controlsDiv.appendChild(this.sliderDiv);this.controlsDiv.appendChild(this.fullscreenDiv);this.seekBarDiv.appendChild(this.progressDiv);this.sliderDiv.appendChild(this.sliderLevelDiv);}.bind(this);this.initializeAdDisplayContainer=function(){this.adDisplayContainerInitialized=true;this.adDisplayContainer.initialize();}.bind(this);this.requestAds=function(){if(!this.adDisplayContainerInitialized){this.adDisplayContainer.initialize();}var adsRequest=new google.ima.AdsRequest();if(this.settings.adTagUrl){adsRequest.adTagUrl=this.settings.adTagUrl;}else{adsRequest.adsResponse=this.settings.adsResponse;}if(this.settings.forceNonLinearFullSlot){adsRequest.forceNonLinearFullSlot=true;}adsRequest.linearAdSlotWidth=this.getPlayerWidth();adsRequest.linearAdSlotHeight=this.getPlayerHeight();adsRequest.nonLinearAdSlotWidth=this.settings.nonLinearWidth||this.getPlayerWidth();adsRequest.nonLinearAdSlotHeight=this.settings.nonLinearHeight||this.getPlayerHeight()/3;adsRequest.setAdWillAutoPlay(this.settings.adWillAutoPlay);this.adsLoader.requestAds(adsRequest);}.bind(this);var onAdsManagerLoaded_=function(adsManagerLoadedEvent){this.adsManager=adsManagerLoadedEvent.getAdsManager(this.contentPlayheadTracker,this.adsRenderingSettings);this.adsManager.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,onAdError_);this.adsManager.addEventListener(google.ima.AdEvent.Type.AD_BREAK_READY,onAdBreakReady_);this.adsManager.addEventListener(google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED,this.onContentPauseRequested_);this.adsManager.addEventListener(google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED,this.onContentResumeRequested_);this.adsManager.addEventListener(google.ima.AdEvent.Type.ALL_ADS_COMPLETED,onAllAdsCompleted_);this.adsManager.addEventListener(google.ima.AdEvent.Type.LOADED,onAdLoaded_);this.adsManager.addEventListener(google.ima.AdEvent.Type.STARTED,onAdStarted_);this.adsManager.addEventListener(google.ima.AdEvent.Type.CLICK,onAdPlayPauseClick_);this.adsManager.addEventListener(google.ima.AdEvent.Type.COMPLETE,this.onAdComplete_);this.adsManager.addEventListener(google.ima.AdEvent.Type.SKIPPED,this.onAdComplete_);if(!this.autoPlayAdBreaks){try{var initWidth=this.getPlayerWidth();var initHeight=this.getPlayerHeight();this.adsManagerDimensions.width=initWidth;this.adsManagerDimensions.height=initHeight;this.adsManager.init(initWidth,initHeight,google.ima.ViewMode.NORMAL);this.adsManager.setVolume(this.player.muted()?0:this.player.volume());}catch(adError){onAdError_(adError);}}this.player.trigger("adsready");}.bind(this);this.start=function(){window.console.log("WARNING: player.ima.start is deprecated. Use "+"player.ima.startFromReadyCallback instead.");};this.startFromReadyCallback=function(){if(this.autoPlayAdBreaks){try{this.adsManager.init(this.getPlayerWidth(),this.getPlayerHeight(),google.ima.ViewMode.NORMAL);this.adsManager.setVolume(this.player.muted()?0:this.player.volume());this.adsManager.start();}catch(adError){onAdError_(adError);}}}.bind(this);var onAdsLoaderError_=function(event){window.console.log("AdsLoader error: "+event.getError());this.adContainerDiv.style.display="none";if(this.adsManager){this.adsManager.destroy();}this.player.trigger({type:"adserror",data:{AdError:event.getError(),AdErrorEvent:event}});}.bind(this);var onAdError_=function(adErrorEvent){var errorMessage=adErrorEvent.getError!==undefined?adErrorEvent.getError():adErrorEvent.stack;window.console.log("Ad error: "+errorMessage);this.vjsControls.show();this.adsManager.destroy();this.adContainerDiv.style.display="none";this.player.trigger({type:"adserror",data:{AdError:errorMessage,AdErrorEvent:adErrorEvent}});}.bind(this);var onAdBreakReady_=function(adEvent){this.adBreakReadyListener(adEvent);}.bind(this);this.playAdBreak=function(){if(!this.autoPlayAdBreaks){this.adsManager.start();}}.bind(this);this.onContentPauseRequested_=function(adEvent){this.adsActive=true;this.adPlaying=true;this.contentSource=this.player.currentSrc();this.player.off("ended",this.localContentEndedListener);if(adEvent.getAd().getAdPodInfo().getPodIndex()!=-1){this.player.ads.startLinearAdMode();}this.adContainerDiv.style.display="block";var contentType=adEvent.getAd().getContentType();if(contentType==="application/javascript"&&!this.settings.showControlsForJSAds){this.controlsDiv.style.display="none";}else{this.controlsDiv.style.display="block";}this.vjsControls.hide();showPlayButton();this.player.pause();}.bind(this);this.onContentResumeRequested_=function(adEvent){this.adsActive=false;this.adPlaying=false;this.player.on("ended",this.localContentEndedListener);if(this.currentAd==null||this.currentAd.isLinear()){this.adContainerDiv.style.display="none";}this.vjsControls.show();if(!this.currentAd){this.player.ads.endLinearAdMode();}else if(!this.contentComplete&&this.currentAd.getAdPodInfo().getPodIndex()!=-1){this.player.ads.endLinearAdMode();}this.controlsDiv.style.display="none";this.countdownDiv.innerHTML="";}.bind(this);var onAllAdsCompleted_=function(adEvent){this.allAdsCompleted=true;this.adContainerDiv.style.display="none";if(this.contentComplete==true){if(this.contentPlayer.src!=this.contentSource){this.player.src(this.contentSource);}for(var index in this.contentAndAdsEndedListeners){this.contentAndAdsEndedListeners[index]();}}}.bind(this);var onAdLoaded_=function(adEvent){if(!adEvent.getAd().isLinear()){this.player.play();}}.bind(this);var onAdStarted_=function(adEvent){this.currentAd=adEvent.getAd();if(this.currentAd.isLinear()){this.adTrackingTimer=setInterval(onAdPlayheadTrackerInterval_,250);removeClass_(this.adContainerDiv,"bumpable-ima-ad-container");}else{addClass_(this.adContainerDiv,"bumpable-ima-ad-container");}this.adContainerDiv.style.display="block";this.player.trigger("ads-ad-started");}.bind(this);this.onAdComplete_=function(adEvent){if(this.currentAd.isLinear()){clearInterval(this.adTrackingTimer);}}.bind(this);var onAdPlayheadTrackerInterval_=function(){var remainingTime=this.adsManager.getRemainingTime();var duration=this.currentAd.getDuration();var currentTime=duration-remainingTime;currentTime=currentTime>0?currentTime:0;var isPod=false;var totalAds=0;var adPosition;if(this.currentAd.getAdPodInfo()){isPod=true;adPosition=this.currentAd.getAdPodInfo().getAdPosition();totalAds=this.currentAd.getAdPodInfo().getTotalAds();}var remainingMinutes=Math.floor(remainingTime/60);var remainingSeconds=Math.floor(remainingTime%60);if(remainingSeconds.toString().length<2){remainingSeconds="0"+remainingSeconds;}var podCount=": ";if(isPod&&totalAds>1){podCount=" ("+adPosition+" of "+totalAds+"): ";}this.countdownDiv.innerHTML=this.settings.adLabel+podCount+remainingMinutes+":"+remainingSeconds;var playProgressRatio=currentTime/duration;var playProgressPercent=playProgressRatio*100;this.progressDiv.style.width=playProgressPercent+"%";}.bind(this);this.getPlayerWidth=function(){var computedStyle=getComputedStyle(this.player.el())||{};return parseInt(computedStyle.width,10)||this.player.width();}.bind(this);this.getPlayerHeight=function(){var computedStyle=getComputedStyle(this.player.el())||{};return parseInt(computedStyle.height,10)||this.player.height();}.bind(this);var hideAdControls_=function(){this.controlsDiv.style.height="14px";this.playPauseDiv.style.display="none";this.muteDiv.style.display="none";this.sliderDiv.style.display="none";this.fullscreenDiv.style.display="none";}.bind(this);var showAdControls_=function(){this.controlsDiv.style.height="37px";this.playPauseDiv.style.display="block";this.muteDiv.style.display="block";this.sliderDiv.style.display="block";this.fullscreenDiv.style.display="block";}.bind(this);var showPauseButton=function(){addClass_(this.playPauseDiv,"ima-paused");removeClass_(this.playPauseDiv,"ima-playing");}.bind(this);var showPlayButton=function(){addClass_(this.playPauseDiv,"ima-playing");removeClass_(this.playPauseDiv,"ima-paused");}.bind(this);var onAdPlayPauseClick_=function(){if(this.adPlaying){showPauseButton();this.adsManager.pause();this.adPlaying=false;}else{showPlayButton();this.adsManager.resume();this.adPlaying=true;}}.bind(this);var onAdMuteClick_=function(){if(this.adMuted){addClass_(this.muteDiv,"ima-non-muted");removeClass_(this.muteDiv,"ima-muted");this.adsManager.setVolume(1);this.player.muted(false);this.adMuted=false;this.sliderLevelDiv.style.width=this.player.volume()*100+"%";}else{addClass_(this.muteDiv,"ima-muted");removeClass_(this.muteDiv,"ima-non-muted");this.adsManager.setVolume(0);this.player.muted(true);this.adMuted=true;this.sliderLevelDiv.style.width="0%";}}.bind(this);var onAdVolumeSliderMouseDown_=function onAdVolumeSliderMouseDown_(){document.addEventListener("mouseup",onMouseUp_,false);document.addEventListener("mousemove",onMouseMove_,false);};var onMouseMove_=function onMouseMove_(event){setVolumeSlider_(event);};var onMouseUp_=function onMouseUp_(event){setVolumeSlider_(event);document.removeEventListener("mousemove",onMouseMove_);document.removeEventListener("mouseup",onMouseUp_);};var setVolumeSlider_=function(event){var percent=(event.clientX-this.sliderDiv.getBoundingClientRect().left)/this.sliderDiv.offsetWidth;percent*=100;percent=Math.min(Math.max(percent,0),100);this.sliderLevelDiv.style.width=percent+"%";this.player.volume(percent/100);this.adsManager.setVolume(percent/100);if(this.player.volume()==0){addClass_(this.muteDiv,"ima-muted");removeClass_(this.muteDiv,"ima-non-muted");this.player.muted(true);this.adMuted=true;}else{addClass_(this.muteDiv,"ima-non-muted");removeClass_(this.muteDiv,"ima-muted");this.player.muted(false);this.adMuted=false;}}.bind(this);var onAdFullscreenClick_=function(){if(this.player.isFullscreen()){this.player.exitFullscreen();}else{this.player.requestFullscreen();}}.bind(this);var onFullscreenChange_=function(){if(this.player.isFullscreen()){addClass_(this.fullscreenDiv,"ima-fullscreen");removeClass_(this.fullscreenDiv,"ima-non-fullscreen");if(this.adsManager){this.adsManager.resize(window.screen.width,window.screen.height,google.ima.ViewMode.FULLSCREEN);}}else{addClass_(this.fullscreenDiv,"ima-non-fullscreen");removeClass_(this.fullscreenDiv,"ima-fullscreen");if(this.adsManager){this.adsManager.resize(this.getPlayerWidth(),this.getPlayerHeight(),google.ima.ViewMode.NORMAL);}}}.bind(this);var onVolumeChange_=function(){var newVolume=this.player.muted()?0:this.player.volume();if(this.adsManager){this.adsManager.setVolume(newVolume);}if(newVolume==0){this.adMuted=true;addClass_(this.muteDiv,"ima-muted");removeClass_(this.muteDiv,"ima-non-muted");this.sliderLevelDiv.style.width="0%";}else{this.adMuted=false;addClass_(this.muteDiv,"ima-non-muted");removeClass_(this.muteDiv,"ima-muted");this.sliderLevelDiv.style.width=newVolume*100+"%";}}.bind(this);var seekContentToZero_=function(){this.player.off("loadedmetadata",seekContentToZero_);this.player.currentTime(0);}.bind(this);var playContentFromZero_=function(){this.player.off("loadedmetadata",playContentFromZero_);this.player.currentTime(0);this.player.play();}.bind(this);var resetIMA_=function(){this.adsActive=false;this.adPlaying=false;this.player.on("ended",this.localContentEndedListener);this.vjsControls.show();this.player.ads.endLinearAdMode();if(this.adTrackingTimer){clearInterval(this.adTrackingTimer);}this.contentPlayheadTracker.currentTime=0;if(this.adsManager){this.adsManager.destroy();this.adsManager=null;}if(this.adsLoader&&!this.contentComplete){this.adsLoader.contentComplete();}this.contentComplete=false;this.allAdsCompleted=false;}.bind(this);this.addEventListener=function(event,callback){if(this.adsManager){this.adsManager.addEventListener(event,callback);}}.bind(this);this.getAdsManager=function(){return this.adsManager;}.bind(this);this.setContent=function(contentSrc,adTag,playOnLoad){window.console.log("WARNING: player.ima.setContent is deprecated. Use "+"player.ima.setContentWithAdTag instead.");this.setContentWithAdTag(contentSrc,adTag,playOnLoad);}.bind(this);this.setContentWithAdTag=function(contentSrc,adTag,playOnLoad){resetIMA_();this.settings.adTagUrl=adTag?adTag:this.settings.adTagUrl;changeSource_(contentSrc,playOnLoad);}.bind(this);this.setContentWithAdsResponse=function(contentSrc,adsResponse,playOnLoad){resetIMA_();this.settings.adsResponse=adsResponse?adsResponse:this.settings.adsResponse;changeSource_(contentSrc,playOnLoad);}.bind(this);this.changeAdTag=function(adTag){resetIMA_();this.settings.adTagUrl=adTag;}.bind(this);var changeSource_=function(contentSrc,playOnLoad){if(!!this.player.currentSrc()){this.player.currentTime(0);this.player.pause();}if(contentSrc){this.player.src(contentSrc);}if(playOnLoad){this.player.on("loadedmetadata",playContentFromZero_);}else{this.player.on("loadedmetadata",seekContentToZero_);}}.bind(this);this.addContentEndedListener=function(listener){this.contentEndedListeners.push(listener);}.bind(this);this.addContentAndAdsEndedListener=function(listener){this.contentAndAdsEndedListeners.push(listener);}.bind(this);this.setAdBreakReadyListener=function(listener){this.adBreakReadyListener=listener;}.bind(this);this.pauseAd=function(){if(this.adsActive&&this.adPlaying){showPauseButton();this.adsManager.pause();this.adPlaying=false;}}.bind(this);this.resumeAd=function(){if(this.adsActive&&!this.adPlaying){showPlayButton();this.adsManager.resume();this.adPlaying=true;}}.bind(this);var setUpPlayerIntervals_=function(){this.updateTimeIntervalHandle=setInterval(updateCurrentTime_,this.seekCheckInterval);this.seekCheckIntervalHandle=setInterval(checkForSeeking_,this.seekCheckInterval);this.resizeCheckIntervalHandle=setInterval(checkForResize_,this.resizeCheckInterval);}.bind(this);var updateCurrentTime_=function(){if(!this.contentPlayheadTracker.seeking){this.contentPlayheadTracker.currentTime=this.player.currentTime();}}.bind(this);var checkForSeeking_=function(){var tempCurrentTime=this.player.currentTime();var diff=(tempCurrentTime-this.contentPlayheadTracker.previousTime)*1e3;if(Math.abs(diff)>this.seekCheckInterval+this.seekThreshold){this.contentPlayheadTracker.seeking=true;}else{this.contentPlayheadTracker.seeking=false;}this.contentPlayheadTracker.previousTime=this.player.currentTime();}.bind(this);var checkForResize_=function(){var currentWidth=this.getPlayerWidth();var currentHeight=this.getPlayerHeight();if(this.adsManager&&(currentWidth!=this.adsManagerDimensions.width||currentHeight!=this.adsManagerDimensions.height)){this.adsManagerDimensions.width=currentWidth;this.adsManagerDimensions.height=currentHeight;this.adsManager.resize(currentWidth,currentHeight,google.ima.ViewMode.NORMAL);}}.bind(this);this.setShowCountdown=function(showCountdownIn){this.showCountdown=showCountdownIn;this.countdownDiv.style.display=this.showCountdown?"block":"none";}.bind(this);this.VERSION="0.6.0";this.settings;this.controlPrefix;this.contentPlayer;this.showCountdown;this.autoPlayAdBreaks;this.vjsControls;this.adContainerDiv;this.controlsDiv;this.countdownDiv;this.seekBarDiv;this.progressDiv;this.playPauseDiv;this.muteDiv;this.sliderDiv;this.sliderLevelDiv;this.fullscreenDiv;this.adDisplayContainer;this.adDisplayContainerInitialized=false;this.adsLoader;this.adsManager;this.adsRenderingSettings=null;this.adTagUrl;this.adsResponse;this.currentAd;this.contentTrackingTimer;this.adTrackingTimer;this.adsActive=false;this.adPlaying=false;this.adMuted=false;this.contentComplete=false;this.allAdsCompleted=false;this.updateTimeIntervalHandle;this.seekCheckIntervalHandle;this.seekCheckInterval=1e3;this.resizeCheckIntervalHandle;this.resizeCheckInterval=250;this.seekThreshold=100;this.contentPlayheadTracker={currentTime:0,previousTime:0,seeking:false,duration:0};this.adPlayheadTracker={currentTime:0,duration:0,isPod:false,adPosition:0,totalAds:0};this.adsManagerDimensions={width:0,height:0};this.contentEndedListeners=[];this.contentAndAdsEndedListeners=[];this.adBreakReadyListener=undefined;this.contentSource="";this.localContentEndedListener=function(){if(this.adsLoader&&!this.contentComplete){this.adsLoader.contentComplete();this.contentComplete=true;}for(var index in this.contentEndedListeners){this.contentEndedListeners[index]();}if(this.allAdsCompleted){for(var index in this.contentAndAdsEndedListeners){this.contentAndAdsEndedListeners[index]();}}clearInterval(this.updateTimeIntervalHandle);clearInterval(this.seekCheckIntervalHandle);clearInterval(this.resizeCheckIntervalHandle);if(this.player.el()){this.player.one("play",setUpPlayerIntervals_);}}.bind(this);this.playerDisposedListener=function(){this.contentEndedListeners,this.contentAndAdsEndedListeners=[],[];this.contentComplete=true;this.player.off("ended",this.localContentEndedListener);if(this.player.ads.adTimeoutTimeout){clearTimeout(this.player.ads.adTimeoutTimeout);}var intervalsToClear=[this.updateTimeIntervalHandle,this.seekCheckIntervalHandle,this.adTrackingTimer,this.resizeCheckIntervalHandle];for(var index in intervalsToClear){var interval=intervalsToClear[index];if(interval){clearInterval(interval);}}if(this.adsManager){this.adsManager.destroy();this.adsManager=null;}}.bind(this);this.settings=extend({},ima_defaults,options||{});if(!this.settings["id"]){window.console.log("Error: must provide id of video.js div");return;}this.controlPrefix=this.settings.id+"_"||"";this.contentPlayer=document.getElementById(this.settings["id"]+"_html5_api");if(this.contentPlayer.hasAttribute("autoplay")){this.settings["adWillAutoPlay"]=this.settings["adWillAutoPlay"]||true;}this.showCountdown=true;if(this.settings["showCountdown"]==false){this.showCountdown=false;}this.autoPlayAdBreaks=true;if(this.settings["autoPlayAdBreaks"]==false){this.autoPlayAdBreaks=false;}player.one("play",setUpPlayerIntervals_);player.on("ended",this.localContentEndedListener);player.on("dispose",this.playerDisposedListener);var contrib_ads_defaults={debug:this.settings.debug,timeout:this.settings.timeout,prerollTimeout:this.settings.prerollTimeout};var ads_plugin_settings=extend({},contrib_ads_defaults,options["contribAdsSettings"]||{});player.ads(ads_plugin_settings);this.adsRenderingSettings=new google.ima.AdsRenderingSettings();this.adsRenderingSettings.restoreCustomPlaybackStateOnAdBreakComplete=true;if(this.settings["adsRenderingSettings"]){for(var setting in this.settings["adsRenderingSettings"]){this.adsRenderingSettings[setting]=this.settings["adsRenderingSettings"][setting];}}if(this.settings["locale"]){google.ima.settings.setLocale(this.settings["locale"]);}if(this.settings["disableFlashAds"]){google.ima.settings.setDisableFlashAds(this.settings["disableFlashAds"]);}if(this.settings["disableCustomPlaybackForIOS10Plus"]){google.ima.settings.setDisableCustomPlaybackForIOS10Plus(this.settings["disableCustomPlaybackForIOS10Plus"]);}createAdContainer_();this.adsLoader=new google.ima.AdsLoader(this.adDisplayContainer);this.adsLoader.getSettings().setVpaidMode(google.ima.ImaSdkSettings.VpaidMode.ENABLED);if(this.settings.vpaidAllowed==false){this.adsLoader.getSettings().setVpaidMode(google.ima.ImaSdkSettings.VpaidMode.DISABLED);}if(this.settings.vpaidMode){this.adsLoader.getSettings().setVpaidMode(this.settings.vpaidMode);}if(this.settings.locale){this.adsLoader.getSettings().setLocale(this.settings.locale);}if(this.settings.numRedirects){this.adsLoader.getSettings().setNumRedirects(this.settings.numRedirects);}this.adsLoader.getSettings().setPlayerType("videojs-ima");this.adsLoader.getSettings().setPlayerVersion(this.VERSION);this.adsLoader.getSettings().setAutoPlayAdBreaks(this.autoPlayAdBreaks);this.adsLoader.addEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,onAdsManagerLoaded_,false);this.adsLoader.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,onAdsLoaderError_,false);if(!readyCallback){readyCallback=this.startFromReadyCallback;}player.on("readyforpreroll",readyCallback);player.ready(function(){onVolumeChange_();player.on("fullscreenchange",onFullscreenChange_);player.on("volumechange",onVolumeChange_);});};var registerPlugin=videojs.registerPlugin||videojs.plugin;registerPlugin("ima",init);window.ImaPlugin=ImaPlugin;module.exports=ImaPlugin;});},{"video.js":340,"videojs-contrib-ads":337}],342:[function(require,module,exports){(function(){"use strict";var videojs=null;if(typeof window.videojs==="undefined"&&typeof require==="function"){videojs=require("video.js");}else{videojs=window.videojs;}(function(window,videojs){var videoJsResolutionSwitcher,defaults={ui:true};var MenuItem=videojs.getComponent("MenuItem");var ResolutionMenuItem=videojs.extend(MenuItem,{constructor:function constructor(player,options){options.selectable=true;MenuItem.call(this,player,options);this.src=options.src;player.on("resolutionchange",videojs.bind(this,this.update));}});ResolutionMenuItem.prototype.handleClick=function(event){MenuItem.prototype.handleClick.call(this,event);this.player_.currentResolution(this.options_.label);};ResolutionMenuItem.prototype.update=function(){var selection=this.player_.currentResolution();this.selected(this.options_.label===selection.label);};MenuItem.registerComponent("ResolutionMenuItem",ResolutionMenuItem);var MenuButton=videojs.getComponent("MenuButton");var ResolutionMenuButton=videojs.extend(MenuButton,{constructor:function constructor(player,options){this.label=document.createElement("span");options.label="Quality";MenuButton.call(this,player,options);this.el().setAttribute("aria-label","Quality");this.controlText("Quality");if(options.dynamicLabel){videojs.addClass(this.label,"vjs-resolution-button-label");this.el().appendChild(this.label);}else{var staticLabel=document.createElement("span");videojs.addClass(staticLabel,"vjs-menu-icon");this.el().appendChild(staticLabel);}player.on("updateSources",videojs.bind(this,this.update));}});ResolutionMenuButton.prototype.createItems=function(){var menuItems=[];var labels=this.sources&&this.sources.label||{};for(var key in labels){if(labels.hasOwnProperty(key)){menuItems.push(new ResolutionMenuItem(this.player_,{label:key,src:labels[key],selected:key===(this.currentSelection?this.currentSelection.label:false)}));}}return menuItems;};ResolutionMenuButton.prototype.update=function(){this.sources=this.player_.getGroupedSrc();this.currentSelection=this.player_.currentResolution();this.label.innerHTML=this.currentSelection?this.currentSelection.label:"";return MenuButton.prototype.update.call(this);};ResolutionMenuButton.prototype.buildCSSClass=function(){return MenuButton.prototype.buildCSSClass.call(this)+" vjs-resolution-button";};MenuButton.registerComponent("ResolutionMenuButton",ResolutionMenuButton);videoJsResolutionSwitcher=function videoJsResolutionSwitcher(options){var settings=videojs.mergeOptions(defaults,options),player=this,groupedSrc={},currentSources={},currentResolutionState={};player.updateSrc=function(src){if(!src){return player.src();}src=src.filter(function(source){try{return player.canPlayType(source.type)!=="";}catch(e){return true;}});this.currentSources=src.sort(compareResolutions);this.groupedSrc=bucketSources(this.currentSources);var chosen=chooseSrc(this.groupedSrc,this.currentSources);this.currentResolutionState={label:chosen.label,sources:chosen.sources};player.trigger("updateSources");player.setSourcesSanitized(chosen.sources,chosen.label,settings.customSourcePicker,true);player.trigger("resolutionchange");return player;};player.currentResolution=function(label,customSourcePicker){if(label==null||label===this.currentResolutionState.label){return this.currentResolutionState;}if(!this.groupedSrc||!this.groupedSrc.label||!this.groupedSrc.label[label]){return;}var sources=this.groupedSrc.label[label];var currentTime=player.currentTime();var isPaused=player.paused();if(!isPaused&&this.player_.options_.bigPlayButton){this.player_.bigPlayButton.hide();}var handleSeekEvent="loadeddata";if(this.player_.techName_!=="Youtube"&&this.player_.preload()==="none"&&this.player_.techName_!=="Flash"){handleSeekEvent="timeupdate";}player.setSourcesSanitized(sources,label,customSourcePicker||settings.customSourcePicker).one(handleSeekEvent,function(){player.currentTime(currentTime);player.handleTechSeeked_();if(!isPaused){player.play().handleTechSeeked_();}player.trigger("resolutionchange");});return player;};player.getGroupedSrc=function(){return this.groupedSrc;};player.setSourcesSanitized=function(sources,label,customSourcePicker,isStarting){this.currentResolutionState={label:label,sources:sources};if(typeof customSourcePicker==="function"){return customSourcePicker(player,sources,label,isStarting);}player.src(sources.map(function(src){return{src:src.src,type:src.type,res:src.res};}));return player;};function compareResolutions(a,b){if(!a.res||!b.res){return 0;}return+b.res-+a.res;}function bucketSources(src){var resolutions={label:{},res:{},type:{}};src.map(function(source){initResolutionKey(resolutions,"label",source);initResolutionKey(resolutions,"res",source);initResolutionKey(resolutions,"type",source);appendSourceToKey(resolutions,"label",source);appendSourceToKey(resolutions,"res",source);appendSourceToKey(resolutions,"type",source);});return resolutions;}function initResolutionKey(resolutions,key,source){if(resolutions[key][source[key]]==null){resolutions[key][source[key]]=[];}}function appendSourceToKey(resolutions,key,source){resolutions[key][source[key]].push(source);}function chooseSrc(groupedSrc,src){var selectedRes=settings["default"];var selectedLabel="";if(selectedRes==="high"){selectedRes=src[0].res;selectedLabel=src[0].label;}else if(selectedRes==="low"||selectedRes==null||!groupedSrc.res[selectedRes]){selectedRes=src[src.length-1].res;selectedLabel=src[src.length-1].label;}else if(groupedSrc.res[selectedRes]){selectedLabel=groupedSrc.res[selectedRes][0].label;}return{res:selectedRes,label:selectedLabel,sources:groupedSrc.res[selectedRes]};}function initResolutionForYt(player){var _yts={highres:{res:1080,label:"1080",yt:"highres"},hd1080:{res:1080,label:"1080",yt:"hd1080"},hd720:{res:720,label:"720",yt:"hd720"},large:{res:480,label:"480",yt:"large"},medium:{res:360,label:"360",yt:"medium"},small:{res:240,label:"240",yt:"small"},tiny:{res:144,label:"144",yt:"tiny"},auto:{res:0,label:"auto",yt:"auto"}};var _customSourcePicker=function _customSourcePicker(_player,_sources,_label){player.tech_.ytPlayer.setPlaybackQuality(_sources[0]._yt);player.trigger("updateSources");return player;};settings.customSourcePicker=_customSourcePicker;player.tech_.ytPlayer.setPlaybackQuality("auto");player.tech_.ytPlayer.addEventListener("onPlaybackQualityChange",function(event){for(var res in _yts){if(res.yt===event.data){player.currentResolution(res.label,_customSourcePicker);return;}}});player.one("play",function(){var qualities=player.tech_.ytPlayer.getAvailableQualityLevels();var _sources=[];qualities.map(function(q){_sources.push({src:player.src().src,type:player.src().type,label:_yts[q].label,res:_yts[q].res,_yt:_yts[q].yt});});player.groupedSrc=bucketSources(_sources);var chosen={label:"auto",res:0,sources:player.groupedSrc.label.auto};this.currentResolutionState={label:chosen.label,sources:chosen.sources};player.trigger("updateSources");player.setSourcesSanitized(chosen.sources,chosen.label,_customSourcePicker);});}player.ready(function(){if(settings.ui){var menuButton=new ResolutionMenuButton(player,settings);player.controlBar.resolutionSwitcher=player.controlBar.el_.insertBefore(menuButton.el_,player.controlBar.getChild("fullscreenToggle").el_);player.controlBar.resolutionSwitcher.dispose=function(){this.parentNode.removeChild(this);};}if(player.options_.sources.length>1){player.updateSrc(player.options_.sources);}if(player.techName_==="Youtube"){initResolutionForYt(player);}});};videojs.plugin("videoJsResolutionSwitcher",videoJsResolutionSwitcher);})(window,videojs);})();},{"video.js":332}],343:[function(require,module,exports){var vttjs=module.exports={WebVTT:require("./vtt.js").WebVTT,VTTCue:require("./vttcue-extended.js").VTTCue,VTTRegion:require("./vttregion-extended.js").VTTRegion};window.vttjs=vttjs;window.WebVTT=vttjs.WebVTT;var cueShim=vttjs.VTTCue;var regionShim=vttjs.VTTRegion;var nativeVTTCue=window.VTTCue;var nativeVTTRegion=window.VTTRegion;vttjs.shim=function(){window.VTTCue=cueShim;window.VTTRegion=regionShim;};vttjs.restore=function(){window.VTTCue=nativeVTTCue;window.VTTRegion=nativeVTTRegion;};if(!window.VTTCue){vttjs.shim();}},{"./vtt.js":344,"./vttcue-extended.js":345,"./vttregion-extended.js":347}],344:[function(require,module,exports){(function(global){var _objCreate=Object.create||function(){function F(){}return function(o){if(arguments.length!==1){throw new Error("Object.create shim only accepts one parameter.");}F.prototype=o;return new F();};}();function ParsingError(errorData,message){this.name="ParsingError";this.code=errorData.code;this.message=message||errorData.message;}ParsingError.prototype=_objCreate(Error.prototype);ParsingError.prototype.constructor=ParsingError;ParsingError.Errors={BadSignature:{code:0,message:"Malformed WebVTT signature."},BadTimeStamp:{code:1,message:"Malformed time stamp."}};function parseTimeStamp(input){function computeSeconds(h,m,s,f){return(h|0)*3600+(m|0)*60+(s|0)+(f|0)/1e3;}var m=input.match(/^(\d+):(\d{2})(:\d{2})?\.(\d{3})/);if(!m){return null;}if(m[3]){return computeSeconds(m[1],m[2],m[3].replace(":",""),m[4]);}else if(m[1]>59){return computeSeconds(m[1],m[2],0,m[4]);}else{return computeSeconds(0,m[1],m[2],m[4]);}}function Settings(){this.values=_objCreate(null);}Settings.prototype={set:function set(k,v){if(!this.get(k)&&v!==""){this.values[k]=v;}},get:function get(k,dflt,defaultKey){if(defaultKey){return this.has(k)?this.values[k]:dflt[defaultKey];}return this.has(k)?this.values[k]:dflt;},has:function has(k){return k in this.values;},alt:function alt(k,v,a){for(var n=0;n<a.length;++n){if(v===a[n]){this.set(k,v);break;}}},integer:function integer(k,v){if(/^-?\d+$/.test(v)){this.set(k,parseInt(v,10));}},percent:function percent(k,v){var m;if(m=v.match(/^([\d]{1,3})(\.[\d]*)?%$/)){v=parseFloat(v);if(v>=0&&v<=100){this.set(k,v);return true;}}return false;}};function parseOptions(input,callback,keyValueDelim,groupDelim){var groups=groupDelim?input.split(groupDelim):[input];for(var i in groups){if(typeof groups[i]!=="string"){continue;}var kv=groups[i].split(keyValueDelim);if(kv.length!==2){continue;}var k=kv[0];var v=kv[1];callback(k,v);}}function parseCue(input,cue,regionList){var oInput=input;function consumeTimeStamp(){var ts=parseTimeStamp(input);if(ts===null){throw new ParsingError(ParsingError.Errors.BadTimeStamp,"Malformed timestamp: "+oInput);}input=input.replace(/^[^\sa-zA-Z-]+/,"");return ts;}function consumeCueSettings(input,cue){var settings=new Settings();parseOptions(input,function(k,v){switch(k){case"region":for(var i=regionList.length-1;i>=0;i--){if(regionList[i].id===v){settings.set(k,regionList[i].region);break;}}break;case"vertical":settings.alt(k,v,["rl","lr"]);break;case"line":var vals=v.split(","),vals0=vals[0];settings.integer(k,vals0);settings.percent(k,vals0)?settings.set("snapToLines",false):null;settings.alt(k,vals0,["auto"]);if(vals.length===2){settings.alt("lineAlign",vals[1],["start","middle","end"]);}break;case"position":vals=v.split(",");settings.percent(k,vals[0]);if(vals.length===2){settings.alt("positionAlign",vals[1],["start","middle","end"]);}break;case"size":settings.percent(k,v);break;case"align":settings.alt(k,v,["start","middle","end","left","right"]);break;}},/:/,/\s/);cue.region=settings.get("region",null);cue.vertical=settings.get("vertical","");cue.line=settings.get("line","auto");cue.lineAlign=settings.get("lineAlign","start");cue.snapToLines=settings.get("snapToLines",true);cue.size=settings.get("size",100);cue.align=settings.get("align","middle");cue.position=settings.get("position",{start:0,left:0,middle:50,end:100,right:100},cue.align);cue.positionAlign=settings.get("positionAlign",{start:"start",left:"start",middle:"middle",end:"end",right:"end"},cue.align);}function skipWhitespace(){input=input.replace(/^\s+/,"");}skipWhitespace();cue.startTime=consumeTimeStamp();skipWhitespace();if(input.substr(0,3)!=="--\x3e"){throw new ParsingError(ParsingError.Errors.BadTimeStamp,"Malformed time stamp (time stamps must be separated by '--\x3e'): "+oInput);}input=input.substr(3);skipWhitespace();cue.endTime=consumeTimeStamp();skipWhitespace();consumeCueSettings(input,cue);}var ESCAPE={"&amp;":"&","&lt;":"<","&gt;":">","&lrm;":"","&rlm;":"","&nbsp;":""};var TAG_NAME={c:"span",i:"i",b:"b",u:"u",ruby:"ruby",rt:"rt",v:"span",lang:"span"};var TAG_ANNOTATION={v:"title",lang:"lang"};var NEEDS_PARENT={rt:"ruby"};function parseContent(window,input){function nextToken(){if(!input){return null;}function consume(result){input=input.substr(result.length);return result;}var m=input.match(/^([^<]*)(<[^>]+>?)?/);return consume(m[1]?m[1]:m[2]);}function unescape1(e){return ESCAPE[e];}function unescape(s){while(m=s.match(/&(amp|lt|gt|lrm|rlm|nbsp);/)){s=s.replace(m[0],unescape1);}return s;}function shouldAdd(current,element){return!NEEDS_PARENT[element.localName]||NEEDS_PARENT[element.localName]===current.localName;}function createElement(type,annotation){var tagName=TAG_NAME[type];if(!tagName){return null;}var element=window.document.createElement(tagName);element.localName=tagName;var name=TAG_ANNOTATION[type];if(name&&annotation){element[name]=annotation.trim();}return element;}var rootDiv=window.document.createElement("div"),current=rootDiv,t,tagStack=[];while((t=nextToken())!==null){if(t[0]==="<"){if(t[1]==="/"){if(tagStack.length&&tagStack[tagStack.length-1]===t.substr(2).replace(">","")){tagStack.pop();current=current.parentNode;}continue;}var ts=parseTimeStamp(t.substr(1,t.length-2));var node;if(ts){node=window.document.createProcessingInstruction("timestamp",ts);current.appendChild(node);continue;}var m=t.match(/^<([^.\s/0-9>]+)(\.[^\s\\>]+)?([^>\\]+)?(\\?)>?$/);if(!m){continue;}node=createElement(m[1],m[3]);if(!node){continue;}if(!shouldAdd(current,node)){continue;}if(m[2]){node.className=m[2].substr(1).replace("."," ");}tagStack.push(m[1]);current.appendChild(node);current=node;continue;}current.appendChild(window.document.createTextNode(unescape(t)));}return rootDiv;}var strongRTLRanges=[[1470,1470],[1472,1472],[1475,1475],[1478,1478],[1488,1514],[1520,1524],[1544,1544],[1547,1547],[1549,1549],[1563,1563],[1566,1610],[1645,1647],[1649,1749],[1765,1766],[1774,1775],[1786,1805],[1807,1808],[1810,1839],[1869,1957],[1969,1969],[1984,2026],[2036,2037],[2042,2042],[2048,2069],[2074,2074],[2084,2084],[2088,2088],[2096,2110],[2112,2136],[2142,2142],[2208,2208],[2210,2220],[8207,8207],[64285,64285],[64287,64296],[64298,64310],[64312,64316],[64318,64318],[64320,64321],[64323,64324],[64326,64449],[64467,64829],[64848,64911],[64914,64967],[65008,65020],[65136,65140],[65142,65276],[67584,67589],[67592,67592],[67594,67637],[67639,67640],[67644,67644],[67647,67669],[67671,67679],[67840,67867],[67872,67897],[67903,67903],[67968,68023],[68030,68031],[68096,68096],[68112,68115],[68117,68119],[68121,68147],[68160,68167],[68176,68184],[68192,68223],[68352,68405],[68416,68437],[68440,68466],[68472,68479],[68608,68680],[126464,126467],[126469,126495],[126497,126498],[126500,126500],[126503,126503],[126505,126514],[126516,126519],[126521,126521],[126523,126523],[126530,126530],[126535,126535],[126537,126537],[126539,126539],[126541,126543],[126545,126546],[126548,126548],[126551,126551],[126553,126553],[126555,126555],[126557,126557],[126559,126559],[126561,126562],[126564,126564],[126567,126570],[126572,126578],[126580,126583],[126585,126588],[126590,126590],[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[1114109,1114109]];function isStrongRTLChar(charCode){for(var i=0;i<strongRTLRanges.length;i++){var currentRange=strongRTLRanges[i];if(charCode>=currentRange[0]&&charCode<=currentRange[1]){return true;}}return false;}function determineBidi(cueDiv){var nodeStack=[],text="",charCode;if(!cueDiv||!cueDiv.childNodes){return"ltr";}function pushNodes(nodeStack,node){for(var i=node.childNodes.length-1;i>=0;i--){nodeStack.push(node.childNodes[i]);}}function nextTextNode(nodeStack){if(!nodeStack||!nodeStack.length){return null;}var node=nodeStack.pop(),text=node.textContent||node.innerText;if(text){var m=text.match(/^.*(\n|\r)/);if(m){nodeStack.length=0;return m[0];}return text;}if(node.tagName==="ruby"){return nextTextNode(nodeStack);}if(node.childNodes){pushNodes(nodeStack,node);return nextTextNode(nodeStack);}}pushNodes(nodeStack,cueDiv);while(text=nextTextNode(nodeStack)){for(var i=0;i<text.length;i++){charCode=text.charCodeAt(i);if(isStrongRTLChar(charCode)){return"rtl";}}}return"ltr";}function computeLinePos(cue){if(typeof cue.line==="number"&&(cue.snapToLines||cue.line>=0&&cue.line<=100)){return cue.line;}if(!cue.track||!cue.track.textTrackList||!cue.track.textTrackList.mediaElement){return-1;}var track=cue.track,trackList=track.textTrackList,count=0;for(var i=0;i<trackList.length&&trackList[i]!==track;i++){if(trackList[i].mode==="showing"){count++;}}return++count*-1;}function StyleBox(){}StyleBox.prototype.applyStyles=function(styles,div){div=div||this.div;for(var prop in styles){if(styles.hasOwnProperty(prop)){div.style[prop]=styles[prop];}}};StyleBox.prototype.formatStyle=function(val,unit){return val===0?0:val+unit;};function CueStyleBox(window,cue,styleOptions){var isIE8=/MSIE\s8\.0/.test(navigator.userAgent);var color="rgba(255, 255, 255, 1)";var backgroundColor="rgba(0, 0, 0, 0.8)";if(isIE8){color="rgb(255, 255, 255)";backgroundColor="rgb(0, 0, 0)";}StyleBox.call(this);this.cue=cue;this.cueDiv=parseContent(window,cue.text);var styles={color:color,backgroundColor:backgroundColor,position:"relative",left:0,right:0,top:0,bottom:0,display:"inline"};if(!isIE8){styles.writingMode=cue.vertical===""?"horizontal-tb":cue.vertical==="lr"?"vertical-lr":"vertical-rl";styles.unicodeBidi="plaintext";}this.applyStyles(styles,this.cueDiv);this.div=window.document.createElement("div");styles={textAlign:cue.align==="middle"?"center":cue.align,font:styleOptions.font,whiteSpace:"pre-line",position:"absolute"};if(!isIE8){styles.direction=determineBidi(this.cueDiv);styles.writingMode=cue.vertical===""?"horizontal-tb":cue.vertical==="lr"?"vertical-lr":"vertical-rl".stylesunicodeBidi="plaintext";}this.applyStyles(styles);this.div.appendChild(this.cueDiv);var textPos=0;switch(cue.positionAlign){case"start":textPos=cue.position;break;case"middle":textPos=cue.position-cue.size/2;break;case"end":textPos=cue.position-cue.size;break;}if(cue.vertical===""){this.applyStyles({left:this.formatStyle(textPos,"%"),width:this.formatStyle(cue.size,"%")});}else{this.applyStyles({top:this.formatStyle(textPos,"%"),height:this.formatStyle(cue.size,"%")});}this.move=function(box){this.applyStyles({top:this.formatStyle(box.top,"px"),bottom:this.formatStyle(box.bottom,"px"),left:this.formatStyle(box.left,"px"),right:this.formatStyle(box.right,"px"),height:this.formatStyle(box.height,"px"),width:this.formatStyle(box.width,"px")});};}CueStyleBox.prototype=_objCreate(StyleBox.prototype);CueStyleBox.prototype.constructor=CueStyleBox;function BoxPosition(obj){var isIE8=/MSIE\s8\.0/.test(navigator.userAgent);var lh,height,width,top;if(obj.div){height=obj.div.offsetHeight;width=obj.div.offsetWidth;top=obj.div.offsetTop;var rects=(rects=obj.div.childNodes)&&(rects=rects[0])&&rects.getClientRects&&rects.getClientRects();obj=obj.div.getBoundingClientRect();lh=rects?Math.max(rects[0]&&rects[0].height||0,obj.height/rects.length):0;}this.left=obj.left;this.right=obj.right;this.top=obj.top||top;this.height=obj.height||height;this.bottom=obj.bottom||top+(obj.height||height);this.width=obj.width||width;this.lineHeight=lh!==undefined?lh:obj.lineHeight;if(isIE8&&!this.lineHeight){this.lineHeight=13;}}BoxPosition.prototype.move=function(axis,toMove){toMove=toMove!==undefined?toMove:this.lineHeight;switch(axis){case"+x":this.left+=toMove;this.right+=toMove;break;case"-x":this.left-=toMove;this.right-=toMove;break;case"+y":this.top+=toMove;this.bottom+=toMove;break;case"-y":this.top-=toMove;this.bottom-=toMove;break;}};BoxPosition.prototype.overlaps=function(b2){return this.left<b2.right&&this.right>b2.left&&this.top<b2.bottom&&this.bottom>b2.top;};BoxPosition.prototype.overlapsAny=function(boxes){for(var i=0;i<boxes.length;i++){if(this.overlaps(boxes[i])){return true;}}return false;};BoxPosition.prototype.within=function(container){return this.top>=container.top&&this.bottom<=container.bottom&&this.left>=container.left&&this.right<=container.right;};BoxPosition.prototype.overlapsOppositeAxis=function(container,axis){switch(axis){case"+x":return this.left<container.left;case"-x":return this.right>container.right;case"+y":return this.top<container.top;case"-y":return this.bottom>container.bottom;}};BoxPosition.prototype.intersectPercentage=function(b2){var x=Math.max(0,Math.min(this.right,b2.right)-Math.max(this.left,b2.left)),y=Math.max(0,Math.min(this.bottom,b2.bottom)-Math.max(this.top,b2.top)),intersectArea=x*y;return intersectArea/(this.height*this.width);};BoxPosition.prototype.toCSSCompatValues=function(reference){return{top:this.top-reference.top,bottom:reference.bottom-this.bottom,left:this.left-reference.left,right:reference.right-this.right,height:this.height,width:this.width};};BoxPosition.getSimpleBoxPosition=function(obj){var height=obj.div?obj.div.offsetHeight:obj.tagName?obj.offsetHeight:0;var width=obj.div?obj.div.offsetWidth:obj.tagName?obj.offsetWidth:0;var top=obj.div?obj.div.offsetTop:obj.tagName?obj.offsetTop:0;obj=obj.div?obj.div.getBoundingClientRect():obj.tagName?obj.getBoundingClientRect():obj;var ret={left:obj.left,right:obj.right,top:obj.top||top,height:obj.height||height,bottom:obj.bottom||top+(obj.height||height),width:obj.width||width};return ret;};function moveBoxToLinePosition(window,styleBox,containerBox,boxPositions){function findBestPosition(b,axis){var bestPosition,specifiedPosition=new BoxPosition(b),percentage=1;for(var i=0;i<axis.length;i++){while(b.overlapsOppositeAxis(containerBox,axis[i])||b.within(containerBox)&&b.overlapsAny(boxPositions)){b.move(axis[i]);}if(b.within(containerBox)){return b;}var p=b.intersectPercentage(containerBox);if(percentage>p){bestPosition=new BoxPosition(b);percentage=p;}b=new BoxPosition(specifiedPosition);}return bestPosition||specifiedPosition;}var boxPosition=new BoxPosition(styleBox),cue=styleBox.cue,linePos=computeLinePos(cue),axis=[];if(cue.snapToLines){var size;switch(cue.vertical){case"":axis=["+y","-y"];size="height";break;case"rl":axis=["+x","-x"];size="width";break;case"lr":axis=["-x","+x"];size="width";break;}var step=boxPosition.lineHeight,position=step*Math.round(linePos),maxPosition=containerBox[size]+step,initialAxis=axis[0];if(Math.abs(position)>maxPosition){position=position<0?-1:1;position*=Math.ceil(maxPosition/step)*step;}if(linePos<0){position+=cue.vertical===""?containerBox.height:containerBox.width;axis=axis.reverse();}boxPosition.move(initialAxis,position);}else{var calculatedPercentage=boxPosition.lineHeight/containerBox.height*100;switch(cue.lineAlign){case"middle":linePos-=calculatedPercentage/2;break;case"end":linePos-=calculatedPercentage;break;}switch(cue.vertical){case"":styleBox.applyStyles({top:styleBox.formatStyle(linePos,"%")});break;case"rl":styleBox.applyStyles({left:styleBox.formatStyle(linePos,"%")});break;case"lr":styleBox.applyStyles({right:styleBox.formatStyle(linePos,"%")});break;}axis=["+y","-x","+x","-y"];boxPosition=new BoxPosition(styleBox);}var bestPosition=findBestPosition(boxPosition,axis);styleBox.move(bestPosition.toCSSCompatValues(containerBox));}function WebVTT(){}WebVTT.StringDecoder=function(){return{decode:function decode(data){if(!data){return"";}if(typeof data!=="string"){throw new Error("Error - expected string data.");}return decodeURIComponent(encodeURIComponent(data));}};};WebVTT.convertCueToDOMTree=function(window,cuetext){if(!window||!cuetext){return null;}return parseContent(window,cuetext);};var FONT_SIZE_PERCENT=.05;var FONT_STYLE="sans-serif";var CUE_BACKGROUND_PADDING="1.5%";WebVTT.processCues=function(window,cues,overlay){if(!window||!cues||!overlay){return null;}while(overlay.firstChild){overlay.removeChild(overlay.firstChild);}var paddedOverlay=window.document.createElement("div");paddedOverlay.style.position="absolute";paddedOverlay.style.left="0";paddedOverlay.style.right="0";paddedOverlay.style.top="0";paddedOverlay.style.bottom="0";paddedOverlay.style.margin=CUE_BACKGROUND_PADDING;overlay.appendChild(paddedOverlay);function shouldCompute(cues){for(var i=0;i<cues.length;i++){if(cues[i].hasBeenReset||!cues[i].displayState){return true;}}return false;}if(!shouldCompute(cues)){for(var i=0;i<cues.length;i++){paddedOverlay.appendChild(cues[i].displayState);}return;}var boxPositions=[],containerBox=BoxPosition.getSimpleBoxPosition(paddedOverlay),fontSize=Math.round(containerBox.height*FONT_SIZE_PERCENT*100)/100;var styleOptions={font:fontSize+"px "+FONT_STYLE};(function(){var styleBox,cue;for(var i=0;i<cues.length;i++){cue=cues[i];styleBox=new CueStyleBox(window,cue,styleOptions);paddedOverlay.appendChild(styleBox.div);moveBoxToLinePosition(window,styleBox,containerBox,boxPositions);cue.displayState=styleBox.div;boxPositions.push(BoxPosition.getSimpleBoxPosition(styleBox));}})();};WebVTT.Parser=function(window,vttjs,decoder){if(!decoder){decoder=vttjs;vttjs={};}if(!vttjs){vttjs={};}this.window=window;this.vttjs=vttjs;this.state="INITIAL";this.buffer="";this.decoder=decoder||new TextDecoder("utf8");this.regionList=[];};WebVTT.Parser.prototype={reportOrThrowError:function reportOrThrowError(e){if(e instanceof ParsingError){this.onparsingerror&&this.onparsingerror(e);}else{throw e;}},parse:function parse(data){var self=this;if(data){self.buffer+=self.decoder.decode(data,{stream:true});}function collectNextLine(){var buffer=self.buffer;var pos=0;while(pos<buffer.length&&buffer[pos]!=="\r"&&buffer[pos]!=="\n"){++pos;}var line=buffer.substr(0,pos);if(buffer[pos]==="\r"){++pos;}if(buffer[pos]==="\n"){++pos;}self.buffer=buffer.substr(pos);return line;}function parseRegion(input){var settings=new Settings();parseOptions(input,function(k,v){switch(k){case"id":settings.set(k,v);break;case"width":settings.percent(k,v);break;case"lines":settings.integer(k,v);break;case"regionanchor":case"viewportanchor":var xy=v.split(",");if(xy.length!==2){break;}var anchor=new Settings();anchor.percent("x",xy[0]);anchor.percent("y",xy[1]);if(!anchor.has("x")||!anchor.has("y")){break;}settings.set(k+"X",anchor.get("x"));settings.set(k+"Y",anchor.get("y"));break;case"scroll":settings.alt(k,v,["up"]);break;}},/=/,/\s/);if(settings.has("id")){var region=new(self.vttjs.VTTRegion||self.window.VTTRegion)();region.width=settings.get("width",100);region.lines=settings.get("lines",3);region.regionAnchorX=settings.get("regionanchorX",0);region.regionAnchorY=settings.get("regionanchorY",100);region.viewportAnchorX=settings.get("viewportanchorX",0);region.viewportAnchorY=settings.get("viewportanchorY",100);region.scroll=settings.get("scroll","");self.onregion&&self.onregion(region);self.regionList.push({id:settings.get("id"),region:region});}}function parseTimestampMap(input){var settings=new Settings();parseOptions(input,function(k,v){switch(k){case"MPEGT":settings.integer(k+"S",v);break;case"LOCA":settings.set(k+"L",parseTimeStamp(v));break;}},/[^\d]:/,/,/);self.ontimestampmap&&self.ontimestampmap({MPEGTS:settings.get("MPEGTS"),LOCAL:settings.get("LOCAL")});}function parseHeader(input){if(input.match(/X-TIMESTAMP-MAP/)){parseOptions(input,function(k,v){switch(k){case"X-TIMESTAMP-MAP":parseTimestampMap(v);break;}},/=/);}else{parseOptions(input,function(k,v){switch(k){case"Region":parseRegion(v);break;}},/:/);}}try{var line;if(self.state==="INITIAL"){if(!/\r\n|\n/.test(self.buffer)){return this;}line=collectNextLine();var m=line.match(/^WEBVTT([ \t].*)?$/);if(!m||!m[0]){throw new ParsingError(ParsingError.Errors.BadSignature);}self.state="HEADER";}var alreadyCollectedLine=false;while(self.buffer){if(!/\r\n|\n/.test(self.buffer)){return this;}if(!alreadyCollectedLine){line=collectNextLine();}else{alreadyCollectedLine=false;}switch(self.state){case"HEADER":if(/:/.test(line)){parseHeader(line);}else if(!line){self.state="ID";}continue;case"NOTE":if(!line){self.state="ID";}continue;case"ID":if(/^NOTE($|[ \t])/.test(line)){self.state="NOTE";break;}if(!line){continue;}self.cue=new(self.vttjs.VTTCue||self.window.VTTCue)(0,0,"");self.state="CUE";if(line.indexOf("--\x3e")===-1){self.cue.id=line;continue;}case"CUE":try{parseCue(line,self.cue,self.regionList);}catch(e){self.reportOrThrowError(e);self.cue=null;self.state="BADCUE";continue;}self.state="CUETEXT";continue;case"CUETEXT":var hasSubstring=line.indexOf("--\x3e")!==-1;if(!line||hasSubstring&&(alreadyCollectedLine=true)){self.oncue&&self.oncue(self.cue);self.cue=null;self.state="ID";continue;}if(self.cue.text){self.cue.text+="\n";}self.cue.text+=line;continue;case"BADCUE":if(!line){self.state="ID";}continue;}}}catch(e){self.reportOrThrowError(e);if(self.state==="CUETEXT"&&self.cue&&self.oncue){self.oncue(self.cue);}self.cue=null;self.state=self.state==="INITIAL"?"BADWEBVTT":"BADCUE";}return this;},flush:function flush(){var self=this;try{self.buffer+=self.decoder.decode();if(self.cue||self.state==="HEADER"){self.buffer+="\n\n";self.parse();}if(self.state==="INITIAL"){throw new ParsingError(ParsingError.Errors.BadSignature);}}catch(e){self.reportOrThrowError(e);}self.onflush&&self.onflush();return this;}};global.WebVTT=WebVTT;})(this,this.vttjs||{});},{}],345:[function(require,module,exports){if(typeof module!=="undefined"&&module.exports){this.VTTCue=this.VTTCue||require("./vttcue").VTTCue;}(function(root){root.VTTCue.prototype.toJSON=function(){var cue={},self=this;Object.keys(this).forEach(function(key){if(key!=="getCueAsHTML"&&key!=="hasBeenReset"&&key!=="displayState"){cue[key]=self[key];}});return cue;};root.VTTCue.create=function(options){if(!options.hasOwnProperty("startTime")||!options.hasOwnProperty("endTime")||!options.hasOwnProperty("text")){throw new Error("You must at least have start time, end time, and text.");}var cue=new root.VTTCue(options.startTime,options.endTime,options.text);for(var key in options){if(cue.hasOwnProperty(key)){cue[key]=options[key];}}return cue;};root.VTTCue.fromJSON=function(json){return this.create(JSON.parse(json));};})(this);},{"./vttcue":346}],346:[function(require,module,exports){(function(root,vttjs){var autoKeyword="auto";var directionSetting={"":true,lr:true,rl:true};var alignSetting={start:true,middle:true,end:true,left:true,right:true};function findDirectionSetting(value){if(typeof value!=="string"){return false;}var dir=directionSetting[value.toLowerCase()];return dir?value.toLowerCase():false;}function findAlignSetting(value){if(typeof value!=="string"){return false;}var align=alignSetting[value.toLowerCase()];return align?value.toLowerCase():false;}function extend(obj){var i=1;for(;i<arguments.length;i++){var cobj=arguments[i];for(var p in cobj){obj[p]=cobj[p];}}return obj;}function VTTCue(startTime,endTime,text){var cue=this;var isIE8=/MSIE\s8\.0/.test(navigator.userAgent);var baseObj={};if(isIE8){cue=document.createElement("custom");}else{baseObj.enumerable=true;}cue.hasBeenReset=false;var _id="";var _pauseOnExit=false;var _startTime=startTime;var _endTime=endTime;var _text=text;var _region=null;var _vertical="";var _snapToLines=true;var _line="auto";var _lineAlign="start";var _position=50;var _positionAlign="middle";var _size=50;var _align="middle";Object.defineProperty(cue,"id",extend({},baseObj,{get:function get(){return _id;},set:function set(value){_id=""+value;}}));Object.defineProperty(cue,"pauseOnExit",extend({},baseObj,{get:function get(){return _pauseOnExit;},set:function set(value){_pauseOnExit=!!value;}}));Object.defineProperty(cue,"startTime",extend({},baseObj,{get:function get(){return _startTime;},set:function set(value){if(typeof value!=="number"){throw new TypeError("Start time must be set to a number.");}_startTime=value;this.hasBeenReset=true;}}));Object.defineProperty(cue,"endTime",extend({},baseObj,{get:function get(){return _endTime;},set:function set(value){if(typeof value!=="number"){throw new TypeError("End time must be set to a number.");}_endTime=value;this.hasBeenReset=true;}}));Object.defineProperty(cue,"text",extend({},baseObj,{get:function get(){return _text;},set:function set(value){_text=""+value;this.hasBeenReset=true;}}));Object.defineProperty(cue,"region",extend({},baseObj,{get:function get(){return _region;},set:function set(value){_region=value;this.hasBeenReset=true;}}));Object.defineProperty(cue,"vertical",extend({},baseObj,{get:function get(){return _vertical;},set:function set(value){var setting=findDirectionSetting(value);if(setting===false){throw new SyntaxError("An invalid or illegal string was specified.");}_vertical=setting;this.hasBeenReset=true;}}));Object.defineProperty(cue,"snapToLines",extend({},baseObj,{get:function get(){return _snapToLines;},set:function set(value){_snapToLines=!!value;this.hasBeenReset=true;}}));Object.defineProperty(cue,"line",extend({},baseObj,{get:function get(){return _line;},set:function set(value){if(typeof value!=="number"&&value!==autoKeyword){throw new SyntaxError("An invalid number or illegal string was specified.");}_line=value;this.hasBeenReset=true;}}));Object.defineProperty(cue,"lineAlign",extend({},baseObj,{get:function get(){return _lineAlign;},set:function set(value){var setting=findAlignSetting(value);if(!setting){throw new SyntaxError("An invalid or illegal string was specified.");}_lineAlign=setting;this.hasBeenReset=true;}}));Object.defineProperty(cue,"position",extend({},baseObj,{get:function get(){return _position;},set:function set(value){if(value<0||value>100){throw new Error("Position must be between 0 and 100.");}_position=value;this.hasBeenReset=true;}}));Object.defineProperty(cue,"positionAlign",extend({},baseObj,{get:function get(){return _positionAlign;},set:function set(value){var setting=findAlignSetting(value);if(!setting){throw new SyntaxError("An invalid or illegal string was specified.");}_positionAlign=setting;this.hasBeenReset=true;}}));Object.defineProperty(cue,"size",extend({},baseObj,{get:function get(){return _size;},set:function set(value){if(value<0||value>100){throw new Error("Size must be between 0 and 100.");}_size=value;this.hasBeenReset=true;}}));Object.defineProperty(cue,"align",extend({},baseObj,{get:function get(){return _align;},set:function set(value){var setting=findAlignSetting(value);if(!setting){throw new SyntaxError("An invalid or illegal string was specified.");}_align=setting;this.hasBeenReset=true;}}));cue.displayState=undefined;if(isIE8){return cue;}}VTTCue.prototype.getCueAsHTML=function(){return WebVTT.convertCueToDOMTree(window,this.text);};root.VTTCue=root.VTTCue||VTTCue;vttjs.VTTCue=VTTCue;})(this,this.vttjs||{});},{}],347:[function(require,module,exports){if(typeof module!=="undefined"&&module.exports){this.VTTRegion=require("./vttregion").VTTRegion;}(function(root){root.VTTRegion.create=function(options){var region=new root.VTTRegion();for(var key in options){if(region.hasOwnProperty(key)){region[key]=options[key];}}return region;};root.VTTRegion.fromJSON=function(json){return this.create(JSON.parse(json));};})(this);},{"./vttregion":348}],348:[function(require,module,exports){(function(root,vttjs){var scrollSetting={"":true,up:true};function findScrollSetting(value){if(typeof value!=="string"){return false;}var scroll=scrollSetting[value.toLowerCase()];return scroll?value.toLowerCase():false;}function isValidPercentValue(value){return typeof value==="number"&&value>=0&&value<=100;}function VTTRegion(){var _width=100;var _lines=3;var _regionAnchorX=0;var _regionAnchorY=100;var _viewportAnchorX=0;var _viewportAnchorY=100;var _scroll="";Object.defineProperties(this,{width:{enumerable:true,get:function get(){return _width;},set:function set(value){if(!isValidPercentValue(value)){throw new Error("Width must be between 0 and 100.");}_width=value;}},lines:{enumerable:true,get:function get(){return _lines;},set:function set(value){if(typeof value!=="number"){throw new TypeError("Lines must be set to a number.");}_lines=value;}},regionAnchorY:{enumerable:true,get:function get(){return _regionAnchorY;},set:function set(value){if(!isValidPercentValue(value)){throw new Error("RegionAnchorX must be between 0 and 100.");}_regionAnchorY=value;}},regionAnchorX:{enumerable:true,get:function get(){return _regionAnchorX;},set:function set(value){if(!isValidPercentValue(value)){throw new Error("RegionAnchorY must be between 0 and 100.");}_regionAnchorX=value;}},viewportAnchorY:{enumerable:true,get:function get(){return _viewportAnchorY;},set:function set(value){if(!isValidPercentValue(value)){throw new Error("ViewportAnchorY must be between 0 and 100.");}_viewportAnchorY=value;}},viewportAnchorX:{enumerable:true,get:function get(){return _viewportAnchorX;},set:function set(value){if(!isValidPercentValue(value)){throw new Error("ViewportAnchorX must be between 0 and 100.");}_viewportAnchorX=value;}},scroll:{enumerable:true,get:function get(){return _scroll;},set:function set(value){var setting=findScrollSetting(value);if(setting===false){throw new SyntaxError("An invalid or illegal string was specified.");}_scroll=setting;}}});}root.VTTRegion=root.VTTRegion||VTTRegion;vttjs.VTTRegion=VTTRegion;})(this,this.vttjs||{});},{}],349:[function(require,module,exports){(function(Buffer){var bs=require("binary-search");var EventEmitter=require("events").EventEmitter;var inherits=require("inherits");var mp4=require("mp4-stream");var Box=require("mp4-box-encoding");var RangeSliceStream=require("range-slice-stream");module.exports=MP4Remuxer;function MP4Remuxer(file){var self=this;EventEmitter.call(self);self._tracks=[];self._fragmentSequence=1;self._file=file;self._decoder=null;self._findMoov(0);}inherits(MP4Remuxer,EventEmitter);MP4Remuxer.prototype._findMoov=function(offset){var self=this;if(self._decoder){self._decoder.destroy();}self._decoder=mp4.decode();var fileStream=self._file.createReadStream({start:offset});fileStream.pipe(self._decoder);self._decoder.once("box",function(headers){if(headers.type==="moov"){self._decoder.decode(function(moov){fileStream.destroy();try{self._processMoov(moov);}catch(err){err.message="Cannot parse mp4 file: "+err.message;self.emit("error",err);}});}else{fileStream.destroy();self._findMoov(offset+headers.length);}});};function RunLengthIndex(entries,countName){var self=this;self._entries=entries;self._countName=countName||"count";self._index=0;self._offset=0;self.value=self._entries[0];}RunLengthIndex.prototype.inc=function(){var self=this;self._offset++;if(self._offset>=self._entries[self._index][self._countName]){self._index++;self._offset=0;}self.value=self._entries[self._index];};MP4Remuxer.prototype._processMoov=function(moov){var self=this;var traks=moov.traks;self._tracks=[];self._hasVideo=false;self._hasAudio=false;for(var i=0;i<traks.length;i++){var trak=traks[i];var stbl=trak.mdia.minf.stbl;var stsdEntry=stbl.stsd.entries[0];var handlerType=trak.mdia.hdlr.handlerType;var codec;var mime;if(handlerType==="vide"&&stsdEntry.type==="avc1"){if(self._hasVideo){continue;}self._hasVideo=true;codec="avc1";if(stsdEntry.avcC){codec+="."+stsdEntry.avcC.mimeCodec;}mime='video/mp4; codecs="'+codec+'"';}else if(handlerType==="soun"&&stsdEntry.type==="mp4a"){if(self._hasAudio){continue;}self._hasAudio=true;codec="mp4a";if(stsdEntry.esds&&stsdEntry.esds.mimeCodec){codec+="."+stsdEntry.esds.mimeCodec;}mime='audio/mp4; codecs="'+codec+'"';}else{continue;}var samples=[];var sample=0;var sampleInChunk=0;var chunk=0;var offsetInChunk=0;var sampleToChunkIndex=0;var dts=0;var decodingTimeEntry=new RunLengthIndex(stbl.stts.entries);var presentationOffsetEntry=null;if(stbl.ctts){presentationOffsetEntry=new RunLengthIndex(stbl.ctts.entries);}var syncSampleIndex=0;while(true){var currChunkEntry=stbl.stsc.entries[sampleToChunkIndex];var size=stbl.stsz.entries[sample];var duration=decodingTimeEntry.value.duration;var presentationOffset=presentationOffsetEntry?presentationOffsetEntry.value.compositionOffset:0;var sync=true;if(stbl.stss){sync=stbl.stss.entries[syncSampleIndex]===sample+1;}samples.push({size:size,duration:duration,dts:dts,presentationOffset:presentationOffset,sync:sync,offset:offsetInChunk+stbl.stco.entries[chunk]});sample++;if(sample>=stbl.stsz.entries.length){break;}sampleInChunk++;offsetInChunk+=size;if(sampleInChunk>=currChunkEntry.samplesPerChunk){sampleInChunk=0;offsetInChunk=0;chunk++;var nextChunkEntry=stbl.stsc.entries[sampleToChunkIndex+1];if(nextChunkEntry&&chunk+1>=nextChunkEntry.firstChunk){sampleToChunkIndex++;}}dts+=duration;decodingTimeEntry.inc();presentationOffsetEntry&&presentationOffsetEntry.inc();if(sync){syncSampleIndex++;}}trak.mdia.mdhd.duration=0;trak.tkhd.duration=0;var defaultSampleDescriptionIndex=currChunkEntry.sampleDescriptionId;var trackMoov={type:"moov",mvhd:moov.mvhd,traks:[{tkhd:trak.tkhd,mdia:{mdhd:trak.mdia.mdhd,hdlr:trak.mdia.hdlr,elng:trak.mdia.elng,minf:{vmhd:trak.mdia.minf.vmhd,smhd:trak.mdia.minf.smhd,dinf:trak.mdia.minf.dinf,stbl:{stsd:stbl.stsd,stts:empty(),ctts:empty(),stsc:empty(),stsz:empty(),stco:empty(),stss:empty()}}}}],mvex:{mehd:{fragmentDuration:moov.mvhd.duration},trexs:[{trackId:trak.tkhd.trackId,defaultSampleDescriptionIndex:defaultSampleDescriptionIndex,defaultSampleDuration:0,defaultSampleSize:0,defaultSampleFlags:0}]}};self._tracks.push({trackId:trak.tkhd.trackId,timeScale:trak.mdia.mdhd.timeScale,samples:samples,currSample:null,currTime:null,moov:trackMoov,mime:mime});}if(self._tracks.length===0){self.emit("error",new Error("no playable tracks"));return;}moov.mvhd.duration=0;self._ftyp={type:"ftyp",brand:"iso5",brandVersion:0,compatibleBrands:["iso5"]};var ftypBuf=Box.encode(self._ftyp);var data=self._tracks.map(function(track){var moovBuf=Box.encode(track.moov);return{mime:track.mime,init:Buffer.concat([ftypBuf,moovBuf])};});self.emit("ready",data);};function empty(){return{version:0,flags:0,entries:[]};}MP4Remuxer.prototype.seek=function(time){var self=this;if(!self._tracks){throw new Error("Not ready yet; wait for 'ready' event");}if(self._fileStream){self._fileStream.destroy();self._fileStream=null;}var startOffset=-1;self._tracks.map(function(track,i){if(track.outStream){track.outStream.destroy();}if(track.inStream){track.inStream.destroy();track.inStream=null;}var outStream=track.outStream=mp4.encode();var fragment=self._generateFragment(i,time);if(!fragment){return outStream.finalize();}if(startOffset===-1||fragment.ranges[0].start<startOffset){startOffset=fragment.ranges[0].start;}writeFragment(fragment);function writeFragment(frag){if(outStream.destroyed)return;outStream.box(frag.moof,function(err){if(err)return self.emit("error",err);if(outStream.destroyed)return;var slicedStream=track.inStream.slice(frag.ranges);slicedStream.pipe(outStream.mediaData(frag.length,function(err){if(err)return self.emit("error",err);if(outStream.destroyed)return;var nextFrag=self._generateFragment(i);if(!nextFrag){return outStream.finalize();}writeFragment(nextFrag);}));});}});if(startOffset>=0){var fileStream=self._fileStream=self._file.createReadStream({start:startOffset});self._tracks.forEach(function(track){track.inStream=new RangeSliceStream(startOffset,{highWaterMark:1e7});fileStream.pipe(track.inStream);});}return self._tracks.map(function(track){return track.outStream;});};MP4Remuxer.prototype._findSampleBefore=function(trackInd,time){var self=this;var track=self._tracks[trackInd];var scaledTime=Math.floor(track.timeScale*time);var sample=bs(track.samples,scaledTime,function(sample,t){var pts=sample.dts+sample.presentationOffset;return pts-t;});if(sample===-1){sample=0;}else if(sample<0){sample=-sample-2;}while(!track.samples[sample].sync){sample--;}return sample;};var MIN_FRAGMENT_DURATION=1;MP4Remuxer.prototype._generateFragment=function(track,time){var self=this;var currTrack=self._tracks[track];var firstSample;if(time!==undefined){firstSample=self._findSampleBefore(track,time);}else{firstSample=currTrack.currSample;}if(firstSample>=currTrack.samples.length)return null;var startDts=currTrack.samples[firstSample].dts;var totalLen=0;var ranges=[];for(var currSample=firstSample;currSample<currTrack.samples.length;currSample++){var sample=currTrack.samples[currSample];if(sample.sync&&sample.dts-startDts>=currTrack.timeScale*MIN_FRAGMENT_DURATION){break;}totalLen+=sample.size;var currRange=ranges.length-1;if(currRange<0||ranges[currRange].end!==sample.offset){ranges.push({start:sample.offset,end:sample.offset+sample.size});}else{ranges[currRange].end+=sample.size;}}currTrack.currSample=currSample;return{moof:self._generateMoof(track,firstSample,currSample),ranges:ranges,length:totalLen};};MP4Remuxer.prototype._generateMoof=function(track,firstSample,lastSample){var self=this;var currTrack=self._tracks[track];var entries=[];for(var j=firstSample;j<lastSample;j++){var currSample=currTrack.samples[j];entries.push({sampleDuration:currSample.duration,sampleSize:currSample.size,sampleFlags:currSample.sync?33554432:16842752,sampleCompositionTimeOffset:currSample.presentationOffset});}var moof={type:"moof",mfhd:{sequenceNumber:self._fragmentSequence++},trafs:[{tfhd:{flags:131072,trackId:currTrack.trackId},tfdt:{baseMediaDecodeTime:currTrack.samples[firstSample].dts},trun:{flags:3841,dataOffset:8,entries:entries}}]};moof.trafs[0].trun.dataOffset+=Box.encodingLength(moof);return moof;};}).call(this,require("buffer").Buffer);},{"binary-search":7,buffer:41,events:73,inherits:94,"mp4-box-encoding":117,"mp4-stream":120,"range-slice-stream":160}],350:[function(require,module,exports){var MediaElementWrapper=require("mediasource");var pump=require("pump");var MP4Remuxer=require("./mp4-remuxer");module.exports=VideoStream;function VideoStream(file,mediaElem,opts){var self=this;if(!(this instanceof VideoStream))return new VideoStream(file,mediaElem,opts);opts=opts||{};self.detailedError=null;self._elem=mediaElem;self._elemWrapper=new MediaElementWrapper(mediaElem);self._waitingFired=false;self._trackMeta=null;self._file=file;self._tracks=null;if(self._elem.preload!=="none"){self._createMuxer();}self._onError=function(err){self.detailedError=self._elemWrapper.detailedError;self.destroy();};self._onWaiting=function(){self._waitingFired=true;if(!self._muxer){self._createMuxer();}else if(self._tracks){self._pump();}};self._elem.addEventListener("waiting",self._onWaiting);self._elem.addEventListener("error",self._onError);}VideoStream.prototype._createMuxer=function(){var self=this;self._muxer=new MP4Remuxer(self._file);self._muxer.on("ready",function(data){self._tracks=data.map(function(trackData){var mediaSource=self._elemWrapper.createWriteStream(trackData.mime);mediaSource.on("error",function(err){self._elemWrapper.error(err);});var track={muxed:null,mediaSource:mediaSource,initFlushed:false,onInitFlushed:null};mediaSource.write(trackData.init,function(err){track.initFlushed=true;if(track.onInitFlushed){track.onInitFlushed(err);}});return track;});if(self._waitingFired||self._elem.preload==="auto"){self._pump();}});self._muxer.on("error",function(err){self._elemWrapper.error(err);});};VideoStream.prototype._pump=function(){var self=this;var muxed=self._muxer.seek(self._elem.currentTime,!self._tracks);self._tracks.forEach(function(track,i){var pumpTrack=function pumpTrack(){if(track.muxed){track.muxed.destroy();track.mediaSource=self._elemWrapper.createWriteStream(track.mediaSource);track.mediaSource.on("error",function(err){self._elemWrapper.error(err);});}track.muxed=muxed[i];pump(track.muxed,track.mediaSource);};if(!track.initFlushed){track.onInitFlushed=function(err){if(err){self._elemWrapper.error(err);return;}pumpTrack();};}else{pumpTrack();}});};VideoStream.prototype.destroy=function(){var self=this;if(self.destroyed){return;}self.destroyed=true;self._elem.removeEventListener("waiting",self._onWaiting);self._elem.removeEventListener("error",self._onError);if(self._tracks){self._tracks.forEach(function(track){track.muxed.destroy();});}self._elem.src="";};},{"./mp4-remuxer":349,mediasource:102,pump:153}],351:[function(require,module,exports){(function(process,global){module.exports=WebTorrent;var Buffer=require("safe-buffer").Buffer;var concat=require("simple-concat");var createTorrent=require("create-torrent");var debug=require("debug")("webtorrent");var DHT=require("bittorrent-dht/client");var EventEmitter=require("events").EventEmitter;var extend=require("xtend");var inherits=require("inherits");var loadIPSet=require("load-ip-set");var parallel=require("run-parallel");var parseTorrent=require("parse-torrent");var path=require("path");var Peer=require("simple-peer");var randombytes=require("randombytes");var speedometer=require("speedometer");var zeroFill=require("zero-fill");var TCPPool=require("./lib/tcp-pool");var Torrent=require("./lib/torrent");var VERSION=require("./package.json").version;var VERSION_STR=VERSION.match(/([0-9]+)/g).slice(0,2).map(function(v){return zeroFill(2,v);}).join("");var VERSION_PREFIX="-WW"+VERSION_STR+"-";inherits(WebTorrent,EventEmitter);function WebTorrent(opts){var self=this;if(!(self instanceof WebTorrent))return new WebTorrent(opts);EventEmitter.call(self);if(!opts)opts={};if(typeof opts.peerId==="string"){self.peerId=opts.peerId;}else if(Buffer.isBuffer(opts.peerId)){self.peerId=opts.peerId.toString("hex");}else{self.peerId=Buffer.from(VERSION_PREFIX+randombytes(9).toString("base64")).toString("hex");}self.peerIdBuffer=Buffer.from(self.peerId,"hex");if(typeof opts.nodeId==="string"){self.nodeId=opts.nodeId;}else if(Buffer.isBuffer(opts.nodeId)){self.nodeId=opts.nodeId.toString("hex");}else{self.nodeId=randombytes(20).toString("hex");}self.nodeIdBuffer=Buffer.from(self.nodeId,"hex");self._debugId=self.peerId.toString("hex").substring(0,7);self.destroyed=false;self.listening=false;self.torrentPort=opts.torrentPort||0;self.dhtPort=opts.dhtPort||0;self.tracker=opts.tracker!==undefined?opts.tracker:{};self.torrents=[];self.maxConns=Number(opts.maxConns)||55;self._debug("new webtorrent (peerId %s, nodeId %s, port %s)",self.peerId,self.nodeId,self.torrentPort);if(self.tracker){if(_typeof2(self.tracker)!=="object")self.tracker={};if(opts.rtcConfig){console.warn("WebTorrent: opts.rtcConfig is deprecated. Use opts.tracker.rtcConfig instead");self.tracker.rtcConfig=opts.rtcConfig;}if(opts.wrtc){console.warn("WebTorrent: opts.wrtc is deprecated. Use opts.tracker.wrtc instead");self.tracker.wrtc=opts.wrtc;}if(global.WRTC&&!self.tracker.wrtc){self.tracker.wrtc=global.WRTC;}}if(typeof TCPPool==="function"){self._tcpPool=new TCPPool(self);}else{process.nextTick(function(){self._onListening();});}self._downloadSpeed=speedometer();self._uploadSpeed=speedometer();if(opts.dht!==false&&typeof DHT==="function"){self.dht=new DHT(extend({nodeId:self.nodeId},opts.dht));self.dht.once("error",function(err){self._destroy(err);});self.dht.once("listening",function(){var address=self.dht.address();if(address)self.dhtPort=address.port;});self.dht.setMaxListeners(0);self.dht.listen(self.dhtPort);}else{self.dht=false;}self.enableWebSeeds=opts.webSeeds!==false;if(typeof loadIPSet==="function"&&opts.blocklist!=null){loadIPSet(opts.blocklist,{headers:{"user-agent":"WebTorrent/"+VERSION+" (https://webtorrent.io)"}},function(err,ipSet){if(err)return self.error("Failed to load blocklist: "+err.message);self.blocked=ipSet;ready();});}else{process.nextTick(ready);}function ready(){if(self.destroyed)return;self.ready=true;self.emit("ready");}}WebTorrent.WEBRTC_SUPPORT=Peer.WEBRTC_SUPPORT;Object.defineProperty(WebTorrent.prototype,"downloadSpeed",{get:function get(){return this._downloadSpeed();}});Object.defineProperty(WebTorrent.prototype,"uploadSpeed",{get:function get(){return this._uploadSpeed();}});Object.defineProperty(WebTorrent.prototype,"progress",{get:function get(){var torrents=this.torrents.filter(function(torrent){return torrent.progress!==1;});var downloaded=torrents.reduce(function(total,torrent){return total+torrent.downloaded;},0);var length=torrents.reduce(function(total,torrent){return total+(torrent.length||0);},0)||1;return downloaded/length;}});Object.defineProperty(WebTorrent.prototype,"ratio",{get:function get(){var uploaded=this.torrents.reduce(function(total,torrent){return total+torrent.uploaded;},0);var received=this.torrents.reduce(function(total,torrent){return total+torrent.received;},0)||1;return uploaded/received;}});WebTorrent.prototype.get=function(torrentId){var self=this;var i,torrent;var len=self.torrents.length;if(torrentId instanceof Torrent){for(i=0;i<len;i++){torrent=self.torrents[i];if(torrent===torrentId)return torrent;}}else{var parsed;try{parsed=parseTorrent(torrentId);}catch(err){}if(!parsed)return null;if(!parsed.infoHash)throw new Error("Invalid torrent identifier");for(i=0;i<len;i++){torrent=self.torrents[i];if(torrent.infoHash===parsed.infoHash)return torrent;}}return null;};WebTorrent.prototype.download=function(torrentId,opts,ontorrent){console.warn("WebTorrent: client.download() is deprecated. Use client.add() instead");return this.add(torrentId,opts,ontorrent);};WebTorrent.prototype.add=function(torrentId,opts,ontorrent){var self=this;if(self.destroyed)throw new Error("client is destroyed");if(typeof opts==="function")return self.add(torrentId,null,opts);self._debug("add");opts=opts?extend(opts):{};var torrent=new Torrent(torrentId,self,opts);self.torrents.push(torrent);torrent.once("_infoHash",onInfoHash);torrent.once("ready",onReady);torrent.once("close",onClose);function onInfoHash(){if(self.destroyed)return;for(var i=0,len=self.torrents.length;i<len;i++){var t=self.torrents[i];if(t.infoHash===torrent.infoHash&&t!==torrent){torrent._destroy(new Error("Cannot add duplicate torrent "+torrent.infoHash));return;}}}function onReady(){if(self.destroyed)return;if(typeof ontorrent==="function")ontorrent(torrent);self.emit("torrent",torrent);}function onClose(){torrent.removeListener("_infoHash",onInfoHash);torrent.removeListener("ready",onReady);torrent.removeListener("close",onClose);}return torrent;};WebTorrent.prototype.seed=function(input,opts,onseed){var self=this;if(self.destroyed)throw new Error("client is destroyed");if(typeof opts==="function")return self.seed(input,null,opts);self._debug("seed");opts=opts?extend(opts):{};if(typeof input==="string")opts.path=path.dirname(input);if(!opts.createdBy)opts.createdBy="WebTorrent/"+VERSION_STR;var torrent=self.add(null,opts,onTorrent);var streams;if(isFileList(input))input=Array.prototype.slice.call(input);if(!Array.isArray(input))input=[input];parallel(input.map(function(item){return function(cb){if(isReadable(item))concat(item,cb);else cb(null,item);};}),function(err,input){if(self.destroyed)return;if(err)return torrent._destroy(err);createTorrent.parseInput(input,opts,function(err,files){if(self.destroyed)return;if(err)return torrent._destroy(err);streams=files.map(function(file){return file.getStream;});createTorrent(input,opts,function(err,torrentBuf){if(self.destroyed)return;if(err)return torrent._destroy(err);var existingTorrent=self.get(torrentBuf);if(existingTorrent){torrent._destroy(new Error("Cannot add duplicate torrent "+existingTorrent.infoHash));}else{torrent._onTorrentId(torrentBuf);}});});});function onTorrent(torrent){var tasks=[function(cb){torrent.load(streams,cb);}];if(self.dht){tasks.push(function(cb){torrent.once("dhtAnnounce",cb);});}parallel(tasks,function(err){if(self.destroyed)return;if(err)return torrent._destroy(err);_onseed(torrent);});}function _onseed(torrent){self._debug("on seed");if(typeof onseed==="function")onseed(torrent);torrent.emit("seed");self.emit("seed",torrent);}return torrent;};WebTorrent.prototype.remove=function(torrentId,cb){this._debug("remove");var torrent=this.get(torrentId);if(!torrent)throw new Error("No torrent with id "+torrentId);this._remove(torrentId,cb);};WebTorrent.prototype._remove=function(torrentId,cb){var torrent=this.get(torrentId);if(!torrent)return;this.torrents.splice(this.torrents.indexOf(torrent),1);torrent.destroy(cb);};WebTorrent.prototype.address=function(){if(!this.listening)return null;return this._tcpPool?this._tcpPool.server.address():{address:"0.0.0.0",family:"IPv4",port:0};};WebTorrent.prototype.destroy=function(cb){if(this.destroyed)throw new Error("client already destroyed");this._destroy(null,cb);};WebTorrent.prototype._destroy=function(err,cb){var self=this;self._debug("client destroy");self.destroyed=true;var tasks=self.torrents.map(function(torrent){return function(cb){torrent.destroy(cb);};});if(self._tcpPool){tasks.push(function(cb){self._tcpPool.destroy(cb);});}if(self.dht){tasks.push(function(cb){self.dht.destroy(cb);});}parallel(tasks,cb);if(err)self.emit("error",err);self.torrents=[];self._tcpPool=null;self.dht=null;};WebTorrent.prototype._onListening=function(){this._debug("listening");this.listening=true;if(this._tcpPool){var address=this._tcpPool.server.address();if(address)this.torrentPort=address.port;}this.emit("listening");};WebTorrent.prototype._debug=function(){var args=[].slice.call(arguments);args[0]="["+this._debugId+"] "+args[0];debug.apply(null,args);};function isReadable(obj){return(typeof obj==="undefined"?"undefined":_typeof2(obj))==="object"&&obj!=null&&typeof obj.pipe==="function";}function isFileList(obj){return typeof FileList!=="undefined"&&obj instanceof FileList;}}).call(this,require("_process"),typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{});},{"./lib/tcp-pool":38,"./lib/torrent":356,"./package.json":369,_process:40,"bittorrent-dht/client":38,"create-torrent":57,debug:69,events:73,inherits:94,"load-ip-set":38,"parse-torrent":149,path:150,randombytes:159,"run-parallel":175,"safe-buffer":177,"simple-concat":179,"simple-peer":181,speedometer:206,xtend:372,"zero-fill":374}],352:[function(require,module,exports){module.exports=FileStream;var debug=require("debug")("webtorrent:file-stream");var inherits=require("inherits");var stream=require("readable-stream");inherits(FileStream,stream.Readable);function FileStream(file,opts){stream.Readable.call(this,opts);this.destroyed=false;this._torrent=file._torrent;var start=opts&&opts.start||0;var end=opts&&opts.end&&opts.end<file.length?opts.end:file.length-1;var pieceLength=file._torrent.pieceLength;this._startPiece=(start+file.offset)/pieceLength|0;this._endPiece=(end+file.offset)/pieceLength|0;this._piece=this._startPiece;this._offset=start+file.offset-this._startPiece*pieceLength;this._missing=end-start+1;this._reading=false;this._notifying=false;this._criticalLength=Math.min(1024*1024/pieceLength|0,2);}FileStream.prototype._read=function(){if(this._reading)return;this._reading=true;this._notify();};FileStream.prototype._notify=function(){var self=this;if(!self._reading||self._missing===0)return;if(!self._torrent.bitfield.get(self._piece)){return self._torrent.critical(self._piece,self._piece+self._criticalLength);}if(self._notifying)return;self._notifying=true;var p=self._piece;self._torrent.store.get(p,function(err,buffer){self._notifying=false;if(self.destroyed)return;if(err)return self._destroy(err);debug("read %s (length %s) (err %s)",p,buffer.length,err&&err.message);if(self._offset){buffer=buffer.slice(self._offset);self._offset=0;}if(self._missing<buffer.length){buffer=buffer.slice(0,self._missing);}self._missing-=buffer.length;debug("pushing buffer of length %s",buffer.length);self._reading=false;self.push(buffer);if(self._missing===0)self.push(null);});self._piece+=1;};FileStream.prototype.destroy=function(onclose){this._destroy(null,onclose);};FileStream.prototype._destroy=function(err,onclose){if(this.destroyed)return;this.destroyed=true;if(!this._torrent.destroyed){this._torrent.deselect(this._startPiece,this._endPiece,true);}if(err)this.emit("error",err);this.emit("close");if(onclose)onclose();};},{debug:69,inherits:94,"readable-stream":367}],353:[function(require,module,exports){(function(process){module.exports=File;var eos=require("end-of-stream");var EventEmitter=require("events").EventEmitter;var FileStream=require("./file-stream");var inherits=require("inherits");var path=require("path");var render=require("render-media");var stream=require("readable-stream");var streamToBlob=require("stream-to-blob");var streamToBlobURL=require("stream-to-blob-url");var streamToBuffer=require("stream-with-known-length-to-buffer");inherits(File,EventEmitter);function File(torrent,file){EventEmitter.call(this);this._torrent=torrent;this._destroyed=false;this.name=file.name;this.path=file.path;this.length=file.length;this.offset=file.offset;this.done=false;var start=file.offset;var end=start+file.length-1;this._startPiece=start/this._torrent.pieceLength|0;this._endPiece=end/this._torrent.pieceLength|0;if(this.length===0){this.done=true;this.emit("done");}}Object.defineProperty(File.prototype,"downloaded",{get:function get(){if(!this._torrent.bitfield)return 0;var downloaded=0;for(var index=this._startPiece;index<=this._endPiece;++index){if(this._torrent.bitfield.get(index)){downloaded+=this._torrent.pieceLength;}else{var piece=this._torrent.pieces[index];downloaded+=piece.length-piece.missing;}}return downloaded;}});Object.defineProperty(File.prototype,"progress",{get:function get(){return this.length?this.downloaded/this.length:0;}});File.prototype.select=function(priority){if(this.length===0)return;this._torrent.select(this._startPiece,this._endPiece,priority);};File.prototype.deselect=function(){if(this.length===0)return;this._torrent.deselect(this._startPiece,this._endPiece,false);};File.prototype.createReadStream=function(opts){var self=this;if(this.length===0){var empty=new stream.PassThrough();process.nextTick(function(){empty.end();});return empty;}var fileStream=new FileStream(self,opts);self._torrent.select(fileStream._startPiece,fileStream._endPiece,true,function(){fileStream._notify();});eos(fileStream,function(){if(self._destroyed)return;if(!self._torrent.destroyed){self._torrent.deselect(fileStream._startPiece,fileStream._endPiece,true);}});return fileStream;};File.prototype.getBuffer=function(cb){streamToBuffer(this.createReadStream(),this.length,cb);};File.prototype.getBlob=function(cb){if(typeof window==="undefined")throw new Error("browser-only method");streamToBlob(this.createReadStream(),this._getMimeType(),cb);};File.prototype.getBlobURL=function(cb){if(typeof window==="undefined")throw new Error("browser-only method");streamToBlobURL(this.createReadStream(),this._getMimeType(),cb);};File.prototype.appendTo=function(elem,opts,cb){if(typeof window==="undefined")throw new Error("browser-only method");render.append(this,elem,opts,cb);};File.prototype.renderTo=function(elem,opts,cb){if(typeof window==="undefined")throw new Error("browser-only method");render.render(this,elem,opts,cb);};File.prototype._getMimeType=function(){return render.mime[path.extname(this.name).toLowerCase()];};File.prototype._destroy=function(){this._destroyed=true;this._torrent=null;};}).call(this,require("_process"));},{"./file-stream":352,_process:40,"end-of-stream":72,events:73,inherits:94,path:150,"readable-stream":367,"render-media":172,"stream-to-blob":223,"stream-to-blob-url":222,"stream-with-known-length-to-buffer":224}],354:[function(require,module,exports){var arrayRemove=require("unordered-array-remove");var debug=require("debug")("webtorrent:peer");var Wire=require("bittorrent-protocol");var WebConn=require("./webconn");var CONNECT_TIMEOUT_TCP=5e3;var CONNECT_TIMEOUT_WEBRTC=25e3;var HANDSHAKE_TIMEOUT=25e3;exports.createWebRTCPeer=function(conn,swarm){var peer=new Peer(conn.id,"webrtc");peer.conn=conn;peer.swarm=swarm;if(peer.conn.connected){peer.onConnect();}else{peer.conn.once("connect",function(){peer.onConnect();});peer.conn.once("error",function(err){peer.destroy(err);});peer.startConnectTimeout();}return peer;};exports.createTCPIncomingPeer=function(conn){var addr=conn.remoteAddress+":"+conn.remotePort;var peer=new Peer(addr,"tcpIncoming");peer.conn=conn;peer.addr=addr;peer.onConnect();return peer;};exports.createTCPOutgoingPeer=function(addr,swarm){var peer=new Peer(addr,"tcpOutgoing");peer.addr=addr;peer.swarm=swarm;return peer;};exports.createWebSeedPeer=function(url,swarm){var peer=new Peer(url,"webSeed");peer.swarm=swarm;peer.conn=new WebConn(url,swarm);peer.onConnect();return peer;};function Peer(id,type){var self=this;self.id=id;self.type=type;debug("new Peer %s",id);self.addr=null;self.conn=null;self.swarm=null;self.wire=null;self.connected=false;self.destroyed=false;self.timeout=null;self.retries=0;self.sentHandshake=false;}Peer.prototype.onConnect=function(){var self=this;if(self.destroyed)return;self.connected=true;debug("Peer %s connected",self.id);clearTimeout(self.connectTimeout);var conn=self.conn;conn.once("end",function(){self.destroy();});conn.once("close",function(){self.destroy();});conn.once("finish",function(){self.destroy();});conn.once("error",function(err){self.destroy(err);});var wire=self.wire=new Wire();wire.type=self.type;wire.once("end",function(){self.destroy();});wire.once("close",function(){self.destroy();});wire.once("finish",function(){self.destroy();});wire.once("error",function(err){self.destroy(err);});wire.once("handshake",function(infoHash,peerId){self.onHandshake(infoHash,peerId);});self.startHandshakeTimeout();conn.pipe(wire).pipe(conn);if(self.swarm&&!self.sentHandshake)self.handshake();};Peer.prototype.onHandshake=function(infoHash,peerId){var self=this;if(!self.swarm)return;if(self.destroyed)return;if(self.swarm.destroyed){return self.destroy(new Error("swarm already destroyed"));}if(infoHash!==self.swarm.infoHash){return self.destroy(new Error("unexpected handshake info hash for this swarm"));}if(peerId===self.swarm.peerId){return self.destroy(new Error("refusing to connect to ourselves"));}debug("Peer %s got handshake %s",self.id,infoHash);clearTimeout(self.handshakeTimeout);self.retries=0;var addr=self.addr;if(!addr&&self.conn.remoteAddress){addr=self.conn.remoteAddress+":"+self.conn.remotePort;}self.swarm._onWire(self.wire,addr);if(!self.swarm||self.swarm.destroyed)return;if(!self.sentHandshake)self.handshake();};Peer.prototype.handshake=function(){var self=this;var opts={dht:self.swarm.private?false:!!self.swarm.client.dht};self.wire.handshake(self.swarm.infoHash,self.swarm.client.peerId,opts);self.sentHandshake=true;};Peer.prototype.startConnectTimeout=function(){var self=this;clearTimeout(self.connectTimeout);self.connectTimeout=setTimeout(function(){self.destroy(new Error("connect timeout"));},self.type==="webrtc"?CONNECT_TIMEOUT_WEBRTC:CONNECT_TIMEOUT_TCP);if(self.connectTimeout.unref)self.connectTimeout.unref();};Peer.prototype.startHandshakeTimeout=function(){var self=this;clearTimeout(self.handshakeTimeout);self.handshakeTimeout=setTimeout(function(){self.destroy(new Error("handshake timeout"));},HANDSHAKE_TIMEOUT);if(self.handshakeTimeout.unref)self.handshakeTimeout.unref();};Peer.prototype.destroy=function(err){var self=this;if(self.destroyed)return;self.destroyed=true;self.connected=false;debug("destroy %s (error: %s)",self.id,err&&(err.message||err));clearTimeout(self.connectTimeout);clearTimeout(self.handshakeTimeout);var swarm=self.swarm;var conn=self.conn;var wire=self.wire;self.swarm=null;self.conn=null;self.wire=null;if(swarm&&wire){arrayRemove(swarm.wires,swarm.wires.indexOf(wire));}if(conn){conn.on("error",noop);conn.destroy();}if(wire)wire.destroy();if(swarm)swarm.removePeer(self.id);};function noop(){}},{"./webconn":357,"bittorrent-protocol":9,debug:69,"unordered-array-remove":235}],355:[function(require,module,exports){module.exports=RarityMap;function RarityMap(torrent){var self=this;self._torrent=torrent;self._numPieces=torrent.pieces.length;self._pieces=[];self._onWire=function(wire){self.recalculate();self._initWire(wire);};self._onWireHave=function(index){self._pieces[index]+=1;};self._onWireBitfield=function(){self.recalculate();};self._torrent.wires.forEach(function(wire){self._initWire(wire);});self._torrent.on("wire",self._onWire);self.recalculate();}RarityMap.prototype.getRarestPiece=function(pieceFilterFunc){if(!pieceFilterFunc)pieceFilterFunc=trueFn;var candidates=[];var min=Infinity;for(var i=0;i<this._numPieces;++i){if(!pieceFilterFunc(i))continue;var availability=this._pieces[i];if(availability===min){candidates.push(i);}else if(availability<min){candidates=[i];min=availability;}}if(candidates.length>0){return candidates[Math.random()*candidates.length|0];}else{return-1;}};RarityMap.prototype.destroy=function(){var self=this;self._torrent.removeListener("wire",self._onWire);self._torrent.wires.forEach(function(wire){self._cleanupWireEvents(wire);});self._torrent=null;self._pieces=null;self._onWire=null;self._onWireHave=null;self._onWireBitfield=null;};RarityMap.prototype._initWire=function(wire){var self=this;wire._onClose=function(){self._cleanupWireEvents(wire);for(var i=0;i<this._numPieces;++i){self._pieces[i]-=wire.peerPieces.get(i);}};wire.on("have",self._onWireHave);wire.on("bitfield",self._onWireBitfield);wire.once("close",wire._onClose);};RarityMap.prototype.recalculate=function(){var i;for(i=0;i<this._numPieces;++i){this._pieces[i]=0;}var numWires=this._torrent.wires.length;for(i=0;i<numWires;++i){var wire=this._torrent.wires[i];for(var j=0;j<this._numPieces;++j){this._pieces[j]+=wire.peerPieces.get(j);}}};RarityMap.prototype._cleanupWireEvents=function(wire){wire.removeListener("have",this._onWireHave);wire.removeListener("bitfield",this._onWireBitfield);if(wire._onClose)wire.removeListener("close",wire._onClose);wire._onClose=null;};function trueFn(){return true;}},{}],356:[function(require,module,exports){(function(process,global){module.exports=Torrent;var addrToIPPort=require("addr-to-ip-port");var BitField=require("bitfield");var ChunkStoreWriteStream=require("chunk-store-stream/write");var debug=require("debug")("webtorrent:torrent");var Discovery=require("torrent-discovery");var EventEmitter=require("events").EventEmitter;var extend=require("xtend");var extendMutable=require("xtend/mutable");var fs=require("fs");var FSChunkStore=require("fs-chunk-store");var get=require("simple-get");var ImmediateChunkStore=require("immediate-chunk-store");var inherits=require("inherits");var MultiStream=require("multistream");var net=require("net");var os=require("os");var parallel=require("run-parallel");var parallelLimit=require("run-parallel-limit");var parseTorrent=require("parse-torrent");var path=require("path");var Piece=require("torrent-piece");var pump=require("pump");var randomIterate=require("random-iterate");var sha1=require("simple-sha1");var speedometer=require("speedometer");var uniq=require("uniq");var utMetadata=require("ut_metadata");var utPex=require("ut_pex");var File=require("./file");var Peer=require("./peer");var RarityMap=require("./rarity-map");var Server=require("./server");var MAX_BLOCK_LENGTH=128*1024;var PIECE_TIMEOUT=3e4;var CHOKE_TIMEOUT=5e3;var SPEED_THRESHOLD=3*Piece.BLOCK_LENGTH;var PIPELINE_MIN_DURATION=.5;var PIPELINE_MAX_DURATION=1;var RECHOKE_INTERVAL=1e4;var RECHOKE_OPTIMISTIC_DURATION=2;var FILESYSTEM_CONCURRENCY=2;var RECONNECT_WAIT=[1e3,5e3,15e3];var VERSION=require("../package.json").version;var USER_AGENT="WebTorrent/"+VERSION+" (https://webtorrent.io)";var TMP;try{TMP=path.join(fs.statSync("/tmp")&&"/tmp","webtorrent");}catch(err){TMP=path.join(typeof os.tmpdir==="function"?os.tmpdir():"/","webtorrent");}inherits(Torrent,EventEmitter);function Torrent(torrentId,client,opts){EventEmitter.call(this);this._debugId="unknown infohash";this.client=client;this.announce=opts.announce;this.urlList=opts.urlList;this.path=opts.path;this._store=opts.store||FSChunkStore;this._getAnnounceOpts=opts.getAnnounceOpts;this.strategy=opts.strategy||"sequential";this.maxWebConns=opts.maxWebConns||4;this._rechokeNumSlots=opts.uploads===false||opts.uploads===0?0:+opts.uploads||10;this._rechokeOptimisticWire=null;this._rechokeOptimisticTime=0;this._rechokeIntervalId=null;this.ready=false;this.destroyed=false;this.paused=false;this.done=false;this.metadata=null;this.store=null;this.files=[];this.pieces=[];this._amInterested=false;this._selections=[];this._critical=[];this.wires=[];this._queue=[];this._peers={};this._peersLength=0;this.received=0;this.uploaded=0;this._downloadSpeed=speedometer();this._uploadSpeed=speedometer();this._servers=[];this._xsRequests=[];this._fileModtimes=opts.fileModtimes;if(torrentId!==null)this._onTorrentId(torrentId);this._debug("new torrent");}Object.defineProperty(Torrent.prototype,"timeRemaining",{get:function get(){if(this.done)return 0;if(this.downloadSpeed===0)return Infinity;return(this.length-this.downloaded)/this.downloadSpeed*1e3;}});Object.defineProperty(Torrent.prototype,"downloaded",{get:function get(){if(!this.bitfield)return 0;var downloaded=0;for(var index=0,len=this.pieces.length;index<len;++index){if(this.bitfield.get(index)){downloaded+=index===len-1?this.lastPieceLength:this.pieceLength;}else{var piece=this.pieces[index];downloaded+=piece.length-piece.missing;}}return downloaded;}});Object.defineProperty(Torrent.prototype,"downloadSpeed",{get:function get(){return this._downloadSpeed();}});Object.defineProperty(Torrent.prototype,"uploadSpeed",{get:function get(){return this._uploadSpeed();}});Object.defineProperty(Torrent.prototype,"progress",{get:function get(){return this.length?this.downloaded/this.length:0;}});Object.defineProperty(Torrent.prototype,"ratio",{get:function get(){return this.uploaded/(this.received||1);}});Object.defineProperty(Torrent.prototype,"numPeers",{get:function get(){return this.wires.length;}});Object.defineProperty(Torrent.prototype,"torrentFileBlobURL",{get:function get(){if(typeof window==="undefined")throw new Error("browser-only property");if(!this.torrentFile)return null;return URL.createObjectURL(new Blob([this.torrentFile],{type:"application/x-bittorrent"}));}});Object.defineProperty(Torrent.prototype,"_numQueued",{get:function get(){return this._queue.length+(this._peersLength-this._numConns);}});Object.defineProperty(Torrent.prototype,"_numConns",{get:function get(){var self=this;var numConns=0;for(var id in self._peers){if(self._peers[id].connected)numConns+=1;}return numConns;}});Object.defineProperty(Torrent.prototype,"swarm",{get:function get(){console.warn("WebTorrent: `torrent.swarm` is deprecated. Use `torrent` directly instead.");return this;}});Torrent.prototype._onTorrentId=function(torrentId){var self=this;if(self.destroyed)return;var parsedTorrent;try{parsedTorrent=parseTorrent(torrentId);}catch(err){}if(parsedTorrent){self.infoHash=parsedTorrent.infoHash;self._debugId=parsedTorrent.infoHash.toString("hex").substring(0,7);process.nextTick(function(){if(self.destroyed)return;self._onParsedTorrent(parsedTorrent);});}else{parseTorrent.remote(torrentId,function(err,parsedTorrent){if(self.destroyed)return;if(err)return self._destroy(err);self._onParsedTorrent(parsedTorrent);});}};Torrent.prototype._onParsedTorrent=function(parsedTorrent){var self=this;if(self.destroyed)return;self._processParsedTorrent(parsedTorrent);if(!self.infoHash){return self._destroy(new Error("Malformed torrent data: No info hash"));}if(!self.path)self.path=path.join(TMP,self.infoHash);self._rechokeIntervalId=setInterval(function(){self._rechoke();},RECHOKE_INTERVAL);if(self._rechokeIntervalId.unref)self._rechokeIntervalId.unref();self.emit("_infoHash",self.infoHash);if(self.destroyed)return;self.emit("infoHash",self.infoHash);if(self.destroyed)return;if(self.client.listening){self._onListening();}else{self.client.once("listening",function(){self._onListening();});}};Torrent.prototype._processParsedTorrent=function(parsedTorrent){this._debugId=parsedTorrent.infoHash.toString("hex").substring(0,7);if(this.announce){parsedTorrent.announce=parsedTorrent.announce.concat(this.announce);}if(this.client.tracker&&global.WEBTORRENT_ANNOUNCE&&!this.private){parsedTorrent.announce=parsedTorrent.announce.concat(global.WEBTORRENT_ANNOUNCE);}if(this.urlList){parsedTorrent.urlList=parsedTorrent.urlList.concat(this.urlList);}uniq(parsedTorrent.announce);uniq(parsedTorrent.urlList);extendMutable(this,parsedTorrent);this.magnetURI=parseTorrent.toMagnetURI(parsedTorrent);this.torrentFile=parseTorrent.toTorrentFile(parsedTorrent);};Torrent.prototype._onListening=function(){var self=this;if(self.discovery||self.destroyed)return;var trackerOpts=self.client.tracker;if(trackerOpts){trackerOpts=extend(self.client.tracker,{getAnnounceOpts:function getAnnounceOpts(){var opts={uploaded:self.uploaded,downloaded:self.downloaded,left:Math.max(self.length-self.downloaded,0)};if(self.client.tracker.getAnnounceOpts){extendMutable(opts,self.client.tracker.getAnnounceOpts());}if(self._getAnnounceOpts){extendMutable(opts,self._getAnnounceOpts());}return opts;}});}self.discovery=new Discovery({infoHash:self.infoHash,announce:self.announce,peerId:self.client.peerId,dht:!self.private&&self.client.dht,tracker:trackerOpts,port:self.client.torrentPort,userAgent:USER_AGENT});self.discovery.on("error",onError);self.discovery.on("peer",onPeer);self.discovery.on("trackerAnnounce",onTrackerAnnounce);self.discovery.on("dhtAnnounce",onDHTAnnounce);self.discovery.on("warning",onWarning);function onError(err){self._destroy(err);}function onPeer(peer){if(typeof peer==="string"&&self.done)return;self.addPeer(peer);}function onTrackerAnnounce(){self.emit("trackerAnnounce");if(self.numPeers===0)self.emit("noPeers","tracker");}function onDHTAnnounce(){self.emit("dhtAnnounce");if(self.numPeers===0)self.emit("noPeers","dht");}function onWarning(err){self.emit("warning",err);}if(self.info){self._onMetadata(self);}else if(self.xs){self._getMetadataFromServer();}};Torrent.prototype._getMetadataFromServer=function(){var self=this;var urls=Array.isArray(self.xs)?self.xs:[self.xs];var tasks=urls.map(function(url){return function(cb){getMetadataFromURL(url,cb);};});parallel(tasks);function getMetadataFromURL(url,cb){if(url.indexOf("http://")!==0&&url.indexOf("https://")!==0){self.emit("warning",new Error("skipping non-http xs param: "+url));return cb(null);}var opts={url:url,method:"GET",headers:{"user-agent":USER_AGENT}};var req;try{req=get.concat(opts,onResponse);}catch(err){self.emit("warning",new Error("skipping invalid url xs param: "+url));return cb(null);}self._xsRequests.push(req);function onResponse(err,res,torrent){if(self.destroyed)return cb(null);if(self.metadata)return cb(null);if(err){self.emit("warning",new Error("http error from xs param: "+url));return cb(null);}if(res.statusCode!==200){self.emit("warning",new Error("non-200 status code "+res.statusCode+" from xs param: "+url));return cb(null);}var parsedTorrent;try{parsedTorrent=parseTorrent(torrent);}catch(err){}if(!parsedTorrent){self.emit("warning",new Error("got invalid torrent file from xs param: "+url));return cb(null);}if(parsedTorrent.infoHash!==self.infoHash){self.emit("warning",new Error("got torrent file with incorrect info hash from xs param: "+url));return cb(null);}self._onMetadata(parsedTorrent);cb(null);}}};Torrent.prototype._onMetadata=function(metadata){var self=this;if(self.metadata||self.destroyed)return;self._debug("got metadata");self._xsRequests.forEach(function(req){req.abort();});self._xsRequests=[];var parsedTorrent;if(metadata&&metadata.infoHash){parsedTorrent=metadata;}else{try{parsedTorrent=parseTorrent(metadata);}catch(err){return self._destroy(err);}}self._processParsedTorrent(parsedTorrent);self.metadata=self.torrentFile;if(self.client.enableWebSeeds){self.urlList.forEach(function(url){self.addWebSeed(url);});}if(self.pieces.length!==0){self.select(0,self.pieces.length-1,false);}self._rarityMap=new RarityMap(self);self.store=new ImmediateChunkStore(new self._store(self.pieceLength,{torrent:{infoHash:self.infoHash},files:self.files.map(function(file){return{path:path.join(self.path,file.path),length:file.length,offset:file.offset};}),length:self.length}));self.files=self.files.map(function(file){return new File(self,file);});self._hashes=self.pieces;self.pieces=self.pieces.map(function(hash,i){var pieceLength=i===self.pieces.length-1?self.lastPieceLength:self.pieceLength;return new Piece(pieceLength);});self._reservations=self.pieces.map(function(){return[];});self.bitfield=new BitField(self.pieces.length);self.wires.forEach(function(wire){if(wire.ut_metadata)wire.ut_metadata.setMetadata(self.metadata);self._onWireWithMetadata(wire);});self._debug("verifying existing torrent data");if(self._fileModtimes&&self._store===FSChunkStore){self.getFileModtimes(function(err,fileModtimes){if(err)return self._destroy(err);var unchanged=self.files.map(function(_,index){return fileModtimes[index]===self._fileModtimes[index];}).every(function(x){return x;});if(unchanged){for(var index=0;index<self.pieces.length;index++){self._markVerified(index);}self._onStore();}else{self._verifyPieces();}});}else{self._verifyPieces();}self.emit("metadata");};Torrent.prototype.getFileModtimes=function(cb){var self=this;var ret=[];parallelLimit(self.files.map(function(file,index){return function(cb){fs.stat(path.join(self.path,file.path),function(err,stat){if(err&&err.code!=="ENOENT")return cb(err);ret[index]=stat&&stat.mtime.getTime();cb(null);});};}),FILESYSTEM_CONCURRENCY,function(err){self._debug("done getting file modtimes");cb(err,ret);});};Torrent.prototype._verifyPieces=function(){var self=this;parallelLimit(self.pieces.map(function(_,index){return function(cb){if(self.destroyed)return cb(new Error("torrent is destroyed"));self.store.get(index,function(err,buf){if(self.destroyed)return cb(new Error("torrent is destroyed"));if(err)return process.nextTick(cb,null);sha1(buf,function(hash){if(self.destroyed)return cb(new Error("torrent is destroyed"));if(hash===self._hashes[index]){if(!self.pieces[index])return;self._debug("piece verified %s",index);self._markVerified(index);}else{self._debug("piece invalid %s",index);}cb(null);});});};}),FILESYSTEM_CONCURRENCY,function(err){if(err)return self._destroy(err);self._debug("done verifying");self._onStore();});};Torrent.prototype._markVerified=function(index){this.pieces[index]=null;this._reservations[index]=null;this.bitfield.set(index,true);};Torrent.prototype._onStore=function(){var self=this;if(self.destroyed)return;self._debug("on store");self.ready=true;self.emit("ready");self._checkDone();self._updateSelections();};Torrent.prototype.destroy=function(cb){var self=this;self._destroy(null,cb);};Torrent.prototype._destroy=function(err,cb){var self=this;if(self.destroyed)return;self.destroyed=true;self._debug("destroy");self.client._remove(self);clearInterval(self._rechokeIntervalId);self._xsRequests.forEach(function(req){req.abort();});if(self._rarityMap){self._rarityMap.destroy();}for(var id in self._peers){self.removePeer(id);}self.files.forEach(function(file){if(file instanceof File)file._destroy();});var tasks=self._servers.map(function(server){return function(cb){server.destroy(cb);};});if(self.discovery){tasks.push(function(cb){self.discovery.destroy(cb);});}if(self.store){tasks.push(function(cb){self.store.close(cb);});}parallel(tasks,cb);if(err){if(self.listenerCount("error")===0){self.client.emit("error",err);}else{self.emit("error",err);}}self.emit("close");self.client=null;self.files=[];self.discovery=null;self.store=null;self._rarityMap=null;self._peers=null;self._servers=null;self._xsRequests=null;};Torrent.prototype.addPeer=function(peer){var self=this;if(self.destroyed)throw new Error("torrent is destroyed");if(!self.infoHash)throw new Error("addPeer() must not be called before the `infoHash` event");if(self.client.blocked){var host;if(typeof peer==="string"){var parts;try{parts=addrToIPPort(peer);}catch(e){self._debug("ignoring peer: invalid %s",peer);self.emit("invalidPeer",peer);return false;}host=parts[0];}else if(typeof peer.remoteAddress==="string"){host=peer.remoteAddress;}if(host&&self.client.blocked.contains(host)){self._debug("ignoring peer: blocked %s",peer);if(typeof peer!=="string")peer.destroy();self.emit("blockedPeer",peer);return false;}}var wasAdded=!!self._addPeer(peer);if(wasAdded){self.emit("peer",peer);}else{self.emit("invalidPeer",peer);}return wasAdded;};Torrent.prototype._addPeer=function(peer){var self=this;if(self.destroyed){if(typeof peer!=="string")peer.destroy();return null;}if(typeof peer==="string"&&!self._validAddr(peer)){self._debug("ignoring peer: invalid %s",peer);return null;}var id=peer&&peer.id||peer;if(self._peers[id]){self._debug("ignoring peer: duplicate (%s)",id);if(typeof peer!=="string")peer.destroy();return null;}if(self.paused){self._debug("ignoring peer: torrent is paused");if(typeof peer!=="string")peer.destroy();return null;}self._debug("add peer %s",id);var newPeer;if(typeof peer==="string"){newPeer=Peer.createTCPOutgoingPeer(peer,self);}else{newPeer=Peer.createWebRTCPeer(peer,self);}self._peers[newPeer.id]=newPeer;self._peersLength+=1;if(typeof peer==="string"){self._queue.push(newPeer);self._drain();}return newPeer;};Torrent.prototype.addWebSeed=function(url){if(this.destroyed)throw new Error("torrent is destroyed");if(!/^https?:\/\/.+/.test(url)){this.emit("warning",new Error("ignoring invalid web seed: "+url));this.emit("invalidPeer",url);return;}if(this._peers[url]){this.emit("warning",new Error("ignoring duplicate web seed: "+url));this.emit("invalidPeer",url);return;}this._debug("add web seed %s",url);var newPeer=Peer.createWebSeedPeer(url,this);this._peers[newPeer.id]=newPeer;this._peersLength+=1;this.emit("peer",url);};Torrent.prototype._addIncomingPeer=function(peer){var self=this;if(self.destroyed)return peer.destroy(new Error("torrent is destroyed"));if(self.paused)return peer.destroy(new Error("torrent is paused"));this._debug("add incoming peer %s",peer.id);self._peers[peer.id]=peer;self._peersLength+=1;};Torrent.prototype.removePeer=function(peer){var self=this;var id=peer&&peer.id||peer;peer=self._peers[id];if(!peer)return;this._debug("removePeer %s",id);delete self._peers[id];self._peersLength-=1;peer.destroy();self._drain();};Torrent.prototype.select=function(start,end,priority,notify){var self=this;if(self.destroyed)throw new Error("torrent is destroyed");if(start<0||end<start||self.pieces.length<=end){throw new Error("invalid selection ",start,":",end);}priority=Number(priority)||0;self._debug("select %s-%s (priority %s)",start,end,priority);self._selections.push({from:start,to:end,offset:0,priority:priority,notify:notify||noop});self._selections.sort(function(a,b){return b.priority-a.priority;});self._updateSelections();};Torrent.prototype.deselect=function(start,end,priority){var self=this;if(self.destroyed)throw new Error("torrent is destroyed");priority=Number(priority)||0;self._debug("deselect %s-%s (priority %s)",start,end,priority);for(var i=0;i<self._selections.length;++i){var s=self._selections[i];if(s.from===start&&s.to===end&&s.priority===priority){self._selections.splice(i,1);break;}}self._updateSelections();};Torrent.prototype.critical=function(start,end){var self=this;if(self.destroyed)throw new Error("torrent is destroyed");self._debug("critical %s-%s",start,end);for(var i=start;i<=end;++i){self._critical[i]=true;}self._updateSelections();};Torrent.prototype._onWire=function(wire,addr){var self=this;self._debug("got wire %s (%s)",wire._debugId,addr||"Unknown");wire.on("download",function(downloaded){if(self.destroyed)return;self.received+=downloaded;self._downloadSpeed(downloaded);self.client._downloadSpeed(downloaded);self.emit("download",downloaded);self.client.emit("download",downloaded);});wire.on("upload",function(uploaded){if(self.destroyed)return;self.uploaded+=uploaded;self._uploadSpeed(uploaded);self.client._uploadSpeed(uploaded);self.emit("upload",uploaded);self.client.emit("upload",uploaded);});self.wires.push(wire);if(addr){var parts=addrToIPPort(addr);wire.remoteAddress=parts[0];wire.remotePort=parts[1];}if(self.client.dht&&self.client.dht.listening){wire.on("port",function(port){if(self.destroyed||self.client.dht.destroyed){return;}if(!wire.remoteAddress){return self._debug("ignoring PORT from peer with no address");}if(port===0||port>65536){return self._debug("ignoring invalid PORT from peer");}self._debug("port: %s (from %s)",port,addr);self.client.dht.addNode({host:wire.remoteAddress,port:port});});}wire.on("timeout",function(){self._debug("wire timeout (%s)",addr);wire.destroy();});wire.setTimeout(PIECE_TIMEOUT,true);wire.setKeepAlive(true);wire.use(utMetadata(self.metadata));wire.ut_metadata.on("warning",function(err){self._debug("ut_metadata warning: %s",err.message);});if(!self.metadata){wire.ut_metadata.on("metadata",function(metadata){self._debug("got metadata via ut_metadata");self._onMetadata(metadata);});wire.ut_metadata.fetch();}if(typeof utPex==="function"&&!self.private){wire.use(utPex());wire.ut_pex.on("peer",function(peer){if(self.done)return;self._debug("ut_pex: got peer: %s (from %s)",peer,addr);self.addPeer(peer);});wire.ut_pex.on("dropped",function(peer){var peerObj=self._peers[peer];if(peerObj&&!peerObj.connected){self._debug("ut_pex: dropped peer: %s (from %s)",peer,addr);self.removePeer(peer);}});wire.once("close",function(){wire.ut_pex.reset();});}self.emit("wire",wire,addr);if(self.metadata){process.nextTick(function(){self._onWireWithMetadata(wire);});}};Torrent.prototype._onWireWithMetadata=function(wire){var self=this;var timeoutId=null;function onChokeTimeout(){if(self.destroyed||wire.destroyed)return;if(self._numQueued>2*(self._numConns-self.numPeers)&&wire.amInterested){wire.destroy();}else{timeoutId=setTimeout(onChokeTimeout,CHOKE_TIMEOUT);if(timeoutId.unref)timeoutId.unref();}}var i;function updateSeedStatus(){if(wire.peerPieces.buffer.length!==self.bitfield.buffer.length)return;for(i=0;i<self.pieces.length;++i){if(!wire.peerPieces.get(i))return;}wire.isSeeder=true;wire.choke();}wire.on("bitfield",function(){updateSeedStatus();self._update();});wire.on("have",function(){updateSeedStatus();self._update();});wire.once("interested",function(){wire.unchoke();});wire.once("close",function(){clearTimeout(timeoutId);});wire.on("choke",function(){clearTimeout(timeoutId);timeoutId=setTimeout(onChokeTimeout,CHOKE_TIMEOUT);if(timeoutId.unref)timeoutId.unref();});wire.on("unchoke",function(){clearTimeout(timeoutId);self._update();});wire.on("request",function(index,offset,length,cb){if(length>MAX_BLOCK_LENGTH){return wire.destroy();}if(self.pieces[index])return;self.store.get(index,{offset:offset,length:length},cb);});wire.bitfield(self.bitfield);wire.interested();if(wire.peerExtensions.dht&&self.client.dht&&self.client.dht.listening){wire.port(self.client.dht.address().port);}if(wire.type!=="webSeed"){timeoutId=setTimeout(onChokeTimeout,CHOKE_TIMEOUT);if(timeoutId.unref)timeoutId.unref();}wire.isSeeder=false;updateSeedStatus();};Torrent.prototype._updateSelections=function(){var self=this;if(!self.ready||self.destroyed)return;process.nextTick(function(){self._gcSelections();});self._updateInterest();self._update();};Torrent.prototype._gcSelections=function(){var self=this;for(var i=0;i<self._selections.length;++i){var s=self._selections[i];var oldOffset=s.offset;while(self.bitfield.get(s.from+s.offset)&&s.from+s.offset<s.to){s.offset+=1;}if(oldOffset!==s.offset)s.notify();if(s.to!==s.from+s.offset)continue;if(!self.bitfield.get(s.from+s.offset))continue;self._selections.splice(i,1);i-=1;s.notify();self._updateInterest();}if(!self._selections.length)self.emit("idle");};Torrent.prototype._updateInterest=function(){var self=this;var prev=self._amInterested;self._amInterested=!!self._selections.length;self.wires.forEach(function(wire){if(self._amInterested)wire.interested();else wire.uninterested();});if(prev===self._amInterested)return;if(self._amInterested)self.emit("interested");else self.emit("uninterested");};Torrent.prototype._update=function(){var self=this;if(self.destroyed)return;var ite=randomIterate(self.wires);var wire;while(wire=ite()){self._updateWire(wire);}};Torrent.prototype._updateWire=function(wire){var self=this;if(wire.peerChoking)return;if(!wire.downloaded)return validateWire();var minOutstandingRequests=getBlockPipelineLength(wire,PIPELINE_MIN_DURATION);if(wire.requests.length>=minOutstandingRequests)return;var maxOutstandingRequests=getBlockPipelineLength(wire,PIPELINE_MAX_DURATION);trySelectWire(false)||trySelectWire(true);function genPieceFilterFunc(start,end,tried,rank){return function(i){return i>=start&&i<=end&&!(i in tried)&&wire.peerPieces.get(i)&&(!rank||rank(i));};}function validateWire(){if(wire.requests.length)return;var i=self._selections.length;while(i--){var next=self._selections[i];var piece;if(self.strategy==="rarest"){var start=next.from+next.offset;var end=next.to;var len=end-start+1;var tried={};var tries=0;var filter=genPieceFilterFunc(start,end,tried);while(tries<len){piece=self._rarityMap.getRarestPiece(filter);if(piece<0)break;if(self._request(wire,piece,false))return;tried[piece]=true;tries+=1;}}else{for(piece=next.to;piece>=next.from+next.offset;--piece){if(!wire.peerPieces.get(piece))continue;if(self._request(wire,piece,false))return;}}}}function speedRanker(){var speed=wire.downloadSpeed()||1;if(speed>SPEED_THRESHOLD)return function(){return true;};var secs=Math.max(1,wire.requests.length)*Piece.BLOCK_LENGTH/speed;var tries=10;var ptr=0;return function(index){if(!tries||self.bitfield.get(index))return true;var missing=self.pieces[index].missing;for(;ptr<self.wires.length;ptr++){var otherWire=self.wires[ptr];var otherSpeed=otherWire.downloadSpeed();if(otherSpeed<SPEED_THRESHOLD)continue;if(otherSpeed<=speed)continue;if(!otherWire.peerPieces.get(index))continue;if((missing-=otherSpeed*secs)>0)continue;tries--;return false;}return true;};}function shufflePriority(i){var last=i;for(var j=i;j<self._selections.length&&self._selections[j].priority;j++){last=j;}var tmp=self._selections[i];self._selections[i]=self._selections[last];self._selections[last]=tmp;}function trySelectWire(hotswap){if(wire.requests.length>=maxOutstandingRequests)return true;var rank=speedRanker();for(var i=0;i<self._selections.length;i++){var next=self._selections[i];var piece;if(self.strategy==="rarest"){var start=next.from+next.offset;var end=next.to;var len=end-start+1;var tried={};var tries=0;var filter=genPieceFilterFunc(start,end,tried,rank);while(tries<len){piece=self._rarityMap.getRarestPiece(filter);if(piece<0)break;while(self._request(wire,piece,self._critical[piece]||hotswap)){}if(wire.requests.length<maxOutstandingRequests){tried[piece]=true;tries++;continue;}if(next.priority)shufflePriority(i);return true;}}else{for(piece=next.from+next.offset;piece<=next.to;piece++){if(!wire.peerPieces.get(piece)||!rank(piece))continue;while(self._request(wire,piece,self._critical[piece]||hotswap)){}if(wire.requests.length<maxOutstandingRequests)continue;if(next.priority)shufflePriority(i);return true;}}}return false;}};Torrent.prototype._rechoke=function(){var self=this;if(!self.ready)return;if(self._rechokeOptimisticTime>0)self._rechokeOptimisticTime-=1;else self._rechokeOptimisticWire=null;var peers=[];self.wires.forEach(function(wire){if(!wire.isSeeder&&wire!==self._rechokeOptimisticWire){peers.push({wire:wire,downloadSpeed:wire.downloadSpeed(),uploadSpeed:wire.uploadSpeed(),salt:Math.random(),isChoked:true});}});peers.sort(rechokeSort);var unchokeInterested=0;var i=0;for(;i<peers.length&&unchokeInterested<self._rechokeNumSlots;++i){peers[i].isChoked=false;if(peers[i].wire.peerInterested)unchokeInterested+=1;}if(!self._rechokeOptimisticWire&&i<peers.length&&self._rechokeNumSlots){var candidates=peers.slice(i).filter(function(peer){return peer.wire.peerInterested;});var optimistic=candidates[randomInt(candidates.length)];if(optimistic){optimistic.isChoked=false;self._rechokeOptimisticWire=optimistic.wire;self._rechokeOptimisticTime=RECHOKE_OPTIMISTIC_DURATION;}}peers.forEach(function(peer){if(peer.wire.amChoking!==peer.isChoked){if(peer.isChoked)peer.wire.choke();else peer.wire.unchoke();}});function rechokeSort(peerA,peerB){if(peerA.downloadSpeed!==peerB.downloadSpeed){return peerB.downloadSpeed-peerA.downloadSpeed;}if(peerA.uploadSpeed!==peerB.uploadSpeed){return peerB.uploadSpeed-peerA.uploadSpeed;}if(peerA.wire.amChoking!==peerB.wire.amChoking){return peerA.wire.amChoking?1:-1;}return peerA.salt-peerB.salt;}};Torrent.prototype._hotswap=function(wire,index){var self=this;var speed=wire.downloadSpeed();if(speed<Piece.BLOCK_LENGTH)return false;if(!self._reservations[index])return false;var r=self._reservations[index];if(!r){return false;}var minSpeed=Infinity;var minWire;var i;for(i=0;i<r.length;i++){var otherWire=r[i];if(!otherWire||otherWire===wire)continue;var otherSpeed=otherWire.downloadSpeed();if(otherSpeed>=SPEED_THRESHOLD)continue;if(2*otherSpeed>speed||otherSpeed>minSpeed)continue;minWire=otherWire;minSpeed=otherSpeed;}if(!minWire)return false;for(i=0;i<r.length;i++){if(r[i]===minWire)r[i]=null;}for(i=0;i<minWire.requests.length;i++){var req=minWire.requests[i];if(req.piece!==index)continue;self.pieces[index].cancel(req.offset/Piece.BLOCK_LENGTH|0);}self.emit("hotswap",minWire,wire,index);return true;};Torrent.prototype._request=function(wire,index,hotswap){var self=this;var numRequests=wire.requests.length;var isWebSeed=wire.type==="webSeed";if(self.bitfield.get(index))return false;var maxOutstandingRequests=isWebSeed?Math.min(getPiecePipelineLength(wire,PIPELINE_MAX_DURATION,self.pieceLength),self.maxWebConns):getBlockPipelineLength(wire,PIPELINE_MAX_DURATION);if(numRequests>=maxOutstandingRequests)return false;var piece=self.pieces[index];var reservation=isWebSeed?piece.reserveRemaining():piece.reserve();if(reservation===-1&&hotswap&&self._hotswap(wire,index)){reservation=isWebSeed?piece.reserveRemaining():piece.reserve();}if(reservation===-1)return false;var r=self._reservations[index];if(!r)r=self._reservations[index]=[];var i=r.indexOf(null);if(i===-1)i=r.length;r[i]=wire;var chunkOffset=piece.chunkOffset(reservation);var chunkLength=isWebSeed?piece.chunkLengthRemaining(reservation):piece.chunkLength(reservation);wire.request(index,chunkOffset,chunkLength,function onChunk(err,chunk){if(self.destroyed)return;if(!self.ready)return self.once("ready",function(){onChunk(err,chunk);});if(r[i]===wire)r[i]=null;if(piece!==self.pieces[index])return onUpdateTick();if(err){self._debug("error getting piece %s (offset: %s length: %s) from %s: %s",index,chunkOffset,chunkLength,wire.remoteAddress+":"+wire.remotePort,err.message);isWebSeed?piece.cancelRemaining(reservation):piece.cancel(reservation);onUpdateTick();return;}self._debug("got piece %s (offset: %s length: %s) from %s",index,chunkOffset,chunkLength,wire.remoteAddress+":"+wire.remotePort);if(!piece.set(reservation,chunk,wire))return onUpdateTick();var buf=piece.flush();sha1(buf,function(hash){if(self.destroyed)return;if(hash===self._hashes[index]){if(!self.pieces[index])return;self._debug("piece verified %s",index);self.pieces[index]=null;self._reservations[index]=null;self.bitfield.set(index,true);self.store.put(index,buf);self.wires.forEach(function(wire){wire.have(index);});if(self._checkDone()&&!self.destroyed)self.discovery.complete();}else{self.pieces[index]=new Piece(piece.length);self.emit("warning",new Error("Piece "+index+" failed verification"));}onUpdateTick();});});function onUpdateTick(){process.nextTick(function(){self._update();});}return true;};Torrent.prototype._checkDone=function(){var self=this;if(self.destroyed)return;self.files.forEach(function(file){if(file.done)return;for(var i=file._startPiece;i<=file._endPiece;++i){if(!self.bitfield.get(i))return;}file.done=true;file.emit("done");self._debug("file done: "+file.name);});var done=true;for(var i=0;i<self._selections.length;i++){var selection=self._selections[i];for(var piece=selection.from;piece<=selection.to;piece++){if(!self.bitfield.get(piece)){done=false;break;}}if(!done)break;}if(!self.done&&done){self.done=true;self._debug("torrent done: "+self.infoHash);self.emit("done");}self._gcSelections();return done;};Torrent.prototype.load=function(streams,cb){var self=this;if(self.destroyed)throw new Error("torrent is destroyed");if(!self.ready)return self.once("ready",function(){self.load(streams,cb);});if(!Array.isArray(streams))streams=[streams];if(!cb)cb=noop;var readable=new MultiStream(streams);var writable=new ChunkStoreWriteStream(self.store,self.pieceLength);pump(readable,writable,function(err){if(err)return cb(err);self.pieces.forEach(function(piece,index){self.pieces[index]=null;self._reservations[index]=null;self.bitfield.set(index,true);});self._checkDone();cb(null);});};Torrent.prototype.createServer=function(requestListener){if(typeof Server!=="function")throw new Error("node.js-only method");if(this.destroyed)throw new Error("torrent is destroyed");var server=new Server(this,requestListener);this._servers.push(server);return server;};Torrent.prototype.pause=function(){if(this.destroyed)return;this._debug("pause");this.paused=true;};Torrent.prototype.resume=function(){if(this.destroyed)return;this._debug("resume");this.paused=false;this._drain();};Torrent.prototype._debug=function(){var args=[].slice.call(arguments);args[0]="["+this.client._debugId+"] ["+this._debugId+"] "+args[0];debug.apply(null,args);};Torrent.prototype._drain=function(){var self=this;this._debug("_drain numConns %s maxConns %s",self._numConns,self.client.maxConns);if(typeof net.connect!=="function"||self.destroyed||self.paused||self._numConns>=self.client.maxConns){return;}this._debug("drain (%s queued, %s/%s peers)",self._numQueued,self.numPeers,self.client.maxConns);var peer=self._queue.shift();if(!peer)return;this._debug("tcp connect attempt to %s",peer.addr);var parts=addrToIPPort(peer.addr);var opts={host:parts[0],port:parts[1]};var conn=peer.conn=net.connect(opts);conn.once("connect",function(){peer.onConnect();});conn.once("error",function(err){peer.destroy(err);});peer.startConnectTimeout();conn.on("close",function(){if(self.destroyed)return;if(peer.retries>=RECONNECT_WAIT.length){self._debug("conn %s closed: will not re-add (max %s attempts)",peer.addr,RECONNECT_WAIT.length);return;}var ms=RECONNECT_WAIT[peer.retries];self._debug("conn %s closed: will re-add to queue in %sms (attempt %s)",peer.addr,ms,peer.retries+1);var reconnectTimeout=setTimeout(function reconnectTimeout(){var newPeer=self._addPeer(peer.addr);if(newPeer)newPeer.retries=peer.retries+1;},ms);if(reconnectTimeout.unref)reconnectTimeout.unref();});};Torrent.prototype._validAddr=function(addr){var parts;try{parts=addrToIPPort(addr);}catch(e){return false;}var host=parts[0];var port=parts[1];return port>0&&port<65535&&!(host==="127.0.0.1"&&port===this.client.torrentPort);};function getBlockPipelineLength(wire,duration){return 2+Math.ceil(duration*wire.downloadSpeed()/Piece.BLOCK_LENGTH);}function getPiecePipelineLength(wire,duration,pieceLength){return 1+Math.ceil(duration*wire.downloadSpeed()/pieceLength);}function randomInt(high){return Math.random()*high|0;}function noop(){}}).call(this,require("_process"),typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{});},{"../package.json":369,"./file":353,"./peer":354,"./rarity-map":355,"./server":38,_process:40,"addr-to-ip-port":2,bitfield:8,"chunk-store-stream/write":54,debug:69,events:73,fs:39,"fs-chunk-store":114,"immediate-chunk-store":93,inherits:94,multistream:133,net:38,os:38,"parse-torrent":149,path:150,pump:153,"random-iterate":158,"run-parallel":175,"run-parallel-limit":174,"simple-get":180,"simple-sha1":193,speedometer:206,"torrent-discovery":228,"torrent-piece":229,uniq:234,ut_metadata:238,ut_pex:38,xtend:372,"xtend/mutable":373}],357:[function(require,module,exports){module.exports=WebConn;var BitField=require("bitfield");var Buffer=require("safe-buffer").Buffer;var debug=require("debug")("webtorrent:webconn");var get=require("simple-get");var inherits=require("inherits");var sha1=require("simple-sha1");var Wire=require("bittorrent-protocol");var VERSION=require("../package.json").version;inherits(WebConn,Wire);function WebConn(url,torrent){Wire.call(this);this.url=url;this.webPeerId=sha1.sync(url);this._torrent=torrent;this._init();}WebConn.prototype._init=function(){var self=this;self.setKeepAlive(true);self.once("handshake",function(infoHash,peerId){if(self.destroyed)return;self.handshake(infoHash,self.webPeerId);var numPieces=self._torrent.pieces.length;var bitfield=new BitField(numPieces);for(var i=0;i<=numPieces;i++){bitfield.set(i,true);}self.bitfield(bitfield);});self.once("interested",function(){debug("interested");self.unchoke();});self.on("uninterested",function(){debug("uninterested");});self.on("choke",function(){debug("choke");});self.on("unchoke",function(){debug("unchoke");});self.on("bitfield",function(){debug("bitfield");});self.on("request",function(pieceIndex,offset,length,callback){debug("request pieceIndex=%d offset=%d length=%d",pieceIndex,offset,length);self.httpRequest(pieceIndex,offset,length,callback);});};WebConn.prototype.httpRequest=function(pieceIndex,offset,length,cb){var self=this;var pieceOffset=pieceIndex*self._torrent.pieceLength;var rangeStart=pieceOffset+offset;var rangeEnd=rangeStart+length-1;var files=self._torrent.files;var requests;if(files.length<=1){requests=[{url:self.url,start:rangeStart,end:rangeEnd}];}else{var requestedFiles=files.filter(function(file){return file.offset<=rangeEnd&&file.offset+file.length>rangeStart;});if(requestedFiles.length<1){return cb(new Error("Could not find file corresponnding to web seed range request"));}requests=requestedFiles.map(function(requestedFile){var fileEnd=requestedFile.offset+requestedFile.length-1;var url=self.url+(self.url[self.url.length-1]==="/"?"":"/")+requestedFile.path;return{url:url,fileOffsetInRange:Math.max(requestedFile.offset-rangeStart,0),start:Math.max(rangeStart-requestedFile.offset,0),end:Math.min(fileEnd,rangeEnd-requestedFile.offset)};});}var numRequestsSucceeded=0;var hasError=false;var ret;if(requests.length>1){ret=Buffer.alloc(length);}requests.forEach(function(request){var url=request.url;var start=request.start;var end=request.end;debug("Requesting url=%s pieceIndex=%d offset=%d length=%d start=%d end=%d",url,pieceIndex,offset,length,start,end);var opts={url:url,method:"GET",headers:{"user-agent":"WebTorrent/"+VERSION+" (https://webtorrent.io)",range:"bytes="+start+"-"+end}};function onResponse(res,data){if(res.statusCode<200||res.statusCode>=300){hasError=true;return cb(new Error("Unexpected HTTP status code "+res.statusCode));}debug("Got data of length %d",data.length);if(requests.length===1){cb(null,data);}else{data.copy(ret,request.fileOffsetInRange);if(++numRequestsSucceeded===requests.length){cb(null,ret);}}}get.concat(opts,function(err,res,data){if(hasError)return;if(err){if(typeof window==="undefined"||url.startsWith(window.location.origin+"/")){hasError=true;return cb(err);}return get.head(url,function(errHead,res){if(hasError)return;if(errHead){hasError=true;return cb(errHead);}if(res.statusCode<200||res.statusCode>=300){hasError=true;return cb(new Error("Unexpected HTTP status code "+res.statusCode));}if(res.url===url){hasError=true;return cb(err);}opts.url=res.url;get.concat(opts,function(err,res,data){if(hasError)return;if(err){hasError=true;return cb(err);}onResponse(res,data);});});}onResponse(res,data);});});};WebConn.prototype.destroy=function(){Wire.prototype.destroy.call(this);this._torrent=null;};},{"../package.json":369,bitfield:8,"bittorrent-protocol":9,debug:69,inherits:94,"safe-buffer":177,"simple-get":180,"simple-sha1":193}],358:[function(require,module,exports){arguments[4][10][0].apply(exports,arguments);},{dup:10}],359:[function(require,module,exports){arguments[4][11][0].apply(exports,arguments);},{"./_stream_readable":361,"./_stream_writable":363,"core-util-is":56,dup:11,inherits:94,"process-nextick-args":152}],360:[function(require,module,exports){arguments[4][12][0].apply(exports,arguments);},{"./_stream_transform":362,"core-util-is":56,dup:12,inherits:94}],361:[function(require,module,exports){arguments[4][13][0].apply(exports,arguments);},{"./_stream_duplex":359,"./internal/streams/BufferList":364,"./internal/streams/destroy":365,"./internal/streams/stream":366,_process:40,"core-util-is":56,dup:13,events:73,inherits:94,isarray:358,"process-nextick-args":152,"safe-buffer":177,"string_decoder/":368,util:38}],362:[function(require,module,exports){arguments[4][14][0].apply(exports,arguments);},{"./_stream_duplex":359,"core-util-is":56,dup:14,inherits:94}],363:[function(require,module,exports){arguments[4][15][0].apply(exports,arguments);},{"./_stream_duplex":359,"./internal/streams/destroy":365,"./internal/streams/stream":366,_process:40,"core-util-is":56,dup:15,inherits:94,"process-nextick-args":152,"safe-buffer":177,"util-deprecate":239}],364:[function(require,module,exports){arguments[4][16][0].apply(exports,arguments);},{dup:16,"safe-buffer":177}],365:[function(require,module,exports){arguments[4][17][0].apply(exports,arguments);},{dup:17,"process-nextick-args":152}],366:[function(require,module,exports){arguments[4][18][0].apply(exports,arguments);},{dup:18,events:73}],367:[function(require,module,exports){arguments[4][19][0].apply(exports,arguments);},{"./lib/_stream_duplex.js":359,"./lib/_stream_passthrough.js":360,"./lib/_stream_readable.js":361,"./lib/_stream_transform.js":362,"./lib/_stream_writable.js":363,dup:19}],368:[function(require,module,exports){arguments[4][20][0].apply(exports,arguments);},{dup:20,"safe-buffer":177}],369:[function(require,module,exports){module.exports={version:"0.98.19"};},{}],370:[function(require,module,exports){module.exports=wrappy;function wrappy(fn,cb){if(fn&&cb)return wrappy(fn)(cb);if(typeof fn!=="function")throw new TypeError("need wrapper function");Object.keys(fn).forEach(function(k){wrapper[k]=fn[k];});return wrapper;function wrapper(){var args=new Array(arguments.length);for(var i=0;i<args.length;i++){args[i]=arguments[i];}var ret=fn.apply(this,args);var cb=args[args.length-1];if(typeof ret==="function"&&ret!==cb){Object.keys(cb).forEach(function(k){ret[k]=cb[k];});}return ret;}}},{}],371:[function(require,module,exports){"use strict";var window=require("global/window");var isFunction=require("is-function");var parseHeaders=require("parse-headers");var xtend=require("xtend");module.exports=createXHR;createXHR.XMLHttpRequest=window.XMLHttpRequest||noop;createXHR.XDomainRequest="withCredentials"in new createXHR.XMLHttpRequest()?createXHR.XMLHttpRequest:window.XDomainRequest;forEachArray(["get","put","post","patch","head","delete"],function(method){createXHR[method==="delete"?"del":method]=function(uri,options,callback){options=initParams(uri,options,callback);options.method=method.toUpperCase();return _createXHR(options);};});function forEachArray(array,iterator){for(var i=0;i<array.length;i++){iterator(array[i]);}}function isEmpty(obj){for(var i in obj){if(obj.hasOwnProperty(i))return false;}return true;}function initParams(uri,options,callback){var params=uri;if(isFunction(options)){callback=options;if(typeof uri==="string"){params={uri:uri};}}else{params=xtend(options,{uri:uri});}params.callback=callback;return params;}function createXHR(uri,options,callback){options=initParams(uri,options,callback);return _createXHR(options);}function _createXHR(options){if(typeof options.callback==="undefined"){throw new Error("callback argument missing");}var called=false;var callback=function cbOnce(err,response,body){if(!called){called=true;options.callback(err,response,body);}};function readystatechange(){if(xhr.readyState===4){loadFunc();}}function getBody(){var body=undefined;if(xhr.response){body=xhr.response;}else{body=xhr.responseText||getXml(xhr);}if(isJson){try{body=JSON.parse(body);}catch(e){}}return body;}var failureResponse={body:undefined,headers:{},statusCode:0,method:method,url:uri,rawRequest:xhr};function errorFunc(evt){clearTimeout(timeoutTimer);if(!(evt instanceof Error)){evt=new Error(""+(evt||"Unknown XMLHttpRequest Error"));}evt.statusCode=0;return callback(evt,failureResponse);}function loadFunc(){if(aborted)return;var status;clearTimeout(timeoutTimer);if(options.useXDR&&xhr.status===undefined){status=200;}else{status=xhr.status===1223?204:xhr.status;}var response=failureResponse;var err=null;if(status!==0){response={body:getBody(),statusCode:status,method:method,headers:{},url:uri,rawRequest:xhr};if(xhr.getAllResponseHeaders){response.headers=parseHeaders(xhr.getAllResponseHeaders());}}else{err=new Error("Internal XMLHttpRequest Error");}return callback(err,response,response.body);}var xhr=options.xhr||null;if(!xhr){if(options.cors||options.useXDR){xhr=new createXHR.XDomainRequest();}else{xhr=new createXHR.XMLHttpRequest();}}var key;var aborted;var uri=xhr.url=options.uri||options.url;var method=xhr.method=options.method||"GET";var body=options.body||options.data||null;var headers=xhr.headers=options.headers||{};var sync=!!options.sync;var isJson=false;var timeoutTimer;if("json"in options){isJson=true;headers["accept"]||headers["Accept"]||(headers["Accept"]="application/json");if(method!=="GET"&&method!=="HEAD"){headers["content-type"]||headers["Content-Type"]||(headers["Content-Type"]="application/json");body=JSON.stringify(options.json);}}xhr.onreadystatechange=readystatechange;xhr.onload=loadFunc;xhr.onerror=errorFunc;xhr.onprogress=function(){};xhr.ontimeout=errorFunc;xhr.open(method,uri,!sync,options.username,options.password);if(!sync){xhr.withCredentials=!!options.withCredentials;}if(!sync&&options.timeout>0){timeoutTimer=setTimeout(function(){aborted=true;xhr.abort("timeout");var e=new Error("XMLHttpRequest timeout");e.code="ETIMEDOUT";errorFunc(e);},options.timeout);}if(xhr.setRequestHeader){for(key in headers){if(headers.hasOwnProperty(key)){xhr.setRequestHeader(key,headers[key]);}}}else if(options.headers&&!isEmpty(options.headers)){throw new Error("Headers cannot be set on an XDomainRequest object");}if("responseType"in options){xhr.responseType=options.responseType;}if("beforeSend"in options&&typeof options.beforeSend==="function"){options.beforeSend(xhr);}xhr.send(body);return xhr;}function getXml(xhr){if(xhr.responseType==="document"){return xhr.responseXML;}var firefoxBugTakenEffect=xhr.status===204&&xhr.responseXML&&xhr.responseXML.documentElement.nodeName==="parsererror";if(xhr.responseType===""&&!firefoxBugTakenEffect){return xhr.responseXML;}return null;}function noop(){}},{"global/window":90,"is-function":98,"parse-headers":147,xtend:372}],372:[function(require,module,exports){module.exports=extend;var hasOwnProperty=Object.prototype.hasOwnProperty;function extend(){var target={};for(var i=0;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(hasOwnProperty.call(source,key)){target[key]=source[key];}}}return target;}},{}],373:[function(require,module,exports){module.exports=extend;var hasOwnProperty=Object.prototype.hasOwnProperty;function extend(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(hasOwnProperty.call(source,key)){target[key]=source[key];}}}return target;}},{}],374:[function(require,module,exports){module.exports=function zeroFill(width,number,pad){if(number===undefined){return function(number,pad){return zeroFill(width,number,pad);};}if(pad===undefined)pad="0";width-=number.toString().length;if(width>0)return new Array(width+(/\./.test(number)?2:1)).join(pad)+number;return number+"";};},{}],375:[function(require,module,exports){var DependencyInjector=function DependencyInjector(videojs){this._videojs=videojs;this._scripts=[{url:"//imasdk.googleapis.com/js/sdkloader/ima3.js",required:false}];};DependencyInjector.prototype.loadDependencies=function loadDependencies(){var self=this;window.videojs=this._videojs;var _promises=[];for(var i=0;i<this._scripts.length;i++){_promises.push(this._loadScript(this._scripts[i]));}return Promise.all(_promises).then(function(result){var vjsQualitySwitcher=require("videojs-resolution-switcher");var videojs_ima=require("videojs-ima");self._videojs.plugin("ima",function(options,readyCallback){this.ima=new videojs_ima(this,options,readyCallback);});}).catch(function(e){console.log(e.stack);throw new Error("Could not load dependency: "+e);});};DependencyInjector.prototype._loadScript=function _loadScript(scriptObj){return new Promise(function(resolve,reject){var script=document.createElement("script");script.src=scriptObj.url;script.onload=function(){resolve(true);};script.onerror=function(){if(scriptObj.required===true){reject(script);}else{resolve(false);}};document.head.appendChild(script);});};module.exports=DependencyInjector;},{"videojs-ima":341,"videojs-resolution-switcher":342}],376:[function(require,module,exports){var WebTorrent=require("webtorrent");var VideoTorrent=function VideoTorrent(){this.torrent=null;this.destroy=function(){return Promise.resolve(true);};};VideoTorrent.prototype.change=function change(magnet_url){var self=this;if(this.torrent!==null){this.destroy=function(){return new Promise(function(resolve,reject){try{self.torrent.destroy(function(){self.torrent=null;resolve(true);});}catch(e){reject(e);}});};}return this.destroy().then(function(){self.torrent=new WebTorrent();return self.torrent.add(magnet_url,function(file){return file;});});};VideoTorrent.prototype.isSupported=function isSupported(){return WebTorrent.WEBRTC_SUPPORT;};module.exports=VideoTorrent;},{webtorrent:351}]},{},[1]);
